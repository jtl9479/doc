# 29ì¥ ëŒë‹¤ í‘œí˜„ì‹ - Part 2: ê¸°ì—… ì‚¬ë¡€ & ì£¼ë‹ˆì–´ ê°œë°œì ì‹œë‚˜ë¦¬ì˜¤

## ğŸ“š ëª©ì°¨
1. [3ê°œ ê¸°ì—… ì‹¤ì „ ì‚¬ë¡€](#ê¸°ì—…-ì‚¬ë¡€)
   - ë„¤ì´ë²„: ê²€ìƒ‰ í•„í„° ì‹œìŠ¤í…œ
   - ì¿ íŒ¡: ìƒí’ˆ ì •ë ¬ ì—”ì§„
   - í† ìŠ¤: ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì•„í‚¤í…ì²˜
2. [4ê°œ ì£¼ë‹ˆì–´ ê°œë°œì ì‹¤ìˆ˜ ì‹œë‚˜ë¦¬ì˜¤](#ì£¼ë‹ˆì–´-ì‹¤ìˆ˜-ì‹œë‚˜ë¦¬ì˜¤)

---

## ğŸ¢ ê¸°ì—… ì‚¬ë¡€

### ğŸ”· ê¸°ì—… ì‚¬ë¡€ 1: ë„¤ì´ë²„ - ê²€ìƒ‰ í•„í„° ì‹œìŠ¤í…œ

#### ğŸ“Œ ë¹„ì¦ˆë‹ˆìŠ¤ ë°°ê²½

ë„¤ì´ë²„ ì‡¼í•‘ì—ì„œëŠ” ìˆ˜ë°±ë§Œ ê°œì˜ ìƒí’ˆ ì¤‘ ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ì¡°ê±´ì— ë§ëŠ” ìƒí’ˆë§Œ í•„í„°ë§í•´ì•¼ í•©ë‹ˆë‹¤.

**ìš”êµ¬ì‚¬í•­**:
- ë‹¤ì–‘í•œ í•„í„° ì¡°ê±´ (ê°€ê²©, ë¸Œëœë“œ, ë°°ì†¡, í‰ì  ë“±)
- í•„í„° ì¡°ê±´ ë™ì  ì¡°í•©
- ì„±ëŠ¥ ìµœì í™” (ëŒ€ìš©ëŸ‰ ë°ì´í„°)
- ìœ ì—°í•œ í™•ì¥ì„±

**ë¬¸ì œ ìƒí™©**:
- í•„í„° ì¡°ê±´ë§ˆë‹¤ ë³„ë„ ë©”ì„œë“œ ì‘ì„± â†’ ì½”ë“œ ì¤‘ë³µ
- ìƒˆë¡œìš´ í•„í„° ì¶”ê°€ ì‹œ ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • í•„ìš”
- ë³µì¡í•œ ì¡°ê±´ ì¡°í•© êµ¬í˜„ì˜ ì–´ë ¤ì›€

#### ğŸ’¡ ëŒë‹¤ë¥¼ í™œìš©í•œ í•´ê²°ì±…

```java
package com.naver.shopping;

import java.util.*;
import java.util.function.Predicate;
import java.util.stream.Collectors;

/**
 * ìƒí’ˆ ì •ë³´
 */
class Product {
    private String id;
    private String name;
    private String brand;
    private int price;
    private double rating;  // í‰ì  (0.0 ~ 5.0)
    private boolean fastShipping;  // ë¹ ë¥¸ ë°°ì†¡ ê°€ëŠ¥ ì—¬ë¶€
    private String category;

    public Product(String id, String name, String brand, int price,
                   double rating, boolean fastShipping, String category) {
        this.id = id;
        this.name = name;
        this.brand = brand;
        this.price = price;
        this.rating = rating;
        this.fastShipping = fastShipping;
        this.category = category;
    }

    public String getId() { return id; }
    public String getName() { return name; }
    public String getBrand() { return brand; }
    public int getPrice() { return price; }
    public double getRating() { return rating; }
    public boolean isFastShipping() { return fastShipping; }
    public String getCategory() { return category; }

    @Override
    public String toString() {
        return String.format("[%s] %s - %,dì› (â˜…%.1f) %s",
            brand, name, price, rating,
            fastShipping ? "âš¡ë¹ ë¥¸ë°°ì†¡" : "");
    }
}

/**
 * ê²€ìƒ‰ í•„í„° ì‹œìŠ¤í…œ
 */
class ProductFilter {
    private List<Product> products;

    public ProductFilter(List<Product> products) {
        this.products = products;
    }

    /**
     * âœ… ëŒë‹¤ ê¸°ë°˜ í•„í„°ë§ (í•µì‹¬ ë©”ì„œë“œ)
     */
    public List<Product> filter(Predicate<Product> condition) {
        return products.stream()
            .filter(condition)
            .collect(Collectors.toList());
    }

    /**
     * ì‚¬ì „ ì •ì˜ëœ í•„í„° ì¡°ê±´ë“¤ (ì¬ì‚¬ìš© ê°€ëŠ¥)
     */
    public static class Filters {
        // ê°€ê²© ë²”ìœ„
        public static Predicate<Product> priceRange(int min, int max) {
            return product -> product.getPrice() >= min && product.getPrice() <= max;
        }

        // íŠ¹ì • ë¸Œëœë“œ
        public static Predicate<Product> brand(String brand) {
            return product -> product.getBrand().equals(brand);
        }

        // í‰ì  ì´ìƒ
        public static Predicate<Product> ratingAbove(double minRating) {
            return product -> product.getRating() >= minRating;
        }

        // ë¹ ë¥¸ ë°°ì†¡ ê°€ëŠ¥
        public static Predicate<Product> fastShipping() {
            return Product::isFastShipping;
        }

        // ì¹´í…Œê³ ë¦¬
        public static Predicate<Product> category(String category) {
            return product -> product.getCategory().equals(category);
        }

        // í‚¤ì›Œë“œ ê²€ìƒ‰
        public static Predicate<Product> nameContains(String keyword) {
            return product -> product.getName().toLowerCase()
                .contains(keyword.toLowerCase());
        }
    }

    /**
     * ì •ë ¬ ê¸°ì¤€
     */
    public List<Product> sort(Comparator<Product> comparator) {
        return products.stream()
            .sorted(comparator)
            .collect(Collectors.toList());
    }
}

/**
 * ë„¤ì´ë²„ ì‡¼í•‘ ê²€ìƒ‰ ì‹œìŠ¤í…œ ë°ëª¨
 */
public class NaverShoppingDemo {
    public static void main(String[] args) {
        System.out.println("=== ë„¤ì´ë²„ ì‡¼í•‘ ê²€ìƒ‰ í•„í„° ì‹œìŠ¤í…œ ===\n");

        // ìƒí’ˆ ë°ì´í„°
        List<Product> products = Arrays.asList(
            new Product("P001", "ê°¤ëŸ­ì‹œ S23", "ì‚¼ì„±", 1200000, 4.5, true, "ì „ìê¸°ê¸°"),
            new Product("P002", "ì•„ì´í° 14", "ì• í”Œ", 1400000, 4.8, true, "ì „ìê¸°ê¸°"),
            new Product("P003", "ì—ì–´íŒŸ í”„ë¡œ", "ì• í”Œ", 350000, 4.7, true, "ì „ìê¸°ê¸°"),
            new Product("P004", "ê°¤ëŸ­ì‹œ ë²„ì¦ˆ", "ì‚¼ì„±", 180000, 4.3, true, "ì „ìê¸°ê¸°"),
            new Product("P005", "ë§¥ë¶ í”„ë¡œ", "ì• í”Œ", 2500000, 4.9, false, "ì „ìê¸°ê¸°"),
            new Product("P006", "LG ê·¸ë¨", "LG", 1800000, 4.4, true, "ì „ìê¸°ê¸°"),
            new Product("P007", "ë‚˜ì´í‚¤ ìš´ë™í™”", "ë‚˜ì´í‚¤", 120000, 4.2, true, "íŒ¨ì…˜"),
            new Product("P008", "ì•„ë””ë‹¤ìŠ¤ ìš´ë™í™”", "ì•„ë””ë‹¤ìŠ¤", 150000, 4.5, false, "íŒ¨ì…˜"),
            new Product("P009", "ë‹¤ì´ìŠ¨ ì²­ì†Œê¸°", "ë‹¤ì´ìŠ¨", 800000, 4.6, true, "ê°€ì „"),
            new Product("P010", "ì‚¼ì„± ëƒ‰ì¥ê³ ", "ì‚¼ì„±", 1500000, 4.7, false, "ê°€ì „")
        );

        ProductFilter filter = new ProductFilter(products);

        // ì‹œë‚˜ë¦¬ì˜¤ 1: ë‹¨ì¼ ì¡°ê±´ í•„í„°
        System.out.println("ğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 1: ë‹¨ì¼ ì¡°ê±´ í•„í„°");

        // ê°€ê²© 50ë§Œì› ì´í•˜
        List<Product> affordable = filter.filter(
            ProductFilter.Filters.priceRange(0, 500000)
        );

        System.out.println("50ë§Œì› ì´í•˜ ìƒí’ˆ: " + affordable.size() + "ê°œ");
        affordable.forEach(p -> System.out.println("  " + p));
        System.out.println();

        // ì‹œë‚˜ë¦¬ì˜¤ 2: ë³µí•© ì¡°ê±´ (AND)
        System.out.println("ğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 2: ë³µí•© ì¡°ê±´ (AND)");

        // 100ë§Œì› ì´í•˜ + í‰ì  4.5 ì´ìƒ + ë¹ ë¥¸ ë°°ì†¡
        List<Product> premium = filter.filter(
            ProductFilter.Filters.priceRange(0, 1000000)
                .and(ProductFilter.Filters.ratingAbove(4.5))
                .and(ProductFilter.Filters.fastShipping())
        );

        System.out.println("í”„ë¦¬ë¯¸ì—„ ì¡°ê±´ (100ë§Œì› ì´í•˜ + â˜…4.5+ + ë¹ ë¥¸ë°°ì†¡): " + premium.size() + "ê°œ");
        premium.forEach(p -> System.out.println("  " + p));
        System.out.println();

        // ì‹œë‚˜ë¦¬ì˜¤ 3: OR ì¡°ê±´
        System.out.println("ğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 3: OR ì¡°ê±´");

        // ì‚¼ì„± ë˜ëŠ” ì• í”Œ ì œí’ˆ
        List<Product> brands = filter.filter(
            ProductFilter.Filters.brand("ì‚¼ì„±")
                .or(ProductFilter.Filters.brand("ì• í”Œ"))
        );

        System.out.println("ì‚¼ì„± ë˜ëŠ” ì• í”Œ ì œí’ˆ: " + brands.size() + "ê°œ");
        brands.forEach(p -> System.out.println("  " + p));
        System.out.println();

        // ì‹œë‚˜ë¦¬ì˜¤ 4: ì»¤ìŠ¤í…€ í•„í„° (ëŒë‹¤ ì§ì ‘ ì‚¬ìš©)
        System.out.println("ğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 4: ì»¤ìŠ¤í…€ í•„í„°");

        // ê°€ê²©ì´ 7ìë¦¬ ì´ìƒì¸ ì´ˆê³ ê°€ ì œí’ˆ
        List<Product> luxury = filter.filter(
            product -> product.getPrice() >= 1000000
        );

        System.out.println("ì´ˆê³ ê°€ ì œí’ˆ (100ë§Œì› ì´ìƒ): " + luxury.size() + "ê°œ");
        luxury.forEach(p -> System.out.println("  " + p));
        System.out.println();

        // ì‹œë‚˜ë¦¬ì˜¤ 5: ë™ì  í•„í„° ì¡°í•©
        System.out.println("ğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 5: ë™ì  í•„í„° ì¡°í•© (ì‚¬ìš©ì ì„ íƒì— ë”°ë¼)");

        // ì‚¬ìš©ì ì„ íƒ ì‹œë®¬ë ˆì´ì…˜
        Map<String, Object> userSelection = new HashMap<>();
        userSelection.put("minPrice", 0);
        userSelection.put("maxPrice", 500000);
        userSelection.put("minRating", 4.3);
        userSelection.put("fastShipping", true);
        userSelection.put("category", "ì „ìê¸°ê¸°");

        // ë™ì ìœ¼ë¡œ í•„í„° êµ¬ì„±
        Predicate<Product> dynamicFilter = buildDynamicFilter(userSelection);

        List<Product> results = filter.filter(dynamicFilter);

        System.out.println("ì‚¬ìš©ì ì¡°ê±´ì— ë§ëŠ” ìƒí’ˆ: " + results.size() + "ê°œ");
        results.forEach(p -> System.out.println("  " + p));
        System.out.println();

        // ì‹œë‚˜ë¦¬ì˜¤ 6: í•„í„° + ì •ë ¬
        System.out.println("ğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 6: í•„í„° + ì •ë ¬");

        List<Product> filtered = products.stream()
            .filter(ProductFilter.Filters.category("ì „ìê¸°ê¸°"))
            .filter(ProductFilter.Filters.fastShipping())
            .sorted(Comparator.comparing(Product::getPrice))  // ê°€ê²© ë‚®ì€ ìˆœ
            .collect(Collectors.toList());

        System.out.println("ì „ìê¸°ê¸° + ë¹ ë¥¸ë°°ì†¡ (ê°€ê²© ë‚®ì€ ìˆœ):");
        filtered.forEach(p -> System.out.println("  " + p));
        System.out.println();

        // ì„±ëŠ¥ ë¹„êµ
        System.out.println("ğŸ“Š ëŒë‹¤ ê¸°ë°˜ í•„í„°ì˜ ì¥ì :");
        System.out.println("âœ… ì½”ë“œ ê°„ê²°ì„±: ì¡°ê±´ì„ í•œ ì¤„ë¡œ í‘œí˜„");
        System.out.println("âœ… ì¬ì‚¬ìš©ì„±: í•„í„° ì¡°ê±´ì„ ë³€ìˆ˜ë¡œ ì €ì¥ ë° ì¡°í•©");
        System.out.println("âœ… í™•ì¥ì„±: ìƒˆ í•„í„° ì¶”ê°€ ì‹œ ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš”");
        System.out.println("âœ… ê°€ë…ì„±: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ëª…í™•í•¨");
    }

    /**
     * ì‚¬ìš©ì ì„ íƒì— ë”°ë¼ ë™ì ìœ¼ë¡œ í•„í„° êµ¬ì„±
     */
    private static Predicate<Product> buildDynamicFilter(Map<String, Object> selection) {
        Predicate<Product> filter = product -> true;  // ì´ˆê¸°ê°’: ëª¨ë“  ìƒí’ˆ í—ˆìš©

        if (selection.containsKey("minPrice") && selection.containsKey("maxPrice")) {
            int min = (int) selection.get("minPrice");
            int max = (int) selection.get("maxPrice");
            filter = filter.and(ProductFilter.Filters.priceRange(min, max));
        }

        if (selection.containsKey("minRating")) {
            double minRating = (double) selection.get("minRating");
            filter = filter.and(ProductFilter.Filters.ratingAbove(minRating));
        }

        if (selection.containsKey("fastShipping") &&
            (boolean) selection.get("fastShipping")) {
            filter = filter.and(ProductFilter.Filters.fastShipping());
        }

        if (selection.containsKey("category")) {
            String category = (String) selection.get("category");
            filter = filter.and(ProductFilter.Filters.category(category));
        }

        return filter;
    }
}
```

#### ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸

**1. Predicate ì¡°í•© íŒ¨í„´**:
```java
// ì¬ì‚¬ìš© ê°€ëŠ¥í•œ í•„í„° ì¡°ê±´
Predicate<Product> expensive = p -> p.getPrice() > 1000000;
Predicate<Product> highRating = p -> p.getRating() >= 4.5;

// AND ì¡°í•©
Predicate<Product> premium = expensive.and(highRating);

// OR ì¡°í•©
Predicate<Product> goodDeal = expensive.or(highRating);

// NOT
Predicate<Product> notExpensive = expensive.negate();
```

**2. ëŒë‹¤ ê¸°ë°˜ í•„í„°ì˜ ì¥ì **:
```
Before (ì „í†µì ì¸ ë°©ì‹):
- í•„í„° ë©”ì„œë“œ ìˆ˜ì‹­ ê°œ
- ì¡°ê±´ ì¡°í•© ë³µì¡
- ì½”ë“œ ì¤‘ë³µ ë‹¤ìˆ˜

After (ëŒë‹¤):
- ë‹¨ì¼ filter() ë©”ì„œë“œ
- ì¡°ê±´ ì¡°í•© ê°„ë‹¨ (.and, .or)
- ì½”ë“œ ì¬ì‚¬ìš©
```

---

### ğŸ”· ê¸°ì—… ì‚¬ë¡€ 2: ì¿ íŒ¡ - ìƒí’ˆ ì •ë ¬ ì—”ì§„

#### ğŸ“Œ ë¹„ì¦ˆë‹ˆìŠ¤ ë°°ê²½

ì¿ íŒ¡ì—ì„œëŠ” ìˆ˜ë°±ë§Œ ê°œì˜ ìƒí’ˆì„ ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•´ì•¼ í•©ë‹ˆë‹¤.

**ì •ë ¬ ê¸°ì¤€**:
```
1. ë‚®ì€ ê°€ê²©ìˆœ
2. ë†’ì€ ê°€ê²©ìˆœ
3. í• ì¸ìœ¨ ë†’ì€ ìˆœ
4. í‰ì  ë†’ì€ ìˆœ
5. ë¦¬ë·° ë§ì€ ìˆœ
6. ìµœì‹  ë“±ë¡ìˆœ
7. ë¡œì¼“ë°°ì†¡ ìš°ì„ 
```

**ë¬¸ì œ ìƒí™©**:
- ì •ë ¬ ê¸°ì¤€ë§ˆë‹¤ ë³„ë„ ë©”ì„œë“œ í•„ìš”
- ë‹¤ë‹¨ê³„ ì •ë ¬ êµ¬í˜„ì˜ ë³µì¡í•¨
- ì •ë ¬ ê¸°ì¤€ ë³€ê²½ ì‹œ ê¸°ì¡´ ì½”ë“œ ìˆ˜ì •

#### ğŸ’¡ ëŒë‹¤ë¥¼ í™œìš©í•œ í•´ê²°ì±…

```java
package com.coupang.sort;

import java.time.LocalDate;
import java.util.*;
import java.util.stream.Collectors;

/**
 * ì¿ íŒ¡ ìƒí’ˆ
 */
class CoupangProduct {
    private String name;
    private int originalPrice;  // ì›ê°€
    private int salePrice;      // íŒë§¤ê°€
    private double rating;      // í‰ì 
    private int reviewCount;    // ë¦¬ë·° ìˆ˜
    private LocalDate registeredDate;  // ë“±ë¡ì¼
    private boolean rocketDelivery;    // ë¡œì¼“ë°°ì†¡

    public CoupangProduct(String name, int originalPrice, int salePrice,
                          double rating, int reviewCount, LocalDate registeredDate,
                          boolean rocketDelivery) {
        this.name = name;
        this.originalPrice = originalPrice;
        this.salePrice = salePrice;
        this.rating = rating;
        this.reviewCount = reviewCount;
        this.registeredDate = registeredDate;
        this.rocketDelivery = rocketDelivery;
    }

    public String getName() { return name; }
    public int getOriginalPrice() { return originalPrice; }
    public int getSalePrice() { return salePrice; }
    public double getRating() { return rating; }
    public int getReviewCount() { return reviewCount; }
    public LocalDate getRegisteredDate() { return registeredDate; }
    public boolean isRocketDelivery() { return rocketDelivery; }

    /**
     * í• ì¸ìœ¨ ê³„ì‚°
     */
    public double getDiscountRate() {
        if (originalPrice == 0) return 0;
        return (1.0 - (double) salePrice / originalPrice) * 100;
    }

    @Override
    public String toString() {
        return String.format("%s - %,dì› (%.0f%% í• ì¸) â˜…%.1f (%dë¦¬ë·°) %s",
            name, salePrice, getDiscountRate(), rating, reviewCount,
            rocketDelivery ? "ğŸš€" : "");
    }
}

/**
 * ì •ë ¬ ì—”ì§„
 */
class SortingEngine {
    /**
     * ì‚¬ì „ ì •ì˜ëœ ì •ë ¬ ê¸°ì¤€ë“¤
     */
    public static class Sorters {
        // ë‚®ì€ ê°€ê²©ìˆœ
        public static Comparator<CoupangProduct> byPriceLowToHigh() {
            return Comparator.comparing(CoupangProduct::getSalePrice);
        }

        // ë†’ì€ ê°€ê²©ìˆœ
        public static Comparator<CoupangProduct> byPriceHighToLow() {
            return Comparator.comparing(CoupangProduct::getSalePrice).reversed();
        }

        // í• ì¸ìœ¨ ë†’ì€ ìˆœ
        public static Comparator<CoupangProduct> byDiscountRate() {
            return Comparator.comparing(CoupangProduct::getDiscountRate).reversed();
        }

        // í‰ì  ë†’ì€ ìˆœ
        public static Comparator<CoupangProduct> byRating() {
            return Comparator.comparing(CoupangProduct::getRating).reversed();
        }

        // ë¦¬ë·° ë§ì€ ìˆœ
        public static Comparator<CoupangProduct> byReviewCount() {
            return Comparator.comparing(CoupangProduct::getReviewCount).reversed();
        }

        // ìµœì‹  ë“±ë¡ìˆœ
        public static Comparator<CoupangProduct> byRegisteredDate() {
            return Comparator.comparing(CoupangProduct::getRegisteredDate).reversed();
        }

        // ë¡œì¼“ë°°ì†¡ ìš°ì„ 
        public static Comparator<CoupangProduct> byRocketDelivery() {
            return Comparator.comparing(CoupangProduct::isRocketDelivery).reversed();
        }

        /**
         * ì¿ íŒ¡ ì¶”ì²œìˆœ (ë³µí•© ì •ë ¬)
         * 1. ë¡œì¼“ë°°ì†¡ ìš°ì„ 
         * 2. í‰ì  ë†’ì€ ìˆœ
         * 3. ë¦¬ë·° ë§ì€ ìˆœ
         */
        public static Comparator<CoupangProduct> recommended() {
            return byRocketDelivery()
                .thenComparing(byRating())
                .thenComparing(byReviewCount());
        }
    }

    /**
     * ì •ë ¬ ìˆ˜í–‰
     */
    public static List<CoupangProduct> sort(List<CoupangProduct> products,
                                            Comparator<CoupangProduct> comparator) {
        return products.stream()
            .sorted(comparator)
            .collect(Collectors.toList());
    }
}

/**
 * ì¿ íŒ¡ ì •ë ¬ ì—”ì§„ ë°ëª¨
 */
public class CoupangSortDemo {
    public static void main(String[] args) {
        System.out.println("=== ì¿ íŒ¡ ìƒí’ˆ ì •ë ¬ ì—”ì§„ ===\n");

        // ìƒí’ˆ ë°ì´í„°
        List<CoupangProduct> products = Arrays.asList(
            new CoupangProduct("ë…¸íŠ¸ë¶ A", 1500000, 1200000, 4.5, 350, LocalDate.of(2023, 1, 15), true),
            new CoupangProduct("ë…¸íŠ¸ë¶ B", 2000000, 1800000, 4.8, 520, LocalDate.of(2023, 2, 10), true),
            new CoupangProduct("ë…¸íŠ¸ë¶ C", 1000000, 700000, 4.2, 180, LocalDate.of(2023, 3, 5), false),
            new CoupangProduct("ë…¸íŠ¸ë¶ D", 1800000, 1500000, 4.6, 420, LocalDate.of(2023, 1, 20), true),
            new CoupangProduct("ë…¸íŠ¸ë¶ E", 1200000, 1000000, 4.3, 210, LocalDate.of(2023, 2, 28), false),
            new CoupangProduct("ë…¸íŠ¸ë¶ F", 2500000, 2000000, 4.9, 680, LocalDate.of(2023, 3, 12), true)
        );

        // ì‹œë‚˜ë¦¬ì˜¤ 1: ë‚®ì€ ê°€ê²©ìˆœ
        System.out.println("ğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 1: ë‚®ì€ ê°€ê²©ìˆœ");
        List<CoupangProduct> byPrice = SortingEngine.sort(
            products,
            SortingEngine.Sorters.byPriceLowToHigh()
        );

        byPrice.forEach(p -> System.out.println("  " + p));
        System.out.println();

        // ì‹œë‚˜ë¦¬ì˜¤ 2: í• ì¸ìœ¨ ë†’ì€ ìˆœ
        System.out.println("ğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 2: í• ì¸ìœ¨ ë†’ì€ ìˆœ");
        List<CoupangProduct> byDiscount = SortingEngine.sort(
            products,
            SortingEngine.Sorters.byDiscountRate()
        );

        byDiscount.forEach(p -> System.out.println("  " + p));
        System.out.println();

        // ì‹œë‚˜ë¦¬ì˜¤ 3: í‰ì  ë†’ì€ ìˆœ
        System.out.println("ğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 3: í‰ì  ë†’ì€ ìˆœ");
        List<CoupangProduct> byRating = SortingEngine.sort(
            products,
            SortingEngine.Sorters.byRating()
        );

        byRating.forEach(p -> System.out.println("  " + p));
        System.out.println();

        // ì‹œë‚˜ë¦¬ì˜¤ 4: ì¿ íŒ¡ ì¶”ì²œìˆœ (ë³µí•© ì •ë ¬)
        System.out.println("ğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 4: ì¿ íŒ¡ ì¶”ì²œìˆœ (ë¡œì¼“ë°°ì†¡ â†’ í‰ì  â†’ ë¦¬ë·°)");
        List<CoupangProduct> recommended = SortingEngine.sort(
            products,
            SortingEngine.Sorters.recommended()
        );

        recommended.forEach(p -> System.out.println("  " + p));
        System.out.println();

        // ì‹œë‚˜ë¦¬ì˜¤ 5: ì»¤ìŠ¤í…€ ì •ë ¬ (ëŒë‹¤ ì§ì ‘ ì‚¬ìš©)
        System.out.println("ğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 5: ì»¤ìŠ¤í…€ ì •ë ¬ (ê°€ì„±ë¹„ = í‰ì  / ê°€ê²©)");

        List<CoupangProduct> byValueForMoney = products.stream()
            .sorted((p1, p2) -> {
                double value1 = p1.getRating() / p1.getSalePrice() * 1000000;
                double value2 = p2.getRating() / p2.getSalePrice() * 1000000;
                return Double.compare(value2, value1);  // ë‚´ë¦¼ì°¨ìˆœ
            })
            .collect(Collectors.toList());

        byValueForMoney.forEach(p -> System.out.println("  " + p));
        System.out.println();

        // ì‹œë‚˜ë¦¬ì˜¤ 6: ë‹¤ë‹¨ê³„ ì •ë ¬ (ì‚¬ìš©ì ì •ì˜)
        System.out.println("ğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 6: ë‹¤ë‹¨ê³„ ì •ë ¬");
        System.out.println("1ìˆœìœ„: ë¡œì¼“ë°°ì†¡");
        System.out.println("2ìˆœìœ„: í• ì¸ìœ¨");
        System.out.println("3ìˆœìœ„: ë‚®ì€ ê°€ê²©\n");

        List<CoupangProduct> multiLevel = products.stream()
            .sorted(
                SortingEngine.Sorters.byRocketDelivery()
                    .thenComparing(SortingEngine.Sorters.byDiscountRate())
                    .thenComparing(SortingEngine.Sorters.byPriceLowToHigh())
            )
            .collect(Collectors.toList());

        multiLevel.forEach(p -> System.out.println("  " + p));
        System.out.println();

        // ì„±ëŠ¥ ë¹„êµ
        System.out.println("ğŸ“Š ëŒë‹¤ ê¸°ë°˜ ì •ë ¬ì˜ ì¥ì :");
        System.out.println("âœ… ìœ ì—°ì„±: ì •ë ¬ ê¸°ì¤€ì„ ëŸ°íƒ€ì„ì— ë³€ê²½ ê°€ëŠ¥");
        System.out.println("âœ… ì¡°í•©ì„±: thenComparing()ìœ¼ë¡œ ë‹¤ë‹¨ê³„ ì •ë ¬ ì‰½ê²Œ êµ¬í˜„");
        System.out.println("âœ… ì¬ì‚¬ìš©ì„±: ì •ë ¬ ê¸°ì¤€ì„ ë³€ìˆ˜ë¡œ ì €ì¥ ë° ì „ë‹¬");
        System.out.println("âœ… ê°€ë…ì„±: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ëª…í™•íˆ ë“œëŸ¬ë‚¨");
    }
}
```

#### ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸

**1. Comparator ë‹¤ë‹¨ê³„ ì •ë ¬**:
```java
// 1ìˆœìœ„: í‰ì 
// 2ìˆœìœ„: ë¦¬ë·° ìˆ˜
// 3ìˆœìœ„: ê°€ê²©
Comparator<Product> comparator =
    Comparator.comparing(Product::getRating).reversed()
        .thenComparing(Comparator.comparing(Product::getReviewCount).reversed())
        .thenComparing(Product::getPrice);
```

**2. ì •ë ¬ ê¸°ì¤€ì˜ ì¬ì‚¬ìš©**:
```java
// ì •ë ¬ ê¸°ì¤€ì„ ë³€ìˆ˜ë¡œ ì €ì¥
Comparator<Product> byPrice = Comparator.comparing(Product::getPrice);
Comparator<Product> byRating = Comparator.comparing(Product::getRating);

// ì‚¬ìš©ì ì„ íƒì— ë”°ë¼ ë™ì ìœ¼ë¡œ ì ìš©
String sortBy = getUserSelection();  // "price" ë˜ëŠ” "rating"

Comparator<Product> comparator = sortBy.equals("price") ? byPrice : byRating;
products.sort(comparator);
```

---

### ğŸ”· ê¸°ì—… ì‚¬ë¡€ 3: í† ìŠ¤ - ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì•„í‚¤í…ì²˜

#### ğŸ“Œ ë¹„ì¦ˆë‹ˆìŠ¤ ë°°ê²½

í† ìŠ¤ì—ì„œëŠ” ì†¡ê¸ˆ, ê²°ì œ, ì¶©ì „ ë“± ë‹¤ì–‘í•œ ì´ë²¤íŠ¸ê°€ ë°œìƒí•  ë•Œë§ˆë‹¤ ì—¬ëŸ¬ í›„ì† ì‘ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤.

**ì´ë²¤íŠ¸ ì²˜ë¦¬ ì˜ˆì‹œ**:
```
ì†¡ê¸ˆ ì™„ë£Œ ì´ë²¤íŠ¸ ë°œìƒ ì‹œ:
1. ì•Œë¦¼ ì „ì†¡
2. í¬ì¸íŠ¸ ì ë¦½
3. í†µê³„ ì—…ë°ì´íŠ¸
4. ë¡œê·¸ ê¸°ë¡
5. ì™¸ë¶€ API í˜¸ì¶œ
```

**ë¬¸ì œ ìƒí™©**:
- ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€/ì‚­ì œ ì‹œ ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • í•„ìš”
- í•¸ë“¤ëŸ¬ ê°„ ê²°í•©ë„ ë†’ìŒ
- ë¹„ë™ê¸° ì²˜ë¦¬ ë³µì¡

#### ğŸ’¡ ëŒë‹¤ë¥¼ í™œìš©í•œ í•´ê²°ì±…

```java
package com.toss.event;

import java.time.LocalDateTime;
import java.util.*;
import java.util.concurrent.*;
import java.util.function.Consumer;

/**
 * ì´ë²¤íŠ¸ ê¸°ë³¸ í´ë˜ìŠ¤
 */
abstract class Event {
    private final String eventId;
    private final LocalDateTime timestamp;

    public Event() {
        this.eventId = UUID.randomUUID().toString();
        this.timestamp = LocalDateTime.now();
    }

    public String getEventId() { return eventId; }
    public LocalDateTime getTimestamp() { return timestamp; }
}

/**
 * ì†¡ê¸ˆ ì´ë²¤íŠ¸
 */
class TransferEvent extends Event {
    private String fromUserId;
    private String toUserId;
    private long amount;

    public TransferEvent(String fromUserId, String toUserId, long amount) {
        super();
        this.fromUserId = fromUserId;
        this.toUserId = toUserId;
        this.amount = amount;
    }

    public String getFromUserId() { return fromUserId; }
    public String getToUserId() { return toUserId; }
    public long getAmount() { return amount; }

    @Override
    public String toString() {
        return String.format("ì†¡ê¸ˆ: %s â†’ %s (%,dì›)", fromUserId, toUserId, amount);
    }
}

/**
 * ê²°ì œ ì´ë²¤íŠ¸
 */
class PaymentEvent extends Event {
    private String userId;
    private String merchantName;
    private long amount;

    public PaymentEvent(String userId, String merchantName, long amount) {
        super();
        this.userId = userId;
        this.merchantName = merchantName;
        this.amount = amount;
    }

    public String getUserId() { return userId; }
    public String getMerchantName() { return merchantName; }
    public long getAmount() { return amount; }

    @Override
    public String toString() {
        return String.format("ê²°ì œ: %s @ %s (%,dì›)", userId, merchantName, amount);
    }
}

/**
 * ì´ë²¤íŠ¸ ë²„ìŠ¤ (ì´ë²¤íŠ¸ ì¤‘ì•™ ê´€ë¦¬)
 */
class EventBus {
    // ì´ë²¤íŠ¸ íƒ€ì…ë³„ í•¸ë“¤ëŸ¬ ëª©ë¡
    private Map<Class<? extends Event>, List<Consumer<Event>>> handlers = new ConcurrentHashMap<>();

    // ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•œ ìŠ¤ë ˆë“œí’€
    private ExecutorService executor = Executors.newFixedThreadPool(5);

    /**
     * âœ… ëŒë‹¤ ê¸°ë°˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡
     */
    public <T extends Event> void subscribe(Class<T> eventType, Consumer<T> handler) {
        handlers.computeIfAbsent(eventType, k -> new CopyOnWriteArrayList<>())
            .add((Consumer<Event>) handler);

        System.out.println("âœ… í•¸ë“¤ëŸ¬ ë“±ë¡: " + eventType.getSimpleName());
    }

    /**
     * ì´ë²¤íŠ¸ ë°œí–‰ (ë™ê¸°)
     */
    public void publish(Event event) {
        System.out.println("\nğŸ“¢ ì´ë²¤íŠ¸ ë°œìƒ: " + event);

        List<Consumer<Event>> eventHandlers = handlers.get(event.getClass());

        if (eventHandlers != null) {
            for (Consumer<Event> handler : eventHandlers) {
                try {
                    handler.accept(event);
                } catch (Exception e) {
                    System.err.println("âŒ í•¸ë“¤ëŸ¬ ì‹¤í–‰ ì˜¤ë¥˜: " + e.getMessage());
                }
            }
        }
    }

    /**
     * ì´ë²¤íŠ¸ ë°œí–‰ (ë¹„ë™ê¸°)
     */
    public CompletableFuture<Void> publishAsync(Event event) {
        System.out.println("\nğŸ“¢ ì´ë²¤íŠ¸ ë°œìƒ (ë¹„ë™ê¸°): " + event);

        List<Consumer<Event>> eventHandlers = handlers.get(event.getClass());

        if (eventHandlers == null || eventHandlers.isEmpty()) {
            return CompletableFuture.completedFuture(null);
        }

        // ëª¨ë“  í•¸ë“¤ëŸ¬ë¥¼ ë¹„ë™ê¸°ë¡œ ì‹¤í–‰
        CompletableFuture<?>[] futures = eventHandlers.stream()
            .map(handler -> CompletableFuture.runAsync(() -> {
                try {
                    handler.accept(event);
                } catch (Exception e) {
                    System.err.println("âŒ í•¸ë“¤ëŸ¬ ì‹¤í–‰ ì˜¤ë¥˜: " + e.getMessage());
                }
            }, executor))
            .toArray(CompletableFuture[]::new);

        return CompletableFuture.allOf(futures);
    }

    /**
     * ì¢…ë£Œ
     */
    public void shutdown() {
        executor.shutdown();
    }
}

/**
 * í† ìŠ¤ ì´ë²¤íŠ¸ ì‹œìŠ¤í…œ ë°ëª¨
 */
public class TossEventDemo {
    public static void main(String[] args) throws Exception {
        System.out.println("=== í† ìŠ¤ ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì•„í‚¤í…ì²˜ ===\n");

        EventBus eventBus = new EventBus();

        // ì‹œë‚˜ë¦¬ì˜¤ 1: ì†¡ê¸ˆ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡
        System.out.println("ğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 1: ì†¡ê¸ˆ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡\n");

        // í•¸ë“¤ëŸ¬ 1: ì•Œë¦¼ ì „ì†¡
        eventBus.subscribe(TransferEvent.class, event -> {
            TransferEvent transferEvent = (TransferEvent) event;
            System.out.println("  ğŸ“± [ì•Œë¦¼] " + transferEvent.getToUserId() + "ë‹˜ì—ê²Œ "
                + String.format("%,d", transferEvent.getAmount()) + "ì›ì´ ì…ê¸ˆë˜ì—ˆìŠµë‹ˆë‹¤");
        });

        // í•¸ë“¤ëŸ¬ 2: í¬ì¸íŠ¸ ì ë¦½
        eventBus.subscribe(TransferEvent.class, event -> {
            TransferEvent transferEvent = (TransferEvent) event;
            long points = transferEvent.getAmount() / 1000;  // 0.1% í¬ì¸íŠ¸
            System.out.println("  ğŸ [í¬ì¸íŠ¸] " + points + "P ì ë¦½");
        });

        // í•¸ë“¤ëŸ¬ 3: ë¡œê·¸ ê¸°ë¡
        eventBus.subscribe(TransferEvent.class, event -> {
            System.out.println("  ğŸ“ [ë¡œê·¸] ì´ë²¤íŠ¸ ID: " + event.getEventId()
                + " | ì‹œê°: " + event.getTimestamp());
        });

        // í•¸ë“¤ëŸ¬ 4: í†µê³„ ì—…ë°ì´íŠ¸
        eventBus.subscribe(TransferEvent.class, event -> {
            TransferEvent transferEvent = (TransferEvent) event;
            System.out.println("  ğŸ“Š [í†µê³„] ì¼ì¼ ì†¡ê¸ˆì•¡ ëˆ„ê³„ ì—…ë°ì´íŠ¸");
        });

        // ì†¡ê¸ˆ ì´ë²¤íŠ¸ ë°œìƒ
        TransferEvent transferEvent = new TransferEvent("USER001", "USER002", 50000);
        eventBus.publish(transferEvent);

        Thread.sleep(1000);

        // ì‹œë‚˜ë¦¬ì˜¤ 2: ê²°ì œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡
        System.out.println("\nğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 2: ê²°ì œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡\n");

        // í•¸ë“¤ëŸ¬ 1: ì˜ìˆ˜ì¦ ì „ì†¡
        eventBus.subscribe(PaymentEvent.class, event -> {
            PaymentEvent paymentEvent = (PaymentEvent) event;
            System.out.println("  ğŸ§¾ [ì˜ìˆ˜ì¦] " + paymentEvent.getMerchantName()
                + " ê²°ì œ ì˜ìˆ˜ì¦ ì „ì†¡");
        });

        // í•¸ë“¤ëŸ¬ 2: ìºì‹œë°± ì ë¦½
        eventBus.subscribe(PaymentEvent.class, event -> {
            PaymentEvent paymentEvent = (PaymentEvent) event;
            long cashback = paymentEvent.getAmount() / 100;  // 1% ìºì‹œë°±
            System.out.println("  ğŸ’° [ìºì‹œë°±] " + cashback + "ì› ì ë¦½");
        });

        // ê²°ì œ ì´ë²¤íŠ¸ ë°œìƒ
        PaymentEvent paymentEvent = new PaymentEvent("USER001", "ìŠ¤íƒ€ë²…ìŠ¤", 15000);
        eventBus.publish(paymentEvent);

        Thread.sleep(1000);

        // ì‹œë‚˜ë¦¬ì˜¤ 3: ë¹„ë™ê¸° ì´ë²¤íŠ¸ ì²˜ë¦¬
        System.out.println("\nğŸ“ ì‹œë‚˜ë¦¬ì˜¤ 3: ë¹„ë™ê¸° ì´ë²¤íŠ¸ ì²˜ë¦¬\n");

        // ë¬´ê±°ìš´ ì‘ì—… í•¸ë“¤ëŸ¬ ë“±ë¡
        eventBus.subscribe(TransferEvent.class, event -> {
            System.out.println("  â³ [ì™¸ë¶€ API] í˜¸ì¶œ ì‹œì‘...");
            try {
                Thread.sleep(2000);  // 2ì´ˆ ì†Œìš”
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            System.out.println("  âœ… [ì™¸ë¶€ API] í˜¸ì¶œ ì™„ë£Œ");
        });

        // ë¹„ë™ê¸° ë°œí–‰
        TransferEvent asyncEvent = new TransferEvent("USER003", "USER004", 100000);
        CompletableFuture<Void> future = eventBus.publishAsync(asyncEvent);

        System.out.println("\në©”ì¸ ìŠ¤ë ˆë“œëŠ” ê³„ì† ì‹¤í–‰ë©ë‹ˆë‹¤...");

        // ëª¨ë“  í•¸ë“¤ëŸ¬ ì™„ë£Œ ëŒ€ê¸°
        future.get();

        System.out.println("\nëª¨ë“  í•¸ë“¤ëŸ¬ ì²˜ë¦¬ ì™„ë£Œ!");

        // ì •ë¦¬
        eventBus.shutdown();

        System.out.println("\nğŸ“Š ëŒë‹¤ ê¸°ë°˜ ì´ë²¤íŠ¸ ì‹œìŠ¤í…œì˜ ì¥ì :");
        System.out.println("âœ… ëŠìŠ¨í•œ ê²°í•©: ì´ë²¤íŠ¸ ë°œí–‰ìì™€ í•¸ë“¤ëŸ¬ê°€ ë…ë¦½ì ");
        System.out.println("âœ… í™•ì¥ì„±: í•¸ë“¤ëŸ¬ ì¶”ê°€/ì œê±°ê°€ ì‰¬ì›€");
        System.out.println("âœ… ë¹„ë™ê¸° ì²˜ë¦¬: CompletableFutureì™€ ê²°í•©");
        System.out.println("âœ… í…ŒìŠ¤íŠ¸ ìš©ì´: í•¸ë“¤ëŸ¬ë¥¼ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥");
    }
}
```

#### ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸

**1. Consumer ëŒë‹¤**:
```java
// Consumer<T>: T â†’ void (ì†Œë¹„)

// ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡
eventBus.subscribe(TransferEvent.class, event -> {
    // ì´ë²¤íŠ¸ ì²˜ë¦¬ ë¡œì§
    System.out.println("ì²˜ë¦¬: " + event);
});
```

**2. ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì•„í‚¤í…ì²˜**:
```
Before (ì „í†µì ì¸ ë°©ì‹):
class TransferService {
    void transfer() {
        // ì†¡ê¸ˆ ë¡œì§
        notificationService.send();    // ê°•í•œ ê²°í•©
        pointService.accumulate();     // ê°•í•œ ê²°í•©
        logService.write();            // ê°•í•œ ê²°í•©
    }
}

After (ì´ë²¤íŠ¸ ê¸°ë°˜):
class TransferService {
    void transfer() {
        // ì†¡ê¸ˆ ë¡œì§
        eventBus.publish(new TransferEvent(...));  // ëŠìŠ¨í•œ ê²°í•©
    }
}

// ë‹¤ë¥¸ ê³³ì—ì„œ í•¸ë“¤ëŸ¬ ë“±ë¡
eventBus.subscribe(TransferEvent.class, event -> notificationService.send());
eventBus.subscribe(TransferEvent.class, event -> pointService.accumulate());
```

---

## ğŸš¨ ì£¼ë‹ˆì–´ ì‹¤ìˆ˜ ì‹œë‚˜ë¦¬ì˜¤

### âŒ ì‹¤ìˆ˜ 1: ëŒë‹¤ì—ì„œ ì™¸ë¶€ ë³€ìˆ˜ ìˆ˜ì •

#### ë¬¸ì œ ì½”ë“œ

```java
package lambda.mistakes;

import java.util.*;

public class Mistake1_ModifyingExternalVariable {
    public static void main(String[] args) {
        List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5);

        // âŒ ë‚˜ìœ ì˜ˆ: ì™¸ë¶€ ë³€ìˆ˜ ìˆ˜ì • ì‹œë„
        int sum = 0;  // effectively finalì´ ì•„ë‹˜

        numbers.forEach(n -> {
            // sum += n;  // ì»´íŒŒì¼ ì—ëŸ¬!
            // Variable used in lambda should be final or effectively final
        });

        System.out.println("Sum: " + sum);
    }
}
```

#### ì™œ ë¬¸ì œì¸ê°€?

```
ëŒë‹¤ì—ì„œ ì ‘ê·¼í•˜ëŠ” ì™¸ë¶€ ë³€ìˆ˜ëŠ” final ë˜ëŠ” effectively finalì´ì–´ì•¼ í•¨

ì´ìœ :
1. ëŒë‹¤ëŠ” ë³€ìˆ˜ì˜ ë³µì‚¬ë³¸ì„ ìº¡ì²˜
2. ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ ë™ì‘
3. ëŒë‹¤ê°€ ë‚˜ì¤‘ì— ì‹¤í–‰ë  ìˆ˜ ìˆìŒ
```

#### âœ… ì˜¬ë°”ë¥¸ í•´ê²°ì±…

```java
package lambda.mistakes;

import java.util.*;
import java.util.concurrent.atomic.AtomicInteger;

public class Mistake1_Solution {
    public static void main(String[] args) {
        List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5);

        System.out.println("=== ì™¸ë¶€ ë³€ìˆ˜ ìˆ˜ì • ì˜¬ë°”ë¥¸ ë°©ë²• ===\n");

        // âœ… í•´ê²°ì±… 1: Streamì˜ reduce ì‚¬ìš© (í•¨ìˆ˜í˜• ë°©ì‹)
        int sum1 = numbers.stream()
            .reduce(0, Integer::sum);

        System.out.println("í•´ê²°ì±… 1 (reduce): " + sum1);

        // âœ… í•´ê²°ì±… 2: AtomicInteger ì‚¬ìš©
        AtomicInteger sum2 = new AtomicInteger(0);
        numbers.forEach(n -> sum2.addAndGet(n));

        System.out.println("í•´ê²°ì±… 2 (AtomicInteger): " + sum2.get());

        // âœ… í•´ê²°ì±… 3: ë°°ì—´ ì‚¬ìš© (íŠ¸ë¦­)
        int[] sum3 = {0};
        numbers.forEach(n -> sum3[0] += n);

        System.out.println("í•´ê²°ì±… 3 (ë°°ì—´): " + sum3[0]);

        // âœ… í•´ê²°ì±… 4: ëŒë‹¤ ëŒ€ì‹  ì¼ë°˜ forë¬¸ (ê°€ì¥ ë‹¨ìˆœ)
        int sum4 = 0;
        for (int n : numbers) {
            sum4 += n;
        }

        System.out.println("í•´ê²°ì±… 4 (forë¬¸): " + sum4);

        System.out.println("\nğŸ’¡ ê¶Œì¥: Stream APIì˜ reduce ì‚¬ìš© (í•¨ìˆ˜í˜• ë°©ì‹)");
    }
}
```

---

### âŒ ì‹¤ìˆ˜ 2: ëŒë‹¤ ë‚´ë¶€ì—ì„œ ì²´í¬ ì˜ˆì™¸ ì²˜ë¦¬

#### ë¬¸ì œ ì½”ë“œ

```java
package lambda.mistakes;

import java.util.*;

public class Mistake2_CheckedException {
    public static void main(String[] args) {
        List<String> urls = Arrays.asList(
            "http://example.com/1",
            "http://example.com/2",
            "http://example.com/3"
        );

        // âŒ ë‚˜ìœ ì˜ˆ: ì²´í¬ ì˜ˆì™¸ë¥¼ ëŒë‹¤ì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŒ
        /*
        urls.forEach(url -> {
            String content = fetchUrl(url);  // ì»´íŒŒì¼ ì—ëŸ¬!
            // Unhandled exception: java.io.IOException
        });
        */
    }

    static String fetchUrl(String url) throws java.io.IOException {
        // URLì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        return "content";
    }
}
```

#### ì™œ ë¬¸ì œì¸ê°€?

```
í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ì˜ ë©”ì„œë“œëŠ” ì²´í¬ ì˜ˆì™¸ë¥¼ ë˜ì§€ì§€ ì•ŠìŒ

ì˜ˆ: Consumer<T>ì˜ accept() ë©”ì„œë“œ
void accept(T t);  // throws ì ˆì´ ì—†ìŒ!
```

#### âœ… ì˜¬ë°”ë¥¸ í•´ê²°ì±…

```java
package lambda.mistakes;

import java.io.IOException;
import java.util.*;
import java.util.function.Consumer;

public class Mistake2_Solution {
    public static void main(String[] args) {
        List<String> urls = Arrays.asList(
            "http://example.com/1",
            "http://example.com/2",
            "http://example.com/3"
        );

        System.out.println("=== ì²´í¬ ì˜ˆì™¸ ì²˜ë¦¬ ì˜¬ë°”ë¥¸ ë°©ë²• ===\n");

        // âœ… í•´ê²°ì±… 1: try-catchë¡œ ê°ì‹¸ê¸°
        System.out.println("í•´ê²°ì±… 1: try-catch");
        urls.forEach(url -> {
            try {
                String content = fetchUrl(url);
                System.out.println("  " + url + ": " + content);
            } catch (IOException e) {
                System.err.println("  ì˜¤ë¥˜: " + url + " - " + e.getMessage());
            }
        });
        System.out.println();

        // âœ… í•´ê²°ì±… 2: ë˜í¼ ë©”ì„œë“œ ì‚¬ìš©
        System.out.println("í•´ê²°ì±… 2: ë˜í¼ ë©”ì„œë“œ");
        urls.forEach(unchecked(url -> {
            String content = fetchUrl(url);
            System.out.println("  " + url + ": " + content);
        }));
        System.out.println();

        // âœ… í•´ê²°ì±… 3: ì»¤ìŠ¤í…€ í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤
        System.out.println("í•´ê²°ì±… 3: ì»¤ìŠ¤í…€ í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤");
        urls.forEach(safeConsumer(url -> {
            String content = fetchUrl(url);
            System.out.println("  " + url + ": " + content);
        }));

        System.out.println("\nğŸ’¡ ê¶Œì¥: ë˜í¼ ë©”ì„œë“œ ì‚¬ìš© (ì½”ë“œ ì¬ì‚¬ìš©)");
    }

    static String fetchUrl(String url) throws IOException {
        // ì‹œë®¬ë ˆì´ì…˜
        if (url.contains("2")) {
            throw new IOException("Connection timeout");
        }
        return "Content of " + url;
    }

    /**
     * ì²´í¬ ì˜ˆì™¸ë¥¼ ì–¸ì²´í¬ ì˜ˆì™¸ë¡œ ë³€í™˜
     */
    static <T> Consumer<T> unchecked(ThrowingConsumer<T> consumer) {
        return t -> {
            try {
                consumer.accept(t);
            } catch (Exception e) {
                throw new RuntimeException(e);
            }
        };
    }

    /**
     * ì²´í¬ ì˜ˆì™¸ë¥¼ í—ˆìš©í•˜ëŠ” Consumer
     */
    @FunctionalInterface
    interface ThrowingConsumer<T> {
        void accept(T t) throws Exception;
    }

    /**
     * ì˜ˆì™¸ë¥¼ ë¬´ì‹œí•˜ëŠ” Consumer
     */
    static <T> Consumer<T> safeConsumer(ThrowingConsumer<T> consumer) {
        return t -> {
            try {
                consumer.accept(t);
            } catch (Exception e) {
                System.err.println("  ì˜¤ë¥˜ ë¬´ì‹œ: " + e.getMessage());
            }
        };
    }
}
```

---

### âŒ ì‹¤ìˆ˜ 3: ëŒë‹¤ì—ì„œ this ì˜¤í•´

#### ë¬¸ì œ ì½”ë“œ

```java
package lambda.mistakes;

public class Mistake3_ThisReference {
    private String name = "Outer";

    public void testAnonymousClass() {
        Runnable runnable = new Runnable() {
            private String name = "Inner";

            @Override
            public void run() {
                System.out.println(this.name);  // "Inner" (ìµëª… í´ë˜ìŠ¤ì˜ this)
            }
        };

        runnable.run();
    }

    public void testLambda() {
        Runnable runnable = () -> {
            // private String name = "Inner";  // ì»´íŒŒì¼ ì—ëŸ¬! ëŒë‹¤ì—ëŠ” í•„ë“œ ë¶ˆê°€

            System.out.println(this.name);  // "Outer" (ì™¸ë¶€ í´ë˜ìŠ¤ì˜ this)
        };

        runnable.run();
    }

    public static void main(String[] args) {
        Mistake3_ThisReference example = new Mistake3_ThisReference();

        System.out.println("ìµëª… í´ë˜ìŠ¤:");
        example.testAnonymousClass();

        System.out.println("\nëŒë‹¤:");
        example.testLambda();
    }
}
```

#### ì™œ ë¬¸ì œì¸ê°€?

```
ìµëª… í´ë˜ìŠ¤ vs ëŒë‹¤ì˜ this:

ìµëª… í´ë˜ìŠ¤:
- thisëŠ” ìµëª… í´ë˜ìŠ¤ ìì²´ë¥¼ ê°€ë¦¬í‚´
- ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ ì„ ì–¸ ê°€ëŠ¥

ëŒë‹¤:
- thisëŠ” ì™¸ë¶€ í´ë˜ìŠ¤ë¥¼ ê°€ë¦¬í‚´
- ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ ì„ ì–¸ ë¶ˆê°€
```

#### âœ… ì˜¬ë°”ë¥¸ ì´í•´

```java
package lambda.mistakes;

public class Mistake3_Solution {
    private String outerField = "Outer Field";

    public void demonstrate() {
        System.out.println("=== this ì°¸ì¡° ì˜¬ë°”ë¥¸ ì´í•´ ===\n");

        // ìµëª… í´ë˜ìŠ¤: thisëŠ” ìµëª… í´ë˜ìŠ¤ ìì²´
        Runnable anonymousClass = new Runnable() {
            private String innerField = "Inner Field";

            @Override
            public void run() {
                System.out.println("ìµëª… í´ë˜ìŠ¤:");
                System.out.println("  this.innerField: " + this.innerField);
                // ì™¸ë¶€ í´ë˜ìŠ¤ ì ‘ê·¼: Mistake3_Solution.this.outerField
                System.out.println("  ì™¸ë¶€ í´ë˜ìŠ¤: " + Mistake3_Solution.this.outerField);
            }
        };

        anonymousClass.run();
        System.out.println();

        // ëŒë‹¤: thisëŠ” ì™¸ë¶€ í´ë˜ìŠ¤
        Runnable lambda = () -> {
            System.out.println("ëŒë‹¤:");
            System.out.println("  this.outerField: " + this.outerField);
            System.out.println("  thisëŠ” Mistake3_Solution: " + this.getClass().getSimpleName());
        };

        lambda.run();
        System.out.println();

        System.out.println("ğŸ’¡ í•µì‹¬:");
        System.out.println("- ìµëª… í´ë˜ìŠ¤: ìƒˆë¡œìš´ ê°ì²´ (thisëŠ” ìµëª… í´ë˜ìŠ¤)");
        System.out.println("- ëŒë‹¤: ë©”ì„œë“œì™€ ìœ ì‚¬ (thisëŠ” ì™¸ë¶€ í´ë˜ìŠ¤)");
    }

    public static void main(String[] args) {
        new Mistake3_Solution().demonstrate();
    }
}
```

---

### âŒ ì‹¤ìˆ˜ 4: ë¶ˆí•„ìš”í•œ ëŒë‹¤ ì‚¬ìš©

#### ë¬¸ì œ ì½”ë“œ

```java
package lambda.mistakes;

import java.util.*;
import java.util.stream.Collectors;

public class Mistake4_UnnecessaryLambda {
    public static void main(String[] args) {
        List<String> names = Arrays.asList("Alice", "Bob", "Charlie");

        System.out.println("=== ë¶ˆí•„ìš”í•œ ëŒë‹¤ ì‚¬ìš© ===\n");

        // âŒ ë‚˜ìœ ì˜ˆ 1: ë‹¨ìˆœ ë©”ì„œë“œ í˜¸ì¶œì„ ëŒë‹¤ë¡œ
        names.forEach(name -> System.out.println(name));

        System.out.println();

        // âŒ ë‚˜ìœ ì˜ˆ 2: ë‹¨ìˆœ ë³€í™˜ì„ ëŒë‹¤ë¡œ
        List<Integer> lengths = names.stream()
            .map(name -> name.length())
            .collect(Collectors.toList());

        System.out.println("Lengths: " + lengths);
        System.out.println();

        // âŒ ë‚˜ìœ ì˜ˆ 3: ë‹¨ìˆœ ì •ë ¬ì„ ëŒë‹¤ë¡œ
        names.sort((a, b) -> a.compareTo(b));

        System.out.println("Sorted: " + names);
    }
}
```

#### ì™œ ë¬¸ì œì¸ê°€?

```
ë©”ì„œë“œ ì°¸ì¡°ê°€ ë” ê°„ê²°í•˜ê³  ëª…í™•í•¨

ëŒë‹¤: name -> name.length()
ë©”ì„œë“œ ì°¸ì¡°: String::length

ê°€ë…ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì´ í–¥ìƒë¨
```

#### âœ… ì˜¬ë°”ë¥¸ í•´ê²°ì±…

```java
package lambda.mistakes;

import java.util.*;
import java.util.stream.Collectors;

public class Mistake4_Solution {
    public static void main(String[] args) {
        List<String> names = Arrays.asList("Alice", "Bob", "Charlie");

        System.out.println("=== ë©”ì„œë“œ ì°¸ì¡° ì‚¬ìš© (ê°„ê²°) ===\n");

        // âœ… ì¢‹ì€ ì˜ˆ 1: ë©”ì„œë“œ ì°¸ì¡°
        System.out.println("forEach:");
        names.forEach(System.out::println);
        System.out.println();

        // âœ… ì¢‹ì€ ì˜ˆ 2: ë©”ì„œë“œ ì°¸ì¡°
        List<Integer> lengths = names.stream()
            .map(String::length)
            .collect(Collectors.toList());

        System.out.println("Lengths: " + lengths);
        System.out.println();

        // âœ… ì¢‹ì€ ì˜ˆ 3: ë©”ì„œë“œ ì°¸ì¡° + Comparator
        List<String> sorted = new ArrayList<>(names);
        sorted.sort(String::compareTo);
        // ë˜ëŠ”
        sorted.sort(Comparator.naturalOrder());

        System.out.println("Sorted: " + sorted);
        System.out.println();

        // ë©”ì„œë“œ ì°¸ì¡° ì¢…ë¥˜
        System.out.println("ğŸ“š ë©”ì„œë“œ ì°¸ì¡° ì¢…ë¥˜:");

        // 1. ì •ì  ë©”ì„œë“œ ì°¸ì¡°
        List<Integer> numbers = Arrays.asList(-1, 2, -3, 4);
        numbers.stream()
            .map(Math::abs)  // ì •ì  ë©”ì„œë“œ
            .forEach(System.out::println);

        // 2. ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œ ì°¸ì¡° (íŠ¹ì • ê°ì²´)
        String prefix = "Hello, ";
        names.stream()
            .map(prefix::concat)  // prefix ê°ì²´ì˜ ë©”ì„œë“œ
            .forEach(System.out::println);

        // 3. ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œ ì°¸ì¡° (ì„ì˜ ê°ì²´)
        names.stream()
            .map(String::toUpperCase)  // ê° String ê°ì²´ì˜ ë©”ì„œë“œ
            .forEach(System.out::println);

        // 4. ìƒì„±ì ì°¸ì¡°
        List<Integer> nums = Arrays.asList(1, 2, 3);
        List<String> strings = nums.stream()
            .map(String::valueOf)  // ìƒì„±ì ë˜ëŠ” ì •ì  ë©”ì„œë“œ
            .collect(Collectors.toList());

        System.out.println("\nğŸ’¡ ê¶Œì¥: ë‹¨ìˆœ ë©”ì„œë“œ í˜¸ì¶œì€ ë©”ì„œë“œ ì°¸ì¡° ì‚¬ìš©");
    }
}
```

---

## ğŸ“ Part 2 ì¢…í•© ì •ë¦¬

### ğŸ“Š ëŒë‹¤ í™œìš© íŒ¨í„´

| íŒ¨í„´ | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|
| **í•„í„°ë§** | ì¡°ê±´ì— ë§ëŠ” ìš”ì†Œ ì„ íƒ | `filter(p -> p.getPrice() < 1000)` |
| **ì •ë ¬** | ë¹„êµ ê¸°ì¤€ ì •ì˜ | `sort((a, b) -> a.compareTo(b))` |
| **ë³€í™˜** | ìš”ì†Œë¥¼ ë‹¤ë¥¸ í˜•íƒœë¡œ ë³€í™˜ | `map(s -> s.toUpperCase())` |
| **ì´ë²¤íŠ¸ ì²˜ë¦¬** | ì½œë°± í•¨ìˆ˜ ë“±ë¡ | `button.onClick(e -> ...)` |
| **ì¡°ê±´ ì¡°í•©** | Predicate ê²°í•© | `filter1.and(filter2)` |

---

### ğŸš¨ ì£¼ë‹ˆì–´ ê°œë°œìê°€ ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜

```
1. âŒ ëŒë‹¤ì—ì„œ ì™¸ë¶€ ë³€ìˆ˜ ìˆ˜ì •
   âœ… Stream API ì‚¬ìš© ë˜ëŠ” AtomicInteger

2. âŒ ì²´í¬ ì˜ˆì™¸ ì²˜ë¦¬ ë¯¸í¡
   âœ… ë˜í¼ ë©”ì„œë“œ ë˜ëŠ” try-catch

3. âŒ this ì°¸ì¡° í˜¼ë™
   âœ… ëŒë‹¤ì˜ thisëŠ” ì™¸ë¶€ í´ë˜ìŠ¤

4. âŒ ë¶ˆí•„ìš”í•œ ëŒë‹¤
   âœ… ë©”ì„œë“œ ì°¸ì¡° ì‚¬ìš©
```

**ë‹¤ìŒ Part 3ì—ì„œëŠ”**: ì„±ëŠ¥ ìµœì í™”, ê³ ê¸‰ í™œìš© ê¸°ë²•, ë©´ì ‘ ì§ˆë¬¸ì„ ë‹¤ë£¹ë‹ˆë‹¤.
