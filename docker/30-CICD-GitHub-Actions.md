# ÏÑπÏÖò 30: CI/CD ÌååÏù¥ÌîÑÎùºÏù∏ (GitHub Actions)

> **ÌïôÏäµ Î™©Ìëú**: GitHub ActionsÎ•º ÌôúÏö©ÌïòÏó¨ Docker Ïù¥ÎØ∏ÏßÄ ÎπåÎìúÎ∂ÄÌÑ∞ Î∞∞Ìè¨ÍπåÏßÄ ÏôÑÏ†Ñ ÏûêÎèôÌôîÎêú CI/CD ÌååÏù¥ÌîÑÎùºÏù∏ÏùÑ Íµ¨Ï∂ïÌïòÍ≥†, ÏΩîÎìú Ìë∏ÏãúÎßåÏúºÎ°ú ÌîÑÎ°úÎçïÏÖò Î∞∞Ìè¨Í∞Ä Í∞ÄÎä•Ìïú DevOps ÏõåÌÅ¨ÌîåÎ°úÏö∞Î•º Íµ¨ÌòÑÌï† Ïàò ÏûàÏäµÎãàÎã§.

**‚è±Ô∏è ÏòàÏÉÅ ÌïôÏäµ ÏãúÍ∞Ñ**: 3-4ÏãúÍ∞Ñ
**ÎÇúÏù¥ÎèÑ**: ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ (4Í∞ú/5Í∞ú)

---

## üîç Ïã§ÏÉùÌôú ÎπÑÏú†Î°ú Ïù¥Ìï¥ÌïòÍ∏∞

CI/CDÎäî **ÏûêÎèôÏ∞® Ï°∞Î¶Ω ÎùºÏù∏**Í≥º Í∞ôÏäµÎãàÎã§.

```
ÏûêÎèôÏ∞® Í≥µÏû• Ï°∞Î¶Ω ÎùºÏù∏                CI/CD ÌååÏù¥ÌîÑÎùºÏù∏
====================                ====================
üîß Î∂ÄÌíà Í≤ÄÏÇ¨                    ‚Üí    ÏΩîÎìú Î¶∞Ìä∏/ÌÖåÏä§Ìä∏
üî© Ï°∞Î¶Ω                         ‚Üí    ÎπåÎìú
üé® ÎèÑÏÉâ                         ‚Üí    Docker Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±
üîç ÌíàÏßà Í≤ÄÏÇ¨                    ‚Üí    Î≥¥Ïïà Ïä§Ï∫î
üöó ÏãúÌóò Ï£ºÌñâ                    ‚Üí    Ïä§ÌÖåÏù¥Ïßï Î∞∞Ìè¨
‚úÖ Ï∂úÍ≥†                         ‚Üí    ÌîÑÎ°úÎçïÏÖò Î∞∞Ìè¨
üìä ÌîºÎìúÎ∞± ÏàòÏßë                  ‚Üí    Î™®ÎãàÌÑ∞ÎßÅ
```

ÏàòÏûëÏóÖÏúºÎ°ú ÏûêÎèôÏ∞®Î•º ÎßåÎì§Î©¥ ÎäêÎ¶¨Í≥† Ïã§ÏàòÍ∞Ä ÎßéÎìØÏù¥, ÏàòÎèô Î∞∞Ìè¨Îäî ÎäêÎ¶¨Í≥† ÏóêÎü¨Í∞Ä Î∞úÏÉùÌïòÍ∏∞ ÏâΩÏäµÎãàÎã§.

---

## üí° Ïôú CI/CDÍ∞Ä ÌïÑÏöîÌïúÍ∞Ä?

### 1. ÏàòÎèô Î∞∞Ìè¨Ïùò Î¨∏Ï†úÏ†ê

```
‚ùå ÏàòÎèô Î∞∞Ìè¨ ÌîÑÎ°úÏÑ∏Ïä§
===================

Í∞úÎ∞úÏûê: "Î∞∞Ìè¨ Ï¢Ä Ìï¥Ï£ºÏÑ∏Ïöî"
DevOps: "ÏïåÍ≤†ÏäµÎãàÎã§"

1. ÏΩîÎìú pull
2. ÌÖåÏä§Ìä∏ Ïã§Ìñâ (5Î∂Ñ)
3. ÎπåÎìú (10Î∂Ñ)
4. Docker Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ± (5Î∂Ñ)
5. Ïù¥ÎØ∏ÏßÄ Ìë∏Ïãú
6. ÏÑúÎ≤Ñ Ï†ëÏÜç
7. docker-compose down
8. docker-compose pull
9. docker-compose up -d
10. Ìó¨Ïä§ Ï≤¥ÌÅ¨
11. Î°úÍ∑∏ ÌôïÏù∏

Ï¥ù ÏÜåÏöî ÏãúÍ∞Ñ: 30Î∂Ñ
Î¨∏Ï†úÏ†ê:
- ÏÇ¨ÎûåÏù¥ Ïã§ÏàòÌï† Ïàò ÏûàÏùå
- ÏãúÍ∞ÑÏù¥ Ïò§Îûò Í±∏Î¶º
- Î∞§/Ï£ºÎßê Î∞∞Ìè¨ Î∂àÍ∞Ä
- Î¨∏ÏÑúÌôî ÎàÑÎùΩ
- ÌÖåÏä§Ìä∏ Í±¥ÎÑàÎõ∏ Ïàò ÏûàÏùå


‚úÖ ÏûêÎèôÌôîÎêú CI/CD
==================

Í∞úÎ∞úÏûê: git push origin main
    ‚Üì
GitHub Actions ÏûêÎèô Ïã§Ìñâ:
‚úì ÌÖåÏä§Ìä∏ (2Î∂Ñ)
‚úì ÎπåÎìú (3Î∂Ñ)
‚úì Î≥¥Ïïà Ïä§Ï∫î (1Î∂Ñ)
‚úì Ïù¥ÎØ∏ÏßÄ Ìë∏Ïãú (2Î∂Ñ)
‚úì Î∞∞Ìè¨ (2Î∂Ñ)
‚úì Ìó¨Ïä§ Ï≤¥ÌÅ¨ (1Î∂Ñ)
‚úì Ïä¨Îûô ÏïåÎ¶º

Ï¥ù ÏÜåÏöî ÏãúÍ∞Ñ: 11Î∂Ñ
Ïû•Ï†ê:
- ÏûêÎèôÌôîÎ°ú Ïã§Ïàò Î∞©ÏßÄ
- Îπ†Î•∏ Î∞∞Ìè¨
- 24/7 Î∞∞Ìè¨ Í∞ÄÎä•
- Î™®Îì† Îã®Í≥Ñ Í∏∞Î°ù
- ÌÖåÏä§Ìä∏ ÌïÑÏàò Ïã§Ìñâ
```

### 2. CI/CDÏùò Ïù¥Ï†ê

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ÏßÄÌëú                ‚îÇ ÏàòÎèô Î∞∞Ìè¨    ‚îÇ CI/CD        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Î∞∞Ìè¨ ÎπàÎèÑ           ‚îÇ Ï£º 1Ìöå       ‚îÇ Ïùº 10Ìöå+     ‚îÇ
‚îÇ Î∞∞Ìè¨ ÏãúÍ∞Ñ           ‚îÇ 30Î∂Ñ         ‚îÇ 10Î∂Ñ         ‚îÇ
‚îÇ Î∞∞Ìè¨ Ïã§Ìå®Ïú®         ‚îÇ 20%          ‚îÇ 2%           ‚îÇ
‚îÇ ÌèâÍ∑† Î≥µÍµ¨ ÏãúÍ∞Ñ      ‚îÇ 4ÏãúÍ∞Ñ        ‚îÇ 15Î∂Ñ         ‚îÇ
‚îÇ Í∞úÎ∞úÏûê ÎåÄÍ∏∞ ÏãúÍ∞Ñ    ‚îÇ 1ÏãúÍ∞Ñ        ‚îÇ 0Î∂Ñ          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Í≤∞Í≥º:
- ÏÉùÏÇ∞ÏÑ± 3Î∞∞ Ìñ•ÏÉÅ
- Î∞∞Ìè¨ Ïã†Î¢∞ÎèÑ 10Î∞∞ Ìñ•ÏÉÅ
- Îπ†Î•∏ ÌîºÎìúÎ∞± Î£®ÌîÑ
- ÏãúÏû• Ï∂úÏãú ÏãúÍ∞Ñ Îã®Ï∂ï
```

---

## GitHub Actions Í∏∞Ï¥à

### 1. GitHub Actions Íµ¨Ï°∞

```
Repository
‚îÇ
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îú‚îÄ‚îÄ ci.yml          ‚Üê CI ÏõåÌÅ¨ÌîåÎ°úÏö∞
‚îÇ       ‚îú‚îÄ‚îÄ cd.yml          ‚Üê CD ÏõåÌÅ¨ÌîåÎ°úÏö∞
‚îÇ       ‚îî‚îÄ‚îÄ security.yml    ‚Üê Î≥¥Ïïà Ïä§Ï∫î
‚îÇ
‚îî‚îÄ‚îÄ (ÌîÑÎ°úÏ†ùÌä∏ ÌååÏùºÎì§)

ÏõåÌÅ¨ÌîåÎ°úÏö∞ Íµ¨Ï°∞:
===============

Workflow (ci.yml)
    ‚îú‚îÄ‚îÄ Trigger (on: push, pull_request)
    ‚îú‚îÄ‚îÄ Job 1: Test
    ‚îÇ   ‚îú‚îÄ‚îÄ Step 1: Checkout code
    ‚îÇ   ‚îú‚îÄ‚îÄ Step 2: Setup Java
    ‚îÇ   ‚îú‚îÄ‚îÄ Step 3: Run tests
    ‚îÇ   ‚îî‚îÄ‚îÄ Step 4: Upload test results
    ‚îú‚îÄ‚îÄ Job 2: Build
    ‚îÇ   ‚îú‚îÄ‚îÄ Step 1: Checkout code
    ‚îÇ   ‚îú‚îÄ‚îÄ Step 2: Build Docker image
    ‚îÇ   ‚îî‚îÄ‚îÄ Step 3: Push to registry
    ‚îî‚îÄ‚îÄ Job 3: Deploy
        ‚îú‚îÄ‚îÄ Step 1: Deploy to staging
        ‚îî‚îÄ‚îÄ Step 2: Health check
```

### 2. Í∏∞Î≥∏ ÏõåÌÅ¨ÌîåÎ°úÏö∞ ÏòàÏãú

```yaml
# .github/workflows/hello.yml
name: Hello World

on:
  push:
    branches: [main]

jobs:
  greet:
    runs-on: ubuntu-latest
    steps:
      - name: Say Hello
        run: echo "Hello, World!"

      - name: Show Date
        run: date

      - name: List Files
        run: ls -la
```

---

## LK-Trade CI ÌååÏù¥ÌîÑÎùºÏù∏

### 1. CI ÏõåÌÅ¨ÌîåÎ°úÏö∞ (ÌÖåÏä§Ìä∏ & ÎπåÎìú)

```yaml
# .github/workflows/ci.yml
name: CI Pipeline

on:
  push:
    branches: [main, develop]
    paths:
      - 'modules/**'
      - '.github/workflows/ci.yml'
  pull_request:
    branches: [main, develop]

env:
  REGISTRY: ghcr.io
  IMAGE_PREFIX: lk-trade

jobs:
  # ========================================
  # Job 1: ÏΩîÎìú ÌíàÏßà Í≤ÄÏÇ¨
  # ========================================
  code-quality:
    name: Code Quality Check
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Java
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: 'gradle'

      - name: Grant execute permission for gradlew
        run: chmod +x gradlew

      - name: Run Ktlint
        run: ./gradlew ktlintCheck

      - name: Run Detekt
        run: ./gradlew detekt

      - name: Upload Detekt Report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: detekt-report
          path: build/reports/detekt/

  # ========================================
  # Job 2: Îã®ÏúÑ ÌÖåÏä§Ìä∏
  # ========================================
  unit-test:
    name: Unit Tests
    runs-on: ubuntu-latest
    strategy:
      matrix:
        module: [user, trade, account, strategy]
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Java
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: 'gradle'

      - name: Run Unit Tests - ${{ matrix.module }}
        run: ./gradlew :modules:${{ matrix.module }}:api:test

      - name: Generate Test Report
        if: always()
        run: ./gradlew :modules:${{ matrix.module }}:api:jacocoTestReport

      - name: Upload Test Results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: test-results-${{ matrix.module }}
          path: modules/${{ matrix.module }}/api/build/test-results/

      - name: Upload Coverage Report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: coverage-report-${{ matrix.module }}
          path: modules/${{ matrix.module }}/api/build/reports/jacoco/

      - name: Comment Test Results on PR
        if: github.event_name == 'pull_request'
        uses: EnricoMi/publish-unit-test-result-action@v2
        with:
          files: modules/${{ matrix.module }}/api/build/test-results/**/*.xml

  # ========================================
  # Job 3: ÌÜµÌï© ÌÖåÏä§Ìä∏
  # ========================================
  integration-test:
    name: Integration Tests
    runs-on: ubuntu-latest
    needs: [unit-test]
    services:
      postgres:
        image: postgres:16-alpine
        env:
          POSTGRES_DB: lk_trade_test
          POSTGRES_USER: test_user
          POSTGRES_PASSWORD: test_password
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432

      redis:
        image: redis:7-alpine
        options: >-
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 6379:6379

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Java
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: 'gradle'

      - name: Run Integration Tests
        env:
          SPRING_DATASOURCE_URL: jdbc:postgresql://localhost:5432/lk_trade_test
          SPRING_DATASOURCE_USERNAME: test_user
          SPRING_DATASOURCE_PASSWORD: test_password
          SPRING_REDIS_HOST: localhost
          SPRING_REDIS_PORT: 6379
        run: ./gradlew integrationTest

      - name: Upload Integration Test Results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: integration-test-results
          path: build/test-results/integrationTest/

  # ========================================
  # Job 4: Docker Ïù¥ÎØ∏ÏßÄ ÎπåÎìú
  # ========================================
  build-images:
    name: Build Docker Images
    runs-on: ubuntu-latest
    needs: [code-quality, unit-test, integration-test]
    if: github.event_name == 'push'
    strategy:
      matrix:
        service: [user-service, trade-service, account-service, strategy-service]
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Log in to Container Registry
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}

      - name: Extract metadata
        id: meta
        uses: docker/metadata-action@v5
        with:
          images: ${{ env.REGISTRY }}/${{ github.repository_owner }}/${{ env.IMAGE_PREFIX }}/${{ matrix.service }}
          tags: |
            type=ref,event=branch
            type=sha,prefix={{branch}}-
            type=semver,pattern={{version}}
            type=semver,pattern={{major}}.{{minor}}

      - name: Determine module path
        id: module
        run: |
          case "${{ matrix.service }}" in
            user-service) echo "path=modules/user/api" >> $GITHUB_OUTPUT ;;
            trade-service) echo "path=modules/trade/api" >> $GITHUB_OUTPUT ;;
            account-service) echo "path=modules/account/api" >> $GITHUB_OUTPUT ;;
            strategy-service) echo "path=modules/strategy/api" >> $GITHUB_OUTPUT ;;
          esac

      - name: Build and push Docker image
        uses: docker/build-push-action@v5
        with:
          context: ${{ steps.module.outputs.path }}
          push: true
          tags: ${{ steps.meta.outputs.tags }}
          labels: ${{ steps.meta.outputs.labels }}
          cache-from: type=gha
          cache-to: type=gha,mode=max
          build-args: |
            BUILD_DATE=${{ github.event.head_commit.timestamp }}
            VCS_REF=${{ github.sha }}
            VERSION=${{ steps.meta.outputs.version }}

  # ========================================
  # Job 5: Î≥¥Ïïà Ïä§Ï∫î
  # ========================================
  security-scan:
    name: Security Scan
    runs-on: ubuntu-latest
    needs: [build-images]
    strategy:
      matrix:
        service: [user-service, trade-service, account-service, strategy-service]
    steps:
      - name: Run Trivy vulnerability scanner
        uses: aquasecurity/trivy-action@master
        with:
          image-ref: ${{ env.REGISTRY }}/${{ github.repository_owner }}/${{ env.IMAGE_PREFIX }}/${{ matrix.service }}:${{ github.ref_name }}-${{ github.sha }}
          format: 'sarif'
          output: 'trivy-results-${{ matrix.service }}.sarif'
          severity: 'HIGH,CRITICAL'

      - name: Upload Trivy results to GitHub Security
        uses: github/codeql-action/upload-sarif@v2
        if: always()
        with:
          sarif_file: 'trivy-results-${{ matrix.service }}.sarif'

      - name: Fail on high/critical vulnerabilities
        uses: aquasecurity/trivy-action@master
        with:
          image-ref: ${{ env.REGISTRY }}/${{ github.repository_owner }}/${{ env.IMAGE_PREFIX }}/${{ matrix.service }}:${{ github.ref_name }}-${{ github.sha }}
          format: 'table'
          exit-code: '1'
          severity: 'HIGH,CRITICAL'

  # ========================================
  # Job 6: ÏïåÎ¶º
  # ========================================
  notify:
    name: Send Notifications
    runs-on: ubuntu-latest
    needs: [security-scan]
    if: always()
    steps:
      - name: Send Slack notification
        uses: 8398a7/action-slack@v3
        with:
          status: ${{ job.status }}
          text: |
            CI Pipeline ${{ job.status }}
            Branch: ${{ github.ref_name }}
            Commit: ${{ github.sha }}
            Author: ${{ github.actor }}
          webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
```

---

## CD ÌååÏù¥ÌîÑÎùºÏù∏ (Î∞∞Ìè¨)

### 1. Staging ÌôòÍ≤Ω ÏûêÎèô Î∞∞Ìè¨

```yaml
# .github/workflows/cd-staging.yml
name: CD - Deploy to Staging

on:
  push:
    branches: [develop]
  workflow_dispatch:  # ÏàòÎèô Ïã§Ìñâ Í∞ÄÎä•

env:
  REGISTRY: ghcr.io
  IMAGE_PREFIX: lk-trade

jobs:
  deploy-staging:
    name: Deploy to Staging
    runs-on: ubuntu-latest
    environment:
      name: staging
      url: https://staging.lk-trade.com
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Configure SSH
        run: |
          mkdir -p ~/.ssh
          echo "${{ secrets.STAGING_SSH_KEY }}" > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan -H ${{ secrets.STAGING_HOST }} >> ~/.ssh/known_hosts

      - name: Deploy to Staging Server
        env:
          HOST: ${{ secrets.STAGING_HOST }}
          USER: ${{ secrets.STAGING_USER }}
          VERSION: ${{ github.ref_name }}-${{ github.sha }}
        run: |
          ssh $USER@$HOST << 'ENDSSH'
            cd /opt/lk-trade

            # ÌôòÍ≤Ω Î≥ÄÏàò ÏÑ§Ï†ï
            export VERSION=${{ env.VERSION }}
            export REGISTRY=${{ env.REGISTRY }}
            export GITHUB_ACTOR=${{ github.actor }}

            # GitHub Container Registry Î°úÍ∑∏Ïù∏
            echo "${{ secrets.GITHUB_TOKEN }}" | docker login $REGISTRY -u $GITHUB_ACTOR --password-stdin

            # Docker ComposeÎ°ú Î∞∞Ìè¨
            docker-compose pull
            docker-compose up -d

            # Ìó¨Ïä§ Ï≤¥ÌÅ¨
            sleep 30
            curl -f http://localhost:8080/actuator/health || exit 1

            echo "Deployment to staging completed successfully!"
          ENDSSH

      - name: Run Smoke Tests
        run: |
          # Í∏∞Î≥∏ API ÌÖåÏä§Ìä∏
          curl -f https://staging.lk-trade.com/health
          curl -f https://staging.lk-trade.com/api/v1/health

      - name: Notify Slack
        if: always()
        uses: 8398a7/action-slack@v3
        with:
          status: ${{ job.status }}
          text: |
            Staging Deployment ${{ job.status }}
            Version: ${{ github.ref_name }}-${{ github.sha }}
            URL: https://staging.lk-trade.com
          webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}
```

### 2. Production ÌôòÍ≤Ω ÏàòÎèô ÏäπÏù∏ Î∞∞Ìè¨

```yaml
# .github/workflows/cd-production.yml
name: CD - Deploy to Production

on:
  push:
    branches: [main]
    tags:
      - 'v*.*.*'
  workflow_dispatch:
    inputs:
      version:
        description: 'Version to deploy'
        required: true
        type: string

env:
  REGISTRY: ghcr.io
  IMAGE_PREFIX: lk-trade

jobs:
  # ========================================
  # Job 1: ÌîÑÎ°úÎçïÏÖò Î∞∞Ìè¨ Ï§ÄÎπÑ
  # ========================================
  prepare-deployment:
    name: Prepare Production Deployment
    runs-on: ubuntu-latest
    outputs:
      version: ${{ steps.version.outputs.version }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Determine version
        id: version
        run: |
          if [ "${{ github.event_name }}" == "workflow_dispatch" ]; then
            echo "version=${{ inputs.version }}" >> $GITHUB_OUTPUT
          elif [ "${{ github.ref_type }}" == "tag" ]; then
            echo "version=${{ github.ref_name }}" >> $GITHUB_OUTPUT
          else
            echo "version=${{ github.ref_name }}-${{ github.sha }}" >> $GITHUB_OUTPUT
          fi

      - name: Create deployment summary
        run: |
          echo "# Production Deployment Summary" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "- **Version**: ${{ steps.version.outputs.version }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Branch**: ${{ github.ref_name }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Commit**: ${{ github.sha }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Author**: ${{ github.actor }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Timestamp**: $(date -u)" >> $GITHUB_STEP_SUMMARY

  # ========================================
  # Job 2: ÌîÑÎ°úÎçïÏÖò Î∞∞Ìè¨ (ÏàòÎèô ÏäπÏù∏ ÌïÑÏöî)
  # ========================================
  deploy-production:
    name: Deploy to Production
    runs-on: ubuntu-latest
    needs: [prepare-deployment]
    environment:
      name: production
      url: https://lk-trade.com
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Create backup
        env:
          HOST: ${{ secrets.PROD_HOST }}
          USER: ${{ secrets.PROD_USER }}
        run: |
          ssh $USER@$HOST << 'ENDSSH'
            cd /opt/lk-trade
            bash scripts/backup-all.sh
          ENDSSH

      - name: Blue-Green Deployment
        env:
          HOST: ${{ secrets.PROD_HOST }}
          USER: ${{ secrets.PROD_USER }}
          VERSION: ${{ needs.prepare-deployment.outputs.version }}
        run: |
          ssh $USER@$HOST << 'ENDSSH'
            cd /opt/lk-trade

            # ÌôòÍ≤Ω Î≥ÄÏàò ÏÑ§Ï†ï
            export VERSION=${{ env.VERSION }}
            export REGISTRY=${{ env.REGISTRY }}

            # GitHub Container Registry Î°úÍ∑∏Ïù∏
            echo "${{ secrets.GITHUB_TOKEN }}" | docker login $REGISTRY -u ${{ github.actor }} --password-stdin

            # Blue-Green Î∞∞Ìè¨ Ïã§Ìñâ
            bash scripts/blue-green-deploy.sh

            echo "Production deployment completed!"
          ENDSSH

      - name: Health Check
        run: |
          echo "Waiting for services to be healthy..."
          sleep 60

          # Î™®Îì† ÏÑúÎπÑÏä§ Ìó¨Ïä§ Ï≤¥ÌÅ¨
          services=(user trade account strategy)
          for service in "${services[@]}"; do
            echo "Checking $service-service..."
            curl -f https://lk-trade.com/api/$service/actuator/health || exit 1
          done

          echo "All services are healthy!"

      - name: Run Production Smoke Tests
        run: |
          # Ï§ëÏöî API ÌÖåÏä§Ìä∏
          curl -f https://lk-trade.com/api/v1/health
          curl -f https://lk-trade.com/api/user/actuator/health
          curl -f https://lk-trade.com/api/trade/actuator/health

      - name: Update deployment record
        run: |
          # Î∞∞Ìè¨ Í∏∞Î°ù Ï†ÄÏû•
          echo "Deployment completed at $(date -u)" >> deployment-log.txt
          echo "Version: ${{ needs.prepare-deployment.outputs.version }}" >> deployment-log.txt

      - name: Notify Slack - Success
        if: success()
        uses: 8398a7/action-slack@v3
        with:
          status: custom
          custom_payload: |
            {
              "text": "üöÄ Production Deployment Successful!",
              "blocks": [
                {
                  "type": "section",
                  "text": {
                    "type": "mrkdwn",
                    "text": "*Production Deployment Successful!* ‚úÖ"
                  }
                },
                {
                  "type": "section",
                  "fields": [
                    {"type": "mrkdwn", "text": "*Version:*\n${{ needs.prepare-deployment.outputs.version }}"},
                    {"type": "mrkdwn", "text": "*Deployed by:*\n${{ github.actor }}"},
                    {"type": "mrkdwn", "text": "*Branch:*\n${{ github.ref_name }}"},
                    {"type": "mrkdwn", "text": "*URL:*\n<https://lk-trade.com|lk-trade.com>"}
                  ]
                }
              ]
            }
          webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}

      - name: Notify Slack - Failure
        if: failure()
        uses: 8398a7/action-slack@v3
        with:
          status: custom
          custom_payload: |
            {
              "text": "üö® Production Deployment Failed!",
              "blocks": [
                {
                  "type": "section",
                  "text": {
                    "type": "mrkdwn",
                    "text": "*Production Deployment Failed!* ‚ùå"
                  }
                },
                {
                  "type": "section",
                  "fields": [
                    {"type": "mrkdwn", "text": "*Version:*\n${{ needs.prepare-deployment.outputs.version }}"},
                    {"type": "mrkdwn", "text": "*Attempted by:*\n${{ github.actor }}"},
                    {"type": "mrkdwn", "text": "*Action:*\n<${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}|View Logs>"}
                  ]
                }
              ]
            }
          webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}

  # ========================================
  # Job 3: Î°§Î∞± (Î∞∞Ìè¨ Ïã§Ìå® Ïãú)
  # ========================================
  rollback:
    name: Rollback on Failure
    runs-on: ubuntu-latest
    needs: [deploy-production]
    if: failure()
    steps:
      - name: Rollback deployment
        env:
          HOST: ${{ secrets.PROD_HOST }}
          USER: ${{ secrets.PROD_USER }}
        run: |
          ssh $USER@$HOST << 'ENDSSH'
            cd /opt/lk-trade
            bash scripts/blue-green-rollback.sh
          ENDSSH

      - name: Notify rollback
        uses: 8398a7/action-slack@v3
        with:
          status: custom
          custom_payload: |
            {
              "text": "‚è™ Production Rollback Completed",
              "blocks": [
                {
                  "type": "section",
                  "text": {
                    "type": "mrkdwn",
                    "text": "*Rollback completed due to deployment failure*"
                  }
                }
              ]
            }
          webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}
```

---

## GitHub Secrets ÏÑ§Ï†ï

```bash
# GitHub Repository Settings > Secrets and variables > Actions

# SSH Ï†ëÏÜç Ï†ïÎ≥¥
STAGING_HOST=staging.lk-trade.com
STAGING_USER=deploy
STAGING_SSH_KEY=<private-key-content>

PROD_HOST=lk-trade.com
PROD_USER=deploy
PROD_SSH_KEY=<private-key-content>

# ÏïåÎ¶º
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXX

# Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ (ÌÖåÏä§Ìä∏Ïö©)
DB_PASSWORD=test_password

# Í∏∞ÌÉÄ
GITHUB_TOKEN=<automatically-provided>
```

### Secrets ÏÑ§Ï†ï Î∞©Î≤ï

```bash
# 1. SSH ÌÇ§ ÏÉùÏÑ±
ssh-keygen -t ed25519 -C "github-actions@lk-trade.com" -f ~/.ssh/github-actions

# 2. Í≥µÍ∞ú ÌÇ§Î•º ÏÑúÎ≤ÑÏóê Ï∂îÍ∞Ä
ssh-copy-id -i ~/.ssh/github-actions.pub deploy@lk-trade.com

# 3. Í∞úÏù∏ ÌÇ§Î•º GitHub SecretsÏóê Ï∂îÍ∞Ä
cat ~/.ssh/github-actions
# ÎÇ¥Ïö© Î≥µÏÇ¨ ÌõÑ GitHub SecretsÏóê PROD_SSH_KEYÎ°ú Îì±Î°ù
```

---

## Í≥†Í∏â Í∏∞Îä•

### 1. Matrix Ï†ÑÎûµ (Î≥ëÎ†¨ Ïã§Ìñâ)

```yaml
# Ïó¨Îü¨ Î≤ÑÏ†Ñ/ÌôòÍ≤ΩÏóêÏÑú ÎèôÏãú ÌÖåÏä§Ìä∏
jobs:
  test:
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
        java: ['11', '17', '21']
        exclude:
          - os: macos-latest
            java: '11'
    runs-on: ${{ matrix.os }}
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          java-version: ${{ matrix.java }}
      - run: ./gradlew test
```

### 2. Reusable Workflows (Ïû¨ÏÇ¨Ïö© Í∞ÄÎä•Ìïú ÏõåÌÅ¨ÌîåÎ°úÏö∞)

```yaml
# .github/workflows/reusable-build.yml
name: Reusable Build Workflow

on:
  workflow_call:
    inputs:
      service-name:
        required: true
        type: string
      module-path:
        required: true
        type: string
    outputs:
      image-tag:
        description: "Built image tag"
        value: ${{ jobs.build.outputs.tag }}

jobs:
  build:
    runs-on: ubuntu-latest
    outputs:
      tag: ${{ steps.meta.outputs.tags }}
    steps:
      - uses: actions/checkout@v4
      - name: Build Docker image
        # ... ÎπåÎìú Î°úÏßÅ
```

```yaml
# .github/workflows/build-all-services.yml
name: Build All Services

on: [push]

jobs:
  build-user-service:
    uses: ./.github/workflows/reusable-build.yml
    with:
      service-name: user-service
      module-path: modules/user/api

  build-trade-service:
    uses: ./.github/workflows/reusable-build.yml
    with:
      service-name: trade-service
      module-path: modules/trade/api
```

### 3. Composite Actions (Ïª§Ïä§ÌÖÄ Ïï°ÏÖò)

```yaml
# .github/actions/setup-kotlin-env/action.yml
name: 'Setup Kotlin Environment'
description: 'Setup Java, Kotlin, and Gradle with caching'

inputs:
  java-version:
    description: 'Java version to use'
    required: false
    default: '17'

runs:
  using: 'composite'
  steps:
    - name: Setup Java
      uses: actions/setup-java@v4
      with:
        java-version: ${{ inputs.java-version }}
        distribution: 'temurin'
        cache: 'gradle'

    - name: Grant execute permission for gradlew
      shell: bash
      run: chmod +x gradlew

    - name: Cache Gradle packages
      uses: actions/cache@v3
      with:
        path: |
          ~/.gradle/caches
          ~/.gradle/wrapper
        key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}
        restore-keys: |
          ${{ runner.os }}-gradle-
```

ÏÇ¨Ïö©:

```yaml
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: ./.github/actions/setup-kotlin-env
        with:
          java-version: '17'
      - run: ./gradlew test
```

---

## Î™®ÎãàÌÑ∞ÎßÅ Î∞è ÎîîÎ≤ÑÍπÖ

### 1. ÏõåÌÅ¨ÌîåÎ°úÏö∞ Ïã§Ìñâ Î™®ÎãàÌÑ∞ÎßÅ

```yaml
# .github/workflows/monitor.yml
name: Monitor Workflow Performance

on:
  workflow_run:
    workflows: ["CI Pipeline"]
    types: [completed]

jobs:
  analyze:
    runs-on: ubuntu-latest
    steps:
      - name: Analyze workflow run
        uses: actions/github-script@v7
        with:
          script: |
            const run = context.payload.workflow_run;

            console.log(`Workflow: ${run.name}`);
            console.log(`Status: ${run.conclusion}`);
            console.log(`Duration: ${(new Date(run.updated_at) - new Date(run.created_at)) / 1000}s`);

            // SlackÏúºÎ°ú ÏïåÎ¶º
            if (run.conclusion === 'failure') {
              // Ïã§Ìå® ÏïåÎ¶º Î°úÏßÅ
            }
```

### 2. ÎîîÎ≤ÑÍπÖ ÌåÅ

```yaml
# ÎîîÎ≤ÑÍ∑∏ Î™®Îìú ÌôúÏÑ±Ìôî
jobs:
  debug:
    runs-on: ubuntu-latest
    steps:
      - name: Enable debug logging
        run: echo "ACTIONS_STEP_DEBUG=true" >> $GITHUB_ENV

      - name: Print environment
        run: |
          echo "GitHub Context:"
          echo "${{ toJSON(github) }}"

          echo "Environment Variables:"
          env | sort

      - name: SSH debug session (ÌïÑÏöî Ïãú)
        uses: mxschmitt/action-tmate@v3
        if: failure()
```

---

## ÎπÑÏö© ÏµúÏ†ÅÌôî

### 1. Self-hosted Runners

```yaml
# ÏûêÏ≤¥ Ìò∏Ïä§ÌåÖ Îü¨ÎÑà ÏÇ¨Ïö© (Î¨¥Î£å)
jobs:
  build:
    runs-on: self-hosted
    steps:
      - uses: actions/checkout@v4
      - run: docker build -t myapp .
```

Îü¨ÎÑà ÏÑ§Ï†ï:

```bash
# ÏÑúÎ≤ÑÏóê Îü¨ÎÑà ÏÑ§Ïπò
mkdir actions-runner && cd actions-runner
curl -o actions-runner-linux-x64-2.311.0.tar.gz -L \
  https://github.com/actions/runner/releases/download/v2.311.0/actions-runner-linux-x64-2.311.0.tar.gz
tar xzf ./actions-runner-linux-x64-2.311.0.tar.gz

# Îü¨ÎÑà Îì±Î°ù
./config.sh --url https://github.com/your-org/lk-trade --token YOUR_TOKEN

# Îü¨ÎÑà ÏãúÏûë
./run.sh

# ÎòêÎäî ÏÑúÎπÑÏä§Î°ú Îì±Î°ù
sudo ./svc.sh install
sudo ./svc.sh start
```

### 2. Ï∫êÏã± ÏµúÏ†ÅÌôî

```yaml
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # Gradle Ï∫êÏã±
      - uses: actions/cache@v3
        with:
          path: |
            ~/.gradle/caches
            ~/.gradle/wrapper
          key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*') }}
          restore-keys: |
            ${{ runner.os }}-gradle-

      # Docker Î†àÏù¥Ïñ¥ Ï∫êÏã±
      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Build with cache
        uses: docker/build-push-action@v5
        with:
          context: .
          cache-from: type=gha
          cache-to: type=gha,mode=max
```

---

## Îã§Ïùå Îã®Í≥Ñ

Ï∂ïÌïòÌï©ÎãàÎã§! üéâ GitHub ActionsÎ°ú ÏôÑÏ†ÑÌïú CI/CD ÌååÏù¥ÌîÑÎùºÏù∏ÏùÑ Íµ¨Ï∂ïÌñàÏäµÎãàÎã§.

### Ïù¥Î≤à ÏÑπÏÖòÏóêÏÑú Î∞∞Ïö¥ Í≤É

‚úÖ CI/CDÏùò Ï§ëÏöîÏÑ± Î∞è Ïù¥Ï†ê
‚úÖ GitHub Actions Í∏∞Î≥∏ Íµ¨Ï°∞
‚úÖ ÏΩîÎìú ÌíàÏßà Í≤ÄÏÇ¨ Î∞è ÌÖåÏä§Ìä∏ ÏûêÎèôÌôî
‚úÖ Docker Ïù¥ÎØ∏ÏßÄ ÏûêÎèô ÎπåÎìú Î∞è Ìë∏Ïãú
‚úÖ Î≥¥Ïïà Ïä§Ï∫î ÌÜµÌï©
‚úÖ Staging/Production ÏûêÎèô Î∞∞Ìè¨
‚úÖ Blue-Green Î∞∞Ìè¨ ÏûêÎèôÌôî
‚úÖ Slack ÏïåÎ¶º ÌÜµÌï©
‚úÖ Í≥†Í∏â Í∏∞Îä• (Matrix, Reusable Workflows)
‚úÖ ÎπÑÏö© ÏµúÏ†ÅÌôî

### Îã§ÏùåÏóê Î∞∞Ïö∏ Í≤É

**ÏÑπÏÖò 31: JenkinsÎ•º Ïù¥Ïö©Ìïú CI/CD**ÏóêÏÑúÎäî:
- Jenkins ÏÑ§Ïπò Î∞è ÏÑ§Ï†ï
- Jenkinsfile (Pipeline as Code)
- Jenkins + Docker ÌÜµÌï©
- Jenkins vs GitHub Actions ÎπÑÍµê

### Ï∂îÍ∞Ä ÌïôÏäµ ÏûêÎ£å

**Í≥µÏãù Î¨∏ÏÑú:**
- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [Workflow Syntax](https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions)

**Ïú†Ïö©Ìïú Ïï°ÏÖò:**
- [Awesome Actions](https://github.com/sdras/awesome-actions)
- [GitHub Marketplace](https://github.com/marketplace?type=actions)

---

## üë®‚Äçüíª Ï£ºÎãàÏñ¥ Í∞úÎ∞úÏûê ÏãúÎÇòÎ¶¨Ïò§

### ÏãúÎÇòÎ¶¨Ïò§ 1: Ï≤´ GitHub Actions ÏõåÌÅ¨ÌîåÎ°úÏö∞ ÏûëÏÑ±

**ÏÉÅÌô©:** Ïã†ÏûÖ Í∞úÎ∞úÏûêÎ°ú ÏûÖÏÇ¨Ìïú Ï≤´ÎÇ†, ÌåÄÏû•ÎãòÏù¥ "Í∞ÑÎã®Ìïú CI ÏõåÌÅ¨ÌîåÎ°úÏö∞Î•º Ï∂îÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî"ÎùºÍ≥† ÏöîÏ≤≠ÌñàÏäµÎãàÎã§.

**Î¨∏Ï†ú:**
```
"Ïñ¥ÎîîÏÑúÎ∂ÄÌÑ∞ ÏãúÏûëÌï¥Ïïº ÌïòÏßÄ?
.github/workflows ÎîîÎ†âÌÜ†Î¶¨Î•º Ïñ¥ÎñªÍ≤å ÎßåÎì§ÏßÄ?
ÏõåÌÅ¨ÌîåÎ°úÏö∞ ÌååÏùºÏùÄ Ïñ¥ÎñªÍ≤å ÏûëÏÑ±ÌïòÏßÄ?"
```

**Îã®Í≥ÑÎ≥Ñ Ìï¥Í≤∞:**

```bash
# 1Îã®Í≥Ñ: ÎîîÎ†âÌÜ†Î¶¨ Íµ¨Ï°∞ ÏÉùÏÑ±
mkdir -p .github/workflows

# 2Îã®Í≥Ñ: Ï≤´ Î≤àÏß∏ ÏõåÌÅ¨ÌîåÎ°úÏö∞ ÌååÏùº ÏûëÏÑ±
cat > .github/workflows/hello.yml << 'EOF'
name: My First Workflow

on:
  push:
    branches: [main]

jobs:
  greet:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Say Hello
        run: echo "Hello, GitHub Actions!"

      - name: Show Date
        run: date
EOF

# 3Îã®Í≥Ñ: GitÏóê Ï∂îÍ∞Ä Î∞è Ìë∏Ïãú
git add .github/workflows/hello.yml
git commit -m "Add first GitHub Actions workflow"
git push origin main

# 4Îã®Í≥Ñ: GitHubÏóêÏÑú ÌôïÏù∏
# Repository > Actions ÌÉ≠ ÌôïÏù∏
```

**Ïã§Ï†ú ÌôîÎ©¥ÏóêÏÑú Î≥¥Ïù¥Îäî Í≤É:**
```
‚úÖ Workflow Ïã§Ìñâ ÏÑ±Í≥µ!

Greet
‚îú‚îÄ‚îÄ Checkout code (5s)
‚îú‚îÄ‚îÄ Say Hello (1s)
‚îÇ   Hello, GitHub Actions!
‚îî‚îÄ‚îÄ Show Date (1s)
    Mon Oct 20 10:30:45 UTC 2025
```

**Î∞∞Ïö¥ Ï†ê:**
1. `.github/workflows` ÎîîÎ†âÌÜ†Î¶¨Í∞Ä ÌïÑÏàò
2. YAML ÌååÏùºÎ°ú ÏõåÌÅ¨ÌîåÎ°úÏö∞ Ï†ïÏùò
3. `on:` Ìä∏Î¶¨Í±∞ ÏÑ§Ï†ïÏù¥ Ï§ëÏöî
4. `uses:`Îäî Í∏∞Ï°¥ Ïï°ÏÖò ÏÇ¨Ïö©, `run:`ÏùÄ Î™ÖÎ†π Ïã§Ìñâ
5. GitHub UIÏóêÏÑú Ïã§ÏãúÍ∞Ñ Î°úÍ∑∏ ÌôïÏù∏ Í∞ÄÎä•

**ÌåÄÏû•ÎãòÏùò ÌîºÎìúÎ∞±:**
```
"ÏûòÌñàÏñ¥Ïöî! Ïù¥Ï†ú Ïã§Ï†ú ÌÖåÏä§Ìä∏Î•º Ï∂îÍ∞ÄÌï¥Î≥ºÍπåÏöî?"
```

---

### ÏãúÎÇòÎ¶¨Ïò§ 2: CI Ïã§Ìå® ÎîîÎ≤ÑÍπÖ - "ÌÖåÏä§Ìä∏Í∞Ä Î°úÏª¨ÏóêÏÑúÎäî ÎêòÎäîÎç∞ CIÏóêÏÑú Ïã§Ìå®Ìï¥Ïöî!"

**ÏÉÅÌô©:** Î°úÏª¨ÏóêÏÑúÎäî Î™®Îì† ÌÖåÏä§Ìä∏Í∞Ä ÌÜµÍ≥ºÌïòÎäîÎç∞ GitHub ActionsÏóêÏÑúÎßå Ïã§Ìå®Ìï©ÎãàÎã§.

**ÏóêÎü¨ Î©îÏãúÏßÄ:**
```
Error: Database connection failed
  at UserServiceTest.kt:45

Expected: Connection successful
Actual: Connection timeout

‚ùå Tests failed: 3 tests, 1 passed, 2 failed
```

**Îã®Í≥ÑÎ≥Ñ Ìï¥Í≤∞:**

```yaml
# ‚ùå ÏõêÎûò ÏõåÌÅ¨ÌîåÎ°úÏö∞ (Î¨∏Ï†ú ÏûàÏùå)
name: CI

on: [push]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'

      - name: Run tests
        run: ./gradlew test
      # Î¨∏Ï†ú: Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§Í∞Ä ÏóÜÏùå!
```

**ÏàòÏ†ïÎêú ÏõåÌÅ¨ÌîåÎ°úÏö∞:**

```yaml
# ‚úÖ ÏàòÏ†ïÎêú ÏõåÌÅ¨ÌîåÎ°úÏö∞ (ÏÑúÎπÑÏä§ Ï∂îÍ∞Ä)
name: CI with Database

on: [push]

jobs:
  test:
    runs-on: ubuntu-latest

    # ÌïµÏã¨: ÌÖåÏä§Ìä∏Ïóê ÌïÑÏöîÌïú ÏÑúÎπÑÏä§ Ï∂îÍ∞Ä!
    services:
      postgres:
        image: postgres:16-alpine
        env:
          POSTGRES_DB: test_db
          POSTGRES_USER: test_user
          POSTGRES_PASSWORD: test_password
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432

      redis:
        image: redis:7-alpine
        options: >-
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 6379:6379

    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: 'gradle'

      - name: Wait for PostgreSQL
        run: |
          for i in {1..30}; do
            pg_isready -h localhost -p 5432 && break
            echo "Waiting for PostgreSQL..."
            sleep 1
          done

      - name: Run tests
        env:
          SPRING_DATASOURCE_URL: jdbc:postgresql://localhost:5432/test_db
          SPRING_DATASOURCE_USERNAME: test_user
          SPRING_DATASOURCE_PASSWORD: test_password
          SPRING_REDIS_HOST: localhost
          SPRING_REDIS_PORT: 6379
        run: ./gradlew test

      - name: Upload test results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: test-results
          path: build/test-results/
```

**Í≤∞Í≥º:**
```
‚úÖ All tests passed!

Test Results:
- Total: 45 tests
- Passed: 45 ‚úÖ
- Failed: 0
- Duration: 2m 30s
```

**Î∞∞Ïö¥ Ï†ê:**
1. **Services** Î∏îÎ°ùÏúºÎ°ú DB, Redis Îì± Ï∂îÍ∞Ä Í∞ÄÎä•
2. **Health check**Î°ú ÏÑúÎπÑÏä§ Ï§ÄÎπÑ ÌôïÏù∏
3. **Environment variables**Î°ú Ïó∞Í≤∞ Ï†ïÎ≥¥ Ï†ÑÎã¨
4. `if: always()`Î°ú Ïã§Ìå®Ìï¥ÎèÑ Í≤∞Í≥º ÏóÖÎ°úÎìú
5. `pg_isready` Í∞ôÏùÄ ÎèÑÍµ¨Î°ú ÏÑúÎπÑÏä§ ÎåÄÍ∏∞

**ÎîîÎ≤ÑÍπÖ ÌåÅ:**
```yaml
# ÎîîÎ≤ÑÍ∑∏ Î°úÍ∑∏ ÌôúÏÑ±Ìôî
- name: Enable Debug
  run: echo "ACTIONS_STEP_DEBUG=true" >> $GITHUB_ENV

# ÌôòÍ≤Ω Î≥ÄÏàò Ï∂úÎ†•
- name: Print Environment
  run: env | sort
```

---

### ÏãúÎÇòÎ¶¨Ïò§ 3: GitHub Secrets ÏÑ§Ï†ï - "ÎØºÍ∞êÌïú Ï†ïÎ≥¥Î•º Ïñ¥ÎñªÍ≤å Í¥ÄÎ¶¨ÌïòÏ£†?"

**ÏÉÅÌô©:** Î∞∞Ìè¨Î•º ÏúÑÌï¥ SSH ÌÇ§ÏôÄ API ÌÜ†ÌÅ∞Ïù¥ ÌïÑÏöîÌïúÎç∞, ÏΩîÎìúÏóê ÏßÅÏ†ë ÎÑ£ÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.

**ÏûòÎ™ªÎêú Î∞©Î≤ï (Ï†àÎåÄ ÌïòÏßÄ Îßê Í≤É!):**
```yaml
# ‚ùå ÏúÑÌóò! ÎØºÍ∞ê Ï†ïÎ≥¥ ÎÖ∏Ï∂ú!
- name: Deploy
  run: |
    ssh -i /tmp/private-key deploy@server.com
    export API_KEY="sk-1234567890abcdef"  # Ï†àÎåÄ ÌïòÎ©¥ Ïïà Îê®!
```

**Ïò¨Î∞îÎ•∏ Î∞©Î≤ï:**

**1Îã®Í≥Ñ: GitHub Secrets Ï∂îÍ∞Ä**
```
GitHub Repository ÏÑ§Ï†ï:
1. Settings > Secrets and variables > Actions
2. "New repository secret" ÌÅ¥Î¶≠
3. Îã§Ïùå ÏãúÌÅ¨Î¶ø Ï∂îÍ∞Ä:

Name: PROD_SSH_KEY
Secret: -----BEGIN OPENSSH PRIVATE KEY-----
        b3BlbnNzaC1rZXktdjEAAA...
        -----END OPENSSH PRIVATE KEY-----

Name: PROD_HOST
Secret: production.lk-trade.com

Name: PROD_USER
Secret: deploy

Name: API_KEY
Secret: sk-1234567890abcdef

Name: SLACK_WEBHOOK_URL
Secret: https://hooks.slack.com/services/T00/B00/XXX
```

**2Îã®Í≥Ñ: ÏõåÌÅ¨ÌîåÎ°úÏö∞ÏóêÏÑú ÏÇ¨Ïö©**
```yaml
name: Deploy to Production

on:
  workflow_dispatch:  # ÏàòÎèô Ïã§Ìñâ

jobs:
  deploy:
    runs-on: ubuntu-latest
    environment: production  # ÌôòÍ≤Ω Î≥¥Ìò∏ Í∏∞Îä•

    steps:
      - uses: actions/checkout@v4

      # SSH ÌÇ§ ÏÑ§Ï†ï
      - name: Configure SSH
        run: |
          mkdir -p ~/.ssh
          echo "${{ secrets.PROD_SSH_KEY }}" > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan -H ${{ secrets.PROD_HOST }} >> ~/.ssh/known_hosts

      # Î∞∞Ìè¨ Ïä§ÌÅ¨Î¶ΩÌä∏ Ïã§Ìñâ
      - name: Deploy
        env:
          API_KEY: ${{ secrets.API_KEY }}
        run: |
          ssh ${{ secrets.PROD_USER }}@${{ secrets.PROD_HOST }} << 'ENDSSH'
            cd /opt/lk-trade
            export API_KEY=${{ secrets.API_KEY }}
            docker-compose pull
            docker-compose up -d
          ENDSSH

      # Slack ÏïåÎ¶º
      - name: Notify Slack
        if: always()
        uses: 8398a7/action-slack@v3
        with:
          status: ${{ job.status }}
          webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}
```

**Î°úÍ∑∏ÏóêÏÑú Î≥¥Ïù¥Îäî Í≤É:**
```
Configure SSH
***  # SecretÏùÄ ÏûêÎèôÏúºÎ°ú ÎßàÏä§ÌÇπÎê®!

Deploy
Connecting to ***@***...  # Ìò∏Ïä§Ìä∏ÏôÄ ÏÇ¨Ïö©ÏûêÎèÑ ÎßàÏä§ÌÇπ
Deployment successful!

Notify Slack
Slack notification sent to #deployments
```

**Î∞∞Ïö¥ Ï†ê:**
1. **Ï†àÎåÄ ÎØºÍ∞ê Ï†ïÎ≥¥Î•º ÏΩîÎìúÏóê ÎÑ£ÏßÄ Îßê Í≤É**
2. GitHub SecretsÎ°ú ÏïàÏ†ÑÌïòÍ≤å Í¥ÄÎ¶¨
3. `${{ secrets.NAME }}` Î¨∏Î≤ïÏúºÎ°ú ÏÇ¨Ïö©
4. Î°úÍ∑∏Ïóê ÏûêÎèôÏúºÎ°ú ÎßàÏä§ÌÇπÎê® (***)
5. `environment:`Î°ú Ï∂îÍ∞Ä Î≥¥Ìò∏ (ÏäπÏù∏ ÌïÑÏöî)

**Î≥¥Ïïà Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏:**
```
‚úÖ SSH ÌÇ§Îäî SecretsÏóê Ï†ÄÏû•
‚úÖ API ÌÇ§Îäî SecretsÏóê Ï†ÄÏû•
‚úÖ ÎπÑÎ∞ÄÎ≤àÌò∏Îäî SecretsÏóê Ï†ÄÏû•
‚úÖ SecretsÎäî ÏµúÏÜå Í∂åÌïú ÏõêÏπô
‚úÖ Ï†ïÍ∏∞Ï†ÅÏúºÎ°ú Secrets ÍµêÏ≤¥
‚ùå .env ÌååÏùº Ïª§Î∞ã Í∏àÏßÄ
‚ùå ÌïòÎìúÏΩîÎî© Í∏àÏßÄ
‚ùå Î°úÍ∑∏Ïóê ÎØºÍ∞ê Ï†ïÎ≥¥ Ï∂úÎ†• Í∏àÏßÄ
```

---

### ÏãúÎÇòÎ¶¨Ïò§ 4: ÏûêÎèô Î∞∞Ìè¨ ÌååÏù¥ÌîÑÎùºÏù∏ Íµ¨Ï∂ï

**ÏÉÅÌô©:** develop Î∏åÎûúÏπòÏóê Ìë∏ÏãúÌïòÎ©¥ ÏûêÎèôÏúºÎ°ú StagingÏóê Î∞∞Ìè¨ÎêòÎèÑÎ°ù Ìï¥Ïïº Ìï©ÎãàÎã§.

**ÏöîÍµ¨ÏÇ¨Ìï≠:**
```
1. develop Î∏åÎûúÏπò Ìë∏Ïãú Ïãú ÏûêÎèô Î∞∞Ìè¨
2. ÌÖåÏä§Ìä∏ Ïã§Ìå® Ïãú Î∞∞Ìè¨ Ï§ëÎã®
3. Î∞∞Ìè¨ ÏÑ±Í≥µ/Ïã§Ìå® Ïãú Slack ÏïåÎ¶º
4. Î°§Î∞± Í∞ÄÎä•ÌïòÎèÑÎ°ù Ïù¥Ï†Ñ Î≤ÑÏ†Ñ Ïú†ÏßÄ
```

**ÏôÑÏ†ÑÌïú CD ÏõåÌÅ¨ÌîåÎ°úÏö∞:**

```yaml
name: CD - Auto Deploy to Staging

on:
  push:
    branches: [develop]
    paths-ignore:
      - '**.md'
      - 'docs/**'

env:
  REGISTRY: ghcr.io
  IMAGE_PREFIX: lk-trade

jobs:
  # Job 1: ÌÖåÏä§Ìä∏
  test:
    name: Run Tests
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: 'gradle'

      - name: Run all tests
        run: ./gradlew test integrationTest

      - name: Upload test results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: test-results
          path: build/test-results/

  # Job 2: ÎπåÎìú Î∞è Ìë∏Ïãú
  build:
    name: Build & Push Images
    runs-on: ubuntu-latest
    needs: [test]  # ÌÖåÏä§Ìä∏ ÏÑ±Í≥µ ÌõÑÏóêÎßå Ïã§Ìñâ
    outputs:
      version: ${{ steps.version.outputs.version }}
    steps:
      - uses: actions/checkout@v4

      - name: Generate version
        id: version
        run: |
          VERSION="develop-$(date +%Y%m%d-%H%M%S)-${GITHUB_SHA::7}"
          echo "version=$VERSION" >> $GITHUB_OUTPUT
          echo "Generated version: $VERSION"

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Log in to Container Registry
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}

      - name: Build and push all services
        run: |
          services=(user-service trade-service account-service strategy-service)
          for service in "${services[@]}"; do
            echo "Building $service..."
            docker build \
              -t ${{ env.REGISTRY }}/${{ github.repository_owner }}/${{ env.IMAGE_PREFIX }}/$service:${{ steps.version.outputs.version }} \
              -t ${{ env.REGISTRY }}/${{ github.repository_owner }}/${{ env.IMAGE_PREFIX }}/$service:staging-latest \
              modules/${service%-service}/api

            docker push ${{ env.REGISTRY }}/${{ github.repository_owner }}/${{ env.IMAGE_PREFIX }}/$service:${{ steps.version.outputs.version }}
            docker push ${{ env.REGISTRY }}/${{ github.repository_owner }}/${{ env.IMAGE_PREFIX }}/$service:staging-latest
          done

  # Job 3: Staging Î∞∞Ìè¨
  deploy-staging:
    name: Deploy to Staging
    runs-on: ubuntu-latest
    needs: [build]
    environment:
      name: staging
      url: https://staging.lk-trade.com
    steps:
      - uses: actions/checkout@v4

      - name: Create backup point
        run: |
          echo "BACKUP_VERSION=${{ needs.build.outputs.version }}" >> $GITHUB_ENV
          echo "Backup point: ${{ needs.build.outputs.version }}"

      - name: Configure SSH
        run: |
          mkdir -p ~/.ssh
          echo "${{ secrets.STAGING_SSH_KEY }}" > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan -H ${{ secrets.STAGING_HOST }} >> ~/.ssh/known_hosts

      - name: Deploy to Staging
        run: |
          ssh ${{ secrets.STAGING_USER }}@${{ secrets.STAGING_HOST }} << 'ENDSSH'
            cd /opt/lk-trade

            # ÌòÑÏû¨ Ïã§Ìñâ Ï§ëÏù∏ Î≤ÑÏ†Ñ Î∞±ÏóÖ
            docker-compose ps --format json > backup/running-version.json

            # ÌôòÍ≤Ω Î≥ÄÏàò ÏÑ§Ï†ï
            export VERSION=${{ needs.build.outputs.version }}
            export REGISTRY=${{ env.REGISTRY }}

            # GitHub Registry Î°úÍ∑∏Ïù∏
            echo "${{ secrets.GITHUB_TOKEN }}" | docker login $REGISTRY -u ${{ github.actor }} --password-stdin

            # ÏÉà Î≤ÑÏ†Ñ Î∞∞Ìè¨
            docker-compose pull
            docker-compose up -d

            echo "Deployment completed!"
          ENDSSH

      - name: Wait for services
        run: sleep 30

      - name: Health Check
        id: health
        run: |
          services=(user trade account strategy)
          for service in "${services[@]}"; do
            echo "Checking $service-service..."
            if ! curl -f https://staging.lk-trade.com/api/$service/actuator/health; then
              echo "health_status=failed" >> $GITHUB_OUTPUT
              exit 1
            fi
          done
          echo "health_status=success" >> $GITHUB_OUTPUT

      - name: Smoke Tests
        if: steps.health.outputs.health_status == 'success'
        run: |
          # Í∏∞Î≥∏ API ÌÖåÏä§Ìä∏
          curl -f https://staging.lk-trade.com/api/v1/health
          curl -f https://staging.lk-trade.com/api/user/actuator/health

          echo "All smoke tests passed!"

      - name: Rollback on failure
        if: failure()
        run: |
          echo "Deployment failed, rolling back..."
          ssh ${{ secrets.STAGING_USER }}@${{ secrets.STAGING_HOST }} << 'ENDSSH'
            cd /opt/lk-trade
            docker-compose down
            # Ïù¥Ï†Ñ Î≤ÑÏ†ÑÏúºÎ°ú Î≥µÍµ¨ Î°úÏßÅ
            docker-compose up -d
          ENDSSH

      - name: Notify Slack - Success
        if: success()
        uses: 8398a7/action-slack@v3
        with:
          status: custom
          custom_payload: |
            {
              "text": "‚úÖ Staging Deployment Successful!",
              "blocks": [
                {
                  "type": "section",
                  "text": {
                    "type": "mrkdwn",
                    "text": "*Staging Deployment Successful!* ‚úÖ"
                  }
                },
                {
                  "type": "section",
                  "fields": [
                    {"type": "mrkdwn", "text": "*Version:*\n${{ needs.build.outputs.version }}"},
                    {"type": "mrkdwn", "text": "*Branch:*\ndevelop"},
                    {"type": "mrkdwn", "text": "*Deployed by:*\n${{ github.actor }}"},
                    {"type": "mrkdwn", "text": "*URL:*\n<https://staging.lk-trade.com|staging.lk-trade.com>"}
                  ]
                }
              ]
            }
          webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}

      - name: Notify Slack - Failure
        if: failure()
        uses: 8398a7/action-slack@v3
        with:
          status: custom
          custom_payload: |
            {
              "text": "‚ùå Staging Deployment Failed!",
              "blocks": [
                {
                  "type": "section",
                  "text": {
                    "type": "mrkdwn",
                    "text": "*Staging Deployment Failed!* ‚ùå\n\nRollback initiated."
                  }
                },
                {
                  "type": "section",
                  "fields": [
                    {"type": "mrkdwn", "text": "*Version:*\n${{ needs.build.outputs.version }}"},
                    {"type": "mrkdwn", "text": "*Failed at:*\n${{ job.status }}"},
                    {"type": "mrkdwn", "text": "*Logs:*\n<${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}|View Logs>"}
                  ]
                }
              ]
            }
          webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}
```

**Ïã§Ìñâ Í≤∞Í≥º:**
```
‚úÖ CD - Auto Deploy to Staging

Run Tests (2m 15s)
  ‚úì Unit tests passed
  ‚úì Integration tests passed

Build & Push Images (5m 30s)
  ‚úì Generated version: develop-20251020-143022-a1b2c3d
  ‚úì Built user-service
  ‚úì Built trade-service
  ‚úì Built account-service
  ‚úì Built strategy-service

Deploy to Staging (1m 45s)
  ‚úì Backup created
  ‚úì Deployed successfully
  ‚úì Health checks passed
  ‚úì Smoke tests passed
  ‚úì Slack notification sent

Total time: 9m 30s
```

**Î∞∞Ïö¥ Ï†ê:**
1. **needs**Î°ú Job ÏàúÏÑú Ï†úÏñ¥ (ÌÖåÏä§Ìä∏ ‚Üí ÎπåÎìú ‚Üí Î∞∞Ìè¨)
2. **outputs**Î°ú Job Í∞Ñ Îç∞Ïù¥ÌÑ∞ Ï†ÑÎã¨
3. **environment**Î°ú Î∞∞Ìè¨ ÌôòÍ≤Ω Î≥¥Ìò∏
4. **if: failure()**Î°ú ÏûêÎèô Î°§Î∞±
5. **Health check**Î°ú Î∞∞Ìè¨ Í≤ÄÏ¶ù
6. **Slack ÏïåÎ¶º**ÏúºÎ°ú ÌåÄ ÌòëÏóÖ

**ÏûêÎèôÌôîÎêú ÏõåÌÅ¨ÌîåÎ°úÏö∞:**
```
Developer Push
      ‚Üì
   Run Tests ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí Failed? ‚Üí Stop, notify
      ‚Üì
   Build Images
      ‚Üì
   Deploy to Staging
      ‚Üì
   Health Check ‚îÄ‚îÄ‚Üí Failed? ‚Üí Rollback, notify
      ‚Üì
   Notify Success
```

---

## ‚ùì FAQ

<details>
<summary><strong>Q1: GitHub Actions vs Jenkins, Ïñ¥Îñ§ Í≤ÉÏùÑ ÏÑ†ÌÉùÌï¥Ïïº ÌïòÎÇòÏöî?</strong></summary>

### ÏÉÅÏÑ∏ ÎãµÎ≥Ä

**GitHub ActionsÎ•º ÏÑ†ÌÉùÌïòÎäî Í≤ΩÏö∞:**
```
‚úÖ Ï†ÅÌï©Ìïú ÏÉÅÌô©:
- GitHub Ï§ëÏã¨ Í∞úÎ∞ú ÏõåÌÅ¨ÌîåÎ°úÏö∞
- Îπ†Î•∏ ÏãúÏûëÍ≥º ÏÑ§Ï†ïÏù¥ ÌïÑÏöîÌïú Í≤ΩÏö∞
- ÏÜåÍ∑úÎ™® ÌåÄ (5Î™Ö Ïù¥Ìïò)
- Í∞ÑÎã®~Ï§ëÍ∞Ñ ÏàòÏ§ÄÏùò ÌååÏù¥ÌîÑÎùºÏù∏
- Ïù∏ÌîÑÎùº Í¥ÄÎ¶¨ Î∂ÄÎã¥ÏùÑ Ï§ÑÏù¥Í≥† Ïã∂ÏùÄ Í≤ΩÏö∞
- Ïò§ÌîàÏÜåÏä§ ÌîÑÎ°úÏ†ùÌä∏ (Î¨¥Î£å)

Ïû•Ï†ê:
- ÏÑ§Ï†ïÏù¥ Îß§Ïö∞ Í∞ÑÎã® (.yml ÌååÏùºÎßå Ï∂îÍ∞Ä)
- GitHubÏôÄ ÏôÑÎ≤ΩÌïú ÌÜµÌï©
- Î¨¥Î£å tier Ï†úÍ≥µ (Ïõî 2000Î∂Ñ)
- ÏÑúÎ≤Ñ Í¥ÄÎ¶¨ Î∂àÌïÑÏöî
- MarketplaceÏùò Îã§ÏñëÌïú Ïï°ÏÖò

Îã®Ï†ê:
- Î≥µÏû°Ìïú Ïª§Ïä§ÌÑ∞ÎßàÏù¥Ïßï Ï†úÌïúÏ†Å
- ÎπåÎìú ÏãúÍ∞ÑÏù¥ Í∏∏Î©¥ ÎπÑÏö© Ï¶ùÍ∞Ä
- Self-hosted runner ÏÑ§Ï†ïÏù¥ JenkinsÎ≥¥Îã§ Î≥µÏû°
```

**JenkinsÎ•º ÏÑ†ÌÉùÌïòÎäî Í≤ΩÏö∞:**
```
‚úÖ Ï†ÅÌï©Ìïú ÏÉÅÌô©:
- Î≥µÏû°Ìïú ÌååÏù¥ÌîÑÎùºÏù∏ ÌïÑÏöî
- Í∏∞Ï°¥ Jenkins Ïù∏ÌîÑÎùºÍ∞Ä ÏûàÎäî Í≤ΩÏö∞
- ÎÜíÏùÄ ÏàòÏ§ÄÏùò Ïª§Ïä§ÌÑ∞ÎßàÏù¥Ïßï ÌïÑÏöî
- Ïò®ÌîÑÎ†àÎØ∏Ïä§ ÌôòÍ≤Ω ÌïÑÏàò
- ÎπåÎìúÍ∞Ä Îß§Ïö∞ ÎπàÎ≤àÌïú Í≤ΩÏö∞ (ÎπÑÏö© Ï†àÍ∞ê)
- ÎåÄÍ∑úÎ™® ÌåÄ (10Î™Ö Ïù¥ÏÉÅ)

Ïû•Ï†ê:
- Î¨¥Ï†úÌïú ÎπåÎìú (ÏÑúÎ≤ÑÎßå ÏûàÏúºÎ©¥ Îê®)
- Îß§Ïö∞ ÎÜíÏùÄ Ïª§Ïä§ÌÑ∞ÎßàÏù¥Ïßï Í∞ÄÎä•
- 1800+ ÌîåÎü¨Í∑∏Ïù∏
- ÌíçÎ∂ÄÌïú UIÏôÄ ÎåÄÏãúÎ≥¥Îìú
- Îã§ÏñëÌïú VCS ÏßÄÏõê

Îã®Ï†ê:
- Ï¥àÍ∏∞ ÏÑ§Ï†ï Î≥µÏû°
- ÏÑúÎ≤Ñ Í¥ÄÎ¶¨ ÌïÑÏöî
- Îü¨Îãù Ïª§Î∏å ÎÜíÏùå
- ÌîåÎü¨Í∑∏Ïù∏ Ï∂©Îèå Í∞ÄÎä•ÏÑ±
```

**Ïã§Ï†ú ÎπÑÏö© ÎπÑÍµê:**
```
ÏãúÎÇòÎ¶¨Ïò§: ÌïòÎ£® 20Ìöå ÎπåÎìú, ÎπåÎìúÎãπ 10Î∂Ñ

GitHub Actions:
- Ïõî ÎπåÎìú ÏãúÍ∞Ñ: 20 √ó 10Î∂Ñ √ó 30Ïùº = 6,000Î∂Ñ
- Î¨¥Î£å tier: 2,000Î∂Ñ
- Ï¥àÍ≥º ÏãúÍ∞Ñ: 4,000Î∂Ñ
- ÎπÑÏö©: 4,000Î∂Ñ √ó $0.008 = $32/Ïõî

Jenkins (Self-hosted):
- ÏÑúÎ≤Ñ ÎπÑÏö©: $50/Ïõî (Í≥†Ï†ï)
- ÎπåÎìú ÌöüÏàò: Î¨¥Ï†úÌïú
- Ï¥ù ÎπÑÏö©: $50/Ïõî

Í≤∞Î°†:
- Ïõî 6,250Î∂Ñ Ïù¥Ìïò: GitHub Actions Í∂åÏû•
- Ïõî 6,250Î∂Ñ Ïù¥ÏÉÅ: Jenkins Í∂åÏû•
```

**Best Practice: ÌïòÏù¥Î∏åÎ¶¨Îìú Ï†ëÍ∑º**
```yaml
# GitHub ActionsÎ°ú Í∞ÑÎã®Ìïú Í≤ÄÏ¶ù
# .github/workflows/quick-check.yml
name: Quick Check
on: [pull_request]
jobs:
  lint-and-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: ./gradlew ktlintCheck test

# JenkinsÎ°ú Î≥µÏû°Ìïú Î∞∞Ìè¨
# Jenkinsfile
pipeline {
    stages {
        stage('Full Build') { ... }
        stage('Security Scan') { ... }
        stage('Deploy') { ... }
    }
}
```

</details>

<details>
<summary><strong>Q2: Self-hosted RunnerÎäî Ïñ∏Ï†ú ÏÇ¨Ïö©ÌïòÎÇòÏöî? Ïñ¥ÎñªÍ≤å ÏÑ§Ï†ïÌïòÎÇòÏöî?</strong></summary>

### ÏÉÅÏÑ∏ ÎãµÎ≥Ä

**Self-hosted RunnerÍ∞Ä ÌïÑÏöîÌïú Í≤ΩÏö∞:**
```
‚úÖ ÏÇ¨Ïö©Ìï¥Ïïº ÌïòÎäî ÏÉÅÌô©:
1. ÎπåÎìú ÏãúÍ∞ÑÏù¥ Îß§Ïö∞ Í∏¥ Í≤ΩÏö∞ (30Î∂Ñ+)
   ‚Üí GitHub-hostedÎäî ÏãúÍ∞ÑÎãπ ÎπÑÏö© Î∞úÏÉù

2. ÌäπÏàò ÌïòÎìúÏõ®Ïñ¥ ÌïÑÏöî
   ‚Üí GPU, ÌäπÏ†ï CPU ÏïÑÌÇ§ÌÖçÏ≤ò (ARM Îì±)

3. Ïò®ÌîÑÎ†àÎØ∏Ïä§ Î¶¨ÏÜåÏä§ Ï†ëÍ∑º ÌïÑÏöî
   ‚Üí ÎÇ¥Î∂Ä Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§, ÎÑ§Ìä∏ÏõåÌÅ¨ Ï†úÌïú

4. ÎÜíÏùÄ ÎπåÎìú ÎπàÎèÑ
   ‚Üí ÌïòÎ£® 50Ìöå+ ÎπåÎìú

5. Î≥¥Ïïà/Í∑úÏ†ï Ï§ÄÏàò ÏöîÍµ¨ÏÇ¨Ìï≠
   ‚Üí Îç∞Ïù¥ÌÑ∞Í∞Ä ÏûêÏ≤¥ Ïù∏ÌîÑÎùºÏóêÎßå ÏûàÏñ¥Ïïº Ìï®
```

**ÏÑ§Ï†ï Î∞©Î≤ï:**

```bash
# 1. Ubuntu ÏÑúÎ≤Ñ Ï§ÄÎπÑ
ssh admin@build-server.company.com

# 2. ÌïÑÏàò Ìå®ÌÇ§ÏßÄ ÏÑ§Ïπò
sudo apt-get update
sudo apt-get install -y curl git

# 3. Runner Îã§Ïö¥Î°úÎìú
mkdir actions-runner && cd actions-runner
curl -o actions-runner-linux-x64-2.311.0.tar.gz -L \
  https://github.com/actions/runner/releases/download/v2.311.0/actions-runner-linux-x64-2.311.0.tar.gz
tar xzf ./actions-runner-linux-x64-2.311.0.tar.gz

# 4. Runner Îì±Î°ù
# GitHub: Repository > Settings > Actions > Runners > New self-hosted runner
# ÌëúÏãúÎêú ÌÜ†ÌÅ∞ÏùÑ ÏÇ¨Ïö©
./config.sh \
  --url https://github.com/your-org/lk-trade \
  --token YOUR_REGISTRATION_TOKEN \
  --name build-server-1 \
  --labels ubuntu-20.04,x64,gpu \
  --work _work

# 5. ÏÑúÎπÑÏä§Î°ú ÏÑ§Ïπò (Ïû¨Î∂ÄÌåÖ Ïãú ÏûêÎèô ÏãúÏûë)
sudo ./svc.sh install
sudo ./svc.sh start

# 6. ÏÉÅÌÉú ÌôïÏù∏
sudo ./svc.sh status
```

**DockerÎ°ú Self-hosted Runner Ïã§Ìñâ:**

```yaml
# docker-compose.runner.yml
version: '3.8'

services:
  github-runner:
    image: myoung34/github-runner:latest
    container_name: github-runner
    environment:
      - REPO_URL=https://github.com/your-org/lk-trade
      - RUNNER_NAME=docker-runner
      - RUNNER_TOKEN=${RUNNER_TOKEN}
      - RUNNER_WORKDIR=/tmp/runner
      - LABELS=ubuntu-latest,docker
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - runner-data:/tmp/runner
    restart: unless-stopped

volumes:
  runner-data:
```

```bash
# Ïã§Ìñâ
export RUNNER_TOKEN=YOUR_TOKEN
docker-compose -f docker-compose.runner.yml up -d
```

**ÏõåÌÅ¨ÌîåÎ°úÏö∞ÏóêÏÑú ÏÇ¨Ïö©:**

```yaml
name: Build on Self-hosted Runner

on: [push]

jobs:
  build:
    runs-on: self-hosted  # Self-hosted runner ÏÇ¨Ïö©
    # ÎòêÎäî ÌäπÏ†ï Î†àÏù¥Î∏î ÏßÄÏ†ï
    # runs-on: [self-hosted, ubuntu-20.04, gpu]

    steps:
      - uses: actions/checkout@v4

      - name: Build with GPU
        run: |
          nvidia-smi  # GPU Ï†ïÎ≥¥ ÌôïÏù∏
          ./gradlew build -Pgpu=true

      - name: Access internal database
        run: |
          # ÎÇ¥Î∂Ä ÎÑ§Ìä∏ÏõåÌÅ¨ Ï†ëÍ∑º Í∞ÄÎä•
          mysql -h internal-db.company.local -u user -p${{ secrets.DB_PASSWORD }}
```

**Î≥¥Ïïà Best Practices:**

```yaml
# 1. Í≥µÍ∞ú Ï†ÄÏû•ÏÜåÏóêÎäî Self-hosted runner ÏÇ¨Ïö© Í∏àÏßÄ!
# GitHub-hosted runnerÎßå ÏÇ¨Ïö©

# 2. Private Ï†ÄÏû•ÏÜåÏóêÏÑúÎßå ÏÇ¨Ïö©
# .github/workflows/secure-build.yml
name: Secure Build

on:
  push:
    branches: [main]

jobs:
  build:
    # Í≥µÍ∞ú Ï†ÄÏû•ÏÜåÎùºÎ©¥ Ïù¥ JobÏùÄ Ïã§Ìñâ Ïïà Îê®
    if: github.repository == 'your-org/lk-trade' && github.event.repository.private == true
    runs-on: self-hosted

    steps:
      - uses: actions/checkout@v4
      # ...

# 3. Runner Í≤©Î¶¨
# Í∞Å Ï°∞ÏßÅ/ÌåÄÎ≥ÑÎ°ú Î≥ÑÎèÑÏùò runner ÏÇ¨Ïö©

# 4. Ï†ïÍ∏∞Ï†ÅÏù∏ Î≥¥Ïïà ÏóÖÎç∞Ïù¥Ìä∏
# Cron jobÏúºÎ°ú ÏûêÎèô ÏóÖÎç∞Ïù¥Ìä∏
```

**ÎπÑÏö© ÎπÑÍµê:**

```
GitHub-hosted Runner:
- Î¨¥Î£å tier: 2,000Î∂Ñ/Ïõî
- Ï¥àÍ≥º Ïãú: $0.008/Î∂Ñ (Linux)
- Ïòà: 10,000Î∂Ñ/Ïõî = $64/Ïõî

Self-hosted Runner:
- ÏÑúÎ≤Ñ ÎπÑÏö©: $50~200/Ïõî
- ÎπåÎìú ÏãúÍ∞Ñ: Î¨¥Ï†úÌïú
- Ï†ÑÎ†•, Í¥ÄÎ¶¨ ÎπÑÏö© Ï∂îÍ∞Ä

Break-even point: Ïõî 8,000Î∂Ñ
```

</details>

<details>
<summary><strong>Q3: GitHub Actions ÎπÑÏö©ÏùÑ ÏµúÏ†ÅÌôîÌïòÎ†§Î©¥ Ïñ¥ÎñªÍ≤å Ìï¥Ïïº ÌïòÎÇòÏöî?</strong></summary>

### ÏÉÅÏÑ∏ ÎãµÎ≥Ä

**ÎπÑÏö© ÏµúÏ†ÅÌôî Ï†ÑÎûµ:**

**1. Ï∫êÏã± Ï†ÅÍ∑π ÌôúÏö©**

```yaml
# ‚ùå Ï∫êÏã± ÏóÜÏùå (ÎäêÎ¶¨Í≥† ÎπÑÏö© Ï¶ùÍ∞Ä)
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
      - run: ./gradlew build  # Îß§Î≤à ÏùòÏ°¥ÏÑ± Îã§Ïö¥Î°úÎìú!

# ‚úÖ Ï∫êÏã± ÏûàÏùå (Îπ†Î•¥Í≥† ÎπÑÏö© Ï†àÍ∞ê)
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: 'gradle'  # Gradle Ï∫êÏãú ÌôúÏÑ±Ìôî

      # Ï∂îÍ∞Ä Ï∫êÏã±
      - uses: actions/cache@v3
        with:
          path: |
            ~/.gradle/caches
            ~/.gradle/wrapper
          key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}
          restore-keys: |
            ${{ runner.os }}-gradle-

      - run: ./gradlew build

# Í≤∞Í≥º:
# - ÏùòÏ°¥ÏÑ± Îã§Ïö¥Î°úÎìú: 5Î∂Ñ ‚Üí 10Ï¥à
# - Ï¥ù ÎπåÎìú ÏãúÍ∞Ñ: 10Î∂Ñ ‚Üí 3Î∂Ñ
# - ÎπÑÏö© Ï†àÍ∞ê: 70%
```

**2. Î∂àÌïÑÏöîÌïú ÏõåÌÅ¨ÌîåÎ°úÏö∞ Ïã§Ìñâ Î∞©ÏßÄ**

```yaml
# ‚ùå Î™®Îì† ÌååÏùº Î≥ÄÍ≤Ω Ïãú Ïã§Ìñâ
on: [push]

# ‚úÖ ÌïÑÏöîÌïú Í≤ΩÏö∞ÏóêÎßå Ïã§Ìñâ
on:
  push:
    branches: [main, develop]
    paths:
      - 'src/**'
      - 'build.gradle.kts'
      - '.github/workflows/**'
    paths-ignore:
      - '**.md'
      - 'docs/**'
      - '.gitignore'

# Ïòà: README.md ÏàòÏ†ï Ïãú ÎπåÎìú Ïïà Ìï® ‚Üí ÎπÑÏö© Ï†àÍ∞ê
```

**3. Job Î≥ëÎ†¨ÌôîÎ°ú ÏãúÍ∞Ñ Îã®Ï∂ï**

```yaml
# ‚ùå ÏàúÏ∞® Ïã§Ìñâ (ÎäêÎ¶º)
jobs:
  test-user:
    runs-on: ubuntu-latest
    steps:
      - run: ./gradlew :user:test

  test-trade:
    needs: [test-user]  # ÎåÄÍ∏∞ ÏãúÍ∞Ñ ÎÇ≠ÎπÑ!
    runs-on: ubuntu-latest
    steps:
      - run: ./gradlew :trade:test

# ‚úÖ Î≥ëÎ†¨ Ïã§Ìñâ (Îπ†Î¶Ñ)
jobs:
  test:
    strategy:
      matrix:
        module: [user, trade, account, strategy]
    runs-on: ubuntu-latest
    steps:
      - run: ./gradlew :${{ matrix.module }}:test

# Í≤∞Í≥º:
# - ÏàúÏ∞®: 20Î∂Ñ (5Î∂Ñ √ó 4)
# - Î≥ëÎ†¨: 5Î∂Ñ
# - ÏãúÍ∞Ñ Ï†àÍ∞ê: 75%
```

**4. Docker Î†àÏù¥Ïñ¥ Ï∫êÏã±**

```yaml
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Build with cache
        uses: docker/build-push-action@v5
        with:
          context: .
          push: false
          cache-from: type=gha  # GitHub Actions Ï∫êÏãú ÏÇ¨Ïö©
          cache-to: type=gha,mode=max
          tags: myapp:latest

# Í≤∞Í≥º:
# - Ï≤´ ÎπåÎìú: 10Î∂Ñ
# - Ïù¥ÌõÑ ÎπåÎìú: 2Î∂Ñ (Ï∫êÏãú ÌûàÌä∏)
# - ÎπÑÏö© Ï†àÍ∞ê: 80%
```

**5. Ï°∞Í±¥Î∂Ä Job Ïã§Ìñâ**

```yaml
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: ./gradlew test

  # Î∞∞Ìè¨Îäî main Î∏åÎûúÏπòÏóêÎßå
  deploy:
    needs: [test]
    if: github.ref == 'refs/heads/main'  # main Î∏åÎûúÏπòÏóêÎßå Ïã§Ìñâ
    runs-on: ubuntu-latest
    steps:
      - run: ./deploy.sh

# PRÏóêÏÑúÎäî deploy Job Í±¥ÎÑàÎúÄ ‚Üí ÎπÑÏö© Ï†àÍ∞ê
```

**6. Self-hosted RunnerÎ°ú Ï†ÑÌôò (ÎåÄÍ∑úÎ™® ÌîÑÎ°úÏ†ùÌä∏)**

```yaml
jobs:
  # Îπ†Î•∏ Í≤ÄÏ¶ùÏùÄ GitHub-hosted
  quick-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: ./gradlew ktlintCheck

  # Í∏¥ ÎπåÎìúÎäî Self-hosted
  full-build:
    runs-on: self-hosted
    steps:
      - uses: actions/checkout@v4
      - run: ./gradlew build integrationTest

# ÎπÑÏö©:
# - quick-check: 1Î∂Ñ √ó $0.008 = $0.008
# - full-build: 30Î∂Ñ √ó $0 (self-hosted) = $0
```

**7. Ïä§ÏºÄÏ§ÑÎêú ÏõåÌÅ¨ÌîåÎ°úÏö∞ ÏµúÏ†ÅÌôî**

```yaml
# ‚ùå ÎπÑÏö© ÎÇ≠ÎπÑ
on:
  schedule:
    - cron: '*/5 * * * *'  # 5Î∂ÑÎßàÎã§ Ïã§Ìñâ (ÎÑàÎ¨¥ ÎπàÎ≤à!)

# ‚úÖ Ï†ÅÏ†àÌïú ÎπàÎèÑ
on:
  schedule:
    - cron: '0 2 * * *'  # ÌïòÎ£® 1Î≤à, ÏÉàÎ≤Ω 2Ïãú
  workflow_dispatch:  # ÌïÑÏöî Ïãú ÏàòÎèô Ïã§Ìñâ
```

**ÎπÑÏö© ÏµúÏ†ÅÌôî ÏöîÏïΩ:**

```
ÏµúÏ†ÅÌôî Ï†Ñ:
- ÌïòÎ£® 20Ìöå ÎπåÎìú
- ÎπåÎìúÎãπ 15Î∂Ñ
- Ïõî Ï¥ù ÏãúÍ∞Ñ: 20 √ó 15 √ó 30 = 9,000Î∂Ñ
- Î¨¥Î£å tier: 2,000Î∂Ñ
- Ï¥àÍ≥º ÏãúÍ∞Ñ: 7,000Î∂Ñ
- ÎπÑÏö©: 7,000 √ó $0.008 = $56/Ïõî

ÏµúÏ†ÅÌôî ÌõÑ:
- ÌïòÎ£® 15Ìöå ÎπåÎìú (Î∂àÌïÑÏöîÌïú Ïã§Ìñâ Ï†úÍ±∞)
- ÎπåÎìúÎãπ 5Î∂Ñ (Ï∫êÏã±, Î≥ëÎ†¨Ìôî)
- Ïõî Ï¥ù ÏãúÍ∞Ñ: 15 √ó 5 √ó 30 = 2,250Î∂Ñ
- Î¨¥Î£å tier: 2,000Î∂Ñ
- Ï¥àÍ≥º ÏãúÍ∞Ñ: 250Î∂Ñ
- ÎπÑÏö©: 250 √ó $0.008 = $2/Ïõî

Ï†àÍ∞êÏï°: $54/Ïõî (96% Ï†àÍ∞ê!)
```

**Best Practices Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏:**

```
‚úÖ Gradle/Maven Ï∫êÏãú ÌôúÏÑ±Ìôî
‚úÖ Docker ÎπåÎìú Ï∫êÏãú ÏÇ¨Ïö©
‚úÖ paths-ignoreÎ°ú Î∂àÌïÑÏöîÌïú Ïã§Ìñâ Î∞©ÏßÄ
‚úÖ Matrix strategyÎ°ú Î≥ëÎ†¨ Ïã§Ìñâ
‚úÖ Ï°∞Í±¥Î∂Ä Job Ïã§Ìñâ (if:)
‚úÖ Self-hosted runner Í≥†Î†§ (ÎπåÎìú ÎπàÎ≤àÌïú Í≤ΩÏö∞)
‚úÖ Ïä§ÏºÄÏ§Ñ ÏõåÌÅ¨ÌîåÎ°úÏö∞ ÏµúÏ†ÅÌôî
‚úÖ Artifacts Ï†ïÎ¶¨ (Ïò§ÎûòÎêú Í≤É ÏÇ≠Ï†ú)
‚ùå Î™®Îì† push/PRÏóê Í∏¥ ÏõåÌÅ¨ÌîåÎ°úÏö∞ Ïã§Ìñâ
‚ùå Ï∫êÏã± ÏóÜÏù¥ ÏùòÏ°¥ÏÑ± Îß§Î≤à Îã§Ïö¥Î°úÎìú
‚ùå Î∂àÌïÑÏöîÌïú Ïä§ÌÖù Ïã§Ìñâ
```

</details>

<details>
<summary><strong>Q4: GitHub ActionsÏóêÏÑú Ï∫êÏã±ÏùÑ Ìö®Í≥ºÏ†ÅÏúºÎ°ú ÏÇ¨Ïö©ÌïòÎäî Î∞©Î≤ïÏùÄ?</strong></summary>

### ÏÉÅÏÑ∏ ÎãµÎ≥Ä

**Ï∫êÏã± Ï†ÑÎûµ:**

**1. Gradle Ï∫êÏã± (ÏûêÎèô)**

```yaml
# Î∞©Î≤ï 1: setup-java ÎÇ¥Ïû• Ï∫êÏã± (Í∞ÄÏû• Í∞ÑÎã®!)
- uses: actions/setup-java@v4
  with:
    java-version: '17'
    distribution: 'temurin'
    cache: 'gradle'  # ÏûêÎèôÏúºÎ°ú ~/.gradle Ï∫êÏã±

# Í≤∞Í≥º:
# - Ï≤´ Ïã§Ìñâ: ÏùòÏ°¥ÏÑ± Îã§Ïö¥Î°úÎìú 5Î∂Ñ
# - Ïù¥ÌõÑ Ïã§Ìñâ: Ï∫êÏãú Î≥µÏõê 10Ï¥à
```

**2. Gradle Ï∫êÏã± (ÏàòÎèô, Îçî ÏÑ∏Î∞ÄÌïú Ï†úÏñ¥)**

```yaml
- uses: actions/cache@v3
  with:
    path: |
      ~/.gradle/caches
      ~/.gradle/wrapper
      .gradle/
    key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}
    restore-keys: |
      ${{ runner.os }}-gradle-

# key ÏÑ§Î™Ö:
# - runner.os: Ïö¥ÏòÅÏ≤¥Ï†úÎ≥ÑÎ°ú Ï∫êÏãú Î∂ÑÎ¶¨
# - hashFiles(): ÌååÏùº ÎÇ¥Ïö© Í∏∞Î∞ò ÌÇ§ ÏÉùÏÑ±
#   ‚Üí build.gradle.kts Î≥ÄÍ≤Ω Ïãú ÏÉà Ï∫êÏãú ÏÉùÏÑ±
# - restore-keys: ÏôÑÏ†Ñ ÏùºÏπò ÏóÜÏùÑ Îïå fallback
```

**3. Docker Î†àÏù¥Ïñ¥ Ï∫êÏã±**

```yaml
- name: Set up Docker Buildx
  uses: docker/setup-buildx-action@v3

- name: Build and push
  uses: docker/build-push-action@v5
  with:
    context: .
    push: true
    tags: myapp:latest
    cache-from: type=gha
    cache-to: type=gha,mode=max

# mode=max: Î™®Îì† Î†àÏù¥Ïñ¥ Ï∫êÏã± (Í∂åÏû•)
# mode=min: ÏµúÏ¢Ö Ïù¥ÎØ∏ÏßÄÎßå Ï∫êÏã±

# Í≤∞Í≥º:
# - Ï≤´ ÎπåÎìú: 10Î∂Ñ
# - Ïù¥ÌõÑ ÎπåÎìú (Î≥ÄÍ≤Ω ÏóÜÏùå): 30Ï¥à
# - Ïù¥ÌõÑ ÎπåÎìú (ÏÜåÏä§Îßå Î≥ÄÍ≤Ω): 2Î∂Ñ
```

**4. npm/yarn Ï∫êÏã±**

```yaml
- uses: actions/setup-node@v4
  with:
    node-version: '20'
    cache: 'npm'  # ÎòêÎäî 'yarn', 'pnpm'

# ÏàòÎèô:
- uses: actions/cache@v3
  with:
    path: ~/.npm
    key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
    restore-keys: |
      ${{ runner.os }}-node-
```

**5. Ïª§Ïä§ÌÖÄ Ï∫êÏã± (ÎπåÎìú ÏÇ∞Ï∂úÎ¨º)**

```yaml
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # ÎπåÎìú ÏÇ∞Ï∂úÎ¨º Ï∫êÏã±
      - uses: actions/cache@v3
        id: build-cache
        with:
          path: build/libs
          key: build-${{ github.sha }}  # Ïª§Î∞ãÎ≥ÑÎ°ú Ï∫êÏãú

      - name: Build
        if: steps.build-cache.outputs.cache-hit != 'true'
        run: ./gradlew build

      - name: Use cached build
        if: steps.build-cache.outputs.cache-hit == 'true'
        run: echo "Using cached build!"

  test:
    needs: [build]
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # Í∞ôÏùÄ ÎπåÎìú ÏÇ∞Ï∂úÎ¨º Ïû¨ÏÇ¨Ïö©
      - uses: actions/cache@v3
        with:
          path: build/libs
          key: build-${{ github.sha }}

      - run: ./test.sh build/libs/app.jar
```

**6. Îã§Ï§ë Ï∫êÏãú ÏÇ¨Ïö©**

```yaml
- name: Cache multiple paths
  uses: actions/cache@v3
  with:
    path: |
      ~/.gradle/caches
      ~/.gradle/wrapper
      ~/.m2/repository
      node_modules
      .next/cache
    key: ${{ runner.os }}-multi-${{ hashFiles('**/*.gradle*', '**/pom.xml', '**/package-lock.json') }}
```

**7. Ï∫êÏãú Î¨¥Ìö®Ìôî Ï†ÑÎûµ**

```yaml
# Ï∫êÏãú ÌÇ§Ïóê Î≤ÑÏ†Ñ Ï∂îÍ∞Ä
- uses: actions/cache@v3
  with:
    path: ~/.gradle
    key: v2-${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*') }}
    #    ^^^ Î≤ÑÏ†Ñ Î≥ÄÍ≤Ω Ïãú ÏÉà Ï∫êÏãú

# Îß§Ïùº ÏÉàÎ°úÏö¥ Ï∫êÏãú ÏÉùÏÑ±
- uses: actions/cache@v3
  with:
    path: ~/.gradle
    key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*') }}-${{ github.run_number }}
    restore-keys: |
      ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*') }}-
      ${{ runner.os }}-gradle-
```

**Ï∫êÏã± Best Practices:**

```yaml
name: Optimized Build with Caching

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # 1. Java/Gradle Ï∫êÏã± (ÏûêÎèô)
      - uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: 'gradle'

      # 2. Docker Buildx ÏÑ§Ï†ï
      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      # 3. Gradle ÎπåÎìú (Ï∫êÏãú ÌôúÏö©)
      - name: Build with Gradle
        run: |
          ./gradlew build \
            --build-cache \
            --configuration-cache

      # 4. Docker ÎπåÎìú (Î†àÏù¥Ïñ¥ Ï∫êÏã±)
      - name: Build Docker image
        uses: docker/build-push-action@v5
        with:
          context: .
          push: false
          cache-from: type=gha
          cache-to: type=gha,mode=max
          tags: myapp:latest

      # 5. ÌÖåÏä§Ìä∏ Í≤∞Í≥º Ï∫êÏã± (ÏÑ†ÌÉùÏ†Å)
      - uses: actions/cache@v3
        with:
          path: build/test-results
          key: test-results-${{ github.sha }}

# Í≤∞Í≥º:
# - Ï≤´ Ïã§Ìñâ: 15Î∂Ñ
# - Ïù¥ÌõÑ Ïã§Ìñâ (Ï∫êÏãú ÌûàÌä∏): 3Î∂Ñ
# - ÏãúÍ∞Ñ Ï†àÍ∞ê: 80%
```

**Ï∫êÏãú ÌÅ¨Í∏∞ Ï†úÌïú:**

```
GitHub Actions Ï∫êÏãú Ï†úÌïú:
- Î¶¨Ìè¨ÏßÄÌÜ†Î¶¨Îãπ: 10GB
- Ï∫êÏãú Î≥¥Í¥Ä: 7Ïùº (ÏÇ¨Ïö©ÎêòÏßÄ ÏïäÏúºÎ©¥ ÏÇ≠Ï†ú)
- Í∞úÎ≥Ñ Ï∫êÏãú: 10GB

Ï£ºÏùò:
- ÎÑàÎ¨¥ ÌÅ∞ Ï∫êÏãúÎäî Î≥µÏõê ÏãúÍ∞Ñ Ï¶ùÍ∞Ä
- Î∂àÌïÑÏöîÌïú ÌååÏùºÏùÄ Ï†úÏô∏
```

**Ï∫êÏã± ÎîîÎ≤ÑÍπÖ:**

```yaml
- name: Debug cache
  run: |
    echo "Cache key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*') }}"
    du -sh ~/.gradle
    ls -la ~/.gradle/caches

- uses: actions/cache@v3
  with:
    path: ~/.gradle
    key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*') }}
    restore-keys: |
      ${{ runner.os }}-gradle-

- name: Check cache hit
  run: |
    if [ "${{ steps.cache.outputs.cache-hit }}" == "true" ]; then
      echo "‚úÖ Cache hit!"
    else
      echo "‚ùå Cache miss"
    fi
```

</details>

<details>
<summary><strong>Q5: GitHub Actions Î≥¥Ïïà Best PracticesÎäî Î¨¥ÏóáÏù∏Í∞ÄÏöî?</strong></summary>

### ÏÉÅÏÑ∏ ÎãµÎ≥Ä

**Î≥¥Ïïà Best Practices:**

**1. Secrets Í¥ÄÎ¶¨**

```yaml
# ‚ùå Ï†àÎåÄ ÌïòÏßÄ Îßê Í≤É!
- name: Deploy
  run: |
    export API_KEY="sk-1234567890"  # ÌïòÎìúÏΩîÎî© Í∏àÏßÄ!
    export PASSWORD="admin123"       # Î°úÍ∑∏Ïóê ÎÖ∏Ï∂úÎê®!

# ‚úÖ Ïò¨Î∞îÎ•∏ Î∞©Î≤ï
- name: Deploy
  env:
    API_KEY: ${{ secrets.API_KEY }}
    PASSWORD: ${{ secrets.DB_PASSWORD }}
  run: |
    ./deploy.sh

# SecretsÎäî ÏûêÎèôÏúºÎ°ú ÎßàÏä§ÌÇπÎê®:
# Î°úÍ∑∏: "Using API key: ***"
```

**2. ÏµúÏÜå Í∂åÌïú ÏõêÏπô**

```yaml
# GitHub Token Í∂åÌïú Ï†úÌïú
permissions:
  contents: read        # ÏΩîÎìú ÏùΩÍ∏∞Îßå
  pull-requests: write  # PR ÏΩîÎ©òÌä∏
  packages: write       # Docker Ïù¥ÎØ∏ÏßÄ Ìë∏Ïãú
  # issues: write       # Î∂àÌïÑÏöîÌïòÎ©¥ Ï†úÏô∏

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Build
        run: ./gradlew build
```

**3. Í≥µÍ∞ú Ï†ÄÏû•ÏÜåÏóêÏÑú Self-hosted Runner ÏÇ¨Ïö© Í∏àÏßÄ**

```yaml
# ‚ùå ÏúÑÌóò! Í≥µÍ∞ú Ï†ÄÏû•ÏÜåÏóêÏÑú Self-hosted runner
jobs:
  build:
    runs-on: self-hosted  # ÎàÑÍµ¨ÎÇò ÏïÖÏùòÏ†Å PRÎ°ú ÏΩîÎìú Ïã§Ìñâ Í∞ÄÎä•!

# ‚úÖ ÏïàÏ†Ñ: Í≥µÍ∞ú Ï†ÄÏû•ÏÜåÎäî GitHub-hostedÎßå
jobs:
  build:
    runs-on: ubuntu-latest

# ‚úÖ Private Ï†ÄÏû•ÏÜåÏóêÏÑúÎßå Self-hosted
jobs:
  build:
    if: github.event.repository.private == true
    runs-on: self-hosted
```

**4. Pull Request Î≥¥Ìò∏**

```yaml
# ‚ùå ÏúÑÌóò: ForkÏóêÏÑú Ïò® PRÏóê Secrets ÎÖ∏Ï∂ú
on: [pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: echo ${{ secrets.API_KEY }}  # Fork PRÏóêÏÑú Ï†ëÍ∑º Í∞ÄÎä•!

# ‚úÖ ÏïàÏ†Ñ: pull_request_target + ÏäπÏù∏ ÌïÑÏöî
on:
  pull_request_target:  # Fork PRÏùÄ Í∏∞Î≥∏Ï†ÅÏúºÎ°ú Secrets Ï†ëÍ∑º Î∂àÍ∞Ä

jobs:
  test:
    runs-on: ubuntu-latest
    environment: production  # ÏàòÎèô ÏäπÏù∏ ÌïÑÏöî
    steps:
      - uses: actions/checkout@v4
        with:
          ref: ${{ github.event.pull_request.head.sha }}  # PR Î∏åÎûúÏπò Ï≤¥ÌÅ¨ÏïÑÏõÉ
      - run: ./test.sh
```

**5. Ïç®ÎìúÌååÌã∞ Ïï°ÏÖò Í≤ÄÏ¶ù**

```yaml
# ‚ùå ÏúÑÌóò: ÏµúÏã† Î≤ÑÏ†Ñ ÏûêÎèô ÏÇ¨Ïö©
- uses: some-org/some-action@main  # main Î∏åÎûúÏπòÍ∞Ä Î≥ÄÍ≤ΩÎê† Ïàò ÏûàÏùå!

# ‚úÖ ÏïàÏ†Ñ: ÌäπÏ†ï Î≤ÑÏ†Ñ Í≥†Ï†ï
- uses: actions/checkout@v4  # Î©îÏù¥Ï†Ä Î≤ÑÏ†Ñ Í≥†Ï†ï
- uses: actions/setup-java@8df82afff59ac2b6
  # ÎòêÎäî Ïª§Î∞ã SHAÎ°ú Í≥†Ï†ï (Í∞ÄÏû• ÏïàÏ†Ñ)

# ‚úÖ Ïã†Î¢∞Ìï† Ïàò ÏûàÎäî Ïï°ÏÖòÎßå ÏÇ¨Ïö©
# - GitHub Í≥µÏãù: actions/*
# - Í≤ÄÏ¶ùÎêú Ï°∞ÏßÅ: docker/*, aws-actions/*
```

**6. ÏΩîÎìú Ïù∏Ï†ùÏÖò Î∞©ÏßÄ**

```yaml
# ‚ùå ÏúÑÌóò: ÏÇ¨Ïö©Ïûê ÏûÖÎ†•ÏùÑ ÏßÅÏ†ë ÏÇ¨Ïö©
on:
  pull_request:
    types: [opened]

jobs:
  comment:
    runs-on: ubuntu-latest
    steps:
      - name: Comment
        run: |
          echo "PR Title: ${{ github.event.pull_request.title }}"
          # ÏïÖÏùòÏ†Å PR Ï†úÎ™©: "; rm -rf / #"
          # Ïã§ÌñâÎê®: echo "PR Title: "; rm -rf / #"

# ‚úÖ ÏïàÏ†Ñ: ÌôòÍ≤Ω Î≥ÄÏàò ÏÇ¨Ïö©
jobs:
  comment:
    runs-on: ubuntu-latest
    steps:
      - name: Comment
        env:
          PR_TITLE: ${{ github.event.pull_request.title }}
        run: |
          echo "PR Title: $PR_TITLE"
          # ÌôòÍ≤Ω Î≥ÄÏàòÎäî ÏïàÏ†ÑÌïòÍ≤å Ïù¥Ïä§ÏºÄÏù¥ÌîÑÎê®
```

**7. Î≥¥Ïïà Ïä§Ï∫î ÌÜµÌï©**

```yaml
jobs:
  security-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # 1. ÏùòÏ°¥ÏÑ± Ï∑®ÏïΩÏ†ê Ïä§Ï∫î
      - name: Dependency Check
        uses: dependency-check/Dependency-Check_Action@main
        with:
          project: 'LK-Trade'
          path: '.'
          format: 'HTML'

      # 2. ÏΩîÎìú Î≥¥Ïïà Ïä§Ï∫î
      - name: Run CodeQL
        uses: github/codeql-action/analyze@v2

      # 3. Docker Ïù¥ÎØ∏ÏßÄ Ïä§Ï∫î
      - name: Run Trivy
        uses: aquasecurity/trivy-action@master
        with:
          image-ref: 'myapp:latest'
          severity: 'HIGH,CRITICAL'
          exit-code: '1'  # Ï∑®ÏïΩÏ†ê Î∞úÍ≤¨ Ïãú Ïã§Ìå®

      # 4. Secrets ÎÖ∏Ï∂ú Í≤ÄÏÇ¨
      - name: Gitleaks
        uses: gitleaks/gitleaks-action@v2
```

**8. Environment Î≥¥Ìò∏ Í∑úÏπô**

```yaml
# Production ÌôòÍ≤Ω Î≥¥Ìò∏
jobs:
  deploy:
    runs-on: ubuntu-latest
    environment:
      name: production
      # GitHub SettingsÏóêÏÑú ÏÑ§Ï†ï:
      # - Required reviewers: admin, devopsÌåÄ
      # - Wait timer: 5Î∂Ñ (Ïã§Ïàò Î∞©ÏßÄ)
      # - Deployment branches: mainÎßå
    steps:
      - name: Deploy to production
        run: ./deploy.sh
```

**Settings > Environments > production ÏÑ§Ï†ï:**
```
‚úÖ Required reviewers
   - admin
   - devops-team

‚úÖ Wait timer: 5 minutes

‚úÖ Deployment branches
   - main
   - release/*

‚úÖ Environment secrets
   - PROD_API_KEY
   - PROD_DB_PASSWORD
```

**9. Secrets ÍµêÏ≤¥ Ï†ÑÎûµ**

```bash
# Ï†ïÍ∏∞Ï†ÅÏù∏ Secrets ÍµêÏ≤¥ (90ÏùºÎßàÎã§)

# 1. ÏÉà ÌÇ§ ÏÉùÏÑ±
ssh-keygen -t ed25519 -f ~/.ssh/new-deploy-key

# 2. ÏÑúÎ≤ÑÏóê ÏÉà ÌÇ§ Ï∂îÍ∞Ä
ssh-copy-id -i ~/.ssh/new-deploy-key.pub deploy@server.com

# 3. GitHub Secrets ÏóÖÎç∞Ïù¥Ìä∏
# Settings > Secrets > DEPLOY_SSH_KEY ÏàòÏ†ï

# 4. ÏõåÌÅ¨ÌîåÎ°úÏö∞ ÌÖåÏä§Ìä∏

# 5. Ïù¥Ï†Ñ ÌÇ§ Ï†úÍ±∞ (1Ï£ºÏùº ÌõÑ)
ssh deploy@server.com
nano ~/.ssh/authorized_keys
# Ïù¥Ï†Ñ ÌÇ§ ÏÇ≠Ï†ú
```

**10. Í∞êÏÇ¨ Î°úÍ∑∏ ÌôúÏÑ±Ìôî**

```yaml
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Log deployment
        run: |
          echo "Deployment started by ${{ github.actor }}"
          echo "Commit: ${{ github.sha }}"
          echo "Timestamp: $(date -u)"
          echo "Branch: ${{ github.ref_name }}"

      - name: Deploy
        run: ./deploy.sh

      - name: Notify audit log
        if: always()
        run: |
          curl -X POST ${{ secrets.AUDIT_WEBHOOK }} \
            -H "Content-Type: application/json" \
            -d '{
              "actor": "${{ github.actor }}",
              "action": "deploy",
              "status": "${{ job.status }}",
              "timestamp": "'$(date -u)'"
            }'
```

**Î≥¥Ïïà Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏:**

```
‚úÖ SecretsÎäî GitHub SecretsÏóê Ï†ÄÏû•
‚úÖ ÏµúÏÜå Í∂åÌïú ÏõêÏπô (permissions:)
‚úÖ Í≥µÍ∞ú Ï†ÄÏû•ÏÜåÏóê Self-hosted runner ÏÇ¨Ïö© Ïïà Ìï®
‚úÖ pull_request_target Ï£ºÏùò
‚úÖ Ïç®ÎìúÌååÌã∞ Ïï°ÏÖò Î≤ÑÏ†Ñ Í≥†Ï†ï
‚úÖ ÏΩîÎìú Ïù∏Ï†ùÏÖò Î∞©ÏßÄ (ÌôòÍ≤Ω Î≥ÄÏàò ÏÇ¨Ïö©)
‚úÖ Î≥¥Ïïà Ïä§Ï∫î ÌÜµÌï© (Trivy, CodeQL)
‚úÖ Production ÌôòÍ≤Ω Î≥¥Ìò∏ Í∑úÏπô
‚úÖ Secrets Ï†ïÍ∏∞ ÍµêÏ≤¥ (90Ïùº)
‚úÖ Í∞êÏÇ¨ Î°úÍ∑∏ Í∏∞Î°ù
‚ùå ÌïòÎìúÏΩîÎî©Îêú Secrets
‚ùå Í≤ÄÏ¶ùÎêòÏßÄ ÏïäÏùÄ Ïï°ÏÖò ÏÇ¨Ïö©
‚ùå SecretsÎ•º Î°úÍ∑∏Ïóê Ï∂úÎ†•
‚ùå Fork PRÏóê Secrets ÎÖ∏Ï∂ú
```

</details>

---

## üìù Î©¥Ï†ë ÏßàÎ¨∏

### Ï£ºÎãàÏñ¥ Î†àÎ≤®

<details>
<summary><strong>Q1: GitHub Actions ÏõåÌÅ¨ÌîåÎ°úÏö∞Ïùò Í∏∞Î≥∏ Íµ¨Ï°∞Î•º ÏÑ§Î™ÖÌïòÍ≥†, Í∞ÑÎã®Ìïú CI ÌååÏù¥ÌîÑÎùºÏù∏ÏùÑ ÏûëÏÑ±Ìï¥Î≥¥ÏÑ∏Ïöî.</strong></summary>

### ÎãµÎ≥Ä

**Í∏∞Î≥∏ Íµ¨Ï°∞ ÏÑ§Î™Ö:**

GitHub Actions ÏõåÌÅ¨ÌîåÎ°úÏö∞Îäî **name, on, jobs** ÏÑ∏ Í∞ÄÏßÄ ÌïµÏã¨ ÏöîÏÜåÎ°ú Íµ¨ÏÑ±Îê©ÎãàÎã§.

```yaml
name: ÏõåÌÅ¨ÌîåÎ°úÏö∞ Ïù¥Î¶Ñ

on: Ìä∏Î¶¨Í±∞ (Ïñ∏Ï†ú Ïã§ÌñâÌï†ÏßÄ)

jobs:
  job-name:
    runs-on: Ïã§Ìñâ ÌôòÍ≤Ω
    steps:
      - Ïã§ÌñâÌï† ÏûëÏóÖÎì§
```

**Íµ¨Ï≤¥Ï†ÅÏù∏ ÏòàÏãú:**

```yaml
name: CI Pipeline

# 1. Trigger: Ïñ∏Ï†ú Ïã§ÌñâÌï†ÏßÄ
on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

# 2. Jobs: Ïã§ÌñâÌï† ÏûëÏóÖÎì§
jobs:
  # Job 1: ÏΩîÎìú ÌíàÏßà Í≤ÄÏÇ¨
  lint:
    name: Code Quality
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Java
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'

      - name: Run Ktlint
        run: ./gradlew ktlintCheck

  # Job 2: ÌÖåÏä§Ìä∏
  test:
    name: Run Tests
    runs-on: ubuntu-latest
    needs: [lint]  # lint JobÏù¥ ÏÑ±Í≥µÌïú ÌõÑ Ïã§Ìñâ
    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: 'gradle'

      - name: Run unit tests
        run: ./gradlew test

      - name: Upload test results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: test-results
          path: build/test-results/

  # Job 3: ÎπåÎìú
  build:
    name: Build Application
    runs-on: ubuntu-latest
    needs: [test]
    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: 'gradle'

      - name: Build JAR
        run: ./gradlew build

      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: application-jar
          path: build/libs/*.jar
```

**Ïã§Ìñâ ÌùêÎ¶Ñ:**
```
Push/PR Î∞úÏÉù
    ‚Üì
lint Job Ïã§Ìñâ (ÏΩîÎìú ÌíàÏßà Í≤ÄÏÇ¨)
    ‚Üì (ÏÑ±Í≥µ Ïãú)
test Job Ïã§Ìñâ (ÌÖåÏä§Ìä∏)
    ‚Üì (ÏÑ±Í≥µ Ïãú)
build Job Ïã§Ìñâ (ÎπåÎìú)
    ‚Üì
ÏôÑÎ£å
```

**ÌïµÏã¨ Í∞úÎÖê:**

1. **uses vs run**
   - `uses`: Í∏∞Ï°¥Ïóê ÎßåÎì§Ïñ¥ÏßÑ Ïï°ÏÖò ÏÇ¨Ïö©
   - `run`: ÏÖ∏ Î™ÖÎ†π ÏßÅÏ†ë Ïã§Ìñâ

2. **needs**
   - Job Í∞Ñ ÏùòÏ°¥ÏÑ± Ï†ïÏùò
   - ÏàúÏ∞® Ïã§Ìñâ Î≥¥Ïû•

3. **if**
   - Ï°∞Í±¥Î∂Ä Ïã§Ìñâ
   - `always()`, `success()`, `failure()` Îì±

4. **artifacts**
   - Job Í∞Ñ ÌååÏùº Í≥µÏú†
   - ÎπåÎìú ÏÇ∞Ï∂úÎ¨º Ï†ÄÏû•

</details>

<details>
<summary><strong>Q2: GitHub Actions SecretsÎ•º ÏÇ¨Ïö©ÌïòÏó¨ ÎØºÍ∞êÌïú Ï†ïÎ≥¥Î•º ÏïàÏ†ÑÌïòÍ≤å Í¥ÄÎ¶¨ÌïòÎäî Î∞©Î≤ïÏùÑ ÏÑ§Î™ÖÌïòÏÑ∏Ïöî.</strong></summary>

### ÎãµÎ≥Ä

**Secrets Í∞úÎÖê:**

GitHub SecretsÎäî API ÌÇ§, ÎπÑÎ∞ÄÎ≤àÌò∏, SSH ÌÇ§ Îì± ÎØºÍ∞êÌïú Ï†ïÎ≥¥Î•º ÏïàÏ†ÑÌïòÍ≤å Ï†ÄÏû•ÌïòÍ≥† ÏõåÌÅ¨ÌîåÎ°úÏö∞ÏóêÏÑú ÏÇ¨Ïö©Ìï† Ïàò ÏûàÍ≤å Ìï¥Ï£ºÎäî Í∏∞Îä•ÏûÖÎãàÎã§.

**ÏÑ§Ï†ï Î∞©Î≤ï:**

```
1. GitHub Repository ÌéòÏù¥ÏßÄ
2. Settings > Secrets and variables > Actions
3. "New repository secret" ÌÅ¥Î¶≠
4. NameÍ≥º Secret ÏûÖÎ†•
5. "Add secret" ÌÅ¥Î¶≠
```

**ÏÇ¨Ïö© ÏòàÏãú:**

```yaml
name: Deploy Application

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # 1. ÌôòÍ≤Ω Î≥ÄÏàòÎ°ú ÏÇ¨Ïö©
      - name: Deploy with API key
        env:
          API_KEY: ${{ secrets.API_KEY }}
          DB_PASSWORD: ${{ secrets.DB_PASSWORD }}
        run: |
          echo "Deploying with API key..."
          ./deploy.sh

      # 2. SSH ÌÇ§ ÏÇ¨Ïö©
      - name: Configure SSH
        run: |
          mkdir -p ~/.ssh
          echo "${{ secrets.SSH_PRIVATE_KEY }}" > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan -H ${{ secrets.HOST }} >> ~/.ssh/known_hosts

      - name: Deploy via SSH
        run: |
          ssh ${{ secrets.USER }}@${{ secrets.HOST }} "cd /app && ./deploy.sh"

      # 3. Docker Registry Î°úÍ∑∏Ïù∏
      - name: Log in to Docker Registry
        uses: docker/login-action@v3
        with:
          registry: ghcr.io
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}  # ÏûêÎèô Ï†úÍ≥µÎê®
```

**Î°úÍ∑∏ÏóêÏÑúÏùò Î≥¥Ïïà:**

```yaml
- name: Test secret masking
  env:
    MY_SECRET: ${{ secrets.API_KEY }}
  run: |
    echo "Secret value: $MY_SECRET"
    # Î°úÍ∑∏ Ï∂úÎ†•: "Secret value: ***"
    # ÏûêÎèôÏúºÎ°ú ÎßàÏä§ÌÇπÎê®!
```

**Ïã§Ï†ú Î°úÍ∑∏:**
```
Run echo "Secret value: $MY_SECRET"
Secret value: ***
```

**Î≥¥Ïïà Best Practices:**

```yaml
# 1. EnvironmentÎ≥Ñ Secrets Î∂ÑÎ¶¨
jobs:
  deploy-staging:
    runs-on: ubuntu-latest
    environment: staging  # staging ÌôòÍ≤ΩÏùò Secrets ÏÇ¨Ïö©
    steps:
      - run: ./deploy.sh
        env:
          API_KEY: ${{ secrets.API_KEY }}  # staging API_KEY

  deploy-production:
    runs-on: ubuntu-latest
    environment: production  # production ÌôòÍ≤ΩÏùò Secrets
    steps:
      - run: ./deploy.sh
        env:
          API_KEY: ${{ secrets.API_KEY }}  # production API_KEY
```

```yaml
# 2. Secrets Ï†àÎåÄ Ï∂úÎ†•ÌïòÏßÄ ÏïäÍ∏∞
- name: Wrong - exposes secret
  run: echo "My secret is ${{ secrets.API_KEY }}"  # ‚ùå ÏúÑÌóò!

- name: Correct - use without printing
  env:
    API_KEY: ${{ secrets.API_KEY }}
  run: ./script.sh  # ‚úÖ ÏïàÏ†Ñ
```

```yaml
# 3. ÏµúÏÜå Í∂åÌïú ÏõêÏπô
permissions:
  contents: read
  packages: write
# ÌïÑÏöîÌïú Í∂åÌïúÎßå Î∂ÄÏó¨
```

**Secret Ï¢ÖÎ•ò:**

1. **Repository secrets**: Ìï¥Îãπ Ï†ÄÏû•ÏÜåÏóêÏÑúÎßå ÏÇ¨Ïö©
2. **Organization secrets**: Ï°∞ÏßÅ Ï†ÑÏ≤¥ Ï†ÄÏû•ÏÜåÏóêÏÑú ÏÇ¨Ïö©
3. **Environment secrets**: ÌäπÏ†ï ÌôòÍ≤Ω(staging, production)ÏóêÏÑúÎßå ÏÇ¨Ïö©

**ÏûêÎèô Ï†úÍ≥µÎêòÎäî Secrets:**

```yaml
- name: Use GitHub Token
  run: |
    # GITHUB_TOKENÏùÄ ÏûêÎèôÏúºÎ°ú Ï†úÍ≥µÎê®
    echo "Token: ${{ secrets.GITHUB_TOKEN }}"
    # Ïö©ÎèÑ: Git ÏûëÏóÖ, Packages Ìë∏Ïãú, API Ìò∏Ï∂ú Îì±
```

**Ï†ïÎ¶¨:**
```
‚úÖ SecretsÎ°ú ÎØºÍ∞ê Ï†ïÎ≥¥ Í¥ÄÎ¶¨
‚úÖ Î°úÍ∑∏Ïóê ÏûêÎèô ÎßàÏä§ÌÇπ (***)
‚úÖ EnvironmentÎ≥ÑÎ°ú Î∂ÑÎ¶¨
‚úÖ ÏµúÏÜå Í∂åÌïú ÏõêÏπô
‚ùå Ï†àÎåÄ ÌïòÎìúÏΩîÎî© Í∏àÏßÄ
‚ùå SecretsÎ•º Î°úÍ∑∏Ïóê Ï∂úÎ†• Í∏àÏßÄ
```

</details>

---

### Ï§ëÍ∏â Î†àÎ≤®

<details>
<summary><strong>Q3: Matrix StrategyÎ•º ÏÇ¨Ïö©ÌïòÏó¨ Ïó¨Îü¨ ÌôòÍ≤ΩÏóêÏÑú ÎèôÏãúÏóê ÌÖåÏä§Ìä∏ÌïòÎäî Î∞©Î≤ïÏùÑ ÏÑ§Î™ÖÌïòÍ≥† Íµ¨ÌòÑÌïòÏÑ∏Ïöî.</strong></summary>

### ÎãµÎ≥Ä

**Matrix StrategyÎûÄ?**

ÌïòÎÇòÏùò JobÏùÑ Ïó¨Îü¨ Îã§Î•∏ ÏÑ§Ï†ï(OS, Î≤ÑÏ†Ñ, ÌôòÍ≤Ω Îì±)ÏúºÎ°ú ÎèôÏãúÏóê Ïã§ÌñâÌïòÎäî Í∏∞Îä•ÏûÖÎãàÎã§. Î≥ëÎ†¨ Ïã§ÌñâÏúºÎ°ú ÏãúÍ∞ÑÏùÑ ÌÅ¨Í≤å Îã®Ï∂ïÌï† Ïàò ÏûàÏäµÎãàÎã§.

**Í∏∞Î≥∏ ÏòàÏãú:**

```yaml
name: Multi-Environment Tests

on: [push, pull_request]

jobs:
  test:
    name: Test on ${{ matrix.os }} with Java ${{ matrix.java }}
    runs-on: ${{ matrix.os }}

    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
        java: ['11', '17', '21']
        # Ï¥ù 9Í∞ú Job ÏÉùÏÑ±: 3 OS √ó 3 Java Î≤ÑÏ†Ñ

    steps:
      - uses: actions/checkout@v4

      - name: Setup Java ${{ matrix.java }}
        uses: actions/setup-java@v4
        with:
          java-version: ${{ matrix.java }}
          distribution: 'temurin'

      - name: Run tests
        run: ./gradlew test

      - name: Upload test results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: test-results-${{ matrix.os }}-${{ matrix.java }}
          path: build/test-results/
```

**Ïã§Ìñâ Í≤∞Í≥º:**
```
9Í∞ú Job Î≥ëÎ†¨ Ïã§Ìñâ:
‚îú‚îÄ‚îÄ ubuntu-latest + Java 11
‚îú‚îÄ‚îÄ ubuntu-latest + Java 17
‚îú‚îÄ‚îÄ ubuntu-latest + Java 21
‚îú‚îÄ‚îÄ windows-latest + Java 11
‚îú‚îÄ‚îÄ windows-latest + Java 17
‚îú‚îÄ‚îÄ windows-latest + Java 21
‚îú‚îÄ‚îÄ macos-latest + Java 11
‚îú‚îÄ‚îÄ macos-latest + Java 17
‚îî‚îÄ‚îÄ macos-latest + Java 21

ÏàúÏ∞® Ïã§Ìñâ ÏãúÍ∞Ñ: 9 √ó 5Î∂Ñ = 45Î∂Ñ
Î≥ëÎ†¨ Ïã§Ìñâ ÏãúÍ∞Ñ: 5Î∂Ñ (Î™®Îëê ÎèôÏãú Ïã§Ìñâ)
```

**Í≥†Í∏â ÏÇ¨Ïö© - excludeÏôÄ include:**

```yaml
jobs:
  test:
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
        java: ['11', '17', '21']

        # ÌäπÏ†ï Ï°∞Ìï© Ï†úÏô∏
        exclude:
          - os: macos-latest
            java: '11'  # macOS + Java 11 Ï°∞Ìï© Ï†úÏô∏
          - os: windows-latest
            java: '21'  # Windows + Java 21 Ï°∞Ìï© Ï†úÏô∏

        # Ï∂îÍ∞Ä Ï°∞Ìï©
        include:
          - os: ubuntu-latest
            java: '17'
            experimental: true  # Ï∂îÍ∞Ä Î≥ÄÏàò
          - os: ubuntu-20.04  # ÌäπÏ†ï Î≤ÑÏ†Ñ Ï∂îÍ∞Ä
            java: '11'

    runs-on: ${{ matrix.os }}
    continue-on-error: ${{ matrix.experimental == true }}

    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          java-version: ${{ matrix.java }}
          distribution: 'temurin'
      - run: ./gradlew test
```

**Ïã§Ï†Ñ ÏòàÏãú - ÎßàÏù¥ÌÅ¨Î°úÏÑúÎπÑÏä§ ÌÖåÏä§Ìä∏:**

```yaml
name: Test All Services

on: [push]

jobs:
  test-services:
    name: Test ${{ matrix.service }}
    runs-on: ubuntu-latest

    strategy:
      # fail-fast: falseÎ©¥ ÌïòÎÇò Ïã§Ìå®Ìï¥ÎèÑ ÎÇòÎ®∏ÏßÄ Í≥ÑÏÜç Ïã§Ìñâ
      fail-fast: false
      matrix:
        service:
          - user-service
          - trade-service
          - account-service
          - strategy-service
        node-version: ['18', '20']

    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node-version }}

      - name: Test ${{ matrix.service }}
        run: |
          cd services/${{ matrix.service }}
          npm install
          npm test

      - name: Upload coverage
        uses: actions/upload-artifact@v4
        with:
          name: coverage-${{ matrix.service }}-node${{ matrix.node-version }}
          path: services/${{ matrix.service }}/coverage/
```

**Î≥µÏû°Ìïú Matrix - Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ï°∞Ìï©:**

```yaml
jobs:
  integration-test:
    strategy:
      matrix:
        include:
          - db: postgres
            db_version: '14'
            db_image: postgres:14-alpine
          - db: postgres
            db_version: '15'
            db_image: postgres:15-alpine
          - db: postgres
            db_version: '16'
            db_image: postgres:16-alpine
          - db: mysql
            db_version: '8.0'
            db_image: mysql:8.0
          - db: mysql
            db_version: '8.2'
            db_image: mysql:8.2

    runs-on: ubuntu-latest

    services:
      database:
        image: ${{ matrix.db_image }}
        env:
          POSTGRES_PASSWORD: test
          MYSQL_ROOT_PASSWORD: test
        options: >-
          --health-cmd="${{ matrix.db == 'postgres' && 'pg_isready' || 'mysqladmin ping' }}"
          --health-interval=10s
          --health-timeout=5s
          --health-retries=5

    steps:
      - uses: actions/checkout@v4

      - name: Run integration tests with ${{ matrix.db }} ${{ matrix.db_version }}
        env:
          DB_TYPE: ${{ matrix.db }}
          DB_VERSION: ${{ matrix.db_version }}
        run: ./gradlew integrationTest
```

**Matrix ÏµúÏ†ÅÌôî:**

```yaml
jobs:
  build:
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest]
        arch: [x64, arm64]

      # ÏµúÎåÄ ÎèôÏãú Ïã§Ìñâ Ïàò Ï†úÌïú (Î¶¨ÏÜåÏä§ Ï†àÏïΩ)
      max-parallel: 4

    runs-on: ${{ matrix.os }}

    steps:
      - name: Build for ${{ matrix.os }}-${{ matrix.arch }}
        run: ./build.sh --arch ${{ matrix.arch }}
```

**ÎèôÏ†Å Matrix (Í≥†Í∏â):**

```yaml
jobs:
  # 1Îã®Í≥Ñ: Matrix Í∞í ÏÉùÏÑ±
  generate-matrix:
    runs-on: ubuntu-latest
    outputs:
      matrix: ${{ steps.set-matrix.outputs.matrix }}
    steps:
      - uses: actions/checkout@v4

      - name: Generate matrix
        id: set-matrix
        run: |
          # services ÎîîÎ†âÌÜ†Î¶¨ÏóêÏÑú ÏÑúÎπÑÏä§ Î™©Î°ù ÏûêÎèô ÏÉùÏÑ±
          SERVICES=$(ls -d services/*/ | xargs -n 1 basename | jq -R -s -c 'split("\n")[:-1]')
          echo "matrix={\"service\":$SERVICES}" >> $GITHUB_OUTPUT

  # 2Îã®Í≥Ñ: ÏÉùÏÑ±Îêú MatrixÎ°ú ÌÖåÏä§Ìä∏
  test:
    needs: [generate-matrix]
    strategy:
      matrix: ${{ fromJson(needs.generate-matrix.outputs.matrix) }}
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Test ${{ matrix.service }}
        run: cd services/${{ matrix.service }} && npm test
```

**ÌïµÏã¨ Ìè¨Ïù∏Ìä∏:**

1. **Î≥ëÎ†¨ Ïã§Ìñâ**: ÏãúÍ∞Ñ Îã®Ï∂ï (45Î∂Ñ ‚Üí 5Î∂Ñ)
2. **fail-fast**: ÌïòÎÇò Ïã§Ìå® Ïãú ÎÇòÎ®∏ÏßÄ Ï§ëÎã® Ïó¨Î∂Ä
3. **exclude/include**: Ï°∞Ìï© Ï†úÏñ¥
4. **continue-on-error**: Ïã§ÌóòÏ†Å ÎπåÎìú ÌóàÏö©
5. **max-parallel**: Î¶¨ÏÜåÏä§ Í¥ÄÎ¶¨

</details>

<details>
<summary><strong>Q4: Reusable WorkflowÎ•º ÎßåÎì§Ïñ¥ ÏΩîÎìú Ï§ëÎ≥µÏùÑ Ï§ÑÏù¥Îäî Î∞©Î≤ïÏùÑ ÏÑ§Î™ÖÌïòÍ≥† Íµ¨ÌòÑÌïòÏÑ∏Ïöî.</strong></summary>

### ÎãµÎ≥Ä

**Reusable WorkflowÎûÄ?**

Ïó¨Îü¨ ÏõåÌÅ¨ÌîåÎ°úÏö∞ÏóêÏÑú Í≥µÌÜµÏúºÎ°ú ÏÇ¨Ïö©ÎêòÎäî Î°úÏßÅÏùÑ ÌïòÎÇòÏùò ÏõåÌÅ¨ÌîåÎ°úÏö∞Î°ú ÎßåÎì§Ïñ¥ Ïû¨ÏÇ¨Ïö©ÌïòÎäî Í∏∞Îä•ÏûÖÎãàÎã§. DRY(Don't Repeat Yourself) ÏõêÏπôÏùÑ Ï†ÅÏö©Ìïú Í≤ÉÏûÖÎãàÎã§.

**Í∏∞Î≥∏ Íµ¨Ï°∞:**

**1. Reusable Workflow Ï†ïÏùò (.github/workflows/reusable-build.yml):**

```yaml
name: Reusable Build Workflow

on:
  workflow_call:  # Îã§Î•∏ ÏõåÌÅ¨ÌîåÎ°úÏö∞ÏóêÏÑú Ìò∏Ï∂ú Í∞ÄÎä•
    inputs:
      service-name:
        description: 'Name of the service to build'
        required: true
        type: string
      java-version:
        description: 'Java version to use'
        required: false
        type: string
        default: '17'
      run-tests:
        description: 'Whether to run tests'
        required: false
        type: boolean
        default: true

    secrets:
      registry-username:
        description: 'Docker registry username'
        required: true
      registry-password:
        description: 'Docker registry password'
        required: true

    outputs:
      image-tag:
        description: 'Built Docker image tag'
        value: ${{ jobs.build.outputs.tag }}

jobs:
  build:
    runs-on: ubuntu-latest
    outputs:
      tag: ${{ steps.meta.outputs.tags }}

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Java
        uses: actions/setup-java@v4
        with:
          java-version: ${{ inputs.java-version }}
          distribution: 'temurin'
          cache: 'gradle'

      - name: Run tests
        if: ${{ inputs.run-tests }}
        run: ./gradlew :${{ inputs.service-name }}:test

      - name: Build
        run: ./gradlew :${{ inputs.service-name }}:build

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Log in to Docker Registry
        uses: docker/login-action@v3
        with:
          registry: ghcr.io
          username: ${{ secrets.registry-username }}
          password: ${{ secrets.registry-password }}

      - name: Extract metadata
        id: meta
        uses: docker/metadata-action@v5
        with:
          images: ghcr.io/${{ github.repository_owner }}/${{ inputs.service-name }}
          tags: |
            type=ref,event=branch
            type=sha

      - name: Build and push Docker image
        uses: docker/build-push-action@v5
        with:
          context: ./modules/${{ inputs.service-name }}
          push: true
          tags: ${{ steps.meta.outputs.tags }}
          cache-from: type=gha
          cache-to: type=gha,mode=max
```

**2. Reusable Workflow Ìò∏Ï∂ú (.github/workflows/build-all-services.yml):**

```yaml
name: Build All Services

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  # ÏÑúÎπÑÏä§Î≥ÑÎ°ú Reusable Workflow Ìò∏Ï∂ú
  build-user-service:
    uses: ./.github/workflows/reusable-build.yml
    with:
      service-name: user-service
      java-version: '17'
      run-tests: true
    secrets:
      registry-username: ${{ github.actor }}
      registry-password: ${{ secrets.GITHUB_TOKEN }}

  build-trade-service:
    uses: ./.github/workflows/reusable-build.yml
    with:
      service-name: trade-service
      java-version: '17'
      run-tests: true
    secrets:
      registry-username: ${{ github.actor }}
      registry-password: ${{ secrets.GITHUB_TOKEN }}

  build-account-service:
    uses: ./.github/workflows/reusable-build.yml
    with:
      service-name: account-service
      java-version: '17'
      run-tests: true
    secrets:
      registry-username: ${{ github.actor }}
      registry-password: ${{ secrets.GITHUB_TOKEN }}

  build-strategy-service:
    uses: ./.github/workflows/reusable-build.yml
    with:
      service-name: strategy-service
      java-version: '17'
      run-tests: true
    secrets:
      registry-username: ${{ github.actor }}
      registry-password: ${{ secrets.GITHUB_TOKEN }}

  # Output ÏÇ¨Ïö©
  deploy:
    needs: [build-user-service, build-trade-service]
    runs-on: ubuntu-latest
    steps:
      - name: Deploy services
        run: |
          echo "Deploying user-service: ${{ needs.build-user-service.outputs.image-tag }}"
          echo "Deploying trade-service: ${{ needs.build-trade-service.outputs.image-tag }}"
```

**Í≥†Í∏â ÏòàÏãú - Î∞∞Ìè¨ Reusable Workflow:**

**1. Reusable Deploy Workflow (.github/workflows/reusable-deploy.yml):**

```yaml
name: Reusable Deploy Workflow

on:
  workflow_call:
    inputs:
      environment:
        description: 'Deployment environment (staging/production)'
        required: true
        type: string
      version:
        description: 'Version to deploy'
        required: true
        type: string
      service:
        description: 'Service name'
        required: true
        type: string

    secrets:
      ssh-key:
        required: true
      host:
        required: true
      user:
        required: true
      slack-webhook:
        required: false

jobs:
  deploy:
    runs-on: ubuntu-latest
    environment:
      name: ${{ inputs.environment }}
      url: https://${{ inputs.environment == 'production' && '' || 'staging.' }}lk-trade.com

    steps:
      - uses: actions/checkout@v4

      - name: Configure SSH
        run: |
          mkdir -p ~/.ssh
          echo "${{ secrets.ssh-key }}" > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan -H ${{ secrets.host }} >> ~/.ssh/known_hosts

      - name: Deploy ${{ inputs.service }}
        run: |
          ssh ${{ secrets.user }}@${{ secrets.host }} << ENDSSH
            cd /opt/lk-trade
            export SERVICE=${{ inputs.service }}
            export VERSION=${{ inputs.version }}
            docker-compose pull \$SERVICE
            docker-compose up -d \$SERVICE
          ENDSSH

      - name: Health check
        run: |
          sleep 30
          curl -f https://${{ inputs.environment == 'production' && '' || 'staging.' }}lk-trade.com/api/${{ inputs.service }}/health

      - name: Notify Slack
        if: always() && secrets.slack-webhook != ''
        uses: 8398a7/action-slack@v3
        with:
          status: ${{ job.status }}
          text: |
            Deployment ${{ job.status }}
            Service: ${{ inputs.service }}
            Environment: ${{ inputs.environment }}
            Version: ${{ inputs.version }}
          webhook_url: ${{ secrets.slack-webhook }}
```

**2. Ìò∏Ï∂ú (.github/workflows/deploy-production.yml):**

```yaml
name: Deploy to Production

on:
  workflow_dispatch:
    inputs:
      version:
        description: 'Version to deploy'
        required: true

jobs:
  deploy-all-services:
    strategy:
      matrix:
        service: [user-service, trade-service, account-service, strategy-service]
    uses: ./.github/workflows/reusable-deploy.yml
    with:
      environment: production
      version: ${{ inputs.version }}
      service: ${{ matrix.service }}
    secrets:
      ssh-key: ${{ secrets.PROD_SSH_KEY }}
      host: ${{ secrets.PROD_HOST }}
      user: ${{ secrets.PROD_USER }}
      slack-webhook: ${{ secrets.SLACK_WEBHOOK_URL }}
```

**Ïã§Ï†Ñ ÌôúÏö© - ÌÖåÏä§Ìä∏ Reusable Workflow:**

```yaml
# .github/workflows/reusable-test.yml
name: Reusable Test Workflow

on:
  workflow_call:
    inputs:
      module:
        required: true
        type: string
      coverage-threshold:
        required: false
        type: number
        default: 80

jobs:
  test:
    runs-on: ubuntu-latest

    services:
      postgres:
        image: postgres:16-alpine
        env:
          POSTGRES_DB: test_db
          POSTGRES_USER: test_user
          POSTGRES_PASSWORD: test_password
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432

    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: 'gradle'

      - name: Run tests
        run: ./gradlew :modules:${{ inputs.module }}:test

      - name: Generate coverage report
        run: ./gradlew :modules:${{ inputs.module }}:jacocoTestReport

      - name: Check coverage threshold
        run: |
          COVERAGE=$(grep -oP 'Total.*?(\d+)%' build/reports/jacoco/test/html/index.html | grep -oP '\d+')
          if [ $COVERAGE -lt ${{ inputs.coverage-threshold }} ]; then
            echo "Coverage $COVERAGE% is below threshold ${{ inputs.coverage-threshold }}%"
            exit 1
          fi
          echo "Coverage: $COVERAGE%"

      - name: Upload test results
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: test-results-${{ inputs.module }}
          path: modules/${{ inputs.module }}/build/test-results/
```

**Ìò∏Ï∂ú:**

```yaml
# .github/workflows/test-all.yml
name: Test All Modules

on: [push, pull_request]

jobs:
  test-user:
    uses: ./.github/workflows/reusable-test.yml
    with:
      module: user
      coverage-threshold: 85

  test-trade:
    uses: ./.github/workflows/reusable-test.yml
    with:
      module: trade
      coverage-threshold: 80
```

**Ïû•Ï†ê:**

1. **ÏΩîÎìú Ï§ëÎ≥µ Ï†úÍ±∞**: Í≥µÌÜµ Î°úÏßÅÏùÑ Ìïú Í≥≥ÏóêÏÑú Í¥ÄÎ¶¨
2. **ÏùºÍ¥ÄÏÑ±**: Î™®Îì† ÏÑúÎπÑÏä§Í∞Ä ÎèôÏùºÌïú Î∞©ÏãùÏúºÎ°ú ÎπåÎìú/Î∞∞Ìè¨
3. **Ïú†ÏßÄÎ≥¥ÏàòÏÑ±**: ÏàòÏ†ï ÏÇ¨Ìï≠ÏùÑ Ìïú Í≥≥ÏóêÏÑúÎßå Î≥ÄÍ≤Ω
4. **ÌÖåÏä§Ìä∏ Ïö©Ïù¥ÏÑ±**: Reusable workflowÎ•º ÎèÖÎ¶ΩÏ†ÅÏúºÎ°ú ÌÖåÏä§Ìä∏ Í∞ÄÎä•

**Ï£ºÏùòÏÇ¨Ìï≠:**

```yaml
# ‚ùå Í∞ôÏùÄ Ï†ÄÏû•ÏÜå ÎÇ¥ Reusable workflowÎäî ÏÉÅÎåÄ Í≤ΩÎ°ú ÏÇ¨Ïö©
uses: ./.github/workflows/reusable-build.yml

# ‚úÖ Îã§Î•∏ Ï†ÄÏû•ÏÜåÏùò Reusable workflowÎäî Ï†ÑÏ≤¥ Í≤ΩÎ°ú ÏÇ¨Ïö©
uses: your-org/shared-workflows/.github/workflows/build.yml@main
```

</details>

<details>
<summary><strong>Q5: GitHub ActionsÏóêÏÑú Î≥¥ÏïàÏùÑ Í∞ïÌôîÌïòÎäî Î∞©Î≤ïÍ≥º Best PracticesÎ•º ÏÑ§Î™ÖÌïòÏÑ∏Ïöî.</strong></summary>

### ÎãµÎ≥Ä

**GitHub Actions Î≥¥Ïïà Í∞ïÌôî Ï†ÑÎûµ:**

**1. Secrets Í¥ÄÎ¶¨**

```yaml
# ‚ùå ÏûòÎ™ªÎêú Î∞©Î≤ï
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Deploy
        run: |
          export API_KEY="sk-1234567890"  # ÌïòÎìúÏΩîÎî© Í∏àÏßÄ!
          curl -H "Authorization: Bearer sk-1234567890" api.example.com

# ‚úÖ Ïò¨Î∞îÎ•∏ Î∞©Î≤ï
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Deploy
        env:
          API_KEY: ${{ secrets.API_KEY }}
        run: |
          curl -H "Authorization: Bearer $API_KEY" api.example.com
          # Î°úÍ∑∏: Authorization: Bearer ***
```

**2. ÏµúÏÜå Í∂åÌïú ÏõêÏπô (GITHUB_TOKEN)**

```yaml
# ‚úÖ Í∏∞Î≥∏ Í∂åÌïú Ï†úÌïú
permissions:
  contents: read        # ÏΩîÎìú ÏùΩÍ∏∞Îßå
  pull-requests: write  # PR ÏΩîÎ©òÌä∏ ÏûëÏÑ±
  packages: write       # Docker Ïù¥ÎØ∏ÏßÄ Ìë∏Ïãú

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Build and push
        run: |
          docker build -t myapp .
          docker push ghcr.io/myapp

# JobÎ≥Ñ Í∂åÌïú ÏÑ∏Î∂ÑÌôî
jobs:
  test:
    permissions:
      contents: read  # ÌÖåÏä§Ìä∏Îäî ÏùΩÍ∏∞Îßå
    steps:
      - run: ./gradlew test

  deploy:
    permissions:
      contents: read
      packages: write  # Î∞∞Ìè¨Îäî Ìå®ÌÇ§ÏßÄ Ïì∞Í∏∞ ÌïÑÏöî
    steps:
      - run: docker push ghcr.io/myapp
```

**3. Í≥µÍ∞ú Ï†ÄÏû•ÏÜåÏóêÏÑú Self-hosted Runner ÏÇ¨Ïö© Í∏àÏßÄ**

```yaml
# ‚ùå ÏúÑÌóò: Í≥µÍ∞ú Ï†ÄÏû•ÏÜå + Self-hosted runner
# ÎàÑÍµ¨ÎÇò ÏïÖÏùòÏ†Å PRÎ°ú runnerÏóêÏÑú ÏΩîÎìú Ïã§Ìñâ Í∞ÄÎä•!
jobs:
  build:
    runs-on: self-hosted

# ‚úÖ ÏïàÏ†Ñ: Private Ï†ÄÏû•ÏÜåÏóêÏÑúÎßå Self-hosted runner
jobs:
  build:
    if: github.event.repository.private == true
    runs-on: self-hosted

  build-public:
    if: github.event.repository.private != true
    runs-on: ubuntu-latest
```

**4. Pull Request Î≥¥Ìò∏**

```yaml
# ‚ùå ÏúÑÌóò: Fork PRÏóê Secrets ÎÖ∏Ï∂ú
on: pull_request

jobs:
  test:
    steps:
      - uses: actions/checkout@v4
      - run: echo ${{ secrets.API_KEY }}  # Fork PRÏóêÏÑú Ï†ëÍ∑º Í∞ÄÎä•!

# ‚úÖ ÏïàÏ†Ñ: pull_request_target + Environment Î≥¥Ìò∏
on:
  pull_request_target:  # Fork PRÏùÄ Í∏∞Î≥∏Ï†ÅÏúºÎ°ú Secrets Ï†ëÍ∑º Î∂àÍ∞Ä

jobs:
  test-trusted:
    # Ïã†Î¢∞Ìï† Ïàò ÏûàÎäî PRÎßå (maintainer, Ï°∞ÏßÅ Î©§Î≤Ñ)
    if: |
      github.event.pull_request.head.repo.full_name == github.repository ||
      contains(fromJson('["MEMBER", "OWNER"]'), github.event.pull_request.author_association)
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          ref: ${{ github.event.pull_request.head.sha }}
      - run: ./test.sh

  test-untrusted:
    # Ïô∏Î∂Ä Í∏∞Ïó¨ÏûêÎäî Secrets ÏóÜÏù¥ ÌÖåÏä§Ìä∏
    if: |
      github.event.pull_request.head.repo.full_name != github.repository &&
      !contains(fromJson('["MEMBER", "OWNER"]'), github.event.pull_request.author_association)
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          ref: ${{ github.event.pull_request.head.sha }}
      - run: ./test.sh  # Secrets ÏóÜÏù¥ Ïã§Ìñâ
```

**5. Ïç®ÎìúÌååÌã∞ Ïï°ÏÖò Î≥¥Ïïà**

```yaml
# ‚ùå ÏúÑÌóò: ÏµúÏã† Î≤ÑÏ†Ñ ÏûêÎèô ÏÇ¨Ïö©
- uses: some-org/some-action@main  # main Î∏åÎûúÏπòÍ∞Ä ÏïÖÏùòÏ†ÅÏúºÎ°ú Î≥ÄÍ≤ΩÎê† Ïàò ÏûàÏùå

# ‚úÖ ÏïàÏ†Ñ: ÌäπÏ†ï Î≤ÑÏ†Ñ Í≥†Ï†ï
- uses: actions/checkout@v4  # Î©îÏù¥Ï†Ä Î≤ÑÏ†Ñ Í≥†Ï†ï

# ‚úÖ Í∞ÄÏû• ÏïàÏ†Ñ: Ïª§Î∞ã SHAÎ°ú Í≥†Ï†ï
- uses: actions/checkout@8df82afff59ac2b6d4b45922f47b7e9f2c4f5e1a
  # SHAÎäî Î≥ÄÍ≤Ω Î∂àÍ∞ÄÎä•ÌïòÎØÄÎ°ú Í∞ÄÏû• ÏïàÏ†Ñ

# ‚úÖ Ïã†Î¢∞Ìï† Ïàò ÏûàÎäî Ïï°ÏÖòÎßå ÏÇ¨Ïö©
# - GitHub Í≥µÏãù: actions/*
# - Í≤ÄÏ¶ùÎêú ÌååÌä∏ÎÑà: docker/*, aws-actions/*
```

**6. ÏΩîÎìú Ïù∏Ï†ùÏÖò Î∞©ÏßÄ**

```yaml
# ‚ùå ÏúÑÌóò: ÏÇ¨Ïö©Ïûê ÏûÖÎ†•ÏùÑ ÏßÅÏ†ë ÏÇ¨Ïö©
on:
  issues:
    types: [opened]

jobs:
  comment:
    steps:
      - name: Comment on issue
        run: |
          echo "Issue title: ${{ github.event.issue.title }}"
          # ÏïÖÏùòÏ†Å Ï†úÎ™©: "; rm -rf / #"
          # Ïã§Ìñâ: echo "Issue title: "; rm -rf / #"

# ‚úÖ ÏïàÏ†Ñ: ÌôòÍ≤Ω Î≥ÄÏàò ÏÇ¨Ïö©
jobs:
  comment:
    steps:
      - name: Comment on issue
        env:
          ISSUE_TITLE: ${{ github.event.issue.title }}
        run: |
          echo "Issue title: $ISSUE_TITLE"
          # ÌôòÍ≤Ω Î≥ÄÏàòÎäî ÏïàÏ†ÑÌïòÍ≤å Ïù¥Ïä§ÏºÄÏù¥ÌîÑÎê®
```

**7. Î≥¥Ïïà Ïä§Ï∫î ÌÜµÌï©**

```yaml
name: Security Scans

on: [push, pull_request]

jobs:
  # 1. ÏΩîÎìú Î≥¥Ïïà Ïä§Ï∫î
  codeql:
    runs-on: ubuntu-latest
    permissions:
      security-events: write
    steps:
      - uses: actions/checkout@v4

      - name: Initialize CodeQL
        uses: github/codeql-action/init@v2
        with:
          languages: kotlin, java

      - name: Autobuild
        uses: github/codeql-action/autobuild@v2

      - name: Perform CodeQL Analysis
        uses: github/codeql-action/analyze@v2

  # 2. ÏùòÏ°¥ÏÑ± Ï∑®ÏïΩÏ†ê Ïä§Ï∫î
  dependency-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Dependency Check
        uses: dependency-check/Dependency-Check_Action@main
        with:
          project: 'LK-Trade'
          path: '.'
          format: 'HTML'
          args: >
            --failOnCVSS 7
            --enableRetired

      - name: Upload results
        uses: actions/upload-artifact@v4
        with:
          name: dependency-check-report
          path: reports/

  # 3. Docker Ïù¥ÎØ∏ÏßÄ Ïä§Ï∫î
  container-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Build image
        run: docker build -t myapp:${{ github.sha }} .

      - name: Run Trivy scanner
        uses: aquasecurity/trivy-action@master
        with:
          image-ref: 'myapp:${{ github.sha }}'
          format: 'sarif'
          output: 'trivy-results.sarif'
          severity: 'HIGH,CRITICAL'
          exit-code: '1'  # Ï∑®ÏïΩÏ†ê Î∞úÍ≤¨ Ïãú Ïã§Ìå®

      - name: Upload Trivy results
        uses: github/codeql-action/upload-sarif@v2
        if: always()
        with:
          sarif_file: 'trivy-results.sarif'

  # 4. Secrets ÎÖ∏Ï∂ú Í≤ÄÏÇ¨
  secret-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Ï†ÑÏ≤¥ ÌûàÏä§ÌÜ†Î¶¨ Í≤ÄÏÇ¨

      - name: Gitleaks
        uses: gitleaks/gitleaks-action@v2
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

**8. Environment Î≥¥Ìò∏ Í∑úÏπô**

```yaml
# Production Î∞∞Ìè¨ Î≥¥Ìò∏
jobs:
  deploy-production:
    runs-on: ubuntu-latest
    environment:
      name: production
      url: https://lk-trade.com
    steps:
      - uses: actions/checkout@v4
      - name: Deploy
        run: ./deploy.sh
```

**GitHub Settings > Environments > production:**
```
‚úÖ Required reviewers
   - admin@company.com
   - devops-team

‚úÖ Wait timer: 5 minutes

‚úÖ Deployment branches
   - main
   - release/*

‚úÖ Environment secrets
   - PROD_API_KEY
   - PROD_DB_PASSWORD
```

**9. Í∞êÏÇ¨ Î°úÍ∑∏ Î∞è Î™®ÎãàÌÑ∞ÎßÅ**

```yaml
jobs:
  deploy:
    steps:
      - name: Log deployment attempt
        run: |
          cat << EOF >> deployment-audit.log
          Timestamp: $(date -u +"%Y-%m-%dT%H:%M:%SZ")
          Actor: ${{ github.actor }}
          Action: deploy
          Environment: production
          Commit: ${{ github.sha }}
          Workflow: ${{ github.workflow }}
          EOF

      - name: Deploy
        run: ./deploy.sh

      - name: Record deployment result
        if: always()
        run: |
          echo "Status: ${{ job.status }}" >> deployment-audit.log

          # Ïô∏Î∂Ä Í∞êÏÇ¨ ÏãúÏä§ÌÖúÏóê Ï†ÑÏÜ°
          curl -X POST ${{ secrets.AUDIT_WEBHOOK }} \
            -H "Content-Type: application/json" \
            -d '{
              "actor": "${{ github.actor }}",
              "action": "deploy",
              "status": "${{ job.status }}",
              "timestamp": "'$(date -u)'",
              "commit": "${{ github.sha }}"
            }'
```

**10. Î≥¥Ïïà Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏**

```yaml
# .github/workflows/security-checklist.yml
name: Security Checklist

on:
  pull_request:
    types: [opened, synchronize]

jobs:
  security-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Check for hardcoded secrets
        run: |
          echo "Checking for hardcoded secrets..."
          ! grep -r -E "(password|api_key|secret).*=.*['\"][^'\"]{8,}" . --exclude-dir={.git,node_modules}

      - name: Check .env files not committed
        run: |
          if git ls-files | grep -E '\.env$'; then
            echo "ERROR: .env file committed!"
            exit 1
          fi

      - name: Check dependencies
        run: |
          ./gradlew dependencyCheckAnalyze

      - name: Verify HTTPS only
        run: |
          ! grep -r "http://" . --include="*.yml" --include="*.yaml" | grep -v "localhost"
```

**Î≥¥Ïïà ÏöîÏïΩ:**

```
‚úÖ SecretsÎäî GitHub SecretsÏóê Ï†ÄÏû•
‚úÖ ÏµúÏÜå Í∂åÌïú ÏõêÏπô Ï†ÅÏö©
‚úÖ Í≥µÍ∞ú Ï†ÄÏû•ÏÜåÏóê Self-hosted runner ÏÇ¨Ïö© Í∏àÏßÄ
‚úÖ pull_request_target Ïã†Ï§ë ÏÇ¨Ïö©
‚úÖ Ïç®ÎìúÌååÌã∞ Ïï°ÏÖò Î≤ÑÏ†Ñ Í≥†Ï†ï (SHA Í∂åÏû•)
‚úÖ ÏΩîÎìú Ïù∏Ï†ùÏÖò Î∞©ÏßÄ (ÌôòÍ≤Ω Î≥ÄÏàò ÏÇ¨Ïö©)
‚úÖ Î≥¥Ïïà Ïä§Ï∫î ÌÜµÌï© (CodeQL, Trivy, Gitleaks)
‚úÖ Environment Î≥¥Ìò∏ Í∑úÏπô ÏÑ§Ï†ï
‚úÖ Í∞êÏÇ¨ Î°úÍ∑∏ Í∏∞Î°ù
‚úÖ Ï†ïÍ∏∞Ï†ÅÏù∏ Secrets ÍµêÏ≤¥ (90Ïùº)

‚ùå ÌïòÎìúÏΩîÎî©Îêú Secrets
‚ùå Í≥ºÎèÑÌïú Í∂åÌïú Î∂ÄÏó¨
‚ùå Í≤ÄÏ¶ùÎêòÏßÄ ÏïäÏùÄ Ïï°ÏÖò ÏÇ¨Ïö©
‚ùå Fork PRÏóê Secrets ÎÖ∏Ï∂ú
‚ùå Î≥¥Ïïà Ïä§Ï∫î ÏÉùÎûµ
```

</details>

---

**Îã§Ïùå ÏÑπÏÖòÏóêÏÑú ÎßåÎÇòÏöî!** üöÄ