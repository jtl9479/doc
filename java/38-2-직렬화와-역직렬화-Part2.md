# 38ì¥ ì§ë ¬í™”ì™€ ì—­ì§ë ¬í™” - Part 2: serialVersionUIDì™€ ê³ ê¸‰ ê¸°ë²•

> **í•™ìŠµ ëª©í‘œ**: serialVersionUIDì˜ ì¤‘ìš”ì„±ê³¼ ì»¤ìŠ¤í…€ ì§ë ¬í™”ë¥¼ ë§ˆìŠ¤í„°í•œë‹¤

**â±ï¸ ì˜ˆìƒ í•™ìŠµ ì‹œê°„**: 3-4ì‹œê°„
**ë‚œì´ë„**: â­â­â­â­â­ (5/5)

---

## ğŸ“š ëª©ì°¨
- [serialVersionUIDë€](#serialversionuidë€)
- [ì»¤ìŠ¤í…€ ì§ë ¬í™”](#ì»¤ìŠ¤í…€-ì§ë ¬í™”)
- [ì‹¤ë¬´ í™œìš© ì‚¬ë¡€](#ì‹¤ë¬´-í™œìš©-ì‚¬ë¡€)
- [ì£¼ë‹ˆì–´ ì‹œë‚˜ë¦¬ì˜¤](#ì£¼ë‹ˆì–´-ì‹œë‚˜ë¦¬ì˜¤)

---

## ğŸ”‘ serialVersionUIDë€?

### ë²„ì „ í˜¸í™˜ì„± ë¬¸ì œ

```java
// âŒ ë²„ì „ 1: serialVersionUID ì—†ìŒ
class User implements Serializable {
    private String name;
    private int age;
}

// ì§ë ¬í™”
User user = new User("ì² ìˆ˜", 30);
ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("user.ser"));
oos.writeObject(user);

// --- ì´í›„ í´ë˜ìŠ¤ ìˆ˜ì • ---

// âŒ ë²„ì „ 2: í•„ë“œ ì¶”ê°€
class User implements Serializable {
    private String name;
    private int age;
    private String email;  // ìƒˆ í•„ë“œ ì¶”ê°€!
}

// ì—­ì§ë ¬í™” ì‹œë„
ObjectInputStream ois = new ObjectInputStream(new FileInputStream("user.ser"));
User user = (User) ois.readObject();
// InvalidClassException: local class incompatible!
```

**ë¬¸ì œ**: í´ë˜ìŠ¤ êµ¬ì¡°ê°€ ë³€ê²½ë˜ë©´ ê¸°ì¡´ ì§ë ¬í™” íŒŒì¼ì„ ì½ì„ ìˆ˜ ì—†ìŒ!

---

### serialVersionUID í•´ê²°ì±…

```java
// âœ… serialVersionUID ëª…ì‹œ
class User implements Serializable {
    private static final long serialVersionUID = 1L;  // ë²„ì „ ëª…ì‹œ!

    private String name;
    private int age;
    private String email;  // í•„ë“œ ì¶”ê°€í•´ë„ í˜¸í™˜!
}
```

**ì¥ì **:
1. **ë²„ì „ í˜¸í™˜ì„±**: serialVersionUIDê°€ ê°™ìœ¼ë©´ í•„ë“œ ì¶”ê°€/ì‚­ì œ ê°€ëŠ¥
2. **ëª…ì‹œì  ê´€ë¦¬**: ë²„ì „ ë³€ê²½ ì‹œ ì˜ë„ì ìœ¼ë¡œ serialVersionUID ë³€ê²½
3. **ê²½ê³  ì œê±°**: IDE ê²½ê³  ì‚¬ë¼ì§

### ì‹¤ìŠµ: serialVersionUID í…ŒìŠ¤íŠ¸

```java
import java.io.*;

// ë²„ì „ 1
class Person implements Serializable {
    private static final long serialVersionUID = 1L;

    private String name;
    private int age;

    public Person(String name, int age) {
        this.name = name;
        this.age = age;
    }

    @Override
    public String toString() {
        return "Person{name='" + name + "', age=" + age + "}";
    }
}

public class SerialVersionUIDTest {
    public static void main(String[] args) throws Exception {
        String fileName = "person.ser";

        // 1ë‹¨ê³„: ì§ë ¬í™”
        System.out.println("=== 1ë‹¨ê³„: ì§ë ¬í™” ===");
        Person person = new Person("ê¹€ì² ìˆ˜", 30);
        try (ObjectOutputStream oos = new ObjectOutputStream(
                new FileOutputStream(fileName))) {
            oos.writeObject(person);
            System.out.println("ì €ì¥: " + person);
        }

        // 2ë‹¨ê³„: í´ë˜ìŠ¤ ìˆ˜ì • í›„ ì—­ì§ë ¬í™”
        // (ì‹¤ì œë¡œëŠ” Person í´ë˜ìŠ¤ì— email í•„ë“œ ì¶”ê°€)
        System.out.println("\n=== 2ë‹¨ê³„: ì—­ì§ë ¬í™” ===");
        try (ObjectInputStream ois = new ObjectInputStream(
                new FileInputStream(fileName))) {
            Person loaded = (Person) ois.readObject();
            System.out.println("ë³µì›: " + loaded);
            System.out.println("âœ… serialVersionUID ë•ë¶„ì— í˜¸í™˜ ì„±ê³µ!");
        }
    }
}
```

---

## ğŸ¨ ì»¤ìŠ¤í…€ ì§ë ¬í™”

### ê¸°ë³¸ ì§ë ¬í™”ì˜ í•œê³„

```java
// âŒ ë¬¸ì œ: ë¹„ë°€ë²ˆí˜¸ê°€ ê·¸ëŒ€ë¡œ ì €ì¥ë¨!
class User implements Serializable {
    private String username;
    private String password;  // í‰ë¬¸ ì €ì¥ ìœ„í—˜!
}
```

### í•´ê²°: readObject/writeObject ì˜¤ë²„ë¼ì´ë“œ

```java
import java.io.*;
import java.util.Base64;

class SecureUser implements Serializable {
    private static final long serialVersionUID = 1L;

    private String username;
    private transient String password;  // ê¸°ë³¸ ì§ë ¬í™” ì œì™¸

    public SecureUser(String username, String password) {
        this.username = username;
        this.password = password;
    }

    /**
     * ì»¤ìŠ¤í…€ ì§ë ¬í™”: ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”
     */
    private void writeObject(ObjectOutputStream oos) throws IOException {
        // 1. ê¸°ë³¸ í•„ë“œ ì €ì¥
        oos.defaultWriteObject();

        // 2. ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” í›„ ì €ì¥
        String encoded = Base64.getEncoder().encodeToString(password.getBytes());
        oos.writeObject(encoded);

        System.out.println("âœ… ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”: " + password + " â†’ " + encoded);
    }

    /**
     * ì»¤ìŠ¤í…€ ì—­ì§ë ¬í™”: ë¹„ë°€ë²ˆí˜¸ ë³µí˜¸í™”
     */
    private void readObject(ObjectInputStream ois)
            throws IOException, ClassNotFoundException {
        // 1. ê¸°ë³¸ í•„ë“œ ë³µì›
        ois.defaultReadObject();

        // 2. ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸ ë³µí˜¸í™”
        String encoded = (String) ois.readObject();
        this.password = new String(Base64.getDecoder().decode(encoded));

        System.out.println("âœ… ë¹„ë°€ë²ˆí˜¸ ë³µí˜¸í™”: " + encoded + " â†’ " + password);
    }

    @Override
    public String toString() {
        return "SecureUser{username='" + username + "', password='" + password + "'}";
    }
}

public class CustomSerializationExample {
    public static void main(String[] args) throws Exception {
        String fileName = "secure_user.ser";

        // ì§ë ¬í™”
        System.out.println("=== ì§ë ¬í™” ===");
        SecureUser user = new SecureUser("admin", "secret123");
        try (ObjectOutputStream oos = new ObjectOutputStream(
                new FileOutputStream(fileName))) {
            oos.writeObject(user);
        }

        // ì—­ì§ë ¬í™”
        System.out.println("\n=== ì—­ì§ë ¬í™” ===");
        try (ObjectInputStream ois = new ObjectInputStream(
                new FileInputStream(fileName))) {
            SecureUser loaded = (SecureUser) ois.readObject();
            System.out.println("ë³µì›: " + loaded);
        }
    }
}
```

**ì‹¤í–‰ ê²°ê³¼**:
```
=== ì§ë ¬í™” ===
âœ… ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”: secret123 â†’ c2VjcmV0MTIz

=== ì—­ì§ë ¬í™” ===
âœ… ë¹„ë°€ë²ˆí˜¸ ë³µí˜¸í™”: c2VjcmV0MTIz â†’ secret123
ë³µì›: SecureUser{username='admin', password='secret123'}
```

---

## ğŸ¢ ì‹¤ë¬´ í™œìš© ì‚¬ë¡€

### ì‚¬ë¡€ 1: ë„¤ì´ë²„ - ì„¸ì…˜ í´ëŸ¬ìŠ¤í„°ë§ (Redis)

**ë°°ê²½**:
- ì›¹ ì„œë²„ 100ëŒ€ ìš´ì˜
- ì‚¬ìš©ì ë¡œê·¸ì¸ ì„¸ì…˜ì„ ëª¨ë“  ì„œë²„ì—ì„œ ê³µìœ  í•„ìš”
- Redisì— Java ê°ì²´ ì§ì ‘ ì €ì¥

**êµ¬í˜„**:

```java
import java.io.*;
import java.time.LocalDateTime;

/**
 * ë„¤ì´ë²„ í†µí•© ë¡œê·¸ì¸ ì„¸ì…˜ ê°ì²´
 * Redisì— ì§ë ¬í™”í•˜ì—¬ ì €ì¥
 */
class NaverSession implements Serializable {
    private static final long serialVersionUID = 1L;

    private String sessionId;
    private String userId;
    private String userName;
    private LocalDateTime loginTime;
    private LocalDateTime lastAccessTime;

    // í† í°ì€ Redisì—ì„œ ë³„ë„ ê´€ë¦¬ (ë³´ì•ˆ)
    private transient String accessToken;
    private transient String refreshToken;

    public NaverSession(String sessionId, String userId, String userName) {
        this.sessionId = sessionId;
        this.userId = userId;
        this.userName = userName;
        this.loginTime = LocalDateTime.now();
        this.lastAccessTime = LocalDateTime.now();
    }

    /**
     * ì»¤ìŠ¤í…€ ì§ë ¬í™”: ë¯¼ê° ì •ë³´ ì œì™¸
     */
    private void writeObject(ObjectOutputStream oos) throws IOException {
        oos.defaultWriteObject();
        System.out.println("âœ… ì„¸ì…˜ ì§ë ¬í™”: " + sessionId + " (í† í° ì œì™¸)");
    }

    /**
     * ì»¤ìŠ¤í…€ ì—­ì§ë ¬í™”: í† í° ë³„ë„ ë¡œë“œ
     */
    private void readObject(ObjectInputStream ois)
            throws IOException, ClassNotFoundException {
        ois.defaultReadObject();
        // í† í°ì€ Redisì—ì„œ ë³„ë„ í‚¤ë¡œ ì¡°íšŒ
        System.out.println("âœ… ì„¸ì…˜ ì—­ì§ë ¬í™”: " + sessionId);
    }

    public void updateLastAccessTime() {
        this.lastAccessTime = LocalDateTime.now();
    }

    @Override
    public String toString() {
        return "NaverSession{" +
               "sessionId='" + sessionId + '\'' +
               ", userId='" + userId + '\'' +
               ", userName='" + userName + '\'' +
               ", loginTime=" + loginTime +
               ", lastAccessTime=" + lastAccessTime +
               '}';
    }
}

/**
 * Redis ì—°ë™ ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œë¡œëŠ” Jedis/Lettuce ì‚¬ìš©)
 */
class RedisSessionManager {
    public void saveSession(NaverSession session) throws IOException {
        // ê°ì²´ â†’ ë°”ì´íŠ¸ ë°°ì—´
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        ObjectOutputStream oos = new ObjectOutputStream(bos);
        oos.writeObject(session);
        byte[] data = bos.toByteArray();

        // Redisì— ì €ì¥ (ì‹¤ì œë¡œëŠ” jedis.set(sessionId, data))
        System.out.println("Redis ì €ì¥: " + session.sessionId + " (" + data.length + " bytes)");
    }

    public NaverSession loadSession(String sessionId, byte[] data)
            throws IOException, ClassNotFoundException {
        // ë°”ì´íŠ¸ ë°°ì—´ â†’ ê°ì²´
        ByteArrayInputStream bis = new ByteArrayInputStream(data);
        ObjectInputStream ois = new ObjectInputStream(bis);
        NaverSession session = (NaverSession) ois.readObject();

        System.out.println("Redis ì¡°íšŒ: " + sessionId);
        return session;
    }
}

public class NaverSessionExample {
    public static void main(String[] args) throws Exception {
        RedisSessionManager redis = new RedisSessionManager();

        // 1. ë¡œê·¸ì¸: ì„¸ì…˜ ìƒì„± ë° ì €ì¥
        System.out.println("=== 1. ë¡œê·¸ì¸ (ì„œë²„ A) ===");
        NaverSession session = new NaverSession(
            "sess_abc123",
            "user_12345",
            "í™ê¸¸ë™"
        );
        redis.saveSession(session);

        // 2. ë‹¤ë¥¸ ì„œë²„ì—ì„œ ì„¸ì…˜ ì¡°íšŒ
        System.out.println("\n=== 2. ìš”ì²­ ì²˜ë¦¬ (ì„œë²„ B) ===");
        // ì‹¤ì œë¡œëŠ” Redisì—ì„œ ë°”ì´íŠ¸ ë°°ì—´ ê°€ì ¸ì˜´
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        ObjectOutputStream oos = new ObjectOutputStream(bos);
        oos.writeObject(session);
        byte[] sessionData = bos.toByteArray();

        NaverSession loadedSession = redis.loadSession("sess_abc123", sessionData);
        loadedSession.updateLastAccessTime();
        System.out.println("ì„¸ì…˜ ë³µì›: " + loadedSession);
    }
}
```

**ì‹¤í–‰ ê²°ê³¼**:
```
=== 1. ë¡œê·¸ì¸ (ì„œë²„ A) ===
âœ… ì„¸ì…˜ ì§ë ¬í™”: sess_abc123 (í† í° ì œì™¸)
Redis ì €ì¥: sess_abc123 (234 bytes)

=== 2. ìš”ì²­ ì²˜ë¦¬ (ì„œë²„ B) ===
âœ… ì„¸ì…˜ ì—­ì§ë ¬í™”: sess_abc123
Redis ì¡°íšŒ: sess_abc123
ì„¸ì…˜ ë³µì›: NaverSession{sessionId='sess_abc123', userId='user_12345', ...}
```

**ì„±ê³¼**:
- ğŸš€ **ì„œë²„ í™•ì¥ì„±**: 100ëŒ€ ì„œë²„ì—ì„œ ì„¸ì…˜ ê³µìœ  (ë¬´ì¤‘ë‹¨ ë°°í¬ ê°€ëŠ¥)
- ğŸ’° **ë¹„ìš© ì ˆê°**: Sticky Session ë¶ˆí•„ìš” â†’ ë¡œë“œë°¸ëŸ°ì‹± íš¨ìœ¨ 30% â†‘
- âš¡ **ì‘ë‹µ ì†ë„**: Redis ì¡°íšŒ < 1ms (íŒŒì¼ ëŒ€ë¹„ 100ë°° ë¹ ë¦„)
- ğŸ“Š **ì²˜ë¦¬ëŸ‰**: ë™ì‹œ ì ‘ì†ì 100ë§Œëª… ì§€ì›

---

### ì‚¬ë¡€ 2: ì¹´ì¹´ì˜¤ë±…í¬ - ê±°ë˜ ë‚´ì—­ ë°±ì—… (S3)

**ë°°ê²½**:
- ì€í–‰ ê±°ë˜ ë°ì´í„° ì¥ê¸° ë³´ê´€ í•„ìš” (ê¸ˆìœµê°ë…ì› ê·œì •)
- ì¼ ê±°ë˜ 10ë§Œê±´+
- S3ì— ì¼ ë‹¨ìœ„ ì§ë ¬í™” ë°±ì—…

**êµ¬í˜„**:

```java
import java.io.*;
import java.math.BigDecimal;
import java.time.LocalDateTime;
import java.util.*;

/**
 * ê±°ë˜ ë‚´ì—­ VO (Value Object)
 */
class Transaction implements Serializable {
    private static final long serialVersionUID = 1L;

    private String transactionId;
    private String accountNumber;
    private String type;  // "DEPOSIT", "WITHDRAW", "TRANSFER"
    private BigDecimal amount;
    private BigDecimal balance;
    private LocalDateTime timestamp;
    private String description;

    public Transaction(String transactionId, String accountNumber,
                      String type, BigDecimal amount, BigDecimal balance,
                      String description) {
        this.transactionId = transactionId;
        this.accountNumber = accountNumber;
        this.type = type;
        this.amount = amount;
        this.balance = balance;
        this.timestamp = LocalDateTime.now();
        this.description = description;
    }

    @Override
    public String toString() {
        return String.format("[%s] %s %s: %sì› (ì”ì•¡: %sì›)",
            timestamp.toLocalTime(), accountNumber, type, amount, balance);
    }
}

/**
 * ì¼ ë‹¨ìœ„ ê±°ë˜ ë°±ì—… í´ë˜ìŠ¤
 */
class DailyTransactionBackup implements Serializable {
    private static final long serialVersionUID = 1L;

    private String backupDate;  // "2025-10-10"
    private List<Transaction> transactions;
    private int totalCount;
    private BigDecimal totalAmount;

    public DailyTransactionBackup(String backupDate) {
        this.backupDate = backupDate;
        this.transactions = new ArrayList<>();
        this.totalCount = 0;
        this.totalAmount = BigDecimal.ZERO;
    }

    public void addTransaction(Transaction tx) {
        transactions.add(tx);
        totalCount++;
        totalAmount = totalAmount.add(tx.amount);
    }

    /**
     * ì••ì¶• ì§ë ¬í™” (ìš©ëŸ‰ 70% ì ˆê°)
     */
    public void saveToFile(String fileName) throws IOException {
        try (FileOutputStream fos = new FileOutputStream(fileName);
             java.util.zip.GZIPOutputStream gzip = new java.util.zip.GZIPOutputStream(fos);
             ObjectOutputStream oos = new ObjectOutputStream(gzip)) {

            oos.writeObject(this);
            System.out.println("âœ… ë°±ì—… ì €ì¥: " + fileName);
            System.out.println("   - ê±°ë˜ ê±´ìˆ˜: " + totalCount + "ê±´");
            System.out.println("   - ì´ ê±°ë˜ì•¡: " + totalAmount + "ì›");
        }
    }

    /**
     * ì••ì¶• ì—­ì§ë ¬í™”
     */
    public static DailyTransactionBackup loadFromFile(String fileName)
            throws IOException, ClassNotFoundException {
        try (FileInputStream fis = new FileInputStream(fileName);
             java.util.zip.GZIPInputStream gzip = new java.util.zip.GZIPInputStream(fis);
             ObjectInputStream ois = new ObjectInputStream(gzip)) {

            DailyTransactionBackup backup = (DailyTransactionBackup) ois.readObject();
            System.out.println("âœ… ë°±ì—… ë³µì›: " + fileName);
            return backup;
        }
    }

    public void printSummary() {
        System.out.println("\n=== ê±°ë˜ ë°±ì—… ìš”ì•½ ===");
        System.out.println("ë‚ ì§œ: " + backupDate);
        System.out.println("ì´ ê±°ë˜: " + totalCount + "ê±´");
        System.out.println("ì´ ê±°ë˜ì•¡: " + totalAmount + "ì›");
        System.out.println("\nê±°ë˜ ë‚´ì—­:");
        transactions.forEach(System.out::println);
    }
}

public class KakaoBankBackupExample {
    public static void main(String[] args) throws Exception {
        String backupFile = "transactions_20251010.ser.gz";

        // 1. ì¼ ê±°ë˜ ë‚´ì—­ ìˆ˜ì§‘
        System.out.println("=== 1. ê±°ë˜ ë‚´ì—­ ë°±ì—… ===");
        DailyTransactionBackup backup = new DailyTransactionBackup("2025-10-10");

        backup.addTransaction(new Transaction(
            "tx_001", "3333-01-1234567", "DEPOSIT",
            new BigDecimal("1000000"), new BigDecimal("5000000"),
            "ê¸‰ì—¬ ì…ê¸ˆ"
        ));

        backup.addTransaction(new Transaction(
            "tx_002", "3333-01-1234567", "WITHDRAW",
            new BigDecimal("50000"), new BigDecimal("4950000"),
            "ATM ì¶œê¸ˆ"
        ));

        backup.addTransaction(new Transaction(
            "tx_003", "3333-01-1234567", "TRANSFER",
            new BigDecimal("300000"), new BigDecimal("4650000"),
            "ì¹´ë“œ ê²°ì œ"
        ));

        // 2. S3 ì—…ë¡œë“œ (ì‹¤ì œë¡œëŠ” AWS SDK ì‚¬ìš©)
        backup.saveToFile(backupFile);

        // 3. ë°±ì—… ê²€ì¦ (ë³µì› í…ŒìŠ¤íŠ¸)
        System.out.println("\n=== 2. ë°±ì—… ë³µì› í…ŒìŠ¤íŠ¸ ===");
        DailyTransactionBackup restored = DailyTransactionBackup.loadFromFile(backupFile);
        restored.printSummary();
    }
}
```

**ì‹¤í–‰ ê²°ê³¼**:
```
=== 1. ê±°ë˜ ë‚´ì—­ ë°±ì—… ===
âœ… ë°±ì—… ì €ì¥: transactions_20251010.ser.gz
   - ê±°ë˜ ê±´ìˆ˜: 3ê±´
   - ì´ ê±°ë˜ì•¡: 1350000ì›

=== 2. ë°±ì—… ë³µì› í…ŒìŠ¤íŠ¸ ===
âœ… ë°±ì—… ë³µì›: transactions_20251010.ser.gz

=== ê±°ë˜ ë°±ì—… ìš”ì•½ ===
ë‚ ì§œ: 2025-10-10
ì´ ê±°ë˜: 3ê±´
ì´ ê±°ë˜ì•¡: 1350000ì›

ê±°ë˜ ë‚´ì—­:
[14:30:15] 3333-01-1234567 DEPOSIT: 1000000ì› (ì”ì•¡: 5000000ì›)
[14:30:15] 3333-01-1234567 WITHDRAW: 50000ì› (ì”ì•¡: 4950000ì›)
[14:30:15] 3333-01-1234567 TRANSFER: 300000ì› (ì”ì•¡: 4650000ì›)
```

**ì„±ê³¼**:
- ğŸ›¡ï¸ **ê·œì • ì¤€ìˆ˜**: ê¸ˆìœµê°ë…ì› ë°ì´í„° ë³´ê´€ ê¸°ì¤€ ì¶©ì¡±
- ğŸ’¾ **ì €ì¥ íš¨ìœ¨**: GZIP ì••ì¶•ìœ¼ë¡œ ìš©ëŸ‰ 70% ì ˆê° (1GB â†’ 300MB)
- â±ï¸ **ë³µêµ¬ ì†ë„**: ì¥ì•  ì‹œ 1ì‹œê°„ ë‚´ ë°ì´í„° ë³µêµ¬ ê°€ëŠ¥
- ğŸ’° **ë¹„ìš©**: S3 Standard-IAë¡œ ì›” ì €ì¥ë¹„ìš© 50ë§Œì›

---

### ì‚¬ë¡€ 3: ì¿ íŒ¡ - ì¥ë°”êµ¬ë‹ˆ ì„ì‹œ ì €ì¥ (Local Cache)

**ë°°ê²½**:
- ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ì‚¬ìš©ìë„ ì¥ë°”êµ¬ë‹ˆ ì‚¬ìš©
- ë¸Œë¼ìš°ì € ì„¸ì…˜ ì¢…ë£Œ ì‹œ ìœ ì§€ í•„ìš”
- ì¿ í‚¤/Local Storage ëŒ€ì‹  ì„œë²„ íŒŒì¼ ìºì‹œ

**êµ¬í˜„**:

```java
import java.io.*;
import java.time.LocalDateTime;
import java.util.*;

/**
 * ì¥ë°”êµ¬ë‹ˆ ìƒí’ˆ
 */
class CartItem implements Serializable {
    private static final long serialVersionUID = 1L;

    private String productId;
    private String productName;
    private int price;
    private int quantity;

    public CartItem(String productId, String productName, int price, int quantity) {
        this.productId = productId;
        this.productName = productName;
        this.price = price;
        this.quantity = quantity;
    }

    public int getTotalPrice() {
        return price * quantity;
    }

    @Override
    public String toString() {
        return String.format("%s x%d = %,dì›", productName, quantity, getTotalPrice());
    }
}

/**
 * ê²ŒìŠ¤íŠ¸ ì¥ë°”êµ¬ë‹ˆ (ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì)
 */
class GuestCart implements Serializable {
    private static final long serialVersionUID = 1L;

    private String guestId;  // ì¿ í‚¤ UUID
    private List<CartItem> items;
    private LocalDateTime createdAt;
    private LocalDateTime lastModified;

    public GuestCart(String guestId) {
        this.guestId = guestId;
        this.items = new ArrayList<>();
        this.createdAt = LocalDateTime.now();
        this.lastModified = LocalDateTime.now();
    }

    public void addItem(CartItem item) {
        items.add(item);
        this.lastModified = LocalDateTime.now();
    }

    public int getTotalPrice() {
        return items.stream()
                   .mapToInt(CartItem::getTotalPrice)
                   .sum();
    }

    public boolean isExpired(int hours) {
        return lastModified.plusHours(hours).isBefore(LocalDateTime.now());
    }

    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("=== ì¥ë°”êµ¬ë‹ˆ (").append(guestId).append(") ===\n");
        items.forEach(item -> sb.append("- ").append(item).append("\n"));
        sb.append("ì´ ê¸ˆì•¡: ").append(String.format("%,dì›", getTotalPrice()));
        return sb.toString();
    }
}

/**
 * ì¥ë°”êµ¬ë‹ˆ ìºì‹œ ê´€ë¦¬ì
 */
class CartCacheManager {
    private static final String CACHE_DIR = "cart_cache/";
    private static final int EXPIRE_HOURS = 24;

    public CartCacheManager() {
        new File(CACHE_DIR).mkdirs();
    }

    /**
     * ì¥ë°”êµ¬ë‹ˆ ì €ì¥
     */
    public void saveCart(GuestCart cart) throws IOException {
        String fileName = CACHE_DIR + cart.guestId + ".cart";
        try (ObjectOutputStream oos = new ObjectOutputStream(
                new FileOutputStream(fileName))) {
            oos.writeObject(cart);
            System.out.println("âœ… ì¥ë°”êµ¬ë‹ˆ ì €ì¥: " + cart.guestId);
        }
    }

    /**
     * ì¥ë°”êµ¬ë‹ˆ ë¡œë“œ
     */
    public GuestCart loadCart(String guestId)
            throws IOException, ClassNotFoundException {
        String fileName = CACHE_DIR + guestId + ".cart";
        File file = new File(fileName);

        if (!file.exists()) {
            System.out.println("ì¥ë°”êµ¬ë‹ˆ ì—†ìŒ: " + guestId);
            return new GuestCart(guestId);
        }

        try (ObjectInputStream ois = new ObjectInputStream(
                new FileInputStream(fileName))) {
            GuestCart cart = (GuestCart) ois.readObject();

            // ë§Œë£Œ ì²´í¬ (24ì‹œê°„)
            if (cart.isExpired(EXPIRE_HOURS)) {
                System.out.println("âš ï¸ ì¥ë°”êµ¬ë‹ˆ ë§Œë£Œ: " + guestId);
                file.delete();
                return new GuestCart(guestId);
            }

            System.out.println("âœ… ì¥ë°”êµ¬ë‹ˆ ë³µì›: " + guestId);
            return cart;
        }
    }

    /**
     * ë§Œë£Œëœ ìºì‹œ ì •ë¦¬ (ë°°ì¹˜ ì‘ì—…)
     */
    public void cleanupExpiredCarts() {
        File dir = new File(CACHE_DIR);
        File[] files = dir.listFiles((d, name) -> name.endsWith(".cart"));

        if (files == null) return;

        int deleted = 0;
        for (File file : files) {
            try (ObjectInputStream ois = new ObjectInputStream(
                    new FileInputStream(file))) {
                GuestCart cart = (GuestCart) ois.readObject();
                if (cart.isExpired(EXPIRE_HOURS)) {
                    file.delete();
                    deleted++;
                }
            } catch (Exception e) {
                file.delete();  // ì†ìƒëœ íŒŒì¼ ì œê±°
                deleted++;
            }
        }

        System.out.println("âœ… ë§Œë£Œ ìºì‹œ ì •ë¦¬: " + deleted + "ê°œ ì‚­ì œ");
    }
}

public class CoupangCartExample {
    public static void main(String[] args) throws Exception {
        CartCacheManager cacheManager = new CartCacheManager();

        // ì‹œë‚˜ë¦¬ì˜¤ 1: ê²ŒìŠ¤íŠ¸ ë°©ë¬¸ - ì¥ë°”êµ¬ë‹ˆ ì¶”ê°€
        System.out.println("=== ì‹œë‚˜ë¦¬ì˜¤ 1: ì²« ë°©ë¬¸ ===");
        String guestId = UUID.randomUUID().toString();
        GuestCart cart = new GuestCart(guestId);

        cart.addItem(new CartItem("prod_001", "ë¬´ì„  ì´ì–´í°", 89000, 1));
        cart.addItem(new CartItem("prod_002", "í•¸ë“œí° ì¼€ì´ìŠ¤", 15000, 2));
        cacheManager.saveCart(cart);

        // ì‹œë‚˜ë¦¬ì˜¤ 2: í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ - ì¥ë°”êµ¬ë‹ˆ ë³µì›
        System.out.println("\n=== ì‹œë‚˜ë¦¬ì˜¤ 2: í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ===");
        GuestCart restoredCart = cacheManager.loadCart(guestId);
        System.out.println(restoredCart);

        // ì‹œë‚˜ë¦¬ì˜¤ 3: ìƒí’ˆ ì¶”ê°€
        System.out.println("\n=== ì‹œë‚˜ë¦¬ì˜¤ 3: ìƒí’ˆ ì¶”ê°€ ===");
        restoredCart.addItem(new CartItem("prod_003", "USB ì¼€ì´ë¸”", 8000, 3));
        cacheManager.saveCart(restoredCart);
        System.out.println(restoredCart);

        // ì‹œë‚˜ë¦¬ì˜¤ 4: ë§Œë£Œ ìºì‹œ ì •ë¦¬ (ë°°ì¹˜)
        System.out.println("\n=== ì‹œë‚˜ë¦¬ì˜¤ 4: ë§Œë£Œ ìºì‹œ ì •ë¦¬ ===");
        cacheManager.cleanupExpiredCarts();
    }
}
```

**ì‹¤í–‰ ê²°ê³¼**:
```
=== ì‹œë‚˜ë¦¬ì˜¤ 1: ì²« ë°©ë¬¸ ===
âœ… ì¥ë°”êµ¬ë‹ˆ ì €ì¥: a1b2c3d4-...

=== ì‹œë‚˜ë¦¬ì˜¤ 2: í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ===
âœ… ì¥ë°”êµ¬ë‹ˆ ë³µì›: a1b2c3d4-...
=== ì¥ë°”êµ¬ë‹ˆ (a1b2c3d4-...) ===
- ë¬´ì„  ì´ì–´í° x1 = 89,000ì›
- í•¸ë“œí° ì¼€ì´ìŠ¤ x2 = 30,000ì›
ì´ ê¸ˆì•¡: 119,000ì›

=== ì‹œë‚˜ë¦¬ì˜¤ 3: ìƒí’ˆ ì¶”ê°€ ===
âœ… ì¥ë°”êµ¬ë‹ˆ ì €ì¥: a1b2c3d4-...
=== ì¥ë°”êµ¬ë‹ˆ (a1b2c3d4-...) ===
- ë¬´ì„  ì´ì–´í° x1 = 89,000ì›
- í•¸ë“œí° ì¼€ì´ìŠ¤ x2 = 30,000ì›
- USB ì¼€ì´ë¸” x3 = 24,000ì›
ì´ ê¸ˆì•¡: 143,000ì›

=== ì‹œë‚˜ë¦¬ì˜¤ 4: ë§Œë£Œ ìºì‹œ ì •ë¦¬ ===
âœ… ë§Œë£Œ ìºì‹œ ì •ë¦¬: 0ê°œ ì‚­ì œ
```

**ì„±ê³¼**:
- ğŸ“ˆ **ì „í™˜ìœ¨ í–¥ìƒ**: ê²ŒìŠ¤íŠ¸ ì¥ë°”êµ¬ë‹ˆ ìœ ì§€ë¡œ êµ¬ë§¤ ì „í™˜ìœ¨ 15% â†‘
- ğŸ’¾ **ì„œë²„ ë¶€í•˜ ê°ì†Œ**: Redis ëŒ€ì‹  íŒŒì¼ ìºì‹œë¡œ ë©”ëª¨ë¦¬ ë¹„ìš© 80% â†“
- ğŸ—‘ï¸ **ìë™ ì •ë¦¬**: 24ì‹œê°„ ë§Œë£Œ ì •ì±…ìœ¼ë¡œ ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ ê´€ë¦¬
- âš¡ **ì‘ë‹µ ì†ë„**: íŒŒì¼ I/O < 5ms (ì¶©ë¶„íˆ ë¹ ë¦„)

---

## ğŸ‘¨â€ğŸ’» ì£¼ë‹ˆì–´ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: serialVersionUID ë¯¸ì§€ì •ìœ¼ë¡œ ì—ëŸ¬

**ìƒí™©**: í´ë˜ìŠ¤ ìˆ˜ì • í›„ InvalidClassException ë°œìƒ

```java
// âŒ ì£¼ë‹ˆì–´ ê°œë°œì ì½”ë“œ
class Product implements Serializable {
    // serialVersionUID ì—†ìŒ!
    private String name;
    private int price;
}

// ì§ë ¬í™” í›„ í•„ë“œ ì¶”ê°€
Product product = new Product("ë…¸íŠ¸ë¶", 1500000);
save(product);

// í´ë˜ìŠ¤ ìˆ˜ì •
class Product implements Serializable {
    private String name;
    private int price;
    private String description;  // ì¶”ê°€!
}

// ì—­ì§ë ¬í™” ì‹œë„
Product loaded = load();
// InvalidClassException: local class incompatible!
```

**í•´ê²°**:
```java
// âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ
class Product implements Serializable {
    private static final long serialVersionUID = 1L;  // ëª…ì‹œ!

    private String name;
    private int price;
    private String description;  // í•„ë“œ ì¶”ê°€ OK!
}
```

**ë°°ìš´ ì **:
- ğŸ’¡ í•­ìƒ `serialVersionUID` ëª…ì‹œ
- ğŸ’¡ IDEì—ì„œ ìë™ ìƒì„± ê°€ëŠ¥ (Alt + Enter)
- ğŸ’¡ í˜¸í™˜ì„± ìœ ì§€ ì‹œ ê°’ ìœ ì§€, í˜¸í™˜ ì•ˆ í•  ì‹œ ë³€ê²½

---

### ì‹œë‚˜ë¦¬ì˜¤ 2: ë¹„ì§ë ¬í™” í•„ë“œë¡œ ì¸í•œ ì—ëŸ¬

**ìƒí™©**: ì§ë ¬í™” ë¶ˆê°€ëŠ¥í•œ ê°ì²´ë¥¼ í¬í•¨í•˜ì—¬ ì—ëŸ¬

```java
// âŒ ì£¼ë‹ˆì–´ ê°œë°œì ì½”ë“œ
class User implements Serializable {
    private String name;
    private Socket socket;  // Socketì€ Serializable ì•„ë‹˜!
}

// ì§ë ¬í™” ì‹œë„
User user = new User();
user.socket = new Socket("localhost", 8080);
save(user);
// NotSerializableException: java.net.Socket
```

**í•´ê²°**:
```java
// âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ
class User implements Serializable {
    private static final long serialVersionUID = 1L;

    private String name;
    private transient Socket socket;  // transient ì¶”ê°€!
}

// ì—­ì§ë ¬í™” í›„ ì¬ì—°ê²°
User user = load();
user.socket = new Socket("localhost", 8080);  // ìˆ˜ë™ ì¬ì—°ê²°
```

**ë°°ìš´ ì **:
- ğŸ’¡ Stream, Thread, Socket ë“±ì€ ì§ë ¬í™” ë¶ˆê°€
- ğŸ’¡ `transient`ë¡œ ì œì™¸ í›„ ìˆ˜ë™ ì¬ìƒì„±
- ğŸ’¡ ë˜ëŠ” ì»¤ìŠ¤í…€ ì§ë ¬í™”ë¡œ ì²˜ë¦¬

---

### ì‹œë‚˜ë¦¬ì˜¤ 3: ë¹„ë°€ë²ˆí˜¸ í‰ë¬¸ ì €ì¥ ë¬¸ì œ

**ìƒí™©**: ë¯¼ê° ì •ë³´ë¥¼ ê·¸ëŒ€ë¡œ ì§ë ¬í™”í•˜ì—¬ ë³´ì•ˆ ì·¨ì•½

**ë¬¸ì œ ì½”ë“œ**:
```java
// âŒ ì£¼ë‹ˆì–´ ê°œë°œì ì½”ë“œ
class UserAccount implements Serializable {
    private static final long serialVersionUID = 1L;

    private String username;
    private String password;  // í‰ë¬¸ ê·¸ëŒ€ë¡œ ì €ì¥!
    private String creditCard;  // ì¹´ë“œë²ˆí˜¸ë„ í‰ë¬¸!
}

// ì§ë ¬í™”
UserAccount account = new UserAccount("admin", "secret123", "1234-5678-9012-3456");
try (ObjectOutputStream oos = new ObjectOutputStream(
        new FileOutputStream("account.ser"))) {
    oos.writeObject(account);
}
// íŒŒì¼ì„ ì—´ì–´ë³´ë©´ í‰ë¬¸ìœ¼ë¡œ ë³´ì„!
```

**ë¬¸ì œì **:
- ğŸ˜± ì§ë ¬í™” íŒŒì¼(.ser)ì„ í…ìŠ¤íŠ¸ ì—ë””í„°ë¡œ ì—´ë©´ ë¹„ë°€ë²ˆí˜¸ê°€ ë³´ì„
- ğŸ˜± ë°±ì—… íŒŒì¼ì´ ìœ ì¶œë˜ë©´ ì¦‰ì‹œ í•´í‚¹ ê°€ëŠ¥
- ğŸ˜± ë¡œê·¸ì— ë¯¼ê° ì •ë³´ê°€ ë‚¨ì„ ìˆ˜ ìˆìŒ

**í•´ê²°**:
```java
// âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ - ì»¤ìŠ¤í…€ ì§ë ¬í™”ë¡œ ì•”í˜¸í™”
import javax.crypto.*;
import javax.crypto.spec.SecretKeySpec;
import java.security.Key;
import java.util.Base64;

class SecureUserAccount implements Serializable {
    private static final long serialVersionUID = 1L;
    private static final String ALGORITHM = "AES";
    private static final String SECRET_KEY = "MySecretKey12345";  // ì‹¤ë¬´ì—ì„œëŠ” í™˜ê²½ë³€ìˆ˜

    private String username;
    private transient String password;  // ê¸°ë³¸ ì§ë ¬í™” ì œì™¸
    private transient String creditCard;

    public SecureUserAccount(String username, String password, String creditCard) {
        this.username = username;
        this.password = password;
        this.creditCard = creditCard;
    }

    /**
     * ì»¤ìŠ¤í…€ ì§ë ¬í™”: ë¯¼ê° ì •ë³´ ì•”í˜¸í™”
     */
    private void writeObject(ObjectOutputStream oos) throws Exception {
        oos.defaultWriteObject();  // username ì €ì¥

        // AES ì•”í˜¸í™”
        Key key = new SecretKeySpec(SECRET_KEY.getBytes(), ALGORITHM);
        Cipher cipher = Cipher.getInstance(ALGORITHM);
        cipher.init(Cipher.ENCRYPT_MODE, key);

        // ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”
        byte[] encryptedPassword = cipher.doFinal(password.getBytes());
        oos.writeObject(Base64.getEncoder().encodeToString(encryptedPassword));

        // ì¹´ë“œë²ˆí˜¸ ì•”í˜¸í™”
        byte[] encryptedCard = cipher.doFinal(creditCard.getBytes());
        oos.writeObject(Base64.getEncoder().encodeToString(encryptedCard));

        System.out.println("âœ… ë¯¼ê°ì •ë³´ ì•”í˜¸í™” ì™„ë£Œ");
    }

    /**
     * ì»¤ìŠ¤í…€ ì—­ì§ë ¬í™”: ë³µí˜¸í™”
     */
    private void readObject(ObjectInputStream ois) throws Exception {
        ois.defaultReadObject();  // username ë³µì›

        // AES ë³µí˜¸í™”
        Key key = new SecretKeySpec(SECRET_KEY.getBytes(), ALGORITHM);
        Cipher cipher = Cipher.getInstance(ALGORITHM);
        cipher.init(Cipher.DECRYPT_MODE, key);

        // ë¹„ë°€ë²ˆí˜¸ ë³µí˜¸í™”
        String encryptedPassword = (String) ois.readObject();
        byte[] decryptedPassword = cipher.doFinal(
            Base64.getDecoder().decode(encryptedPassword)
        );
        this.password = new String(decryptedPassword);

        // ì¹´ë“œë²ˆí˜¸ ë³µí˜¸í™”
        String encryptedCard = (String) ois.readObject();
        byte[] decryptedCard = cipher.doFinal(
            Base64.getDecoder().decode(encryptedCard)
        );
        this.creditCard = new String(decryptedCard);

        System.out.println("âœ… ë¯¼ê°ì •ë³´ ë³µí˜¸í™” ì™„ë£Œ");
    }

    @Override
    public String toString() {
        return "SecureUserAccount{" +
               "username='" + username + '\'' +
               ", password='" + password + '\'' +
               ", creditCard='" + creditCard + '\'' +
               '}';
    }
}

public class SecureSerializationExample {
    public static void main(String[] args) throws Exception {
        String fileName = "secure_account.ser";

        // ì§ë ¬í™”
        System.out.println("=== ì§ë ¬í™” ===");
        SecureUserAccount account = new SecureUserAccount(
            "admin",
            "secret123",
            "1234-5678-9012-3456"
        );
        try (ObjectOutputStream oos = new ObjectOutputStream(
                new FileOutputStream(fileName))) {
            oos.writeObject(account);
        }

        // ì—­ì§ë ¬í™”
        System.out.println("\n=== ì—­ì§ë ¬í™” ===");
        try (ObjectInputStream ois = new ObjectInputStream(
                new FileInputStream(fileName))) {
            SecureUserAccount loaded = (SecureUserAccount) ois.readObject();
            System.out.println("ë³µì›: " + loaded);
        }
    }
}
```

**ì‹¤í–‰ ê²°ê³¼**:
```
=== ì§ë ¬í™” ===
âœ… ë¯¼ê°ì •ë³´ ì•”í˜¸í™” ì™„ë£Œ

=== ì—­ì§ë ¬í™” ===
âœ… ë¯¼ê°ì •ë³´ ë³µí˜¸í™” ì™„ë£Œ
ë³µì›: SecureUserAccount{username='admin', password='secret123', creditCard='1234-5678-9012-3456'}
```

**ë°°ìš´ ì **:
- ğŸ’¡ **ë¯¼ê° ì •ë³´ëŠ” ì ˆëŒ€ í‰ë¬¸ ì €ì¥ ê¸ˆì§€** (GDPR, ê°œì¸ì •ë³´ë³´í˜¸ë²• ìœ„ë°˜)
- ğŸ’¡ **ì»¤ìŠ¤í…€ ì§ë ¬í™”ë¡œ ì•”í˜¸í™”**: AES, RSA ë“± ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©
- ğŸ’¡ **transient + writeObject/readObject ì¡°í•©**: ì•”í˜¸í™” ë¡œì§ ì§ì ‘ êµ¬í˜„
- ğŸ’¡ **ì‹¤ë¬´ íŒ**: ì•”í˜¸í™” í‚¤ëŠ” í™˜ê²½ë³€ìˆ˜ë‚˜ Key Management Service(KMS) ì‚¬ìš©

---

### ì‹œë‚˜ë¦¬ì˜¤ 4: ì»¬ë ‰ì…˜ ì§ë ¬í™” ì‹œ ConcurrentModificationException

**ìƒí™©**: ì§ë ¬í™” ì¤‘ ì»¬ë ‰ì…˜ ìˆ˜ì •ìœ¼ë¡œ ì˜ˆì™¸ ë°œìƒ

**ë¬¸ì œ ì½”ë“œ**:
```java
// âŒ ì£¼ë‹ˆì–´ ê°œë°œì ì½”ë“œ
class UserCache implements Serializable {
    private static final long serialVersionUID = 1L;

    private List<String> userIds = new ArrayList<>();

    public void addUser(String userId) {
        userIds.add(userId);
    }

    public List<String> getUsers() {
        return userIds;  // ì›ë³¸ ë°˜í™˜!
    }
}

// ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½
UserCache cache = new UserCache();
cache.addUser("user1");
cache.addUser("user2");

// ìŠ¤ë ˆë“œ 1: ì§ë ¬í™”
new Thread(() -> {
    try (ObjectOutputStream oos = new ObjectOutputStream(
            new FileOutputStream("cache.ser"))) {
        oos.writeObject(cache);  // ì§ë ¬í™” ì¤‘...
    } catch (Exception e) {
        e.printStackTrace();
    }
}).start();

// ìŠ¤ë ˆë“œ 2: ë™ì‹œì— ìˆ˜ì •
new Thread(() -> {
    cache.addUser("user3");  // ConcurrentModificationException!
}).start();
```

**ë¬¸ì œì **:
- ğŸ˜± ì§ë ¬í™” ì¤‘ ì»¬ë ‰ì…˜ì„ ìˆ˜ì •í•˜ë©´ `ConcurrentModificationException` ë°œìƒ
- ğŸ˜± ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ë°ì´í„° ì†ìƒ ê°€ëŠ¥
- ğŸ˜± ì¼ë¶€ë§Œ ì§ë ¬í™”ë˜ì–´ ë³µì› ì‹œ ë¶ˆì™„ì „í•œ ë°ì´í„°

**í•´ê²° 1: ë™ê¸°í™” (synchronized)**
```java
// âœ… í•´ê²°ì±… 1: ë™ê¸°í™”
class SynchronizedUserCache implements Serializable {
    private static final long serialVersionUID = 1L;

    private List<String> userIds = Collections.synchronizedList(new ArrayList<>());

    public synchronized void addUser(String userId) {
        userIds.add(userId);
    }

    public synchronized List<String> getUsers() {
        return new ArrayList<>(userIds);  // ë°©ì–´ì  ë³µì‚¬
    }

    /**
     * ì»¤ìŠ¤í…€ ì§ë ¬í™”: ë™ê¸°í™”
     */
    private synchronized void writeObject(ObjectOutputStream oos) throws IOException {
        oos.defaultWriteObject();
        System.out.println("âœ… ë™ê¸°í™”ëœ ì§ë ¬í™” ì™„ë£Œ: " + userIds.size() + "ê°œ");
    }

    private synchronized void readObject(ObjectInputStream ois)
            throws IOException, ClassNotFoundException {
        ois.defaultReadObject();
        System.out.println("âœ… ë™ê¸°í™”ëœ ì—­ì§ë ¬í™” ì™„ë£Œ: " + userIds.size() + "ê°œ");
    }
}
```

**í•´ê²° 2: ë¶ˆë³€ ìŠ¤ëƒ…ìƒ· (Immutable Snapshot)**
```java
// âœ… í•´ê²°ì±… 2: ì§ë ¬í™” ì‹œ ìŠ¤ëƒ…ìƒ· ìƒì„±
class SnapshotUserCache implements Serializable {
    private static final long serialVersionUID = 1L;

    private transient List<String> userIds = new ArrayList<>();  // ê¸°ë³¸ ì§ë ¬í™” ì œì™¸

    public void addUser(String userId) {
        userIds.add(userId);
    }

    /**
     * ì»¤ìŠ¤í…€ ì§ë ¬í™”: ìŠ¤ëƒ…ìƒ· ìƒì„±
     */
    private void writeObject(ObjectOutputStream oos) throws IOException {
        oos.defaultWriteObject();

        // ìŠ¤ëƒ…ìƒ· ìƒì„± (ë³µì‚¬ë³¸ì„ ì§ë ¬í™”)
        List<String> snapshot = new ArrayList<>(userIds);
        oos.writeObject(snapshot);

        System.out.println("âœ… ìŠ¤ëƒ…ìƒ· ì§ë ¬í™”: " + snapshot.size() + "ê°œ");
    }

    /**
     * ì»¤ìŠ¤í…€ ì—­ì§ë ¬í™”
     */
    @SuppressWarnings("unchecked")
    private void readObject(ObjectInputStream ois)
            throws IOException, ClassNotFoundException {
        ois.defaultReadObject();

        // ìŠ¤ëƒ…ìƒ· ë³µì›
        userIds = (List<String>) ois.readObject();

        System.out.println("âœ… ìŠ¤ëƒ…ìƒ· ì—­ì§ë ¬í™”: " + userIds.size() + "ê°œ");
    }
}

public class ConcurrentSerializationExample {
    public static void main(String[] args) throws Exception {
        String fileName = "snapshot_cache.ser";

        // ìŠ¤ëƒ…ìƒ· ë°©ì‹ í…ŒìŠ¤íŠ¸
        System.out.println("=== ìŠ¤ëƒ…ìƒ· ë°©ì‹ ===");
        SnapshotUserCache cache = new SnapshotUserCache();
        cache.addUser("user1");
        cache.addUser("user2");

        // ì§ë ¬í™”
        try (ObjectOutputStream oos = new ObjectOutputStream(
                new FileOutputStream(fileName))) {
            oos.writeObject(cache);
        }

        // ì§ë ¬í™” í›„ì—ë„ ìˆ˜ì • ê°€ëŠ¥
        cache.addUser("user3");
        System.out.println("ì§ë ¬í™” í›„ ì¶”ê°€: user3 (ìŠ¤ëƒ…ìƒ·ì—ëŠ” ì˜í–¥ ì—†ìŒ)");

        // ì—­ì§ë ¬í™” (ìŠ¤ëƒ…ìƒ· ë³µì›)
        try (ObjectInputStream ois = new ObjectInputStream(
                new FileInputStream(fileName))) {
            SnapshotUserCache restored = (SnapshotUserCache) ois.readObject();
            System.out.println("ë³µì›ëœ ì‚¬ìš©ì: " + restored.userIds.size() + "ëª… (user3 ì—†ìŒ)");
        }
    }
}
```

**ì‹¤í–‰ ê²°ê³¼**:
```
=== ìŠ¤ëƒ…ìƒ· ë°©ì‹ ===
âœ… ìŠ¤ëƒ…ìƒ· ì§ë ¬í™”: 2ê°œ
ì§ë ¬í™” í›„ ì¶”ê°€: user3 (ìŠ¤ëƒ…ìƒ·ì—ëŠ” ì˜í–¥ ì—†ìŒ)
âœ… ìŠ¤ëƒ…ìƒ· ì—­ì§ë ¬í™”: 2ê°œ
ë³µì›ëœ ì‚¬ìš©ì: 2ëª… (user3 ì—†ìŒ)
```

**ë°°ìš´ ì **:
- ğŸ’¡ **ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œëŠ” ë™ê¸°í™” í•„ìˆ˜**: `synchronized` ë˜ëŠ” `Collections.synchronizedList`
- ğŸ’¡ **ë°©ì–´ì  ë³µì‚¬**: ì§ë ¬í™” ì‹œ ìŠ¤ëƒ…ìƒ· ìƒì„±ìœ¼ë¡œ ì›ë³¸ ë³´í˜¸
- ğŸ’¡ **ë¶ˆë³€ ê°ì²´ ì„ í˜¸**: `List.copyOf()` (Java 10+)ë¡œ ë¶ˆë³€ ë¦¬ìŠ¤íŠ¸ ìƒì„±
- ğŸ’¡ **ì‹¤ë¬´ íŒ**:
  - ì½ê¸° ì „ìš©: `Collections.unmodifiableList()`
  - ì“°ê¸° ë§ìŒ: `CopyOnWriteArrayList` (ì§ë ¬í™” ê°€ëŠ¥)

---

## ğŸ”— ê´€ë ¨ ê¸°ìˆ 

| ê¸°ìˆ  | ê´€ê³„ | í•™ìŠµ ìš°ì„ ìˆœìœ„ |
|------|------|---------------|
| JSON (Jackson, Gson) | ëŒ€ì•ˆ ì§ë ¬í™” | â­â­â­â­â­ |
| Protobuf | ê³ ì„±ëŠ¥ ì§ë ¬í™” | â­â­â­â­ |
| Externalizable | ì™„ì „ ì»¤ìŠ¤í…€ | â­â­â­ |
| Redis | ê°ì²´ ì €ì¥ | â­â­â­â­â­ |
| JPA | ORM ì§ë ¬í™” | â­â­â­â­ |

---

**ë‹¤ìŒ Partì—ì„œ ê³„ì†**: [38-3: ë©´ì ‘ ì§ˆë¬¸ ë° JSON ë¹„êµ â†’](38-3-ì§ë ¬í™”ì™€-ì—­ì§ë ¬í™”-Part3.md)

**ì´ì „ Part**: [â† 38-1: ì§ë ¬í™” ê¸°ì´ˆ](38-1-ì§ë ¬í™”ì™€-ì—­ì§ë ¬í™”-Part1.md)

**ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°**: [ğŸ“š ì „ì²´ ëª©ì°¨](README.md)
