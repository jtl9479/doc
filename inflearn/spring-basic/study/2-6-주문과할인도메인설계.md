# 2-6. ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ì„¤ê³„

## í•™ìŠµ ëª©í‘œ
- ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ì˜ ìš”êµ¬ì‚¬í•­ì„ ë¶„ì„í•œë‹¤
- ì—­í• ê³¼ êµ¬í˜„ì„ ë¶„ë¦¬í•œ ìœ ì—°í•œ ì„¤ê³„ë¥¼ í•™ìŠµí•œë‹¤
- í• ì¸ ì •ì±…ì˜ ë‹¤í˜•ì„±ì„ ì´í•´í•œë‹¤
- í˜‘ë ¥, ì—­í• , ì±…ì„ ê´€ì ì—ì„œ ë„ë©”ì¸ì„ ì„¤ê³„í•œë‹¤

## ì—°ê´€ ê°œë…
- **Strategy Pattern**: ì•Œê³ ë¦¬ì¦˜ì„ ìº¡ìŠí™”í•˜ì—¬ êµì²´ ê°€ëŠ¥í•˜ê²Œ ë§Œë“œëŠ” íŒ¨í„´
- **ë‹¤í˜•ì„±(Polymorphism)**: í•˜ë‚˜ì˜ ì¸í„°í˜ì´ìŠ¤ë¡œ ì—¬ëŸ¬ êµ¬í˜„ì²´ ì‚¬ìš©
- **SRP(ë‹¨ì¼ ì±…ì„ ì›ì¹™)**: ê° í´ë˜ìŠ¤ëŠ” í•˜ë‚˜ì˜ ì±…ì„ë§Œ ê°€ì§
- **OCP(ê°œë°©-íì‡„ ì›ì¹™)**: í™•ì¥ì—ëŠ” ì—´ë ¤ìˆê³  ë³€ê²½ì—ëŠ” ë‹«í˜€ìˆìŒ

---

## TL;DR (ê°„ë‹¨ ìš”ì•½)

### ì£¼ë¬¸ê³¼ í• ì¸ ìš”êµ¬ì‚¬í•­
- íšŒì›ì€ ìƒí’ˆì„ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤
- íšŒì› ë“±ê¸‰ì— ë”°ë¼ í• ì¸ ì •ì±… ì ìš©
- **ê³ ì • ê¸ˆì•¡ í• ì¸**: VIPëŠ” 1000ì› í• ì¸ (í˜„ì¬ ì •ì±…)
- **í• ì¸ ì •ì±…ì€ ë³€ê²½ ê°€ëŠ¥ì„± ë†’ìŒ** (ë¯¸í™•ì •)

### ì„¤ê³„ ì „ëµ
```
1. ì£¼ë¬¸ ì„œë¹„ìŠ¤: ì£¼ë¬¸ ìƒì„± ë° í• ì¸ ì ìš©
2. í• ì¸ ì •ì±…: ì¸í„°í˜ì´ìŠ¤ë¡œ ì¶”ìƒí™”
3. êµ¬í˜„ì²´: FixDiscountPolicy(ê³ ì •), RateDiscountPolicy(ì •ë¥ )
4. ì—­í•  ë¶„ë¦¬: ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” í• ì¸ ì •ì±… ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´
```

### í˜‘ë ¥ íë¦„
```
í´ë¼ì´ì–¸íŠ¸ â†’ ì£¼ë¬¸ ì„œë¹„ìŠ¤ â†’ íšŒì› ì €ì¥ì†Œ (íšŒì› ì¡°íšŒ)
                      â†“
                  í• ì¸ ì •ì±… (í• ì¸ ê¸ˆì•¡ ê³„ì‚°)
                      â†“
                  ì£¼ë¬¸ ê²°ê³¼ ë°˜í™˜
```

---

## ì£¼ë¬¸ê³¼ í• ì¸ ì •ì±… ìš”êµ¬ì‚¬í•­

### ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­
```
1. íšŒì›ì€ ìƒí’ˆì„ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤
2. íšŒì› ë“±ê¸‰ì— ë”°ë¼ í• ì¸ ì •ì±…ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤
3. í• ì¸ ì •ì±…ì€ ëª¨ë“  VIPëŠ” 1000ì›ì„ í• ì¸í•´ì£¼ëŠ” ê³ ì • ê¸ˆì•¡ í• ì¸ì„ ì ìš© (ë³€ê²½ ê°€ëŠ¥)
4. í• ì¸ ì •ì±…ì€ ë³€ê²½ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤
   - íšŒì‚¬ì˜ ê¸°ë³¸ í• ì¸ ì •ì±…ì„ ì•„ì§ ì •í•˜ì§€ ëª»í–ˆìŒ
   - ì˜¤í”ˆ ì§ì „ê¹Œì§€ ê³ ë¯¼ì„ ë¯¸ë£¨ê³  ì‹¶ìŒ
   - ìµœì•…ì˜ ê²½ìš° í• ì¸ì„ ì ìš©í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆìŒ (ë¯¸í™•ì •)
```

### ë¶ˆí™•ì‹¤ì„± ëŒ€ì‘ ì „ëµ
```
ë¯¸í™•ì • ì‚¬í•­:
- í• ì¸ ì •ì±…ì´ í™•ì •ë˜ì§€ ì•ŠìŒ
- ê³ ì • ê¸ˆì•¡ í• ì¸? ì •ë¥  í• ì¸? í• ì¸ ì—†ìŒ?

í•´ê²°ì±…:
ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ê³  êµ¬í˜„ì²´ë¥¼ ì–¸ì œë“ ì§€ ê°ˆì•„ë¼ìš¸ ìˆ˜ ìˆë„ë¡ ì„¤ê³„
â†’ ì •ì±…ì´ ê²°ì •ë  ë•Œê¹Œì§€ ê°œë°œì„ ê¸°ë‹¤ë¦¬ì§€ ì•ŠìŒ!
```

---

## ì£¼ë¬¸ ë„ë©”ì¸ í˜‘ë ¥, ì—­í• , ì±…ì„

```mermaid
graph TD
    A[í´ë¼ì´ì–¸íŠ¸] -->|1. ì£¼ë¬¸ ìƒì„± ìš”ì²­<br/>íšŒì›ID, ìƒí’ˆëª…, ê°€ê²©| B[ì£¼ë¬¸ ì„œë¹„ìŠ¤ ì—­í• ]
    B -->|2. íšŒì› ì¡°íšŒ| C[íšŒì› ì €ì¥ì†Œ ì—­í• ]
    C -->|íšŒì› ì •ë³´ ë°˜í™˜| B
    B -->|3. í• ì¸ ì ìš©<br/>íšŒì›, ê°€ê²©| D[í• ì¸ ì •ì±… ì—­í• ]
    D -->|í• ì¸ ê¸ˆì•¡ ë°˜í™˜| B
    B -->|4. ì£¼ë¬¸ ê²°ê³¼ ë°˜í™˜| A

    style B fill:#ffe6e6
    style C fill:#e6f3ff
    style D fill:#fff4e6
```

### í˜‘ë ¥ íë¦„ ìƒì„¸ ì„¤ëª…

#### 1. ì£¼ë¬¸ ìƒì„±
```
í´ë¼ì´ì–¸íŠ¸ê°€ ì£¼ë¬¸ ì„œë¹„ìŠ¤ì— ì£¼ë¬¸ ìƒì„± ìš”ì²­
- íšŒì› ID
- ìƒí’ˆëª…
- ìƒí’ˆ ê°€ê²©
```

#### 2. íšŒì› ì¡°íšŒ
```
í• ì¸ì„ ìœ„í•´ì„œëŠ” íšŒì› ë“±ê¸‰ì´ í•„ìš”
â†’ ì£¼ë¬¸ ì„œë¹„ìŠ¤ê°€ íšŒì› ì €ì¥ì†Œì—ì„œ íšŒì› ì¡°íšŒ
```

#### 3. í• ì¸ ì ìš©
```
ì£¼ë¬¸ ì„œë¹„ìŠ¤ê°€ íšŒì› ë“±ê¸‰ì— ë”°ë¥¸ í• ì¸ ì—¬ë¶€ë¥¼ í• ì¸ ì •ì±…ì— ìœ„ì„
â†’ í• ì¸ ì •ì±…ì´ í• ì¸ ê¸ˆì•¡ ê³„ì‚°
```

#### 4. ì£¼ë¬¸ ê²°ê³¼ ë°˜í™˜
```
ì£¼ë¬¸ ì„œë¹„ìŠ¤ê°€ í• ì¸ ê²°ê³¼ë¥¼ í¬í•¨í•œ ì£¼ë¬¸ ê²°ê³¼ ë°˜í™˜
â†’ ì‹¤ì œë¡œëŠ” DB ì €ì¥ì´ í•„ìš”í•˜ì§€ë§Œ ì˜ˆì œì—ì„œëŠ” ìƒëµ
```

---

## ì£¼ë¬¸ ë„ë©”ì¸ ì „ì²´ êµ¬ì¡°

```mermaid
graph TB
    A[í´ë¼ì´ì–¸íŠ¸] -->|ì£¼ë¬¸ ìƒì„±| B[ì£¼ë¬¸ ì„œë¹„ìŠ¤ ì—­í• ]

    B -->|íšŒì› ì¡°íšŒ| C[íšŒì› ì €ì¥ì†Œ ì—­í• ]
    C -.êµ¬í˜„ì²´ ì„ íƒ.-> D[ë©”ëª¨ë¦¬<br/>íšŒì› ì €ì¥ì†Œ]
    C -.êµ¬í˜„ì²´ ì„ íƒ.-> E[DB<br/>íšŒì› ì €ì¥ì†Œ]

    B -->|í• ì¸ ê³„ì‚°| F[í• ì¸ ì •ì±… ì—­í• ]
    F -.êµ¬í˜„ì²´ ì„ íƒ.-> G[ì •ì•¡<br/>í• ì¸ ì •ì±…]
    F -.êµ¬í˜„ì²´ ì„ íƒ.-> H[ì •ë¥ <br/>í• ì¸ ì •ì±…]

    style B fill:#ffe6e6
    style C fill:#e6f3ff
    style D fill:#e8f5e9
    style E fill:#e8f5e9
    style F fill:#fff4e6
    style G fill:#fce4ec
    style H fill:#fce4ec
```

### ì—­í• ê³¼ êµ¬í˜„ì˜ ë¶„ë¦¬

**ì—­í•  (ì¸í„°í˜ì´ìŠ¤)**
- ì£¼ë¬¸ ì„œë¹„ìŠ¤: `OrderService`
- íšŒì› ì €ì¥ì†Œ: `MemberRepository`
- í• ì¸ ì •ì±…: `DiscountPolicy`

**êµ¬í˜„ (êµ¬í˜„ì²´)**
- íšŒì› ì €ì¥ì†Œ: `MemoryMemberRepository`, `DbMemberRepository`
- í• ì¸ ì •ì±…: `FixDiscountPolicy`, `RateDiscountPolicy`

**ì¥ì **
```
íšŒì› ì €ì¥ì†ŒëŠ” ë¬¼ë¡ ì´ê³ , í• ì¸ ì •ì±…ë„ ìœ ì—°í•˜ê²Œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤
â†’ ì£¼ë¬¸ ì„œë¹„ìŠ¤ ì½”ë“œ ë³€ê²½ ì—†ì´ êµ¬í˜„ì²´ë§Œ êµì²´
â†’ OCP(ê°œë°©-íì‡„ ì›ì¹™) ì¤€ìˆ˜
```

---

## ì£¼ë¬¸ ë„ë©”ì¸ í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

```mermaid
classDiagram
    class OrderService {
        <<interface>>
        +createOrder(memberId, itemName, itemPrice) Order
    }

    class OrderServiceImpl {
        -MemberRepository memberRepository
        -DiscountPolicy discountPolicy
        +createOrder(memberId, itemName, itemPrice) Order
    }

    class DiscountPolicy {
        <<interface>>
        +discount(Member, price) int
    }

    class FixDiscountPolicy {
        -int discountFixAmount
        +discount(Member, price) int
    }

    class RateDiscountPolicy {
        -int discountPercent
        +discount(Member, price) int
    }

    class Order {
        -Long memberId
        -String itemName
        -int itemPrice
        -int discountPrice
        +calculatePrice() int
    }

    class MemberRepository {
        <<interface>>
        +save(Member)
        +findById(Long) Member
    }

    OrderService <|.. OrderServiceImpl : implements
    DiscountPolicy <|.. FixDiscountPolicy : implements
    DiscountPolicy <|.. RateDiscountPolicy : implements
    OrderServiceImpl --> MemberRepository : uses
    OrderServiceImpl --> DiscountPolicy : uses
    OrderServiceImpl ..> Order : creates
```

### í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ ì„¤ëª…

#### í•µì‹¬ ì¸í„°í˜ì´ìŠ¤
1. **OrderService**: ì£¼ë¬¸ ìƒì„± ì—­í• 
2. **DiscountPolicy**: í• ì¸ ì •ì±… ì—­í• 
3. **MemberRepository**: íšŒì› ì €ì¥ì†Œ ì—­í•  (ì¬ì‚¬ìš©)

#### êµ¬í˜„ í´ë˜ìŠ¤
1. **OrderServiceImpl**: ì£¼ë¬¸ ì„œë¹„ìŠ¤ êµ¬í˜„
2. **FixDiscountPolicy**: ê³ ì • ê¸ˆì•¡ í• ì¸ (1000ì›)
3. **RateDiscountPolicy**: ì •ë¥  í• ì¸ (10%)
4. **Order**: ì£¼ë¬¸ ê²°ê³¼ ì—”í‹°í‹°

---

## ì£¼ë¬¸ ë„ë©”ì¸ ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨

### ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨ 1 - ë©”ëª¨ë¦¬ ì €ì¥ì†Œ + ì •ì•¡ í• ì¸

```mermaid
graph LR
    A[í´ë¼ì´ì–¸íŠ¸] -->|ì‚¬ìš©| B[ì£¼ë¬¸ ì„œë¹„ìŠ¤ êµ¬í˜„ì²´<br/>OrderServiceImpl]
    B -->|ì˜ì¡´| C[ë©”ëª¨ë¦¬<br/>íšŒì› ì €ì¥ì†Œ<br/>MemoryMemberRepository]
    B -->|ì˜ì¡´| D[ì •ì•¡ í• ì¸ ì •ì±…<br/>FixDiscountPolicy]

    style B fill:#ffe6e6
    style C fill:#e8f5e9
    style D fill:#fce4ec
```

**íŠ¹ì§•**
- ë©”ëª¨ë¦¬ì—ì„œ íšŒì› ì¡°íšŒ
- ì •ì•¡ í• ì¸ ì •ì±… (VIPëŠ” 1000ì› í• ì¸)
- ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” ë³€ê²½ ì—†ìŒ

---

### ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨ 2 - DB ì €ì¥ì†Œ + ì •ë¥  í• ì¸

```mermaid
graph LR
    A[í´ë¼ì´ì–¸íŠ¸] -->|ì‚¬ìš©| B[ì£¼ë¬¸ ì„œë¹„ìŠ¤ êµ¬í˜„ì²´<br/>OrderServiceImpl]
    B -->|ì˜ì¡´| C[DB<br/>íšŒì› ì €ì¥ì†Œ<br/>DbMemberRepository]
    B -->|ì˜ì¡´| D[ì •ë¥  í• ì¸ ì •ì±…<br/>RateDiscountPolicy]

    style B fill:#ffe6e6
    style C fill:#e3f2fd
    style D fill:#fff9c4
```

**íŠ¹ì§•**
- ì‹¤ì œ DBì—ì„œ íšŒì› ì¡°íšŒ
- ì •ë¥  í• ì¸ ì •ì±… (VIPëŠ” 10% í• ì¸)
- **ì£¼ë¬¸ ì„œë¹„ìŠ¤ ì½”ë“œëŠ” ë³€ê²½í•˜ì§€ ì•ŠìŒ!**
- ì—­í• ë“¤ì˜ í˜‘ë ¥ ê´€ê³„ë¥¼ ê·¸ëŒ€ë¡œ ì¬ì‚¬ìš©

---

## ì‹¬í™” ë‚´ìš©

### 1. Strategy Pattern (ì „ëµ íŒ¨í„´)

í• ì¸ ì •ì±…ì€ ì „ëµ íŒ¨í„´ì˜ ëŒ€í‘œì ì¸ ì˜ˆì…ë‹ˆë‹¤.

```java
// ì „ëµ ì¸í„°í˜ì´ìŠ¤
public interface DiscountPolicy {
    int discount(Member member, int price);
}

// ì „ëµ 1: ê³ ì • ê¸ˆì•¡ í• ì¸
public class FixDiscountPolicy implements DiscountPolicy {
    private int discountFixAmount = 1000;

    @Override
    public int discount(Member member, int price) {
        if (member.getGrade() == Grade.VIP) {
            return discountFixAmount;
        }
        return 0;
    }
}

// ì „ëµ 2: ì •ë¥  í• ì¸
public class RateDiscountPolicy implements DiscountPolicy {
    private int discountPercent = 10;

    @Override
    public int discount(Member member, int price) {
        if (member.getGrade() == Grade.VIP) {
            return price * discountPercent / 100;
        }
        return 0;
    }
}

// ì»¨í…ìŠ¤íŠ¸ (ì „ëµì„ ì‚¬ìš©í•˜ëŠ” í´ë˜ìŠ¤)
public class OrderServiceImpl implements OrderService {
    private final DiscountPolicy discountPolicy;

    // ì „ëµ ì£¼ì…
    public OrderServiceImpl(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        // ...
        int discountPrice = discountPolicy.discount(member, itemPrice);
        // ...
    }
}
```

### 2. ë‹¨ì¼ ì±…ì„ ì›ì¹™ (SRP)

ê° í´ë˜ìŠ¤ëŠ” í•˜ë‚˜ì˜ ì±…ì„ë§Œ ê°€ì§‘ë‹ˆë‹¤.

```
OrderService: ì£¼ë¬¸ ìƒì„± ì±…ì„
  - íšŒì› ì¡°íšŒëŠ” MemberRepositoryì— ìœ„ì„
  - í• ì¸ ê³„ì‚°ì€ DiscountPolicyì— ìœ„ì„
  - ìì‹ ì€ ì£¼ë¬¸ ìƒì„± ë¡œì§ë§Œ ë‹´ë‹¹

DiscountPolicy: í• ì¸ ê³„ì‚° ì±…ì„
  - íšŒì› ë“±ê¸‰ì— ë”°ë¥¸ í• ì¸ ê¸ˆì•¡ ê³„ì‚°
  - í• ì¸ ì •ì±… ë³€ê²½ ì‹œ ì´ í´ë˜ìŠ¤ë§Œ ìˆ˜ì •

MemberRepository: íšŒì› ë°ì´í„° ê´€ë¦¬ ì±…ì„
  - íšŒì› ì €ì¥ê³¼ ì¡°íšŒë§Œ ë‹´ë‹¹
```

### 3. ê°œë°©-íì‡„ ì›ì¹™ (OCP)

```java
// âœ… í™•ì¥ì—ëŠ” ì—´ë ¤ìˆìŒ - ìƒˆë¡œìš´ í• ì¸ ì •ì±… ì¶”ê°€
public class SeasonDiscountPolicy implements DiscountPolicy {
    @Override
    public int discount(Member member, int price) {
        // ê³„ì ˆë³„ í• ì¸ ë¡œì§
        return price * 20 / 100;
    }
}

// âœ… ë³€ê²½ì—ëŠ” ë‹«í˜€ìˆìŒ - OrderServiceImpl ì½”ë“œëŠ” ë³€ê²½ ì—†ìŒ
OrderService orderService = new OrderServiceImpl(
    new MemberRepository(),
    new SeasonDiscountPolicy()  // ìƒˆë¡œìš´ ì •ì±…ìœ¼ë¡œ êµì²´
);
```

---

## Tip

### ì—­í• ê³¼ êµ¬í˜„ ë¶„ë¦¬ ê¸°ì¤€
```
ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ì–´ì•¼ í•˜ëŠ” ê²½ìš°:
1. ë³€ê²½ ê°€ëŠ¥ì„±ì´ ìˆëŠ” ê²½ìš° (í• ì¸ ì •ì±…, ì €ì¥ì†Œ)
2. ë‹¤í˜•ì„±ì´ í•„ìš”í•œ ê²½ìš°
3. í…ŒìŠ¤íŠ¸ ì‹œ Mockì´ í•„ìš”í•œ ê²½ìš°

êµ¬ì²´ í´ë˜ìŠ¤ë§Œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°:
1. ë³€ê²½ ê°€ëŠ¥ì„±ì´ ê±°ì˜ ì—†ëŠ” ê²½ìš°
2. ë‹¨ìˆœí•œ VO(Value Object)ë‚˜ ì—”í‹°í‹°
```

### ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨ í™œìš©
```
- í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨: ëª¨ë“  ê°€ëŠ¥ì„± í‘œí˜„
- ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨: íŠ¹ì • ì‹œì ì˜ ì‹¤ì œ ì¸ìŠ¤í„´ìŠ¤
â†’ ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨ìœ¼ë¡œ ëŸ°íƒ€ì„ ë™ì‘ ì´í•´
```

### í˜‘ë ¥ ì„¤ê³„ ì‹œ ê³ ë ¤ì‚¬í•­
```
1. ì—­í•  ë¨¼ì € ì •ì˜ (ì¸í„°í˜ì´ìŠ¤)
2. ì±…ì„ ë¶„ë¦¬ (SRP)
3. ì˜ì¡´ ë°©í–¥ ê³ ë ¤ (DIP)
4. í™•ì¥ ê°€ëŠ¥ì„± (OCP)
```

---

## ì£¼ì˜ì‚¬í•­

### 1. ê³¼ë„í•œ ì¶”ìƒí™” ì§€ì–‘
```java
// âŒ ë¶ˆí•„ìš”í•œ ì¸í„°í˜ì´ìŠ¤
public interface Order {
    int calculatePrice();
}

public class OrderImpl implements Order {
    // Order ì—”í‹°í‹°ëŠ” ë³€ê²½ ê°€ëŠ¥ì„±ì´ ê±°ì˜ ì—†ìŒ
    // ì¸í„°í˜ì´ìŠ¤ê°€ ë¶ˆí•„ìš”
}

// âœ… ê°„ë‹¨í•œ ì—”í‹°í‹°ëŠ” êµ¬ì²´ í´ë˜ìŠ¤ë§Œ
public class Order {
    private Long memberId;
    private String itemName;
    private int itemPrice;
    private int discountPrice;

    public int calculatePrice() {
        return itemPrice - discountPrice;
    }
}
```

### 2. í• ì¸ ì •ì±…ì˜ null ì²˜ë¦¬
```java
// í• ì¸ì„ ì ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°
public class NoDiscountPolicy implements DiscountPolicy {
    @Override
    public int discount(Member member, int price) {
        return 0;  // í• ì¸ ì—†ìŒ
    }
}

// nullì„ ë°˜í™˜í•˜ì§€ ë§ ê²ƒ!
public class BadDiscountPolicy implements DiscountPolicy {
    @Override
    public int discount(Member member, int price) {
        return null;  // âŒ NullPointerException ë°œìƒ ìœ„í—˜
    }
}
```

### 3. í• ì¸ ì •ì±… ë³€ê²½ ì‹œ ì£¼ì˜
```
í˜„ì¬ ì„¤ê³„ì˜ ë¬¸ì œì  (ë‹¤ìŒ ì±•í„°ì—ì„œ í•´ê²°):
OrderServiceImplì´ êµ¬ì²´ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ìƒì„±
â†’ DIP ìœ„ë°˜
â†’ OCP ìœ„ë°˜ (í• ì¸ ì •ì±… ë³€ê²½ ì‹œ OrderServiceImpl ìˆ˜ì • í•„ìš”)
```

---

## ë©´ì ‘ ì§ˆë¬¸

### ì´ˆê¸‰ - ê°œë… ì´í•´

**Q1. ì£¼ë¬¸ ì„œë¹„ìŠ¤ì—ì„œ í• ì¸ ì •ì±…ì„ ì¸í„°í˜ì´ìŠ¤ë¡œ ì„¤ê³„í•œ ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?**

A: í• ì¸ ì •ì±…ì€ ë³€ê²½ ê°€ëŠ¥ì„±ì´ ë§¤ìš° ë†’ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ìš”êµ¬ì‚¬í•­ì—ì„œ "í• ì¸ ì •ì±…ì´ í™•ì •ë˜ì§€ ì•Šì•˜ê³ , ì˜¤í”ˆ ì§ì „ê¹Œì§€ ê³ ë¯¼ì„ ë¯¸ë£¨ê³  ì‹¶ë‹¤"ê³  ëª…ì‹œë˜ì–´ ìˆìŠµë‹ˆë‹¤.

DiscountPolicy ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ë©´:
1. ê³ ì • ê¸ˆì•¡ í• ì¸ (FixDiscountPolicy)
2. ì •ë¥  í• ì¸ (RateDiscountPolicy)
3. í• ì¸ ì—†ìŒ (NoDiscountPolicy)
ë“± ë‹¤ì–‘í•œ êµ¬í˜„ì²´ë¡œ ì‰½ê²Œ êµì²´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```java
// ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´
public class OrderServiceImpl implements OrderService {
    private final DiscountPolicy discountPolicy;

    // êµ¬í˜„ì²´ëŠ” ì™¸ë¶€ì—ì„œ ì£¼ì… (ìœ ì—°ì„±)
    public OrderServiceImpl(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }
}
```

**Q2. ì£¼ë¬¸ ë„ë©”ì¸ì˜ í˜‘ë ¥ íë¦„ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”.**

A: ì£¼ë¬¸ ë„ë©”ì¸ì€ 4ë‹¨ê³„ë¡œ í˜‘ë ¥í•©ë‹ˆë‹¤:

1. **ì£¼ë¬¸ ìƒì„± ìš”ì²­**: í´ë¼ì´ì–¸íŠ¸ê°€ ì£¼ë¬¸ ì„œë¹„ìŠ¤ì— íšŒì›ID, ìƒí’ˆëª…, ê°€ê²© ì „ë‹¬
2. **íšŒì› ì¡°íšŒ**: ì£¼ë¬¸ ì„œë¹„ìŠ¤ê°€ íšŒì› ì €ì¥ì†Œì—ì„œ íšŒì› ì •ë³´ ì¡°íšŒ (í• ì¸ì„ ìœ„í•´ ë“±ê¸‰ í•„ìš”)
3. **í• ì¸ ì ìš©**: ì£¼ë¬¸ ì„œë¹„ìŠ¤ê°€ í• ì¸ ì •ì±…ì— íšŒì›ê³¼ ê°€ê²©ì„ ì „ë‹¬í•˜ì—¬ í• ì¸ ê¸ˆì•¡ ê³„ì‚°
4. **ì£¼ë¬¸ ê²°ê³¼ ë°˜í™˜**: ì£¼ë¬¸ ì„œë¹„ìŠ¤ê°€ í• ì¸ì´ ì ìš©ëœ ì£¼ë¬¸ ê²°ê³¼ë¥¼ í´ë¼ì´ì–¸íŠ¸ì— ë°˜í™˜

í•µì‹¬ì€ **ì£¼ë¬¸ ì„œë¹„ìŠ¤ê°€ ì§ì ‘ í• ì¸ì„ ê³„ì‚°í•˜ì§€ ì•Šê³  í• ì¸ ì •ì±…ì— ìœ„ì„**í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.

### ì¤‘ê¸‰ - ì„¤ê³„ ì›ì¹™

**Q3. í˜„ì¬ ì„¤ê³„ê°€ ì–´ë–»ê²Œ OCP(ê°œë°©-íì‡„ ì›ì¹™)ë¥¼ ì¤€ìˆ˜í•˜ë‚˜ìš”?**

A: OCPëŠ” "í™•ì¥ì—ëŠ” ì—´ë ¤ìˆê³ , ë³€ê²½ì—ëŠ” ë‹«í˜€ìˆì–´ì•¼ í•œë‹¤"ëŠ” ì›ì¹™ì…ë‹ˆë‹¤.

**í™•ì¥ì— ì—´ë ¤ìˆìŒ:**
```java
// ìƒˆë¡œìš´ í• ì¸ ì •ì±… ì¶”ê°€ ê°€ëŠ¥
public class SeasonDiscountPolicy implements DiscountPolicy {
    @Override
    public int discount(Member member, int price) {
        // ê³„ì ˆë³„ í• ì¸ ë¡œì§
        return price * 20 / 100;
    }
}

public class VipOnlyDiscountPolicy implements DiscountPolicy {
    @Override
    public int discount(Member member, int price) {
        if (member.getGrade() == Grade.VIP) {
            return price * 15 / 100;
        }
        return 0;
    }
}
```

**ë³€ê²½ì— ë‹«í˜€ìˆìŒ:**
```java
// OrderServiceImpl ì½”ë“œëŠ” ìˆ˜ì •í•˜ì§€ ì•Šì•„ë„ ë¨
public class OrderServiceImpl implements OrderService {
    private final DiscountPolicy discountPolicy;

    // ìƒì„± ì‹œì ì— ì–´ë–¤ ì •ì±…ì„ ì‚¬ìš©í• ì§€ ê²°ì •
    public OrderServiceImpl(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }

    @Override
    public Order createOrder(...) {
        // ì´ ì½”ë“œëŠ” í• ì¸ ì •ì±…ì´ ì¶”ê°€ë˜ì–´ë„ ë³€ê²½ ë¶ˆí•„ìš”
        int discountPrice = discountPolicy.discount(member, itemPrice);
        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

ë‹¤ë§Œ í˜„ì¬ ì½”ë“œì—ëŠ” ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. `new FixDiscountPolicy()`ì²˜ëŸ¼ êµ¬í˜„ì²´ë¥¼ ì§ì ‘ ìƒì„±í•˜ë©´ OCPë¥¼ ìœ„ë°˜í•©ë‹ˆë‹¤. ì´ëŠ” Springì˜ DIë¡œ í•´ê²°í•  ì˜ˆì •ì…ë‹ˆë‹¤.

**Q4. ì£¼ë¬¸ ì„œë¹„ìŠ¤ê°€ SRP(ë‹¨ì¼ ì±…ì„ ì›ì¹™)ë¥¼ ì–´ë–»ê²Œ ì¤€ìˆ˜í•˜ë‚˜ìš”?**

A: OrderServiceImplì€ "ì£¼ë¬¸ ìƒì„±"ì´ë¼ëŠ” í•˜ë‚˜ì˜ ì±…ì„ë§Œ ê°€ì§‘ë‹ˆë‹¤.

**ì±…ì„ ë¶„ë¦¬:**
```java
public class OrderServiceImpl implements OrderService {
    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        // 1. íšŒì› ì¡°íšŒ - MemberRepositoryì— ìœ„ì„
        Member member = memberRepository.findById(memberId);

        // 2. í• ì¸ ê³„ì‚° - DiscountPolicyì— ìœ„ì„
        int discountPrice = discountPolicy.discount(member, itemPrice);

        // 3. ì£¼ë¬¸ ìƒì„± - OrderServiceImplì˜ ì±…ì„
        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

**ê° í´ë˜ìŠ¤ì˜ ì±…ì„:**
- `OrderServiceImpl`: ì£¼ë¬¸ ë¡œì§ ì¡°ìœ¨
- `MemberRepository`: íšŒì› ë°ì´í„° ê´€ë¦¬
- `DiscountPolicy`: í• ì¸ ê¸ˆì•¡ ê³„ì‚°
- `Order`: ì£¼ë¬¸ ë°ì´í„° ë³´ê´€

ë§Œì•½ í• ì¸ ì •ì±…ì´ ë³€ê²½ë˜ì–´ë„ `DiscountPolicy` êµ¬í˜„ì²´ë§Œ ìˆ˜ì •í•˜ë©´ ë˜ê³ , `OrderServiceImpl`ì€ ìˆ˜ì •í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤. ì´ê²ƒì´ SRPì˜ í•µì‹¬ì…ë‹ˆë‹¤.

**SRP ìœ„ë°˜ ì˜ˆì‹œ:**
```java
// âŒ SRP ìœ„ë°˜: OrderServiceImplì´ í• ì¸ ê³„ì‚°ê¹Œì§€ ë‹´ë‹¹
public class BadOrderServiceImpl implements OrderService {
    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);

        // í• ì¸ ë¡œì§ì´ OrderServiceImplì— ì§ì ‘ êµ¬í˜„ë¨
        int discountPrice = 0;
        if (member.getGrade() == Grade.VIP) {
            discountPrice = 1000;  // í• ì¸ ì •ì±… ë³€ê²½ ì‹œ ì—¬ê¸°ë¥¼ ìˆ˜ì •í•´ì•¼ í•¨
        }

        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

### ê³ ê¸‰ - ì•„í‚¤í…ì²˜ ì„¤ê³„

**Q5. ì£¼ë¬¸ ë„ë©”ì¸ì„ ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ë¡œ ì¬ì„¤ê³„í•œë‹¤ë©´ ì–´ë–»ê²Œ êµ¬ì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?**

A: ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜(Event-Driven Architecture)ë¡œ ì¬ì„¤ê³„í•˜ë©´ ê° ë„ë©”ì¸ ê°„ì˜ ê²°í•©ë„ë¥¼ ë‚®ì¶”ê³ , í™•ì¥ì„±ê³¼ ìœ ì—°ì„±ì„ ë†’ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### í˜„ì¬ ì„¤ê³„ì˜ ë¬¸ì œì 

```java
// ë™ê¸°ì‹ í˜¸ì¶œ - ê°•í•œ ê²°í•©
public class OrderServiceImpl implements OrderService {
    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;
    private final EmailService emailService;  // ì´ë©”ì¼ ë°œì†¡
    private final PointService pointService;  // í¬ì¸íŠ¸ ì ë¦½
    private final InventoryService inventoryService;  // ì¬ê³  ì°¨ê°

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        // 1. íšŒì› ì¡°íšŒ
        Member member = memberRepository.findById(memberId);

        // 2. í• ì¸ ê³„ì‚°
        int discountPrice = discountPolicy.discount(member, itemPrice);

        // 3. ì£¼ë¬¸ ìƒì„±
        Order order = new Order(memberId, itemName, itemPrice, discountPrice);

        // 4. ì´ë©”ì¼ ë°œì†¡ (ë™ê¸°)
        emailService.sendOrderConfirmation(order);

        // 5. í¬ì¸íŠ¸ ì ë¦½ (ë™ê¸°)
        pointService.addPoints(memberId, itemPrice);

        // 6. ì¬ê³  ì°¨ê° (ë™ê¸°)
        inventoryService.decreaseStock(itemName);

        return order;  // ëª¨ë“  ì²˜ë¦¬ê°€ ëë‚˜ì•¼ ë°˜í™˜
    }
}
```

**ë¬¸ì œì :**
1. ëª¨ë“  ì²˜ë¦¬ê°€ ë™ê¸°ì‹ìœ¼ë¡œ ì§„í–‰ â†’ ëŠë¦° ì‘ë‹µ ì‹œê°„
2. í•œ ì„œë¹„ìŠ¤ ì¥ì•  ì‹œ ì „ì²´ ì£¼ë¬¸ ì‹¤íŒ¨
3. ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ ì‹œ OrderServiceImpl ìˆ˜ì • í•„ìš” (OCP ìœ„ë°˜)

#### ì´ë²¤íŠ¸ ê¸°ë°˜ ì„¤ê³„

```mermaid
graph TD
    A[í´ë¼ì´ì–¸íŠ¸] -->|ì£¼ë¬¸ ìš”ì²­| B[OrderService]
    B -->|ì£¼ë¬¸ ìƒì„±| C[Order]
    B -->|ì´ë²¤íŠ¸ ë°œí–‰| D[Event Bus<br/>Message Broker]

    D -->|OrderCreatedEvent| E[EmailService]
    D -->|OrderCreatedEvent| F[PointService]
    D -->|OrderCreatedEvent| G[InventoryService]
    D -->|OrderCreatedEvent| H[NotificationService]

    style B fill:#ffe6e6
    style D fill:#fff4e6
    style E fill:#e6f3ff
    style F fill:#e6f3ff
    style G fill:#e6f3ff
    style H fill:#e6f3ff
```

#### ì½”ë“œ êµ¬í˜„

**1. ì´ë²¤íŠ¸ ì •ì˜**
```java
// ë„ë©”ì¸ ì´ë²¤íŠ¸
public class OrderCreatedEvent {
    private final Long orderId;
    private final Long memberId;
    private final String itemName;
    private final int itemPrice;
    private final int discountPrice;
    private final LocalDateTime createdAt;

    public OrderCreatedEvent(Order order) {
        this.orderId = order.getId();
        this.memberId = order.getMemberId();
        this.itemName = order.getItemName();
        this.itemPrice = order.getItemPrice();
        this.discountPrice = order.getDiscountPrice();
        this.createdAt = LocalDateTime.now();
    }

    // Getters...
}
```

**2. ì´ë²¤íŠ¸ ë°œí–‰ì (Publisher)**
```java
public class OrderServiceImpl implements OrderService {
    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;
    private final OrderRepository orderRepository;
    private final EventPublisher eventPublisher;  // ì´ë²¤íŠ¸ ë°œí–‰

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        // 1. íšŒì› ì¡°íšŒ
        Member member = memberRepository.findById(memberId);

        // 2. í• ì¸ ê³„ì‚°
        int discountPrice = discountPolicy.discount(member, itemPrice);

        // 3. ì£¼ë¬¸ ìƒì„± ë° ì €ì¥
        Order order = new Order(memberId, itemName, itemPrice, discountPrice);
        orderRepository.save(order);

        // 4. ì´ë²¤íŠ¸ ë°œí–‰ (ë¹„ë™ê¸°)
        eventPublisher.publish(new OrderCreatedEvent(order));

        return order;  // ì¦‰ì‹œ ë°˜í™˜ (ë‹¤ë¥¸ ì²˜ë¦¬ë¥¼ ê¸°ë‹¤ë¦¬ì§€ ì•ŠìŒ)
    }
}
```

**3. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (Subscriber)**
```java
// ì´ë©”ì¼ ë°œì†¡ ë¦¬ìŠ¤ë„ˆ
@Component
public class EmailEventListener {

    @Autowired
    private EmailService emailService;

    @EventListener
    @Async  // ë¹„ë™ê¸° ì²˜ë¦¬
    public void handleOrderCreated(OrderCreatedEvent event) {
        emailService.sendOrderConfirmation(
            event.getMemberId(),
            event.getOrderId(),
            event.getItemName()
        );
    }
}

// í¬ì¸íŠ¸ ì ë¦½ ë¦¬ìŠ¤ë„ˆ
@Component
public class PointEventListener {

    @Autowired
    private PointService pointService;

    @EventListener
    @Async
    public void handleOrderCreated(OrderCreatedEvent event) {
        pointService.addPoints(
            event.getMemberId(),
            event.getItemPrice() / 100  // 1% í¬ì¸íŠ¸ ì ë¦½
        );
    }
}

// ì¬ê³  ì°¨ê° ë¦¬ìŠ¤ë„ˆ
@Component
public class InventoryEventListener {

    @Autowired
    private InventoryService inventoryService;

    @EventListener
    @Async
    public void handleOrderCreated(OrderCreatedEvent event) {
        inventoryService.decreaseStock(event.getItemName());
    }
}

// ì•Œë¦¼ ë°œì†¡ ë¦¬ìŠ¤ë„ˆ (ë‚˜ì¤‘ì— ì¶”ê°€)
@Component
public class NotificationEventListener {

    @Autowired
    private NotificationService notificationService;

    @EventListener
    @Async
    public void handleOrderCreated(OrderCreatedEvent event) {
        notificationService.sendPushNotification(
            event.getMemberId(),
            "ì£¼ë¬¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"
        );
    }
}
```

**4. Spring ì´ë²¤íŠ¸ ë°œí–‰ê¸°**
```java
@Component
public class SpringEventPublisher implements EventPublisher {

    @Autowired
    private ApplicationEventPublisher applicationEventPublisher;

    @Override
    public void publish(OrderCreatedEvent event) {
        applicationEventPublisher.publishEvent(event);
    }
}
```

**5. ë©”ì‹œì§€ ë¸Œë¡œì»¤ ì‚¬ìš© (Kafka, RabbitMQ)**
```java
// Kafkaë¥¼ ì‚¬ìš©í•œ ì´ë²¤íŠ¸ ë°œí–‰
@Component
public class KafkaEventPublisher implements EventPublisher {

    @Autowired
    private KafkaTemplate<String, OrderCreatedEvent> kafkaTemplate;

    private static final String TOPIC = "order-created";

    @Override
    public void publish(OrderCreatedEvent event) {
        kafkaTemplate.send(TOPIC, event);
    }
}

// Kafka ë¦¬ìŠ¤ë„ˆ
@Component
public class KafkaOrderEventListener {

    @KafkaListener(topics = "order-created", groupId = "email-service")
    public void handleOrderCreatedForEmail(OrderCreatedEvent event) {
        // ì´ë©”ì¼ ë°œì†¡ ì²˜ë¦¬
    }

    @KafkaListener(topics = "order-created", groupId = "point-service")
    public void handleOrderCreatedForPoint(OrderCreatedEvent event) {
        // í¬ì¸íŠ¸ ì ë¦½ ì²˜ë¦¬
    }
}
```

#### ì¥ì 

1. **ë‚®ì€ ê²°í•©ë„**
```java
// OrderServiceImplì€ ì´ë©”ì¼, í¬ì¸íŠ¸ ë“±ì˜ ì„œë¹„ìŠ¤ë¥¼ ëª¨ë¦„
// ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ ì‹œ ë¦¬ìŠ¤ë„ˆë§Œ ì¶”ê°€í•˜ë©´ ë¨ (OCP ì¤€ìˆ˜)
```

2. **ë†’ì€ í™•ì¥ì„±**
```java
// ìƒˆë¡œìš´ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ë§Œìœ¼ë¡œ ê¸°ëŠ¥ í™•ì¥
@Component
public class SmsEventListener {
    @EventListener
    public void handleOrderCreated(OrderCreatedEvent event) {
        // SMS ë°œì†¡
    }
}
```

3. **ë¹ ë¥¸ ì‘ë‹µ ì‹œê°„**
```java
// ì£¼ë¬¸ ìƒì„± í›„ ì¦‰ì‹œ ì‘ë‹µ
// ì´ë©”ì¼, í¬ì¸íŠ¸ ë“±ì€ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì²˜ë¦¬
```

4. **ì¥ì•  ê²©ë¦¬**
```java
// ì´ë©”ì¼ ì„œë¹„ìŠ¤ ì¥ì• ê°€ ì£¼ë¬¸ ìƒì„±ì— ì˜í–¥ ì—†ìŒ
// ê° ì„œë¹„ìŠ¤ê°€ ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰
```

5. **ì¬ì‹œë„ ë° ë³´ìƒ íŠ¸ëœì­ì…˜**
```java
@Component
public class RobustPointEventListener {

    @Retryable(maxAttempts = 3, backoff = @Backoff(delay = 1000))
    @EventListener
    public void handleOrderCreated(OrderCreatedEvent event) {
        try {
            pointService.addPoints(event.getMemberId(), event.getItemPrice());
        } catch (Exception e) {
            // ì‹¤íŒ¨ ì‹œ ë³´ìƒ ì´ë²¤íŠ¸ ë°œí–‰
            eventPublisher.publish(new PointAdditionFailedEvent(event));
        }
    }
}
```

#### ê³ ë ¤ì‚¬í•­

1. **ì´ë²¤íŠ¸ ìˆœì„œ ë³´ì¥**
```java
// Kafka íŒŒí‹°ì…˜ í‚¤ë¡œ ìˆœì„œ ë³´ì¥
kafkaTemplate.send(TOPIC, event.getMemberId().toString(), event);
```

2. **ë©±ë“±ì„±(Idempotency) ë³´ì¥**
```java
// ì¤‘ë³µ ì´ë²¤íŠ¸ ì²˜ë¦¬ ë°©ì§€
@EventListener
public void handleOrderCreated(OrderCreatedEvent event) {
    if (processedEventRepository.exists(event.getOrderId())) {
        return;  // ì´ë¯¸ ì²˜ë¦¬ëœ ì´ë²¤íŠ¸
    }

    pointService.addPoints(event.getMemberId(), event.getItemPrice());
    processedEventRepository.save(event.getOrderId());
}
```

3. **ë¶„ì‚° íŠ¸ëœì­ì…˜**
```java
// Saga íŒ¨í„´ìœ¼ë¡œ ë¶„ì‚° íŠ¸ëœì­ì…˜ ì²˜ë¦¬
// Choreography Saga
OrderCreated â†’ InventoryReserved â†’ PaymentProcessed â†’ OrderCompleted
             â†“ (ì‹¤íŒ¨ ì‹œ)
             InventoryReservationFailed â†’ OrderCancelled
```

4. **ì´ë²¤íŠ¸ ì†Œì‹± (Event Sourcing)**
```java
// ëª¨ë“  ìƒíƒœ ë³€ê²½ì„ ì´ë²¤íŠ¸ë¡œ ì €ì¥
public class OrderAggregate {
    private List<OrderEvent> events = new ArrayList<>();

    public void createOrder(...) {
        OrderCreatedEvent event = new OrderCreatedEvent(...);
        apply(event);
        events.add(event);
    }

    // ì´ë²¤íŠ¸ ì¬ìƒìœ¼ë¡œ ìƒíƒœ ë³µì›
    public static OrderAggregate rebuild(List<OrderEvent> history) {
        OrderAggregate aggregate = new OrderAggregate();
        history.forEach(aggregate::apply);
        return aggregate;
    }
}
```

---

## ì „ì²´ ìš”ì•½

ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ì„¤ê³„ëŠ” **ì—­í• ê³¼ êµ¬í˜„ì˜ ë¶„ë¦¬**ë¥¼ í†µí•´ ìœ ì—°í•œ êµ¬ì¡°ë¥¼ ë§Œë“­ë‹ˆë‹¤.

### í•µì‹¬ í¬ì¸íŠ¸
1. **í˜‘ë ¥ íë¦„**: ì£¼ë¬¸ ì„œë¹„ìŠ¤ â†’ íšŒì› ì¡°íšŒ â†’ í• ì¸ ê³„ì‚° â†’ ì£¼ë¬¸ ê²°ê³¼
2. **ì—­í•  ë¶„ë¦¬**: OrderService, DiscountPolicy, MemberRepository
3. **ë‹¤í˜•ì„± í™œìš©**: FixDiscountPolicy, RateDiscountPolicy ë“± êµì²´ ê°€ëŠ¥
4. **ì„¤ê³„ ì›ì¹™**: SRP(ë‹¨ì¼ ì±…ì„), OCP(ê°œë°©-íì‡„) ì¤€ìˆ˜

### ì„¤ê³„ì˜ ì¥ì 
```
í• ì¸ ì •ì±… ë³€ê²½ ì‹œ êµ¬í˜„ì²´ë§Œ êµì²´
â†’ OrderServiceImpl ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš”
â†’ ì—­í• ë“¤ì˜ í˜‘ë ¥ ê´€ê³„ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€
```

### ì•„ì§ í•´ê²°ë˜ì§€ ì•Šì€ ë¬¸ì œ
í˜„ì¬ ì„¤ê³„ëŠ” êµ¬í˜„ì²´ë¥¼ ì§ì ‘ ìƒì„±í•˜ë¯€ë¡œ DIPë¥¼ ìœ„ë°˜í•©ë‹ˆë‹¤. ì´ëŠ” ë‹¤ìŒ ì„¹ì…˜ì—ì„œ ì‹¤ì œ ì½”ë“œë¡œ êµ¬í˜„í•˜ë©° í™•ì¸í•˜ê³ , Springì˜ DIë¡œ í•´ê²°í•  ì˜ˆì •ì…ë‹ˆë‹¤.

---

## í•™ìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ì£¼ë¬¸ ë„ë©”ì¸ì˜ í˜‘ë ¥ íë¦„ì„ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤
- [ ] í• ì¸ ì •ì±…ì„ ì¸í„°í˜ì´ìŠ¤ë¡œ ì„¤ê³„í•œ ì´ìœ ë¥¼ ì´í•´í–ˆë‹¤
- [ ] Strategy Patternì„ ì´í•´í–ˆë‹¤
- [ ] ì—­í• ê³¼ êµ¬í˜„ ë¶„ë¦¬ì˜ ì¥ì ì„ ì´í•´í–ˆë‹¤
- [ ] SRPì™€ OCPê°€ ì–´ë–»ê²Œ ì ìš©ë˜ëŠ”ì§€ ì´í•´í–ˆë‹¤

---

## ë‹¤ìŒ í•™ìŠµ
ë‹¤ìŒ ì„¹ì…˜ì—ì„œëŠ” ì„¤ê³„í•œ ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ì„ **ì‹¤ì œ ì½”ë“œë¡œ êµ¬í˜„**í•©ë‹ˆë‹¤.
- DiscountPolicy ì¸í„°í˜ì´ìŠ¤ì™€ FixDiscountPolicy êµ¬í˜„
- Order ì—”í‹°í‹° ì‘ì„±
- OrderService ì¸í„°í˜ì´ìŠ¤ì™€ OrderServiceImpl êµ¬í˜„

**[2-7. ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ê°œë°œ](2-7-ì£¼ë¬¸ê³¼í• ì¸ë„ë©”ì¸ê°œë°œ.md)** ì—ì„œ ê³„ì†ë©ë‹ˆë‹¤.

---

## ğŸ“š ì°¸ê³ ìë£Œ
- [Head First Design Patterns](http://www.yes24.com/Product/Goods/1778966) - Strategy Pattern
- [Clean Architecture - Robert C. Martin](http://www.yes24.com/Product/Goods/77283734) - ì˜ì¡´ì„± ê·œì¹™
- [Domain-Driven Design - Eric Evans](http://www.yes24.com/Product/Goods/5312881) - ë„ë©”ì¸ ëª¨ë¸ë§
- [Implementing Domain-Driven Design - Vaughn Vernon](http://www.yes24.com/Product/Goods/25100510) - ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜
- [Event-Driven Architecture - Martin Fowler](https://martinfowler.com/articles/201701-event-driven.html)
