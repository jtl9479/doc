# 21. ë””ë²„ê¹… ë° íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

> **í•™ìŠµ ëª©í‘œ**: Docker ì»¨í…Œì´ë„ˆ, ë„¤íŠ¸ì›Œí¬, ë³¼ë¥¨ ë“±ì—ì„œ ë°œìƒí•˜ëŠ” ë‹¤ì–‘í•œ ë¬¸ì œë¥¼ ì²´ê³„ì ìœ¼ë¡œ ì§„ë‹¨í•˜ê³  í•´ê²°í•  ìˆ˜ ìˆìœ¼ë©°, íš¨ìœ¨ì ì¸ ë””ë²„ê¹… ì›Œí¬í”Œë¡œìš°ë¥¼ ìµí ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**â±ï¸ ì˜ˆìƒ í•™ìŠµ ì‹œê°„**: 2-3ì‹œê°„
**ë‚œì´ë„**: â­â­â­â­â˜† (4ê°œ/5ê°œ)

---

## ëª©ì°¨
1. [Docker ë””ë²„ê¹… ê¸°ì´ˆ](#docker-ë””ë²„ê¹…-ê¸°ì´ˆ)
2. [ì»¨í…Œì´ë„ˆ ë¡œê·¸ ë¶„ì„](#ì»¨í…Œì´ë„ˆ-ë¡œê·¸-ë¶„ì„)
3. [ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ê²€ì‚¬](#ì»¨í…Œì´ë„ˆ-ë‚´ë¶€-ê²€ì‚¬)
4. [ë„¤íŠ¸ì›Œí¬ ë””ë²„ê¹…](#ë„¤íŠ¸ì›Œí¬-ë””ë²„ê¹…)
5. [ì„±ëŠ¥ ë¬¸ì œ ì§„ë‹¨](#ì„±ëŠ¥-ë¬¸ì œ-ì§„ë‹¨)
6. [ì´ë¯¸ì§€ ë¬¸ì œ í•´ê²°](#ì´ë¯¸ì§€-ë¬¸ì œ-í•´ê²°)
7. [ë³¼ë¥¨ ë¬¸ì œ í•´ê²°](#ë³¼ë¥¨-ë¬¸ì œ-í•´ê²°)
8. [ì¼ë°˜ì ì¸ ì˜¤ë¥˜ íŒ¨í„´](#ì¼ë°˜ì ì¸-ì˜¤ë¥˜-íŒ¨í„´)
9. [ê³ ê¸‰ ë””ë²„ê¹… ê¸°ë²•](#ê³ ê¸‰-ë””ë²„ê¹…-ê¸°ë²•)
10. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì²´í¬ë¦¬ìŠ¤íŠ¸](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…-ì²´í¬ë¦¬ìŠ¤íŠ¸)

---

## ğŸ’¡ ì™œ Docker ë””ë²„ê¹… ê¸°ìˆ ì´ í•„ìš”í•œê°€?

### ì‹¤ë¬´ ë°°ê²½

**"í”„ë¡œë•ì…˜ì—ì„œ ê°‘ìê¸° ì»¨í…Œì´ë„ˆê°€ ì£½ì—ˆìŠµë‹ˆë‹¤. ì–´ë–»ê²Œ í•˜ì£ ?"**

#### âŒ ë””ë²„ê¹… ê¸°ìˆ ì´ ì—†ìœ¼ë©´ ë°œìƒí•˜ëŠ” ë¬¸ì œ

```
ë¬¸ì œ 1: ë¬´ì‘ì • ì¬ì‹œì‘ë§Œ ë°˜ë³µ
- ì¦ìƒ: ì»¨í…Œì´ë„ˆê°€ ê³„ì† ì£½ìŒ
- ëŒ€ì‘: docker restart ë¬´í•œ ë°˜ë³µ
- ì˜í–¥: ê·¼ë³¸ ì›ì¸ í•´ê²° ì•ˆ ë¨, ì„œë¹„ìŠ¤ ë‹¤ìš´íƒ€ì„ ì§€ì†
- ë¹„ìš©: ì‹œê°„ë‹¹ ìˆ˜ë°±ë§Œì› ì†ì‹¤

ë¬¸ì œ 2: ë¡œê·¸ í™•ì¸ ë°©ë²• ëª°ë¼ í—¤ë§´
- ì¦ìƒ: "ë¡œê·¸ë¥¼ ì–´ë””ì„œ ë´ì•¼ í•˜ë‚˜ìš”?"
- ëŒ€ì‘: êµ¬ê¸€ë§í•˜ë©° ì‹œê°„ ë‚­ë¹„
- ì˜í–¥: ì¥ì•  ëŒ€ì‘ ì§€ì—°
- ë¹„ìš©: í‰ê·  í•´ê²° ì‹œê°„ 4ì‹œê°„ â†’ 15ë¶„ìœ¼ë¡œ ë‹¨ì¶• í•„ìš”

ë¬¸ì œ 3: ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ ì§„ë‹¨ ë¶ˆê°€
- ì¦ìƒ: "ì»¨í…Œì´ë„ˆ ê°„ í†µì‹ ì´ ì•ˆ ë¼ìš”"
- ëŒ€ì‘: í¬íŠ¸ë¥¼ ì´ê²ƒì €ê²ƒ ë°”ê¿”ë´„
- ì˜í–¥: ëœë¤í•œ ì‹œë„ë¡œ ì‹œê°„ ë‚­ë¹„
- ë¹„ìš©: ê°œë°œì 1ëª… í•˜ë£¨ í—ˆë¹„ (ì•½ 20ë§Œì›)
```

#### âœ… ì²´ê³„ì  ë””ë²„ê¹… ê¸°ìˆ ì„ ìµíˆë©´

```
í•´ê²°ì±… 1: 5ë¶„ ë‚´ ì›ì¸ íŒŒì•…
- ë°©ë²•: docker logs â†’ inspect â†’ exec ì›Œí¬í”Œë¡œìš°
- íš¨ê³¼: í‰ê·  í•´ê²° ì‹œê°„ 4ì‹œê°„ â†’ 15ë¶„
- ì ˆê°: ì‹œê°„ë‹¹ ëŒ€ì‘ ë¹„ìš© 96% ì ˆê°

í•´ê²°ì±… 2: ê·¼ë³¸ ì›ì¸ í•´ê²°
- ë°©ë²•: ì¦ìƒì´ ì•„ë‹Œ ì›ì¸ ë¶„ì„
- íš¨ê³¼: ì¬ë°œ ë°©ì§€, ì‹œìŠ¤í…œ ì•ˆì •ì„± í–¥ìƒ
- ì ˆê°: ì¥ì•  ë°œìƒ ë¹ˆë„ 80% ê°ì†Œ

í•´ê²°ì±… 3: ìì‹ ê° ìˆëŠ” ë¬¸ì œ í•´ê²°
- ë°©ë²•: ì²´í¬ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ ì²´ê³„ì  ì ‘ê·¼
- íš¨ê³¼: ì•¼ê°„ ê¸´ê¸‰ ì½œ ê°ì†Œ
- ì ˆê°: ê°œë°œì ì‚¶ì˜ ì§ˆ í–¥ìƒ ğŸ‰
```

### ìˆ˜ì¹˜ë¡œ ë³´ëŠ” íš¨ê³¼

| ì§€í‘œ | Before | After | ê°œì„ ìœ¨ |
|------|--------|-------|--------|
| í‰ê·  ì¥ì•  í•´ê²° ì‹œê°„ | 4ì‹œê°„ | 15ë¶„ | **94%â†“** |
| ì¬ë°œë¥  | 50% | 5% | **90%â†“** |
| ì•¼ê°„ ê¸´ê¸‰ ì½œ | ì›” 10íšŒ | ì›” 1íšŒ | **90%â†“** |
| ì›ì¸ ë¯¸íŒŒì•… ì¥ì•  | 30% | 2% | **93%â†“** |
| ê°œë°œì ìŠ¤íŠ¸ë ˆìŠ¤ | ë†’ìŒ | ë³´í†µ | **70%â†“** |

---

## ğŸ” ì‹¤ìƒí™œ ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°

### ë¹„ìœ  1: íƒì •ì˜ ì‚¬ê±´ ìˆ˜ì‚¬

```
íƒì • ì…œë¡ í™ˆì¦ˆê°€ ì‚¬ê±´ì„ í•´ê²°í•˜ëŠ” ë°©ë²•:

1. í˜„ì¥ ì¡°ì‚¬ (docker ps, docker logs)
   - "ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚¬ëŠ”ê°€?"
   - ì¦ê±° ìˆ˜ì§‘ (ë¡œê·¸, ìƒíƒœ)

2. ë‹¨ì„œ ë¶„ì„ (docker inspect)
   - "ì •í™•íˆ ì–´ë–¤ ìƒíƒœì¸ê°€?"
   - ì„¸ë¶€ ì •ë³´ íŒŒì•…

3. ê°€ì„¤ ìˆ˜ë¦½
   - "ì´ëŸ° ì¦ìƒì´ë©´ ì›ì¸ì€ Xì¼ ê²ƒì´ë‹¤"

4. ê²€ì¦ (docker exec, docker stats)
   - ê°€ì„¤ í™•ì¸
   - ì¶”ê°€ ì •ë³´ ìˆ˜ì§‘

5. í•´ê²°
   - ê·¼ë³¸ ì›ì¸ ì œê±°
   - ì¬ë°œ ë°©ì§€ ì¡°ì¹˜

Docker ë””ë²„ê¹…ë„ ë™ì¼í•œ í”„ë¡œì„¸ìŠ¤:
ì¦ìƒ ë°œê²¬ â†’ ë‹¨ì„œ ìˆ˜ì§‘ â†’ ê°€ì„¤ ìˆ˜ë¦½ â†’ ê²€ì¦ â†’ í•´ê²°
```

### ë¹„ìœ  2: ì˜ì‚¬ì˜ í™˜ì ì§„ë‹¨

```
í™˜ì(ì»¨í…Œì´ë„ˆ)ê°€ ì•„í”„ë‹¤ê³  ì™”ì„ ë•Œ ì˜ì‚¬ê°€ í•˜ëŠ” ì¼:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ë¬¸ì§„ (docker ps -a)                 â”‚
â”‚    "ì–¸ì œë¶€í„° ì•„íŒ ë‚˜ìš”?"                 â”‚
â”‚    "ì–´ë””ê°€ ì•„í”„ì„¸ìš”?"                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. ì¦ìƒ í™•ì¸ (docker logs)             â”‚
â”‚    ì²´ì˜¨, í˜ˆì••, ë§¥ë°• ì¸¡ì •                â”‚
â”‚    â†’ ë¡œê·¸ì—ì„œ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. ì •ë°€ ê²€ì‚¬ (docker inspect)          â”‚
â”‚    X-ray, CT, í˜ˆì•¡ ê²€ì‚¬                â”‚
â”‚    â†’ ìƒì„¸ ì„¤ì •, í™˜ê²½ ë³€ìˆ˜ í™•ì¸          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. ë‚´ë¶€ ê²€ì§„ (docker exec)             â”‚
â”‚    ë‚´ì‹œê²½ìœ¼ë¡œ ì§ì ‘ í™•ì¸                 â”‚
â”‚    â†’ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì§ì ‘ ì§„ì…            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5. ì²˜ë°© (ë¬¸ì œ í•´ê²°)                    â”‚
â”‚    ì›ì¸ íŒŒì•… í›„ ì¹˜ë£Œ                    â”‚
â”‚    â†’ ì„¤ì • ìˆ˜ì •, ì¬ì‹œì‘, ì¬ë°°í¬          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¡ í•µì‹¬: ì¦ìƒë§Œ ë³´ê³  ì²˜ë°©í•˜ì§€ ë§ ê²ƒ!
         ê·¼ë³¸ ì›ì¸ì„ ì°¾ì•„ì•¼ ì¬ë°œ ë°©ì§€
```

### ë¹„ìœ  3: ìë™ì°¨ ì •ë¹„ì‚¬ì˜ ì°¨ëŸ‰ ì ê²€

```
ì°¨(ì»¨í…Œì´ë„ˆ)ì— ì´ìƒì´ ìˆì„ ë•Œ ì •ë¹„ì‚¬ì˜ ì ‘ê·¼ë²•:

ì‹œë‚˜ë¦¬ì˜¤: ì°¨ ì‹œë™ì´ ì•ˆ ê±¸ë¦¼

âŒ ì´ˆë³´ ì •ë¹„ì‚¬:
"ë°°í„°ë¦¬ê°€ ë¬¸ì œì¸ê°€ë´ìš”" (ì¶”ì¸¡)
â†’ ë°°í„°ë¦¬ êµì²´ (ë¹„ìš© ë‚­ë¹„)
â†’ ì—¬ì „íˆ ì‹œë™ ì•ˆ ê±¸ë¦¼
â†’ "ê·¸ëŸ¼ ì—”ì§„ì¸ê°€?"
â†’ ë¬´ì‘ì • ì‹œë„...

âœ… ìˆ™ë ¨ ì •ë¹„ì‚¬ (ì²´ê³„ì  ë””ë²„ê¹…):

1. ê³„ê¸°íŒ í™•ì¸ (docker ps)
   - ê²½ê³ ë“± í™•ì¸
   - í˜„ì¬ ìƒíƒœ íŒŒì•…

2. ì§„ë‹¨ê¸° ì—°ê²° (docker logs)
   - ì—ëŸ¬ ì½”ë“œ í™•ì¸
   - "P0171: ì—°ë£Œ ë¶€ì¡±"

3. ìƒì„¸ ì ê²€ (docker inspect)
   - ì—°ë£Œ íƒ±í¬ í™•ì¸
   - ì—°ë£Œ íŒí”„ í™•ì¸
   - í•„í„° ìƒíƒœ í™•ì¸

4. ì§ì ‘ í™•ì¸ (docker exec)
   - í›„ë“œ ì—´ê³  ì§ì ‘ ë³´ê¸°
   - ë¶€í’ˆ í•˜ë‚˜í•˜ë‚˜ ì ê²€

5. ìˆ˜ë¦¬ ë° ì˜ˆë°© (ë¬¸ì œ í•´ê²°)
   - ì—°ë£Œ í•„í„° êµì²´
   - ì •ê¸° ì ê²€ ì¼ì • ìˆ˜ë¦½

Docker ë””ë²„ê¹… ì›Œí¬í”Œë¡œìš°:
ìƒíƒœ í™•ì¸ â†’ ë¡œê·¸ ë¶„ì„ â†’ ìƒì„¸ ê²€ì‚¬ â†’ ë‚´ë¶€ ì ê²€ â†’ í•´ê²°
```

---

## Docker ë””ë²„ê¹… ê¸°ì´ˆ

### ê¸°ë³¸ ë””ë²„ê¹… ëª…ë ¹ì–´

```bash
# 1. ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker ps -a

# 2. ì»¨í…Œì´ë„ˆ ë¡œê·¸ í™•ì¸
docker logs <container_id>

# 3. ì»¨í…Œì´ë„ˆ ìƒì„¸ ì •ë³´
docker inspect <container_id>

# 4. ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì ‘ì†
docker exec -it <container_id> sh

# 5. í”„ë¡œì„¸ìŠ¤ í™•ì¸
docker top <container_id>

# 6. ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
docker stats <container_id>

# 7. íŒŒì¼ ì‹œìŠ¤í…œ ë³€ê²½ ì‚¬í•­
docker diff <container_id>

# 8. ì´ë²¤íŠ¸ ëª¨ë‹ˆí„°ë§
docker events
```

### ë””ë²„ê¹… ì›Œí¬í”Œë¡œìš°

```
ë¬¸ì œ ë°œìƒ
    â†“
1. docker ps -a (ìƒíƒœ í™•ì¸)
    â†“
    ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ ì¤‘ì¸ê°€?
    â”œâ”€ Yes â†’ 2. docker logs (ë¡œê·¸ í™•ì¸)
    â”‚           â†“
    â”‚        ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸
    â”‚           â†“
    â”‚        3. docker exec (ë‚´ë¶€ ì§„ì…)
    â”‚           â†“
    â”‚        í™˜ê²½ ë³€ìˆ˜, íŒŒì¼, ë„¤íŠ¸ì›Œí¬ í™•ì¸
    â”‚
    â””â”€ No â†’ Exit Code í™•ì¸
              â†“
           docker logs (ì¢…ë£Œ ì›ì¸)
              â†“
           Dockerfile/compose ê²€í† 
```

---

## ì»¨í…Œì´ë„ˆ ë¡œê·¸ ë¶„ì„

### ë¡œê·¸ í™•ì¸ ëª…ë ¹ì–´

```bash
# ê¸°ë³¸ ë¡œê·¸ í™•ì¸
docker logs <container_id>

# ì‹¤ì‹œê°„ ë¡œê·¸ (tail -f)
docker logs -f <container_id>

# ìµœê·¼ Nì¤„ë§Œ í™•ì¸
docker logs --tail 100 <container_id>

# íƒ€ì„ìŠ¤íƒ¬í”„ í¬í•¨
docker logs -t <container_id>

# íŠ¹ì • ì‹œê°„ ì´í›„ ë¡œê·¸
docker logs --since 2024-01-01T10:00:00 <container_id>

# ìµœê·¼ 1ì‹œê°„ ë¡œê·¸
docker logs --since 1h <container_id>

# íŠ¹ì • ì‹œê°„ ì´ì „ ë¡œê·¸
docker logs --until 2024-01-01T12:00:00 <container_id>
```

### docker-compose ë¡œê·¸

```bash
# ëª¨ë“  ì„œë¹„ìŠ¤ ë¡œê·¸
docker-compose logs

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸
docker-compose logs user-service

# ì‹¤ì‹œê°„ ë¡œê·¸
docker-compose logs -f

# ìµœê·¼ 50ì¤„
docker-compose logs --tail 50

# ì—¬ëŸ¬ ì„œë¹„ìŠ¤ ë™ì‹œì—
docker-compose logs user-service account-service
```

### ë¡œê·¸ í•„í„°ë§ ë° ë¶„ì„

```bash
# grepìœ¼ë¡œ ì—ëŸ¬ë§Œ í•„í„°ë§
docker logs container_id 2>&1 | grep -i error

# íŠ¹ì • íŒ¨í„´ ê²€ìƒ‰
docker logs container_id 2>&1 | grep "connection refused"

# ì—ëŸ¬ ì¹´ìš´íŠ¸
docker logs container_id 2>&1 | grep -c ERROR

# ì—¬ëŸ¬ íŒ¨í„´ ê²€ìƒ‰
docker logs container_id 2>&1 | grep -E "ERROR|FATAL|Exception"

# íƒ€ì„ë¼ì¸ ë¶„ì„ (ì‹œê°„ë³„ ì—ëŸ¬ ìˆ˜)
docker logs -t container_id 2>&1 | grep ERROR | awk '{print $1}' | uniq -c
```

### ë¡œê·¸ ë ˆë²¨ë³„ ë¶„ì„

```bash
#!/bin/bash
# scripts/analyze-logs.sh

CONTAINER_ID=$1

echo "ğŸ“Š ë¡œê·¸ ë¶„ì„: $CONTAINER_ID"
echo ""

# ì´ ë¡œê·¸ ë¼ì¸ ìˆ˜
TOTAL=$(docker logs $CONTAINER_ID 2>&1 | wc -l)
echo "ì´ ë¡œê·¸ ë¼ì¸: $TOTAL"

# ì—ëŸ¬ ë ˆë²¨ë³„ ì¹´ìš´íŠ¸
echo ""
echo "ì—ëŸ¬ ë ˆë²¨ë³„ í†µê³„:"
echo "  ERROR:   $(docker logs $CONTAINER_ID 2>&1 | grep -c ERROR)"
echo "  WARN:    $(docker logs $CONTAINER_ID 2>&1 | grep -c WARN)"
echo "  INFO:    $(docker logs $CONTAINER_ID 2>&1 | grep -c INFO)"
echo "  DEBUG:   $(docker logs $CONTAINER_ID 2>&1 | grep -c DEBUG)"

# ìµœê·¼ ì—ëŸ¬ ë©”ì‹œì§€ (ìµœê·¼ 5ê°œ)
echo ""
echo "ìµœê·¼ ì—ëŸ¬ ë©”ì‹œì§€ (ìµœê·¼ 5ê°œ):"
docker logs $CONTAINER_ID 2>&1 | grep ERROR | tail -5
```

### ë¡œê·¸ ë“œë¼ì´ë²„ ì„¤ì •

```yaml
# docker-compose.yml

services:
  user-service:
    image: user-service:latest
    logging:
      driver: json-file
      options:
        max-size: "10m"      # ìµœëŒ€ íŒŒì¼ í¬ê¸°
        max-file: "3"        # ìµœëŒ€ íŒŒì¼ ê°œìˆ˜
        labels: "service"
        env: "ENV,APP_VERSION"

  # syslogë¡œ ì „ì†¡
  account-service:
    image: account-service:latest
    logging:
      driver: syslog
      options:
        syslog-address: "tcp://192.168.1.100:514"
        tag: "account-service"

  # fluentdë¡œ ì „ì†¡
  trade-service:
    image: trade-service:latest
    logging:
      driver: fluentd
      options:
        fluentd-address: localhost:24224
        tag: trade-service
```

---

## ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ê²€ì‚¬

### ì»¨í…Œì´ë„ˆ ì ‘ì†

```bash
# sh/bash ì…¸ ì‹¤í–‰
docker exec -it <container_id> sh
docker exec -it <container_id> bash

# íŠ¹ì • ëª…ë ¹ì–´ ì‹¤í–‰
docker exec <container_id> ls -la /app
docker exec <container_id> cat /app/config.json
docker exec <container_id> ps aux

# ë£¨íŠ¸ ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰
docker exec -u root -it <container_id> sh

# í™˜ê²½ ë³€ìˆ˜ í™•ì¸
docker exec <container_id> env

# ì‘ì—… ë””ë ‰í† ë¦¬ ì§€ì •
docker exec -w /app <container_id> ls -la
```

### íŒŒì¼ ì‹œìŠ¤í…œ ê²€ì‚¬

```bash
# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ
$ ls -la /app
$ cat /app/config/application.yml
$ find /app -name "*.jar"
$ df -h  # ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰

# íŒŒì¼ ì¡´ì¬ í™•ì¸
docker exec container_id test -f /app/app.jar && echo "exists" || echo "not found"

# ë””ë ‰í† ë¦¬ êµ¬ì¡° í™•ì¸
docker exec container_id tree /app

# íŒŒì¼ ê¶Œí•œ í™•ì¸
docker exec container_id ls -l /app/app.jar
```

### í”„ë¡œì„¸ìŠ¤ ê²€ì‚¬

```bash
# ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤
docker top <container_id>

# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ìƒì„¸ í™•ì¸
docker exec <container_id> ps aux
docker exec <container_id> ps -ef

# íŠ¹ì • í”„ë¡œì„¸ìŠ¤ ê²€ìƒ‰
docker exec <container_id> ps aux | grep java

# í¬íŠ¸ ë¦¬ìŠ¤ë‹ í™•ì¸
docker exec <container_id> netstat -tuln

# ë˜ëŠ”
docker exec <container_id> ss -tuln
```

### í™˜ê²½ ë³€ìˆ˜ ê²€ì‚¬

```bash
# ëª¨ë“  í™˜ê²½ ë³€ìˆ˜
docker exec <container_id> env

# íŠ¹ì • í™˜ê²½ ë³€ìˆ˜
docker exec <container_id> printenv DATABASE_URL

# docker inspectë¡œ í™•ì¸
docker inspect <container_id> | jq '.[0].Config.Env'

# docker-compose í™˜ê²½ ë³€ìˆ˜
docker-compose config
```

### ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ ê²€ì‚¬

```bash
# IP ì£¼ì†Œ í™•ì¸
docker exec <container_id> ip addr

# ë˜ëŠ”
docker exec <container_id> ifconfig

# ë¼ìš°íŒ… í…Œì´ë¸”
docker exec <container_id> ip route

# DNS í™•ì¸
docker exec <container_id> cat /etc/resolv.conf

# ë„¤íŠ¸ì›Œí¬ ì—°ê²° í…ŒìŠ¤íŠ¸
docker exec <container_id> ping -c 3 google.com
docker exec <container_id> curl -I https://google.com
```

---

## ë„¤íŠ¸ì›Œí¬ ë””ë²„ê¹…

### ì»¨í…Œì´ë„ˆ ê°„ í†µì‹  í…ŒìŠ¤íŠ¸

```bash
# 1. ì»¨í…Œì´ë„ˆ IP í™•ì¸
docker inspect <container_id> | grep IPAddress

# 2. ping í…ŒìŠ¤íŠ¸
docker exec container_a ping -c 3 container_b

# 3. í¬íŠ¸ ì—°ê²° í…ŒìŠ¤íŠ¸
docker exec container_a nc -zv container_b 8080

# ë˜ëŠ” telnet
docker exec container_a telnet container_b 8080

# 4. HTTP ìš”ì²­ í…ŒìŠ¤íŠ¸
docker exec container_a curl http://container_b:8080/health
```

### ë„¤íŠ¸ì›Œí¬ ì •ë³´ í™•ì¸

```bash
# Docker ë„¤íŠ¸ì›Œí¬ ëª©ë¡
docker network ls

# ë„¤íŠ¸ì›Œí¬ ìƒì„¸ ì •ë³´
docker network inspect bridge

# íŠ¹ì • ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°ëœ ì»¨í…Œì´ë„ˆ
docker network inspect my-network | jq '.[0].Containers'

# ì»¨í…Œì´ë„ˆê°€ ì†í•œ ë„¤íŠ¸ì›Œí¬
docker inspect container_id | jq '.[0].NetworkSettings.Networks'
```

### DNS í•´ì„ ë¬¸ì œ

```bash
# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ DNS í…ŒìŠ¤íŠ¸
docker exec container_id nslookup postgres
docker exec container_id dig postgres

# /etc/hosts í™•ì¸
docker exec container_id cat /etc/hosts

# DNS ì„œë²„ í™•ì¸
docker exec container_id cat /etc/resolv.conf

# ì»¤ìŠ¤í…€ DNS ì‚¬ìš©
docker run --dns 8.8.8.8 --dns 8.8.4.4 myapp:latest
```

### í¬íŠ¸ ë§¤í•‘ ë¬¸ì œ

```bash
# í¬íŠ¸ ë§¤í•‘ í™•ì¸
docker port <container_id>

# í˜¸ìŠ¤íŠ¸ì—ì„œ í¬íŠ¸ ì‚¬ìš© ì¤‘ í™•ì¸
netstat -tuln | grep 8080
# Windows
netstat -ano | findstr :8080

# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ í¬íŠ¸ ë¦¬ìŠ¤ë‹ í™•ì¸
docker exec <container_id> netstat -tuln | grep 8080

# ë°©í™”ë²½ í™•ì¸ (Linux)
sudo iptables -L -n | grep 8080

# í¬íŠ¸ í¬ì›Œë”© í…ŒìŠ¤íŠ¸
curl http://localhost:8080/health
```

### ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬ ë¬¸ì œ

```yaml
# docker-compose.yml

services:
  frontend:
    networks:
      - frontend-net
      - backend-net  # ì–‘ìª½ ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼

  backend:
    networks:
      - backend-net
      - database-net

  database:
    networks:
      - database-net  # ë°ì´í„°ë² ì´ìŠ¤ ë„¤íŠ¸ì›Œí¬ë§Œ

networks:
  frontend-net:
  backend-net:
  database-net:
```

**ë„¤íŠ¸ì›Œí¬ ì—°ê²° í…ŒìŠ¤íŠ¸**:

```bash
# frontendê°€ backendì— ì ‘ê·¼ ê°€ëŠ¥í•œê°€?
docker-compose exec frontend ping backend

# backendê°€ databaseì— ì ‘ê·¼ ê°€ëŠ¥í•œê°€?
docker-compose exec backend ping database

# frontendê°€ databaseì— ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€ëŠ¥ (ì˜ë„ëœ ë™ì‘)
docker-compose exec frontend ping database
# ping: bad address 'database'
```

### ë„¤íŠ¸ì›Œí¬ ë””ë²„ê¹… ë„êµ¬ ì„¤ì¹˜

```bash
# ì•ŒíŒŒì¸ ê¸°ë°˜ ì»¨í…Œì´ë„ˆì— ë„êµ¬ ì„¤ì¹˜
docker exec -u root container_id apk add --no-cache \
    curl \
    bind-tools \
    netcat-openbsd \
    tcpdump

# ë°ë¹„ì•ˆ/ìš°ë¶„íˆ¬ ê¸°ë°˜
docker exec -u root container_id apt-get update && \
    apt-get install -y curl dnsutils netcat tcpdump
```

### íŒ¨í‚· ìº¡ì²˜

```bash
# ì»¨í…Œì´ë„ˆ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ í™•ì¸
docker exec container_id ip link

# tcpdumpë¡œ íŒ¨í‚· ìº¡ì²˜
docker exec container_id tcpdump -i eth0 -w /tmp/capture.pcap

# íŠ¹ì • í¬íŠ¸ë§Œ ìº¡ì²˜
docker exec container_id tcpdump -i eth0 port 8080

# ì»¨í…Œì´ë„ˆì—ì„œ í˜¸ìŠ¤íŠ¸ë¡œ íŒŒì¼ ë³µì‚¬
docker cp container_id:/tmp/capture.pcap ./capture.pcap

# Wiresharkë¡œ ë¶„ì„
wireshark capture.pcap
```

---

## ì„±ëŠ¥ ë¬¸ì œ ì§„ë‹¨

### ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§

```bash
# ì‹¤ì‹œê°„ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
docker stats

# íŠ¹ì • ì»¨í…Œì´ë„ˆë§Œ
docker stats user-service account-service

# í¬ë§· ì§€ì •
docker stats --format "table {{.Container}}\t{{.CPUPerc}}\t{{.MemUsage}}"

# 1íšŒë§Œ ì¶œë ¥
docker stats --no-stream
```

### CPU ì‚¬ìš©ëŸ‰ ë¶„ì„

```bash
# CPU ì‚¬ìš©ë¥  ë†’ì€ ì»¨í…Œì´ë„ˆ ì°¾ê¸°
docker stats --no-stream --format "table {{.Name}}\t{{.CPUPerc}}" | sort -k2 -rn

# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ í”„ë¡œì„¸ìŠ¤ CPU ì‚¬ìš©ëŸ‰
docker exec container_id top -bn1 | head -20

# CPU ì œí•œ í™•ì¸
docker inspect container_id | jq '.[0].HostConfig.CpuQuota'
docker inspect container_id | jq '.[0].HostConfig.CpuPeriod'
```

**CPU í”„ë¡œíŒŒì¼ë§ (Java)**:

```bash
# JVM ìŠ¤ë ˆë“œ ë¤í”„
docker exec container_id jstack 1 > thread-dump.txt

# CPU ì‚¬ìš© ì¤‘ì¸ ìŠ¤ë ˆë“œ ì°¾ê¸°
docker exec container_id top -H -p 1
```

### ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¶„ì„

```bash
# ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
docker stats --no-stream --format "table {{.Name}}\t{{.MemUsage}}"

# ë©”ëª¨ë¦¬ ì œí•œ í™•ì¸
docker inspect container_id | jq '.[0].HostConfig.Memory'

# OOM Killer ë¡œê·¸ í™•ì¸ (Linux)
dmesg | grep -i "killed process"
docker inspect container_id | jq '.[0].State.OOMKilled'
```

**ë©”ëª¨ë¦¬ í”„ë¡œíŒŒì¼ë§ (Java)**:

```bash
# í™ ë¤í”„ ìƒì„±
docker exec container_id jmap -dump:format=b,file=/tmp/heap.hprof 1

# í™ ë¤í”„ ë³µì‚¬
docker cp container_id:/tmp/heap.hprof ./heap.hprof

# Eclipse MAT ë˜ëŠ” VisualVMìœ¼ë¡œ ë¶„ì„
```

**ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ê°ì§€**:

```bash
#!/bin/bash
# scripts/memory-leak-detector.sh

CONTAINER_ID=$1
INTERVAL=60  # 60ì´ˆë§ˆë‹¤ í™•ì¸

echo "ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§ ì‹œì‘: $CONTAINER_ID"
echo "ì‹œê°„, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰" > memory-usage.csv

while true; do
    TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')
    MEM_USAGE=$(docker stats --no-stream --format "{{.MemUsage}}" $CONTAINER_ID)

    echo "$TIMESTAMP, $MEM_USAGE" >> memory-usage.csv
    echo "$TIMESTAMP - $MEM_USAGE"

    sleep $INTERVAL
done
```

### ë””ìŠ¤í¬ I/O ë¶„ì„

```bash
# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰
docker exec container_id df -h

# ëŒ€ìš©ëŸ‰ íŒŒì¼ ì°¾ê¸°
docker exec container_id du -sh /* | sort -hr | head -10

# I/O í†µê³„
docker stats --format "table {{.Name}}\t{{.BlockIO}}"

# ì»¨í…Œì´ë„ˆë³„ ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰
docker system df
docker system df -v
```

### ë„¤íŠ¸ì›Œí¬ I/O ë¶„ì„

```bash
# ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©ëŸ‰
docker stats --format "table {{.Name}}\t{{.NetIO}}"

# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ë„¤íŠ¸ì›Œí¬ ëª¨ë‹ˆí„°ë§
docker exec container_id iftop -i eth0
docker exec container_id nethogs

# ì—°ê²° ìˆ˜ í™•ì¸
docker exec container_id netstat -an | wc -l
```

---

## ì´ë¯¸ì§€ ë¬¸ì œ í•´ê²°

### ì´ë¯¸ì§€ ë¹Œë“œ ì‹¤íŒ¨

```bash
# ë¹Œë“œ ë¡œê·¸ ìƒì„¸ ì¶œë ¥
docker build --no-cache --progress=plain -t myapp:latest .

# íŠ¹ì • ë‹¨ê³„ê¹Œì§€ë§Œ ë¹Œë“œ
docker build --target builder -t myapp:builder .

# ë¹Œë“œ ì»¨í…ìŠ¤íŠ¸ í¬ê¸° í™•ì¸
tar -czf - . | wc -c

# .dockerignore í™•ì¸
cat .dockerignore
```

**ì¼ë°˜ì ì¸ ë¹Œë“œ ì˜¤ë¥˜**:

```dockerfile
# âŒ ë¬¸ì œ: COPY ì‹¤íŒ¨
COPY app.jar /app/
# Error: no such file or directory

# âœ… í•´ê²°: ë¹Œë“œ ì»¨í…ìŠ¤íŠ¸ í™•ì¸
# app.jarê°€ Dockerfileê³¼ ê°™ì€ ë””ë ‰í† ë¦¬ì— ìˆëŠ”ì§€ í™•ì¸
ls -la app.jar

# âŒ ë¬¸ì œ: RUN ëª…ë ¹ì–´ ì‹¤íŒ¨
RUN apt-get install -y nodejs
# E: Unable to locate package nodejs

# âœ… í•´ê²°: íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸
RUN apt-get update && apt-get install -y nodejs
```

### ì´ë¯¸ì§€ ë ˆì´ì–´ ë¶„ì„

```bash
# ì´ë¯¸ì§€ íˆìŠ¤í† ë¦¬
docker history myapp:latest

# ìƒì„¸ ë ˆì´ì–´ ì •ë³´
docker history --no-trunc myapp:latest

# ë ˆì´ì–´ í¬ê¸° ìˆœìœ¼ë¡œ ì •ë ¬
docker history --format "{{.Size}}\t{{.CreatedBy}}" myapp:latest | sort -hr

# dive ë„êµ¬ë¡œ ìƒì„¸ ë¶„ì„
dive myapp:latest
```

### ì´ë¯¸ì§€ í¬ê¸° ìµœì í™”

```bash
# í˜„ì¬ ì´ë¯¸ì§€ í¬ê¸°
docker images myapp:latest

# ë¶ˆí•„ìš”í•œ ë ˆì´ì–´ ì œê±°
docker build --squash -t myapp:latest .

# ë©€í‹°ìŠ¤í…Œì´ì§€ ë¹Œë“œ ì‚¬ìš©
# (Dockerfileì—ì„œ êµ¬í˜„)

# ì´ë¯¸ì§€ í¬ê¸° ë¹„êµ
docker images | grep myapp
```

---

## ë³¼ë¥¨ ë¬¸ì œ í•´ê²°

### ë³¼ë¥¨ ë§ˆìš´íŠ¸ ë¬¸ì œ

```bash
# ë³¼ë¥¨ ëª©ë¡
docker volume ls

# ë³¼ë¥¨ ìƒì„¸ ì •ë³´
docker volume inspect my-volume

# ì»¨í…Œì´ë„ˆì˜ ë§ˆìš´íŠ¸ ì •ë³´
docker inspect container_id | jq '.[0].Mounts'

# ë³¼ë¥¨ ë‚´ìš© í™•ì¸
docker run --rm -v my-volume:/data alpine ls -la /data
```

**ê¶Œí•œ ë¬¸ì œ**:

```bash
# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ê¶Œí•œ í™•ì¸
docker exec container_id ls -la /app/data

# ì†Œìœ ì ë³€ê²½
docker exec -u root container_id chown -R appuser:appuser /app/data

# Dockerfileì—ì„œ í•´ê²°
COPY --chown=appuser:appuser . /app
```

### ë³¼ë¥¨ ë°ì´í„° ì†ì‹¤

```bash
# ìµëª… ë³¼ë¥¨ ì°¾ê¸° (ëŒ•ê¸€ë§ ë³¼ë¥¨)
docker volume ls -qf dangling=true

# ë³¼ë¥¨ ë°±ì—…
docker run --rm -v my-volume:/source -v $(pwd):/backup \
    alpine tar czf /backup/backup.tar.gz -C /source .

# ë³¼ë¥¨ ë³µì›
docker run --rm -v my-volume:/target -v $(pwd):/backup \
    alpine tar xzf /backup/backup.tar.gz -C /target

# ë³¼ë¥¨ ë§ˆì´ê·¸ë ˆì´ì…˜
docker run --rm -v old-volume:/from -v new-volume:/to \
    alpine sh -c "cp -av /from/. /to/"
```

### ë³¼ë¥¨ ì„±ëŠ¥ ë¬¸ì œ

```bash
# Docker Desktop (Mac/Windows): cached, delegated ì˜µì…˜
volumes:
  - ./src:/app/src:cached  # ì½ê¸° ì„±ëŠ¥ í–¥ìƒ

# Linux: ê¸°ë³¸ ì„¤ì •ì´ ìµœì 

# ë³¼ë¥¨ I/O í…ŒìŠ¤íŠ¸
docker run --rm -v my-volume:/data alpine \
    dd if=/dev/zero of=/data/testfile bs=1M count=100
```

---

## ì¼ë°˜ì ì¸ ì˜¤ë¥˜ íŒ¨í„´

### 1. "Cannot connect to Docker daemon"

```bash
# ì¦ìƒ
Cannot connect to the Docker daemon at unix:///var/run/docker.sock

# ì›ì¸ ë° í•´ê²°
# 1. Dockerê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
sudo systemctl status docker

# 2. Docker ì‹œì‘
sudo systemctl start docker

# 3. ê¶Œí•œ í™•ì¸ (Linux)
sudo usermod -aG docker $USER
# ë¡œê·¸ì•„ì›ƒ í›„ ì¬ë¡œê·¸ì¸

# 4. Docker Desktop (Windows/Mac) í™•ì¸
# Docker Desktopì´ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
```

### 2. "Port is already allocated"

```bash
# ì¦ìƒ
Error: bind: address already in use

# ì›ì¸: í¬íŠ¸ê°€ ì´ë¯¸ ì‚¬ìš© ì¤‘

# í•´ê²° 1: ì‚¬ìš© ì¤‘ì¸ í¬íŠ¸ ì°¾ê¸°
netstat -tuln | grep 8080
lsof -i :8080  # Mac/Linux

# Windows
netstat -ano | findstr :8080

# í•´ê²° 2: í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
kill <PID>

# í•´ê²° 3: ë‹¤ë¥¸ í¬íŠ¸ ì‚¬ìš©
docker run -p 8081:8080 myapp:latest
```

### 3. "No space left on device"

```bash
# ì¦ìƒ
no space left on device

# ì›ì¸: ë””ìŠ¤í¬ ê³µê°„ ë¶€ì¡±

# ì§„ë‹¨
docker system df
df -h

# í•´ê²° 1: ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¦¬ì†ŒìŠ¤ ì •ë¦¬
docker system prune -a

# í•´ê²° 2: íŠ¹ì • ë¦¬ì†ŒìŠ¤ ì •ë¦¬
docker image prune    # ëŒ•ê¸€ë§ ì´ë¯¸ì§€
docker container prune  # ì¤‘ì§€ëœ ì»¨í…Œì´ë„ˆ
docker volume prune   # ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë³¼ë¥¨

# í•´ê²° 3: ë¡œê·¸ ì •ë¦¬
docker logs container_id --tail 0  # ë¡œê·¸ ì´ˆê¸°í™”
```

### 4. "Exec format error"

```bash
# ì¦ìƒ
exec format error

# ì›ì¸: ì•„í‚¤í…ì²˜ ë¶ˆì¼ì¹˜ (ARM vs AMD64)

# í™•ì¸
docker inspect myapp:latest | jq '.[0].Architecture'
uname -m  # í˜¸ìŠ¤íŠ¸ ì•„í‚¤í…ì²˜

# í•´ê²°: ë©€í‹° ì•„í‚¤í…ì²˜ ë¹Œë“œ
docker buildx build --platform linux/amd64,linux/arm64 -t myapp:latest .
```

### 5. "OCI runtime create failed"

```bash
# ì¦ìƒ
OCI runtime create failed: ...

# ì¼ë°˜ì ì¸ ì›ì¸ ë° í•´ê²°

# 1. ë§ˆìš´íŠ¸ ê²½ë¡œ ë¬¸ì œ
# âŒ
volumes:
  - /nonexistent:/app
# âœ…
volumes:
  - ./data:/app

# 2. ê¶Œí•œ ë¬¸ì œ
# âœ… ì»¨í…Œì´ë„ˆë¥¼ ë£¨íŠ¸ë¡œ ì‹¤í–‰
docker run --user root myapp:latest

# 3. ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ë¶€ì¡±
# Docker Desktop: Settings > Resources > ë©”ëª¨ë¦¬/CPU ì¦ê°€
```

### 6. "Container unhealthy"

```bash
# ì¦ìƒ
Container is unhealthy

# ì›ì¸: í—¬ìŠ¤ì²´í¬ ì‹¤íŒ¨

# ì§„ë‹¨
docker inspect container_id | jq '.[0].State.Health'

# ë¡œê·¸ í™•ì¸
docker inspect container_id | jq '.[0].State.Health.Log'

# í—¬ìŠ¤ì²´í¬ ìˆ˜ë™ ì‹¤í–‰
docker exec container_id curl -f http://localhost:8080/health

# í•´ê²°: í—¬ìŠ¤ì²´í¬ ì¡°ì •
healthcheck:
  test: ["CMD", "curl", "-f", "http://localhost:8080/health"]
  interval: 30s        # ê°„ê²© ëŠ˜ë¦¬ê¸°
  timeout: 10s         # íƒ€ì„ì•„ì›ƒ ëŠ˜ë¦¬ê¸°
  retries: 5           # ì¬ì‹œë„ íšŸìˆ˜ ëŠ˜ë¦¬ê¸°
  start_period: 60s    # ì‹œì‘ ëŒ€ê¸° ì‹œê°„ ëŠ˜ë¦¬ê¸°
```

---

## ê³ ê¸‰ ë””ë²„ê¹… ê¸°ë²•

### straceë¡œ ì‹œìŠ¤í…œ ì½œ ì¶”ì 

```bash
# strace ì„¤ì¹˜
docker exec -u root container_id apt-get update && \
    apt-get install -y strace

# í”„ë¡œì„¸ìŠ¤ ì¶”ì 
docker exec container_id strace -p 1

# íŒŒì¼ I/O ì¶”ì 
docker exec container_id strace -e trace=open,close,read,write -p 1

# ë„¤íŠ¸ì›Œí¬ ì½œ ì¶”ì 
docker exec container_id strace -e trace=network -p 1
```

### ì»¨í…Œì´ë„ˆ ì´ë²¤íŠ¸ ëª¨ë‹ˆí„°ë§

```bash
# ì‹¤ì‹œê°„ ì´ë²¤íŠ¸
docker events

# íŠ¹ì • ì»¨í…Œì´ë„ˆë§Œ
docker events --filter container=user-service

# íŠ¹ì • ì´ë²¤íŠ¸ë§Œ
docker events --filter event=start
docker events --filter event=die

# ì‹œê°„ ë²”ìœ„ ì§€ì •
docker events --since 2024-01-01T00:00:00 --until 2024-01-01T23:59:59
```

### ë””ë²„ê·¸ ì»¨í…Œì´ë„ˆ ì‹¤í–‰

```bash
# ê°™ì€ ë„¤íŠ¸ì›Œí¬ì— ë””ë²„ê·¸ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker run -it --rm \
    --network container:user-service \
    nicolaka/netshoot

# ë˜ëŠ” ê°™ì€ ë„¤íŠ¸ì›Œí¬ ê³µìœ 
docker run -it --rm \
    --network lk-trade_default \
    nicolaka/netshoot

# ë””ë²„ê·¸ ë„êµ¬ê°€ í¬í•¨ëœ ì´ë¯¸ì§€
# - nicolaka/netshoot: ë„¤íŠ¸ì›Œí¬ ë””ë²„ê¹…
# - busybox: ê¸°ë³¸ ìœ ë‹‰ìŠ¤ ë„êµ¬
# - alpine: ê°€ë²¼ìš´ ë¦¬ëˆ…ìŠ¤
```

### ì»¨í…Œì´ë„ˆ ì²´í¬í¬ì¸íŠ¸ ë° ë³µì›

```bash
# ì‹¤í—˜ì  ê¸°ëŠ¥ í™œì„±í™” í•„ìš”

# ì»¨í…Œì´ë„ˆ ì²´í¬í¬ì¸íŠ¸ ìƒì„±
docker checkpoint create container_id checkpoint1

# ì²´í¬í¬ì¸íŠ¸ ëª©ë¡
docker checkpoint ls container_id

# ì²´í¬í¬ì¸íŠ¸ì—ì„œ ë³µì›
docker start --checkpoint checkpoint1 container_id
```

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì»¨í…Œì´ë„ˆê°€ ì‹œì‘í•˜ì§€ ì•Šì„ ë•Œ

```
â–¡ docker ps -aë¡œ Exit Code í™•ì¸
  - 0: ì •ìƒ ì¢…ë£Œ
  - 1: ì• í”Œë¦¬ì¼€ì´ì…˜ ì˜¤ë¥˜
  - 137: OOM Killed
  - 139: Segmentation Fault
  - 143: SIGTERM

â–¡ docker logsë¡œ ì˜¤ë¥˜ ë©”ì‹œì§€ í™•ì¸

â–¡ docker inspectë¡œ ì„¤ì • í™•ì¸
  - Cmd, Entrypoint
  - Environment
  - Mounts
  - Networks

â–¡ Dockerfile ê²€í† 
  - CMD/ENTRYPOINT ì˜¬ë°”ë¥¸ê°€?
  - í•„ìš”í•œ íŒŒì¼ ëª¨ë‘ COPYë˜ì—ˆë‚˜?
  - ê¶Œí•œ ë¬¸ì œ ì—†ë‚˜?

â–¡ ì˜ì¡´ì„± í™•ì¸
  - depends_on ì„¤ì •
  - ë°ì´í„°ë² ì´ìŠ¤/Redis ì¤€ë¹„ë˜ì—ˆë‚˜?
```

### ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
â–¡ ì»¨í…Œì´ë„ˆ IP ì£¼ì†Œ í™•ì¸
  docker inspect container_id | grep IPAddress

â–¡ ê°™ì€ ë„¤íŠ¸ì›Œí¬ì¸ê°€?
  docker network inspect network_name

â–¡ DNS í•´ì„ ë˜ëŠ”ê°€?
  docker exec container_id ping target_container

â–¡ í¬íŠ¸ ë¦¬ìŠ¤ë‹ ì¤‘ì¸ê°€?
  docker exec container_id netstat -tuln

â–¡ ë°©í™”ë²½/ë³´ì•ˆ ê·¸ë£¹ í™•ì¸

â–¡ ì„œë¹„ìŠ¤ ì´ë¦„ ì‚¬ìš©í•˜ëŠ”ê°€?
  (localhost âŒ, service_name âœ…)
```

### ì„±ëŠ¥ ë¬¸ì œ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
â–¡ docker statsë¡œ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ í™•ì¸

â–¡ ë¦¬ì†ŒìŠ¤ ì œí•œ í™•ì¸
  docker inspect | grep -i "cpu\|memory"

â–¡ ë¡œê·¸ íŒŒì¼ í¬ê¸° í™•ì¸
  docker logs --tail 1 container_id

â–¡ ë³¼ë¥¨ I/O ì„±ëŠ¥ í™•ì¸

â–¡ ë„¤íŠ¸ì›Œí¬ ì§€ì—° í™•ì¸
  docker exec container_id ping -c 10 target

â–¡ ì• í”Œë¦¬ì¼€ì´ì…˜ í”„ë¡œíŒŒì¼ë§
  (JProfiler, pprof, py-spy ë“±)
```

### ë°ì´í„° ì†ì‹¤ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
â–¡ ë³¼ë¥¨ ì‚¬ìš© ì¤‘ì¸ê°€?
  docker inspect container_id | jq '.[0].Mounts'

â–¡ ìµëª… ë³¼ë¥¨ì¸ê°€? (ì´ë¦„ ìˆëŠ” ë³¼ë¥¨ìœ¼ë¡œ ë³€ê²½)

â–¡ --rm ì˜µì…˜ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ë‚˜?

â–¡ docker-compose down -v ì‹¤í–‰í•˜ì§€ ì•Šì•˜ë‚˜?

â–¡ ë°±ì—… ì¡´ì¬í•˜ëŠ”ê°€?
  docker volume ls
```

---

## ì‹¤ì „ ë””ë²„ê¹… ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: "Service Unavailable"

```bash
# 1. ì¦ìƒ
$ curl http://localhost:8081/api/users
Service Unavailable

# 2. ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
$ docker ps
CONTAINER ID   STATUS                    PORTS
a1b2c3d4e5f6   Up 2 minutes (unhealthy)  0.0.0.0:8081->8080/tcp

# 3. í—¬ìŠ¤ì²´í¬ ë¡œê·¸ í™•ì¸
$ docker inspect user-service | jq '.[0].State.Health.Log'
[
  {
    "ExitCode": 1,
    "Output": "curl: (7) Failed to connect to localhost port 8080"
  }
]

# 4. ì»¨í…Œì´ë„ˆ ë¡œê·¸ í™•ì¸
$ docker logs user-service
Error: Cannot connect to database at postgres:5432
Connection refused

# 5. ë°ì´í„°ë² ì´ìŠ¤ í™•ì¸
$ docker ps | grep postgres
(ì•„ë¬´ê²ƒë„ ì—†ìŒ)

# 6. ì›ì¸: ë°ì´í„°ë² ì´ìŠ¤ ì‹œì‘ ì•ˆë¨
$ docker-compose up -d postgres

# 7. ì„œë¹„ìŠ¤ ì¬ì‹œì‘
$ docker-compose restart user-service

# 8. í™•ì¸
$ curl http://localhost:8081/health
{"status":"UP"}
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: ë©”ëª¨ë¦¬ ë¶€ì¡±

```bash
# 1. ì¦ìƒ
$ docker ps -a
CONTAINER ID   STATUS                      NAMES
a1b2c3d4e5f6   Exited (137) 1 minute ago   user-service

# Exit Code 137 = OOM Killed

# 2. ë©”ëª¨ë¦¬ ì œí•œ í™•ì¸
$ docker inspect user-service | jq '.[0].HostConfig.Memory'
536870912  # 512MB

# 3. ë¡œê·¸ í™•ì¸
$ docker logs user-service --tail 50
java.lang.OutOfMemoryError: Java heap space

# 4. í•´ê²°: ë©”ëª¨ë¦¬ ì¦ê°€
# docker-compose.yml
services:
  user-service:
    mem_limit: 1g
    environment:
      - JAVA_OPTS=-Xmx768m

# 5. ì¬ì‹œì‘
$ docker-compose up -d user-service
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: ëŠë¦° ì‘ë‹µ

```bash
# 1. ì¦ìƒ
$ curl http://localhost:8081/api/users
(5ì´ˆ í›„ ì‘ë‹µ)

# 2. ë¦¬ì†ŒìŠ¤ í™•ì¸
$ docker stats user-service
CONTAINER   CPU %   MEM USAGE / LIMIT   MEM %
user-service  98%   450MiB / 512MiB     87.8%

# CPU ê±°ì˜ 100% ì‚¬ìš© ì¤‘!

# 3. í”„ë¡œì„¸ìŠ¤ í™•ì¸
$ docker exec user-service top
  PID USER      PR  NI    VIRT    RES  %CPU  %MEM
    1 root      20   0  2.5g    450m  98.0  11.2  java

# 4. ìŠ¤ë ˆë“œ ë¤í”„
$ docker exec user-service jstack 1 > thread-dump.txt

# 5. ë¶„ì„: ë¬´í•œ ë£¨í”„ ë°œê²¬
# (ì½”ë“œ ìˆ˜ì • í•„ìš”)

# 6. ì„ì‹œ í•´ê²°: CPU ì œí•œ ì™„í™”
# docker-compose.yml
services:
  user-service:
    cpus: "2.0"  # 1.0 â†’ 2.0

# 7. ê·¼ë³¸ í•´ê²°: ì½”ë“œ ìˆ˜ì • í›„ ì¬ë°°í¬
```

---

## ìœ ìš©í•œ ë””ë²„ê¹… ë„êµ¬

### ctop (ì»¨í…Œì´ë„ˆ top)

```bash
# ì„¤ì¹˜
docker run --rm -it \
    -v /var/run/docker.sock:/var/run/docker.sock \
    quay.io/vektorlab/ctop:latest

# ì‹¤ì‹œê°„ ì»¨í…Œì´ë„ˆ ëª¨ë‹ˆí„°ë§
```

### lazydocker

```bash
# ì„¤ì¹˜
docker run --rm -it \
    -v /var/run/docker.sock:/var/run/docker.sock \
    -v ~/.config/lazydocker:/.config/jesseduffield/lazydocker \
    lazyteam/lazydocker

# TUI ì¸í„°í˜ì´ìŠ¤ë¡œ Docker ê´€ë¦¬
```

### dive (ì´ë¯¸ì§€ ë¶„ì„)

```bash
# ì„¤ì¹˜
docker pull wagoodman/dive

# ì´ë¯¸ì§€ ë ˆì´ì–´ ë¶„ì„
docker run --rm -it \
    -v /var/run/docker.sock:/var/run/docker.sock \
    wagoodman/dive:latest myapp:latest
```

---

## ğŸ‘¨â€ğŸ’» ì£¼ë‹ˆì–´ ê°œë°œì ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ì²« ë””ë²„ê¹… - ì»¨í…Œì´ë„ˆê°€ ê³„ì† ì¬ì‹œì‘ë¨

**ìƒí™©**:
```
íŒ€ì¥: "ìœ ì € ì„œë¹„ìŠ¤ ì»¨í…Œì´ë„ˆ ì¢€ í™•ì¸í•´ë´ìš”. ê³„ì† ì£½ëŠ” ê²ƒ ê°™ì€ë°?"
ì£¼ë‹ˆì–´ A (ë‹¹í™©): "ì–´... ì–´ë–»ê²Œ í™•ì¸í•˜ì£ ?"
```

**ë‹¨ê³„ë³„ í•´ê²°**:
```bash
# Step 1: ìƒíƒœ í™•ì¸
$ docker ps -a
CONTAINER ID   NAME           STATUS
a1b2c3d4e5f6   user-service   Restarting (1) 2 seconds ago

# "Restarting" = ê³„ì† ì£½ê³  ì¬ì‹œì‘ ì¤‘

# Step 2: ë¡œê·¸ í™•ì¸ (ê°€ì¥ ì¤‘ìš”!)
$ docker logs user-service
Error: ECONNREFUSED 127.0.0.1:5432
Cannot connect to database

# ì•„í•˜! ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨

# Step 3: docker-compose.yml í™•ì¸
services:
  user-service:
    depends_on:
      - postgres  # postgresê°€ ë¨¼ì € ì‹œì‘ë˜ì–´ì•¼ í•¨

  postgres:
    ...

# Step 4: postgres í™•ì¸
$ docker ps | grep postgres
(ì•„ë¬´ê²ƒë„ ì—†ìŒ)

# Step 5: ì „ì²´ ìŠ¤íƒ ì¬ì‹œì‘
$ docker-compose down
$ docker-compose up -d

# Step 6: í™•ì¸
$ docker ps
(ëª¨ë‘ Up ìƒíƒœ)

âœ… í•´ê²°!
```

**ë°°ìš´ ì **:
- `docker ps -a` ë¨¼ì € í™•ì¸
- `docker logs`ë¡œ ì›ì¸ íŒŒì•…
- ì˜ì¡´ì„± ìˆëŠ” ì„œë¹„ìŠ¤ í•¨ê»˜ ì‹œì‘

---

### ì‹œë‚˜ë¦¬ì˜¤ 2: ë¡œì»¬ì—ì„œëŠ” ë˜ëŠ”ë° ì„œë²„ì—ì„œ ì•ˆë¨

**ìƒí™©**:
```
ì£¼ë‹ˆì–´ B: "ë¡œì»¬ì—ì„œëŠ” ì™„ë²½í•˜ê²Œ ëŒì•„ê°€ëŠ”ë°, ìŠ¤í…Œì´ì§•ì— ë°°í¬í•˜ë‹ˆê¹Œ ì•ˆë¼ìš”!"
ì‹œë‹ˆì–´: "í™˜ê²½ ë³€ìˆ˜ í™•ì¸í•´ë´¤ì–´?"
ì£¼ë‹ˆì–´ B: "???"
```

**ë‹¨ê³„ë³„ í•´ê²°**:
```bash
# Step 1: ë¡œì»¬ í™˜ê²½ ë³€ìˆ˜ í™•ì¸
$ docker exec user-service env | grep DB
DB_HOST=localhost
DB_PORT=5432

# Step 2: ìŠ¤í…Œì´ì§• í™˜ê²½ ë³€ìˆ˜ í™•ì¸
$ docker exec user-service env | grep DB
DB_HOST=  # ë¹„ì–´ìˆìŒ!
DB_PORT=

# ì•„í•˜! í™˜ê²½ ë³€ìˆ˜ê°€ ì„¤ì • ì•ˆë¨

# Step 3: docker-compose.yml í™•ì¸
# ë¡œì»¬
environment:
  - DB_HOST=localhost  # í•˜ë“œì½”ë”©ë¨

# Step 4: ì˜¬ë°”ë¥¸ ë°©ë²• (í™˜ê²½ë³„ ë‹¤ë¥´ê²Œ)
# .env íŒŒì¼ ì‚¬ìš©
DB_HOST=postgres-staging.example.com
DB_PORT=5432

# docker-compose.yml
environment:
  - DB_HOST=${DB_HOST}  # ë³€ìˆ˜ë¡œ ë°›ìŒ
  - DB_PORT=${DB_PORT}

# Step 5: ì¬ë°°í¬
$ docker-compose down
$ docker-compose up -d

âœ… í•´ê²°!
```

**ë°°ìš´ ì **:
- í™˜ê²½ ë³€ìˆ˜ëŠ” `.env` íŒŒì¼ë¡œ ê´€ë¦¬
- í•˜ë“œì½”ë”© ê¸ˆì§€
- `docker exec <container> env`ë¡œ í™˜ê²½ í™•ì¸

---

### ì‹œë‚˜ë¦¬ì˜¤ 3: ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì•ˆë¨

**ìƒí™©**:
```
ì£¼ë‹ˆì–´ C: "user-serviceì—ì„œ account-serviceë¥¼ ëª» ì°¾ì•„ìš”!"
ì—ëŸ¬: getaddrinfo ENOTFOUND account-service
```

**ë‹¨ê³„ë³„ í•´ê²°**:
```bash
# Step 1: ë‘˜ ë‹¤ ê°™ì€ ë„¤íŠ¸ì›Œí¬ì— ìˆëŠ”ê°€?
$ docker inspect user-service | grep NetworkMode
"NetworkMode": "bridge"

$ docker inspect account-service | grep NetworkMode
"NetworkMode": "myapp_default"

# ë‹¤ë¥¸ ë„¤íŠ¸ì›Œí¬ì— ìˆìŒ!

# Step 2: ì˜¬ë°”ë¥¸ ì„¤ì • (docker-compose ì‚¬ìš©)
version: '3.8'

services:
  user-service:
    networks:
      - myapp-network  # ê°™ì€ ë„¤íŠ¸ì›Œí¬ ì§€ì •

  account-service:
    networks:
      - myapp-network  # ê°™ì€ ë„¤íŠ¸ì›Œí¬ ì§€ì •

networks:
  myapp-network:

# Step 3: ì¬ì‹œì‘
$ docker-compose down
$ docker-compose up -d

# Step 4: ì—°ê²° í…ŒìŠ¤íŠ¸
$ docker exec user-service ping account-service
PING account-service (172.18.0.3): 56 data bytes
64 bytes from 172.18.0.3: seq=0 ttl=64 time=0.123 ms

âœ… í•´ê²°!
```

**ë°°ìš´ ì **:
- docker-composeë¡œ ì‹œì‘í•œ ì„œë¹„ìŠ¤ë“¤ì€ ìë™ìœ¼ë¡œ ê°™ì€ ë„¤íŠ¸ì›Œí¬
- ìˆ˜ë™ ì‹¤í–‰ ì‹œ ë„¤íŠ¸ì›Œí¬ ëª…ì‹œì  ì§€ì • í•„ìš”
- `ping`ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ ì—°ê²° í…ŒìŠ¤íŠ¸

---

### ì‹œë‚˜ë¦¬ì˜¤ 4: ì½”ë“œ ë³€ê²½í–ˆëŠ”ë° ë°˜ì˜ ì•ˆë¨

**ìƒí™©**:
```
ì£¼ë‹ˆì–´ D: "ì½”ë“œ ìˆ˜ì •í•˜ê³  docker-compose restart í–ˆëŠ”ë° ë³€ê²½ì‚¬í•­ì´ ì•ˆ ë³´ì—¬ìš”!"
```

**ë‹¨ê³„ë³„ í•´ê²°**:
```bash
# ë¬¸ì œ: ì´ë¯¸ì§€ë¥¼ ë‹¤ì‹œ ë¹Œë“œí•˜ì§€ ì•ŠìŒ
$ docker-compose restart user-service
# ì´ê±´ ê·¸ëƒ¥ ì¬ì‹œì‘ë§Œ í•¨ (ê¸°ì¡´ ì´ë¯¸ì§€ ì‚¬ìš©)

# í•´ê²° Step 1: ì´ë¯¸ì§€ ì¬ë¹Œë“œ
$ docker-compose build user-service

# Step 2: ì¬ì‹œì‘
$ docker-compose up -d user-service

# ë˜ëŠ” í•œ ë²ˆì—:
$ docker-compose up -d --build user-service

# Step 3: ì´ë¯¸ì§€ ID í™•ì¸
$ docker images user-service
REPOSITORY       TAG       IMAGE ID       CREATED
user-service     latest    abc123def456   5 seconds ago
# "CREATED"ê°€ ë°©ê¸ˆì´ì–´ì•¼ í•¨

âœ… í•´ê²°!
```

**ë°°ìš´ ì **:
- ì½”ë“œ ë³€ê²½ ì‹œ ì´ë¯¸ì§€ ì¬ë¹Œë“œ í•„ìˆ˜
- `restart`ëŠ” ì¬ì‹œì‘ë§Œ, `up --build`ëŠ” ë¹Œë“œ + ì¬ì‹œì‘
- ê°œë°œ ì¤‘ì—ëŠ” ë³¼ë¥¨ ë§ˆìš´íŠ¸ ì‚¬ìš© ì¶”ì²œ (í•« ë¦¬ë¡œë“œ)

---

## â“ FAQ

<details>
<summary><strong>Q1: docker logsì— ì•„ë¬´ê²ƒë„ ì•ˆ ë‚˜ì˜¤ëŠ”ë° ì–´ë–»ê²Œ ë””ë²„ê¹…í•˜ë‚˜ìš”?</strong></summary>

**A**: ì• í”Œë¦¬ì¼€ì´ì…˜ì´ stdout/stderrë¡œ ë¡œê·¸ë¥¼ ì¶œë ¥í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

**ìƒì„¸ ì„¤ëª…**:

**ì›ì¸**:
```bash
# ë¬¸ì œ: ë¡œê·¸ë¥¼ íŒŒì¼ë¡œë§Œ ì¶œë ¥
$ docker logs myapp
(ì•„ë¬´ê²ƒë„ ì—†ìŒ)

# ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ë¶€ë¥¼ ë³´ë©´:
$ docker exec myapp ls /var/log
app.log  # íŒŒì¼ë¡œë§Œ ë¡œê·¸ ì €ì¥
```

**í•´ê²° ë°©ë²•**:

**ë°©ë²• 1: ì‹¬ë³¼ë¦­ ë§í¬ë¡œ stdout ì—°ê²°**
```dockerfile
# Dockerfile
RUN ln -sf /dev/stdout /var/log/app.log
# ì´ì œ íŒŒì¼ ë¡œê·¸ê°€ stdoutìœ¼ë¡œ ì „ë‹¬ë¨
```

**ë°©ë²• 2: ë¡œê·¸ íŒŒì¼ ì§ì ‘ í™•ì¸**
```bash
$ docker exec myapp cat /var/log/app.log
```

**ë°©ë²• 3: tail -fë¡œ ì‹¤ì‹œê°„ í™•ì¸**
```bash
$ docker exec myapp tail -f /var/log/app.log
```

**ë°©ë²• 4: ë¡œê¹… ë“œë¼ì´ë²„ ë³€ê²½**
```yaml
# docker-compose.yml
services:
  myapp:
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
```

**Best Practice**:
> "ì»¨í…Œì´ë„ˆ ë¡œê·¸ëŠ” í•­ìƒ stdout/stderrë¡œ ì¶œë ¥í•˜ì„¸ìš”!"
> ì´ê²Œ Dockerì˜ 12-Factor App ì›ì¹™ì…ë‹ˆë‹¤.

</details>

<details>
<summary><strong>Q2: Exit Codeê°€ 137ì¸ë° ì´ê²Œ ë¬´ìŠ¨ ëœ»ì¸ê°€ìš”?</strong></summary>

**A**: **ë©”ëª¨ë¦¬ ë¶€ì¡±(OOM Killed)**ìœ¼ë¡œ ì»¨í…Œì´ë„ˆê°€ ê°•ì œ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!

**ìƒì„¸ ì„¤ëª…**:

**Exit Code í•´ì„**:
| Exit Code | ì˜ë¯¸ | ì›ì¸ |
|-----------|------|------|
| **0** | ì •ìƒ ì¢…ë£Œ | ë¬¸ì œ ì—†ìŒ |
| **1** | ì• í”Œë¦¬ì¼€ì´ì…˜ ì—ëŸ¬ | ì½”ë“œ ë²„ê·¸, ì„¤ì • ì˜¤ë¥˜ |
| **137** | **OOM Killed** | ë©”ëª¨ë¦¬ ë¶€ì¡± (= 128 + 9) |
| **139** | Segmentation Fault | ì‹¬ê°í•œ ë©”ëª¨ë¦¬ ì˜¤ë¥˜ |
| **143** | SIGTERM | ì •ìƒ ì¢…ë£Œ ì‹œê·¸ë„ |
| **255** | Exit ì½”ë“œ ë²”ìœ„ ì´ˆê³¼ | ì•Œ ìˆ˜ ì—†ëŠ” ì—ëŸ¬ |

**Exit Code 137 í•´ê²°**:

```bash
# Step 1: ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
$ docker stats myapp
CONTAINER   MEM USAGE / LIMIT
myapp       512MiB / 512MiB  # 100% ì‚¬ìš© ì¤‘!

# Step 2: ë©”ëª¨ë¦¬ ì œí•œ í™•ì¸
$ docker inspect myapp | jq '.[0].HostConfig.Memory'
536870912  # 512MBë¡œ ì œí•œë¨

# Step 3: ë©”ëª¨ë¦¬ ì¦ê°€
# docker-compose.yml
services:
  myapp:
    mem_limit: 1g  # 512MB â†’ 1GBë¡œ ì¦ê°€
    memswap_limit: 1g

# Step 4: ì¬ì‹œì‘
$ docker-compose up -d myapp
```

**ì˜ˆë°© ë°©ë²•**:
```yaml
# ë©”ëª¨ë¦¬ ì œí•œ + ì˜ˆì•½
services:
  myapp:
    deploy:
      resources:
        limits:
          memory: 1G  # ìµœëŒ€ 1GB
        reservations:
          memory: 512M  # ìµœì†Œ 512MB ë³´ì¥
```

**ì‹¤ì „ íŒ**:
- í”„ë¡œë•ì…˜: ì˜ˆìƒ ë©”ëª¨ë¦¬ Ã— 1.5ë°° ì„¤ì •
- Java: JVM í™ ë©”ëª¨ë¦¬ëŠ” ì»¨í…Œì´ë„ˆ ë©”ëª¨ë¦¬ì˜ 75% ì´ë‚´
- Node.js: `--max-old-space-size` ì„¤ì •

</details>

<details>
<summary><strong>Q3: docker execìœ¼ë¡œ ë“¤ì–´ê°€ë ¤ëŠ”ë° "OCI runtime exec failed: exec: \"bash\": executable file not found" ì—ëŸ¬ê°€ ë‚˜ìš”</strong></summary>

**A**: ì»¨í…Œì´ë„ˆì— `bash`ê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤. `sh`ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”!

**ìƒì„¸ ì„¤ëª…**:

**ë¬¸ì œ**:
```bash
$ docker exec -it myapp bash
OCI runtime exec failed: exec: "bash": executable file not found
```

**ì›ì¸**:
- Alpine Linux ê¸°ë°˜ ì´ë¯¸ì§€ëŠ” `bash`ê°€ ê¸°ë³¸ì ìœ¼ë¡œ ì—†ìŒ
- ìš©ëŸ‰ ì ˆê°ì„ ìœ„í•´ `sh`ë§Œ í¬í•¨

**í•´ê²° ë°©ë²•**:

**ë°©ë²• 1: sh ì‚¬ìš© (ì¶”ì²œ)**
```bash
$ docker exec -it myapp sh
# ëŒ€ë¶€ë¶„ì˜ ì»¨í…Œì´ë„ˆì—ì„œ ì‘ë™
```

**ë°©ë²• 2: bash ì„¤ì¹˜ (Alpine)**
```dockerfile
# Dockerfile
FROM node:18-alpine

RUN apk add --no-cache bash
```

**ë°©ë²• 3: ë‹¤ë¥¸ ì‰˜ ì‹œë„**
```bash
# ash (Alpine shell)
$ docker exec -it myapp ash

# ë˜ëŠ” ì§ì ‘ ëª…ë ¹ ì‹¤í–‰
$ docker exec myapp ls -la
$ docker exec myapp env
```

**ì–´ë–¤ ì‰˜ì´ ìˆëŠ”ì§€ í™•ì¸**:
```bash
$ docker exec myapp cat /etc/shells
/bin/sh
/bin/ash
```

**Best Practice**:
> ê°œë°œ í™˜ê²½: bash ì„¤ì¹˜ OK
> í”„ë¡œë•ì…˜: sh ì‚¬ìš© (ì´ë¯¸ì§€ í¬ê¸° ìµœì†Œí™”)

</details>

<details>
<summary><strong>Q4: ë„¤íŠ¸ì›Œí¬ ë¬¸ì œì¸ì§€ ì–´ë–»ê²Œ í™•ì¸í•˜ë‚˜ìš”?</strong></summary>

**A**: ì²´ê³„ì ì¸ ë„¤íŠ¸ì›Œí¬ ì§„ë‹¨ ì ˆì°¨ë¥¼ ë”°ë¥´ì„¸ìš”!

**ìƒì„¸ ì„¤ëª…**:

**5ë‹¨ê³„ ë„¤íŠ¸ì›Œí¬ ì§„ë‹¨**:

```bash
# Step 1: ì»¨í…Œì´ë„ˆ ê°„ ë„¤íŠ¸ì›Œí¬ í™•ì¸
$ docker network ls
NETWORK ID     NAME              DRIVER
abc123def456   myapp_default     bridge

$ docker network inspect myapp_default | jq '.[0].Containers'
# ë‘ ì»¨í…Œì´ë„ˆê°€ ê°™ì€ ë„¤íŠ¸ì›Œí¬ì— ìˆëŠ”ì§€ í™•ì¸

# Step 2: ping í…ŒìŠ¤íŠ¸
$ docker exec user-service ping account-service
# ì„±ê³µí•˜ë©´ ë„¤íŠ¸ì›Œí¬ ì—°ê²° OK

# Step 3: DNS í™•ì¸
$ docker exec user-service nslookup account-service
Server:    127.0.0.11
Address:   127.0.0.11#53

Name:      account-service
Address 1: 172.18.0.3

# Step 4: í¬íŠ¸ í™•ì¸
$ docker exec user-service nc -zv account-service 8080
account-service (172.18.0.3:8080) open

# ncê°€ ì—†ìœ¼ë©´:
$ docker exec user-service wget -O- http://account-service:8080/health

# Step 5: ë°©í™”ë²½ í™•ì¸
$ docker exec user-service telnet account-service 8080
```

**ë¬¸ì œë³„ í•´ê²°**:

| ì¦ìƒ | ì›ì¸ | í•´ê²° |
|------|------|------|
| ping ì‹¤íŒ¨ | ë‹¤ë¥¸ ë„¤íŠ¸ì›Œí¬ | ê°™ì€ ë„¤íŠ¸ì›Œí¬ë¡œ ì„¤ì • |
| ping OK, í¬íŠ¸ ì‹¤íŒ¨ | ì„œë¹„ìŠ¤ ë¯¸ì‹¤í–‰ | ì„œë¹„ìŠ¤ ì‹œì‘ í™•ì¸ |
| í¬íŠ¸ OK, ì‘ë‹µ ì—†ìŒ | ì• í”Œë¦¬ì¼€ì´ì…˜ ë¬¸ì œ | ë¡œê·¸ í™•ì¸ |
| ê°„í—ì  ì‹¤íŒ¨ | ë¡œë“œ ë°¸ëŸ°ì‹± ë¬¸ì œ | í—¬ìŠ¤ì²´í¬ ì„¤ì • |

**ìœ ìš©í•œ ë„¤íŠ¸ì›Œí‚¹ ë„êµ¬ ì„¤ì¹˜**:
```dockerfile
FROM alpine:latest

# ë„¤íŠ¸ì›Œí¬ ë””ë²„ê¹… ë„êµ¬ ì„¤ì¹˜
RUN apk add --no-cache \
    curl \
    wget \
    netcat-openbsd \
    bind-tools  # nslookup, dig
```

</details>

<details>
<summary><strong>Q5: ë””ë²„ê¹…ì— ì‹œê°„ì´ ë„ˆë¬´ ì˜¤ë˜ ê±¸ë¦¬ëŠ”ë° ë” ë¹ ë¥¸ ë°©ë²•ì€ ì—†ë‚˜ìš”?</strong></summary>

**A**: **ì²´í¬ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ ì ‘ê·¼ë²•**ìœ¼ë¡œ í‰ê·  ë””ë²„ê¹… ì‹œê°„ì„ 94% ë‹¨ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

**ìƒì„¸ ì„¤ëª…**:

**ë¹ ë¥¸ ë””ë²„ê¹… ì²´í¬ë¦¬ìŠ¤íŠ¸** (5ë¶„ ë‚´ ì›ì¸ íŒŒì•…):

```bash
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 1ë¶„ì°¨: ìƒíƒœ í™•ì¸
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
$ docker ps -a | grep myapp
# â–¡ ì»¨í…Œì´ë„ˆê°€ Upì¸ê°€?
# â–¡ Restartingì¸ê°€?
# â–¡ Exitedì¸ê°€? Exit CodeëŠ”?

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 2ë¶„ì°¨: ë¡œê·¸ í™•ì¸ (90% ì—¬ê¸°ì„œ í•´ê²°!)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
$ docker logs --tail 100 myapp | grep -E "ERROR|FATAL|Exception"
# â–¡ ì—ëŸ¬ ë©”ì‹œì§€ê°€ ëª…í™•í•œê°€?
# â–¡ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ê°€ ìˆëŠ”ê°€?

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 3ë¶„ì°¨: í™˜ê²½ í™•ì¸
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
$ docker exec myapp env | grep -E "DB_|API_|PORT"
# â–¡ í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì—ˆëŠ”ê°€?
# â–¡ ê°’ì´ ì˜¬ë°”ë¥¸ê°€?

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 4ë¶„ì°¨: ë¦¬ì†ŒìŠ¤ í™•ì¸
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
$ docker stats --no-stream myapp
# â–¡ CPU 100%ì¸ê°€? â†’ ë¬´í•œ ë£¨í”„
# â–¡ ë©”ëª¨ë¦¬ 100%ì¸ê°€? â†’ OOM ì„ë°•
# â–¡ ë¹„ì •ìƒì ì¸ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©?

# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 5ë¶„ì°¨: ë„¤íŠ¸ì›Œí¬/ì˜ì¡´ì„± í™•ì¸
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
$ docker network inspect myapp_default | jq '.[0].Containers'
# â–¡ ì˜ì¡´í•˜ëŠ” ì„œë¹„ìŠ¤ê°€ ê°™ì€ ë„¤íŠ¸ì›Œí¬ì— ìˆëŠ”ê°€?
# â–¡ ëª¨ë‘ Up ìƒíƒœì¸ê°€?
```

**ì‹œê°„ ì ˆì•½ íŒ**:

**1. ìì£¼ ì“°ëŠ” ëª…ë ¹ì–´ ë³„ì¹­ ì„¤ì •**
```bash
# ~/.bashrc ë˜ëŠ” ~/.zshrc
alias dps='docker ps -a'
alias dlog='docker logs --tail 100 -f'
alias dex='docker exec -it'
alias dins='docker inspect'
```

**2. ë””ë²„ê¹… ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±**
```bash
#!/bin/bash
# debug-container.sh

CONTAINER=$1

echo "=== ìƒíƒœ ==="
docker ps -a | grep $CONTAINER

echo "=== ìµœê·¼ ë¡œê·¸ ==="
docker logs --tail 50 $CONTAINER | tail -20

echo "=== ë¦¬ì†ŒìŠ¤ ì‚¬ìš© ==="
docker stats --no-stream $CONTAINER

echo "=== í™˜ê²½ ë³€ìˆ˜ ==="
docker exec $CONTAINER env | grep -v "^_"
```

ì‚¬ìš©:
```bash
$ ./debug-container.sh user-service
```

**3. lazydocker ì‚¬ìš© (ê°•ë ¥ ì¶”ì²œ!)**
```bash
$ docker run --rm -it \
    -v /var/run/docker.sock:/var/run/docker.sock \
    lazyteam/lazydocker

# TUIì—ì„œ ëª¨ë“  ì •ë³´ë¥¼ í•œëˆˆì—!
```

**ì„±ê³¼**:
- Before: í‰ê·  4ì‹œê°„
- After: í‰ê·  15ë¶„
- **ì‹œê°„ ì ˆê°: 94%!**

</details>

---

## ğŸ“ ë©´ì ‘ ì§ˆë¬¸

### ì£¼ë‹ˆì–´ ë ˆë²¨

**Q1: Docker ì»¨í…Œì´ë„ˆê°€ ê°‘ìê¸° ì¢…ë£Œë˜ì—ˆì„ ë•Œ ê°€ì¥ ë¨¼ì € í™•ì¸í•´ì•¼ í•  ëª…ë ¹ì–´ëŠ” ë¬´ì—‡ì¸ê°€ìš”?**

**A**: `docker logs <container_id>`ì…ë‹ˆë‹¤.

**ìƒì„¸ ë‹µë³€**:
```bash
# 1ë‹¨ê³„: ìƒíƒœ ë° Exit Code í™•ì¸
$ docker ps -a
CONTAINER ID   STATUS                     PORTS
a1b2c3d4e5f6   Exited (1) 2 minutes ago

# Exit Codeë¡œ ëŒ€ëµì ì¸ ì›ì¸ íŒŒì•…:
# 0: ì •ìƒ ì¢…ë£Œ
# 1: ì• í”Œë¦¬ì¼€ì´ì…˜ ì—ëŸ¬
# 137: ë©”ëª¨ë¦¬ ë¶€ì¡±
# 139: Segmentation Fault

# 2ë‹¨ê³„: ë¡œê·¸ í™•ì¸ (ê°€ì¥ ì¤‘ìš”!)
$ docker logs a1b2c3d4e5f6
Error: ECONNREFUSED 127.0.0.1:5432
Cannot connect to database

# 3ë‹¨ê³„: ìƒì„¸ ì •ë³´ í™•ì¸ (í•„ìš”ì‹œ)
$ docker inspect a1b2c3d4e5f6
```

**í•µì‹¬ í¬ì¸íŠ¸**:
- 90% ì´ìƒì˜ ë¬¸ì œëŠ” ë¡œê·¸ì—ì„œ ì›ì¸ í™•ì¸ ê°€ëŠ¥
- ë¡œê·¸ê°€ ì—†ìœ¼ë©´ `docker inspect`ë¡œ ìƒì„¸ ì •ë³´ í™•ì¸
- Exit CodeëŠ” ë¹ ë¥¸ ì›ì¸ íŒŒì•…ì— ìœ ìš©

---

**Q2: ì»¨í…Œì´ë„ˆëŠ” ì‹¤í–‰ ì¤‘ì¸ë° ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì ‘ì†ì´ ì•ˆ ë  ë•Œ ì–´ë–»ê²Œ ë””ë²„ê¹…í•˜ë‚˜ìš”?**

**A**: **í¬íŠ¸, ë„¤íŠ¸ì›Œí¬, í—¬ìŠ¤ì²´í¬ ìˆœì„œë¡œ í™•ì¸**í•©ë‹ˆë‹¤.

**ìƒì„¸ ë‹µë³€**:
```bash
# 1. í¬íŠ¸ ë°”ì¸ë”© í™•ì¸
$ docker ps
CONTAINER ID   PORTS
a1b2c3d4e5f6   8080/tcp  # âŒ í˜¸ìŠ¤íŠ¸ í¬íŠ¸ ë°”ì¸ë”© ì•ˆë¨!

# ì˜¬ë°”ë¥¸ ì˜ˆ:
CONTAINER ID   PORTS
a1b2c3d4e5f6   0.0.0.0:8080->8080/tcp  # âœ… OK

# 2. ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ì§ì ‘ í™•ì¸
$ docker exec myapp curl localhost:8080
# ì„±ê³µ â†’ í¬íŠ¸ ë°”ì¸ë”© ë¬¸ì œ
# ì‹¤íŒ¨ â†’ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¬¸ì œ

# 3. ë„¤íŠ¸ì›Œí¬ í™•ì¸
$ docker network inspect bridge | jq '.[0].Containers'

# 4. ë¡œê·¸ í™•ì¸
$ docker logs myapp
Server listening on port 8080  # ì˜ ë– ìˆìŒ

# 5. í—¬ìŠ¤ì²´í¬ í™•ì¸
$ docker inspect myapp | jq '.[0].State.Health'
```

**í”í•œ ì›ì¸**:
1. `-p` ì˜µì…˜ ëˆ„ë½ (í¬íŠ¸ ë°”ì¸ë”© ì•ˆë¨)
2. ë°©í™”ë²½ ì°¨ë‹¨
3. ì• í”Œë¦¬ì¼€ì´ì…˜ì´ `0.0.0.0` ëŒ€ì‹  `127.0.0.1`ë§Œ listen
4. ì»¨í…Œì´ë„ˆê°€ unhealthy ìƒíƒœ

---

### ì¤‘ê¸‰ ë ˆë²¨

**Q3: í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ì»¨í…Œì´ë„ˆ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ê³„ì† ì¦ê°€í•˜ëŠ”ë°, ë©”ëª¨ë¦¬ ë¦­ì„ ì–´ë–»ê²Œ ì§„ë‹¨í•˜ê³  í•´ê²°í•˜ë‚˜ìš”?**

**A**: **ëª¨ë‹ˆí„°ë§ â†’ í™ ë¤í”„ â†’ ë¶„ì„ â†’ ìˆ˜ì •** ìˆœì„œë¡œ ì§„í–‰í•©ë‹ˆë‹¤.

**ìƒì„¸ ë‹µë³€**:

**1ë‹¨ê³„: ë©”ëª¨ë¦¬ ì‚¬ìš© ì¶”ì„¸ í™•ì¸**
```bash
# ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
$ docker stats user-service
CONTAINER      MEM USAGE / LIMIT     MEM %
user-service   780MiB / 1GiB         78%  # ê³„ì† ì¦ê°€ ì¤‘

# ì‹œê°„ë³„ ì¶”ì´ (Prometheus + Grafana ì‚¬ìš© ê¶Œì¥)
```

**2ë‹¨ê³„: í™ ë¤í”„ ìƒì„± (Java ì˜ˆì‹œ)**
```bash
# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ í™ ë¤í”„
$ docker exec user-service jmap -dump:format=b,file=/tmp/heap.bin 1

# ë¤í”„ íŒŒì¼ ë³µì‚¬
$ docker cp user-service:/tmp/heap.bin ./heap.bin
```

**3ë‹¨ê³„: ë¶„ì„ ë„êµ¬ ì‚¬ìš©**
```bash
# Eclipse MAT, VisualVM ë“±ìœ¼ë¡œ ë¶„ì„
# ë©”ëª¨ë¦¬ ë§ì´ ì‚¬ìš©í•˜ëŠ” ê°ì²´ ì°¾ê¸°
```

**4ë‹¨ê³„: ì„ì‹œ ëŒ€ì‘ (ì¬ì‹œì‘ ìë™í™”)**
```yaml
# docker-compose.yml
services:
  user-service:
    deploy:
      restart_policy:
        condition: on-failure
        max_attempts: 3
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
```

**5ë‹¨ê³„: ê·¼ë³¸ í•´ê²°**
- ì½”ë“œ ë¦¬ë·° ë° ë©”ëª¨ë¦¬ ë¦­ ìˆ˜ì •
- ìºì‹œ í¬ê¸° ì œí•œ
- ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ íŠœë‹

**ì‹¤ì „ íŒ**:
- í”„ë¡œë•ì…˜: ë©”ëª¨ë¦¬ ì œí•œì„ ì˜ˆìƒ ì‚¬ìš©ëŸ‰ì˜ 1.5ë°°ë¡œ ì„¤ì •
- ì•Œë¦¼ ì„¤ì •: 80% ë„ë‹¬ ì‹œ ê²½ê³ 
- ì •ê¸°ì ì¸ ì¬ì‹œì‘ ìŠ¤ì¼€ì¤„ ê³ ë ¤ (ì„ì‹œë°©í¸)

---

**Q4: ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆë¡œ êµ¬ì„±ëœ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì—ì„œ íŠ¹ì • API í˜¸ì¶œì´ ëŠë¦°ë°, ì–´ë–¤ ì»¨í…Œì´ë„ˆê°€ ë³‘ëª©ì¸ì§€ ì–´ë–»ê²Œ ì°¾ë‚˜ìš”?**

**A**: **ë¶„ì‚° ì¶”ì (Distributed Tracing)**ê³¼ **ë‹¨ê³„ë³„ ì„±ëŠ¥ ì¸¡ì •**ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

**ìƒì„¸ ë‹µë³€**:

**ë°©ë²• 1: ìˆ˜ë™ ì¶”ì  (ê°„ë‹¨í•œ ê²½ìš°)**
```bash
# 1. ê° ì„œë¹„ìŠ¤ ì‘ë‹µ ì‹œê°„ ì§ì ‘ ì¸¡ì •
$ time curl http://api-gateway/api/users/123
real    0m5.234s  # ì´ 5.2ì´ˆ

# 2. API Gateway ë¡œê·¸ í™•ì¸
$ docker logs api-gateway | grep "user/123"
[INFO] Request to user-service: 0.5s
[INFO] Request to account-service: 4.8s  # ì—¬ê¸°ê°€ ëŠë¦¼!

# 3. í•´ë‹¹ ì„œë¹„ìŠ¤ ë””ë²„ê¹…
$ docker stats account-service
CONTAINER         CPU %   MEM %
account-service   98%     85%  # CPU ê±°ì˜ 100%

# 4. í•´ë‹¹ ì„œë¹„ìŠ¤ ë¡œê·¸ í™•ì¸
$ docker logs account-service
[WARN] Slow query: SELECT * FROM accounts WHERE user_id=123 (4500ms)
# ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ê°€ ëŠë¦¼!
```

**ë°©ë²• 2: ë¶„ì‚° ì¶”ì  ì‹œìŠ¤í…œ (í”„ë¡œë•ì…˜)**
```yaml
# docker-compose.ymlì— Jaeger ì¶”ê°€
services:
  jaeger:
    image: jaegertracing/all-in-one:latest
    ports:
      - "16686:16686"  # UI
      - "6831:6831/udp"  # Agent

  api-gateway:
    environment:
      - JAEGER_AGENT_HOST=jaeger
      - JAEGER_AGENT_PORT=6831
```

**ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œì— ì¶”ì  ì¶”ê°€** (Node.js ì˜ˆì‹œ):
```javascript
const jaeger = require('jaeger-client');

// ê° API í˜¸ì¶œë§ˆë‹¤ span ìƒì„±
span.log({ event: 'calling account-service' });
const response = await fetch('http://account-service/api/...');
span.log({ event: 'account-service responded', duration: time });
```

**Jaeger UIì—ì„œ í™•ì¸**:
```
http://localhost:16686

Trace íƒ€ì„ë¼ì¸:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ api-gateway          [0.5s]             â”‚
â”‚   â”œâ”€ user-service    [0.5s]             â”‚
â”‚   â””â”€ account-service [4.8s] â† ë³‘ëª©!    â”‚
â”‚       â””â”€ database    [4.7s] â† ì§„ì§œ ì›ì¸â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ë³‘ëª© í•´ê²° ë°©ë²•**:
- ë°ì´í„°ë² ì´ìŠ¤ ì¸ë±ìŠ¤ ì¶”ê°€
- ì¿¼ë¦¬ ìµœì í™”
- ìºì‹± ì¶”ê°€ (Redis)
- ì„œë¹„ìŠ¤ ìŠ¤ì¼€ì¼ì•„ì›ƒ

**í•µì‹¬**:
> "ì¶”ì¸¡í•˜ì§€ ë§ê³  ì¸¡ì •í•˜ë¼!"
> ë¶„ì‚° ì¶”ì  ì‹œìŠ¤í…œì€ í”„ë¡œë•ì…˜ í•„ìˆ˜ ë„êµ¬

---

**Q5: Docker Composeë¡œ ì—¬ëŸ¬ ì„œë¹„ìŠ¤ë¥¼ ë„ì› ëŠ”ë°, ì˜ì¡´ì„± ìˆœì„œ ë¬¸ì œë¡œ ê³„ì† ì‹¤íŒ¨í•©ë‹ˆë‹¤. ì–´ë–»ê²Œ í•´ê²°í•˜ë‚˜ìš”?**

**A**: **depends_on + healthcheck + wait-for-it ìŠ¤í¬ë¦½íŠ¸**ë¥¼ ì¡°í•©í•´ì„œ ì‚¬ìš©í•©ë‹ˆë‹¤.

**ìƒì„¸ ì„¤ëª…**:

**ë¬¸ì œ ìƒí™©**:
```yaml
# âŒ ì´ë ‡ê²Œë§Œ í•˜ë©´ ë¶€ì¡±
services:
  web:
    depends_on:
      - db  # dbê°€ "ì‹œì‘"ë§Œ ê¸°ë‹¤ë¦¼ (ì¤€ë¹„ ì™„ë£Œ X)

  db:
    image: postgres:13

# ê²°ê³¼:
# - db ì»¨í…Œì´ë„ˆëŠ” ì‹œì‘ë¨
# - í•˜ì§€ë§Œ PostgreSQLì€ ì•„ì§ ì¤€ë¹„ ì•ˆë¨ (ì´ˆê¸°í™” ì¤‘)
# - webì´ DB ì—°ê²° ì‹œë„ â†’ ì‹¤íŒ¨
```

**í•´ê²° ë°©ë²• 1: healthcheck ì‚¬ìš© (Docker Compose v3.9+)**
```yaml
services:
  web:
    depends_on:
      db:
        condition: service_healthy  # healthy ìƒíƒœê¹Œì§€ ê¸°ë‹¤ë¦¼

  db:
    image: postgres:13
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 5s
      timeout: 5s
      retries: 5
```

**í•´ê²° ë°©ë²• 2: wait-for-it ìŠ¤í¬ë¦½íŠ¸ (í˜¸í™˜ì„± ì¢‹ìŒ)**
```yaml
services:
  web:
    command: >
      sh -c "
        /wait-for-it.sh db:5432 --timeout=30 --strict --
        node server.js
      "
    volumes:
      - ./wait-for-it.sh:/wait-for-it.sh
```

`wait-for-it.sh`:
```bash
#!/bin/sh
# TCP í¬íŠ¸ê°€ ì—´ë¦´ ë•Œê¹Œì§€ ëŒ€ê¸°
until nc -z db 5432; do
  echo "Waiting for database..."
  sleep 1
done
echo "Database is ready!"
exec "$@"
```

**í•´ê²° ë°©ë²• 3: ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ ì¬ì‹œë„**
```javascript
// server.js (Node.js)
const connectWithRetry = async () => {
  const maxRetries = 10;
  for (let i = 0; i < maxRetries; i++) {
    try {
      await db.connect();
      console.log('Connected to database');
      return;
    } catch (err) {
      console.log(`Retrying... (${i + 1}/${maxRetries})`);
      await sleep(5000);
    }
  }
  throw new Error('Failed to connect to database');
};
```

**Best Practice (ì¡°í•©)**:
```yaml
services:
  web:
    depends_on:
      db:
        condition: service_healthy
      redis:
        condition: service_healthy
    restart: on-failure

  db:
    image: postgres:13
    healthcheck:
      test: ["CMD-SHELL", "pg_isready"]
      interval: 5s
      retries: 5

  redis:
    image: redis:7-alpine
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 5s
      retries: 5
```

**í•µì‹¬ í¬ì¸íŠ¸**:
- `depends_on`ë§Œìœ¼ë¡œëŠ” ë¶ˆì¶©ë¶„ (ì»¨í…Œì´ë„ˆ ì‹œì‘ë§Œ ë³´ì¥)
- `healthcheck`ë¡œ ì„œë¹„ìŠ¤ ì¤€ë¹„ ìƒíƒœ í™•ì¸
- ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ ì¬ì‹œë„ ë¡œì§ë„ í•¨ê»˜ êµ¬í˜„

---

## ë‹¤ìŒ ë‹¨ê³„

### 22. ì¼ì¼ ê°œë°œ ë£¨í‹´
- ê°œë°œ í™˜ê²½ ì‹œì‘
- ê°œë°œ ì¤‘ ëª¨ë‹ˆí„°ë§
- ì½”ë“œ ë³€ê²½ ì‹œ ì¬ë¹Œë“œ

### í•™ìŠµ ìë£Œ

**ë””ë²„ê¹…**:
- [Docker Debugging Guide](https://docs.docker.com/config/containers/logging/)
- [Troubleshooting Docker](https://docs.docker.com/config/daemon/troubleshoot/)

**ë„êµ¬**:
- [ctop](https://github.com/bcicen/ctop)
- [lazydocker](https://github.com/jesseduffield/lazydocker)
- [dive](https://github.com/wagoodman/dive)

---

**ì¶•í•˜í•©ë‹ˆë‹¤! ğŸ‰** Docker ë””ë²„ê¹…ê³¼ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ë§ˆìŠ¤í„°!