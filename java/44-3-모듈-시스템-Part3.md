# 44ì¥ ëª¨ë“ˆ ì‹œìŠ¤í…œ (Java 9) - Part 3: ì„±ëŠ¥ ìµœì í™” & ë©´ì ‘ ì§ˆë¬¸

## ğŸ“š ëª©ì°¨
1. [ì„±ëŠ¥ ìµœì í™”](#ì„±ëŠ¥-ìµœì í™”)
2. [jlinkë¥¼ í™œìš©í•œ ì»¤ìŠ¤í…€ ëŸ°íƒ€ì„](#jlinkë¥¼-í™œìš©í•œ-ì»¤ìŠ¤í…€-ëŸ°íƒ€ì„)
3. [ë©´ì ‘ ì§ˆë¬¸](#ë©´ì ‘-ì§ˆë¬¸)

---

## âš¡ ì„±ëŠ¥ ìµœì í™”

### 1. ëª¨ë“ˆ ì‹œìŠ¤í…œì˜ ì„±ëŠ¥ ì´ì 

```java
// Before Java 9 - ëª¨ë“  JDK ë¡œë“œ
java -jar myapp.jar
// â†’ rt.jar ì „ì²´ ë¡œë“œ (63MB)

// After Java 9 - í•„ìš”í•œ ëª¨ë“ˆë§Œ
java --module-path mods --module com.myapp
// â†’ í•„ìš”í•œ ëª¨ë“ˆë§Œ ë¡œë“œ (í›¨ì”¬ ì‘ìŒ)
```

**ì„±ëŠ¥ í–¥ìƒ**:
- ì‹œì‘ ì‹œê°„ 30-50% ë‹¨ì¶•
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ 20-40% ê°ì†Œ
- ë” ì‘ì€ ë°°í¬ í¬ê¸°

---

### 2. jlinkë¡œ ìµœì í™”ëœ ëŸ°íƒ€ì„ ìƒì„±

```bash
# 1. ì»´íŒŒì¼
javac -d mods/com.myapp \
      src/com.myapp/module-info.java \
      src/com.myapp/com/myapp/*.java

# 2. JAR ìƒì„±
jar --create \
    --file=mods/com.myapp.jar \
    -C mods/com.myapp .

# 3. jlinkë¡œ ì»¤ìŠ¤í…€ ëŸ°íƒ€ì„ ìƒì„±
jlink --module-path $JAVA_HOME/jmods:mods \
      --add-modules com.myapp \
      --output myapp-runtime \
      --strip-debug \
      --compress=2 \
      --no-header-files \
      --no-man-pages

# ê²°ê³¼:
# myapp-runtime/ (30-50MB, JDK ì „ì²´ëŠ” 150MB+)
```

---

### 3. í¬ê¸° ë¹„êµ

```bash
# ì „í†µì  ë°©ì‹
JRE + myapp.jar = 150MB + 10MB = 160MB

# jlink ë°©ì‹
myapp-runtime = 35MB (78% ê°ì†Œ!)
```

---

## ğŸš€ jlinkë¥¼ í™œìš©í•œ ì»¤ìŠ¤í…€ ëŸ°íƒ€ì„

### ì˜ˆì œ 1: ìµœì†Œ ëŸ°íƒ€ì„

```bash
# Hello World ì• í”Œë¦¬ì¼€ì´ì…˜
# module-info.java
module hello.world {
    // java.baseëŠ” ìë™ í¬í•¨
}

# HelloWorld.java
package hello;

public class HelloWorld {
    public static void main(String[] args) {
        System.out.println("Hello, World!");
    }
}

# ì»´íŒŒì¼ & íŒ¨í‚¤ì§•
javac -d mods/hello.world \
      src/hello.world/module-info.java \
      src/hello.world/hello/HelloWorld.java

jar --create \
    --file=mods/hello.world.jar \
    --main-class=hello.HelloWorld \
    -C mods/hello.world .

# jlinkë¡œ ìµœì†Œ ëŸ°íƒ€ì„ ìƒì„±
jlink --module-path $JAVA_HOME/jmods:mods \
      --add-modules hello.world \
      --launcher hello=hello.world/hello.HelloWorld \
      --output hello-runtime \
      --strip-debug \
      --compress=2

# ì‹¤í–‰
./hello-runtime/bin/hello
# í¬ê¸°: ì•½ 30MB (JDK ì „ì²´: 150MB)
```

---

### ì˜ˆì œ 2: ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ëŸ°íƒ€ì„

```bash
# í•„ìš”í•œ ëª¨ë“ˆë§Œ í¬í•¨
jlink --module-path $JAVA_HOME/jmods:mods:libs \
      --add-modules com.myapp.web \
      --add-modules java.sql \
      --add-modules java.logging \
      --add-modules jdk.httpserver \
      --launcher myapp=com.myapp.web/com.myapp.Main \
      --output myapp-runtime \
      --strip-debug \
      --compress=2 \
      --no-header-files \
      --no-man-pages

# Docker ì´ë¯¸ì§€ë¡œ íŒ¨í‚¤ì§•
FROM alpine:latest
COPY myapp-runtime /opt/myapp
CMD ["/opt/myapp/bin/myapp"]

# ê²°ê³¼: ì•½ 60MB Docker ì´ë¯¸ì§€
# (ì¼ë°˜ JDK ê¸°ë°˜: 200MB+)
```

---

### ì˜ˆì œ 3: ë‹¤ì¤‘ í”Œë«í¼ ë¹Œë“œ

```bash
# Linux ëŸ°íƒ€ì„
jlink --module-path $JAVA_HOME/jmods:mods \
      --add-modules com.myapp \
      --output myapp-linux \
      --compress=2

# Windows ëŸ°íƒ€ì„
jlink --module-path $JAVA_HOME/jmods:mods \
      --add-modules com.myapp \
      --output myapp-windows \
      --compress=2

# macOS ëŸ°íƒ€ì„
jlink --module-path $JAVA_HOME/jmods:mods \
      --add-modules com.myapp \
      --output myapp-macos \
      --compress=2
```

---

## ğŸ’¡ ë©´ì ‘ ì§ˆë¬¸

### Q1. Java ëª¨ë“ˆ ì‹œìŠ¤í…œì˜ í•µì‹¬ ê°œë…ì€?

**ë‹µë³€**:
```
Java ëª¨ë“ˆ ì‹œìŠ¤í…œ (JPMS - Java Platform Module System)ì˜ í•µì‹¬:

1. ê°•ë ¥í•œ ìº¡ìŠí™”
   - exports í•˜ì§€ ì•Šì€ íŒ¨í‚¤ì§€ëŠ” ì™„ì „íˆ ìˆ¨ê¹€
   - ë¦¬í”Œë ‰ì…˜ìœ¼ë¡œë„ ì ‘ê·¼ ë¶ˆê°€ (opens ì œì™¸)

2. ëª…í™•í•œ ì˜ì¡´ì„±
   - requiresë¡œ ëª…ì‹œì  ì„ ì–¸
   - ìˆœí™˜ ì˜ì¡´ì„± ê°ì§€

3. ëª¨ë“ˆ ê·¸ë˜í”„
   - ì»´íŒŒì¼ íƒ€ì„ì— ì˜ì¡´ì„± ì²´í¬
   - ëˆ„ë½ëœ ëª¨ë“ˆ ì‚¬ì „ ê°ì§€

4. ë” ë‚˜ì€ ì„±ëŠ¥
   - í•„ìš”í•œ ëª¨ë“ˆë§Œ ë¡œë“œ
   - ì‘ì€ ëŸ°íƒ€ì„ ì´ë¯¸ì§€
```

---

### Q2. module-info.javaì˜ ì£¼ìš” í‚¤ì›Œë“œëŠ”?

**ë‹µë³€**:
```java
module com.example.myapp {
    // 1. exports - íŒ¨í‚¤ì§€ ê³µê°œ
    exports com.example.api;
    exports com.example.util to com.example.service;

    // 2. requires - ëª¨ë“ˆ ì˜ì¡´
    requires java.sql;
    requires transitive java.logging;

    // 3. opens - ë¦¬í”Œë ‰ì…˜ í—ˆìš©
    opens com.example.model to com.fasterxml.jackson.databind;

    // 4. provides/uses - ì„œë¹„ìŠ¤
    provides java.sql.Driver with com.mysql.jdbc.Driver;
    uses java.sql.Driver;
}
```

**í‚¤ì›Œë“œ ì„¤ëª…**:
- **exports**: ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ import ê°€ëŠ¥
- **requires**: ë‹¤ë¥¸ ëª¨ë“ˆ ì˜ì¡´
- **requires transitive**: ì „ì´ ì˜ì¡´ì„±
- **opens**: ë¦¬í”Œë ‰ì…˜ ì ‘ê·¼ í—ˆìš©
- **provides/uses**: ServiceLoader íŒ¨í„´

---

### Q3. exportsì™€ opensì˜ ì°¨ì´ëŠ”?

**ë‹µë³€**:
```java
module com.myapp {
    // exports - ì¼ë°˜ ì ‘ê·¼ë§Œ
    exports com.myapp.api;

    // opens - ë¦¬í”Œë ‰ì…˜ë„ í—ˆìš©
    opens com.myapp.model;
}

// ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ
// exports
import com.myapp.api.Service;  // âœ… ê°€ëŠ¥
Service service = new Service();  // âœ… ê°€ëŠ¥

// opens
import com.myapp.model.User;  // âŒ ë¶ˆê°€ëŠ¥ (exports ì•ˆ í•¨)

// í•˜ì§€ë§Œ ë¦¬í”Œë ‰ì…˜ì€ ê°€ëŠ¥
Class<?> clazz = Class.forName("com.myapp.model.User");  // âœ… ê°€ëŠ¥
Field field = clazz.getDeclaredField("name");
field.setAccessible(true);  // âœ… ê°€ëŠ¥ (opens í–ˆìœ¼ë¯€ë¡œ)
```

**ì‚¬ìš© ì‹œê¸°**:
- **exports**: ê³µê°œ API
- **opens**: JPA, Jackson ë“± ë¦¬í”Œë ‰ì…˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© ì‹œ

---

### Q4. requiresì™€ requires transitiveì˜ ì°¨ì´ëŠ”?

**ë‹µë³€**:
```java
// Module A
module com.myapp.core {
    exports com.myapp.core.model;  // User í´ë˜ìŠ¤
}

// Module B
module com.myapp.service {
    requires transitive com.myapp.core;  // transitive!
    exports com.myapp.service.api;
}

// UserService.java
public class UserService {
    public User getUser() { ... }  // Userë¥¼ public APIë¡œ ë…¸ì¶œ
}

// Module C
module com.myapp.web {
    requires com.myapp.service;
    // com.myapp.coreë¥¼ requires ì•ˆ í•´ë„ ë¨!
    // transitiveë¡œ ìë™ ì „ë‹¬
}

// WebController.java
import com.myapp.core.model.User;  // âœ… ê°€ëŠ¥
import com.myapp.service.api.UserService;  // âœ… ê°€ëŠ¥
```

**transitive ì‚¬ìš© ì¡°ê±´**:
- public APIì— ë‹¤ë¥¸ ëª¨ë“ˆì˜ íƒ€ì…ì´ ë…¸ì¶œë  ë•Œ

---

### Q5. ëª¨ë“ˆ ì‹œìŠ¤í…œì˜ ì¥ë‹¨ì ì€?

**ë‹µë³€**:

**ì¥ì **:
```
âœ… ê°•ë ¥í•œ ìº¡ìŠí™” - ë‚´ë¶€ êµ¬í˜„ ì™„ì „íˆ ìˆ¨ê¹€
âœ… ëª…í™•í•œ ì˜ì¡´ì„± - ê·¸ë˜í”„ë¡œ ì‹œê°í™” ê°€ëŠ¥
âœ… ë” ë‚˜ì€ ì„±ëŠ¥ - í•„ìš”í•œ ê²ƒë§Œ ë¡œë“œ
âœ… ì‘ì€ ëŸ°íƒ€ì„ - jlinkë¡œ ìµœì í™”
âœ… ì•ˆì •ì ì¸ API - ê³µê°œ API ëª…ì‹œì  ì„ ì–¸
```

**ë‹¨ì **:
```
âŒ í•™ìŠµ ê³¡ì„  - ìƒˆë¡œìš´ ê°œë…
âŒ ë§ˆì´ê·¸ë ˆì´ì…˜ ë¹„ìš© - ë ˆê±°ì‹œ ì½”ë“œ ìˆ˜ì • í•„ìš”
âŒ ë¼ì´ë¸ŒëŸ¬ë¦¬ í˜¸í™˜ì„± - ëª¨ë“ˆí™” ì•ˆ ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬
âŒ ë³µì¡ì„± ì¦ê°€ - ì‘ì€ í”„ë¡œì íŠ¸ì—ëŠ” ê³¼í•¨
```

---

### Q6. Automatic Moduleì´ë€?

**ë‹µë³€**:
```
Automatic Moduleì€ module-info.java ì—†ëŠ” ì¼ë°˜ JARë¥¼
ëª¨ë“ˆ ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” í˜¸í™˜ì„± ê¸°ëŠ¥ì…ë‹ˆë‹¤.

íŠ¹ì§•:
1. JAR íŒŒì¼ëª…ì´ ëª¨ë“ˆëª…ì´ ë¨
   gson-2.8.jar â†’ ëª¨ë“ˆëª…: gson

2. ëª¨ë“  íŒ¨í‚¤ì§€ê°€ ìë™ìœ¼ë¡œ exportsë¨

3. ëª¨ë“  ë‹¤ë¥¸ ëª¨ë“ˆì„ readsí•  ìˆ˜ ìˆìŒ

4. ìœ„í—˜ì„±:
   - ëª…í™•í•œ ìº¡ìŠí™” ì—†ìŒ
   - ì˜ì¡´ì„±ì´ ë¶ˆëª…í™•
```

```java
// Automatic Module ì‚¬ìš©
module com.myapp {
    requires gson;  // Automatic Module
    requires guava;
}

// ê¶Œì¥: ëª¨ë“ˆí™”ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
module com.myapp {
    requires com.google.gson;  // Named Module
}
```

---

### Q7. jlinkì˜ ì¥ì ì€?

**ë‹µë³€**:
```bash
# ì „í†µì  ë°°í¬
JRE + myapp.jar = 150MB + 10MB = 160MB
ì‹œì‘ ì‹œê°„: 2ì´ˆ
ë©”ëª¨ë¦¬: 200MB

# jlink ë°°í¬
myapp-runtime = 35MB (78% ê°ì†Œ!)
ì‹œì‘ ì‹œê°„: 0.8ì´ˆ (60% ë‹¨ì¶•)
ë©”ëª¨ë¦¬: 120MB (40% ê°ì†Œ)
```

**ì¥ì **:
1. **ì‘ì€ í¬ê¸°** - í•„ìš”í•œ ëª¨ë“ˆë§Œ í¬í•¨
2. **ë¹ ë¥¸ ì‹œì‘** - ì ì€ í´ë˜ìŠ¤ ë¡œë“œ
3. **ë‚®ì€ ë©”ëª¨ë¦¬** - ìµœì í™”ëœ ëŸ°íƒ€ì„
4. **í”Œë«í¼ ë…ë¦½** - ê° OSìš© ëŸ°íƒ€ì„ ìƒì„±
5. **ë³´ì•ˆ** - ë¶ˆí•„ìš”í•œ ëª¨ë“ˆ ì œê±°

---

## ğŸ¯ ì‹¤ì „ ê°€ì´ë“œ

### ëª¨ë“ˆ ì„¤ê³„ íŒ¨í„´

```java
// íŒ¨í„´ 1: API-Implementation ë¶„ë¦¬
module com.myapp.api {
    exports com.myapp.api;
}

module com.myapp.impl {
    requires com.myapp.api;
    exports com.myapp.impl;
    provides com.myapp.api.Service
        with com.myapp.impl.ServiceImpl;
}

// íŒ¨í„´ 2: Core-Service-Web
module com.myapp.core {
    exports com.myapp.core.model;
    exports com.myapp.core.exception;
}

module com.myapp.service {
    requires transitive com.myapp.core;
    exports com.myapp.service.api;
}

module com.myapp.web {
    requires com.myapp.service;
    opens com.myapp.web.controller to spring.core;
}
```

---

### Maven ì„¤ì •

```xml
<!-- pom.xml -->
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>3.11.0</version>
            <configuration>
                <release>17</release>
            </configuration>
        </plugin>

        <!-- jlink í”ŒëŸ¬ê·¸ì¸ -->
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jlink-plugin</artifactId>
            <version>3.1.0</version>
            <extensions>true</extensions>
            <configuration>
                <launcher>myapp=com.myapp/com.myapp.Main</launcher>
                <compress>2</compress>
                <noHeaderFiles>true</noHeaderFiles>
                <noManPages>true</noManPages>
                <stripDebug>true</stripDebug>
            </configuration>
        </plugin>
    </plugins>
</build>
```

---

### Gradle ì„¤ì •

```gradle
// build.gradle
plugins {
    id 'java'
    id 'application'
}

java {
    modularity.inferModulePath = true
    toolchain {
        languageVersion = JavaLanguageVersion.of(17)
    }
}

application {
    mainModule = 'com.myapp'
    mainClass = 'com.myapp.Main'
}

// jlink íƒœìŠ¤í¬
task jlink(type: Exec) {
    commandLine 'jlink',
        '--module-path', "$buildDir/libs:$java.home/jmods",
        '--add-modules', 'com.myapp',
        '--output', "$buildDir/jlink/myapp-runtime",
        '--strip-debug',
        '--compress=2',
        '--no-header-files',
        '--no-man-pages'
}
```

---

## ğŸ“ ìµœì¢… ì •ë¦¬

### ëª¨ë“ˆ ì‹œìŠ¤í…œ í•µì‹¬

```
1. module-info.java - ëª¨ë“ˆ ì„ ì–¸
2. exports - íŒ¨í‚¤ì§€ ê³µê°œ
3. requires - ëª¨ë“ˆ ì˜ì¡´
4. ê°•ë ¥í•œ ìº¡ìŠí™”
5. jlink - ìµœì í™”ëœ ëŸ°íƒ€ì„
```

### ë§ˆì´ê·¸ë ˆì´ì…˜ ìˆœì„œ

```
1. ì˜ì¡´ì„± ë¶„ì„ (jdeps)
2. Bottom-Up ëª¨ë“ˆí™”
3. ìˆœí™˜ ì˜ì¡´ì„± ì œê±°
4. í…ŒìŠ¤íŠ¸ & ê²€ì¦
5. jlink ë°°í¬
```

### ì‹¤ë¬´ ì ìš© ì‹œê¸°

```
âœ… ì ìš© ê¶Œì¥:
- ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤
- ëª…í™•í•œ ê³„ì¸µ êµ¬ì¡°
- ë°°í¬ í¬ê¸°ê°€ ì¤‘ìš”í•œ ê²½ìš°

âŒ ì ìš© ë³´ë¥˜:
- ì†Œê·œëª¨ í”„ë¡œì íŠ¸
- ë ˆê±°ì‹œ ì˜ì¡´ì„± ë§ìŒ
- ë¹ ë¥¸ í”„ë¡œí† íƒ€ì…
```

**ì¶•í•˜í•©ë‹ˆë‹¤! ëª¨ë“ˆ ì‹œìŠ¤í…œì„ ë§ˆìŠ¤í„°í–ˆìŠµë‹ˆë‹¤!** ğŸ‰
