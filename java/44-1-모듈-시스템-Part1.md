# 44ì¥ ëª¨ë“ˆ ì‹œìŠ¤í…œ (Java 9) - Part 1: ì‹¤ìƒí™œ ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°

## ğŸ“š ëª©ì°¨
1. [ëª¨ë“ˆ ì‹œìŠ¤í…œì´ë€?](#ëª¨ë“ˆ-ì‹œìŠ¤í…œì´ë€)
2. [ë¹„ìœ ë¡œ ì´í•´í•˜ê¸°](#ë¹„ìœ ë¡œ-ì´í•´í•˜ê¸°)
3. [ê¸°ë³¸ ë¬¸ë²•](#ê¸°ë³¸-ë¬¸ë²•)
4. [ì‹¤ì „ ì˜ˆì œ](#ì‹¤ì „-ì˜ˆì œ)

---

## ğŸ¯ ëª¨ë“ˆ ì‹œìŠ¤í…œì´ë€?

### Java 9ì˜ í˜ëª…ì  ë³€í™”

**Project Jigsaw** - Javaë¥¼ ëª¨ë“ˆí™”í•˜ì—¬ ë” ì‘ê³ , ë¹ ë¥´ê³ , ì•ˆì „í•˜ê²Œ!

```java
// Before Java 9 - JAR íŒŒì¼
myapp.jar (ëª¨ë“  ê²ƒì´ í•˜ë‚˜ì˜ ë©ì–´ë¦¬)

// After Java 9 - ëª¨ë“ˆ
com.myapp.core
com.myapp.api
com.myapp.service
```

---

## ğŸ“– ë¹„ìœ  1: ë ˆê³  ë¸”ë¡

**ëª¨ë“ˆì€ ë ˆê³  ë¸”ë¡ê³¼ ê°™ìŠµë‹ˆë‹¤.**

```
ğŸ§± ë ˆê³  ë¸”ë¡ (ëª¨ë“ˆ)
â”œâ”€â”€ ê° ë¸”ë¡ì€ ë…ë¦½ì 
â”œâ”€â”€ ì¡°ë¦½ ë°©ë²•ì´ ëª…í™• (requires, exports)
â”œâ”€â”€ í•„ìš”í•œ ë¸”ë¡ë§Œ ì‚¬ìš©
â””â”€â”€ ìˆ¨ê²¨ì§„ ë¶€ë¶„ì€ ì ‘ê·¼ ë¶ˆê°€
```

```java
// module-info.java
module com.myapp.user {
    requires com.myapp.core;      // ë‹¤ë¥¸ ë¸”ë¡ í•„ìš”
    exports com.myapp.user.api;   // ì´ ë¶€ë¶„ë§Œ ë…¸ì¶œ
}
```

---

## ğŸ“– ë¹„ìœ  2: ì•„íŒŒíŠ¸ êµ¬ì¡°

**ëª¨ë“ˆì€ ì•„íŒŒíŠ¸ ê±´ë¬¼ê³¼ ê°™ìŠµë‹ˆë‹¤.**

```
ğŸ¢ ì•„íŒŒíŠ¸ (ì• í”Œë¦¬ì¼€ì´ì…˜)
â”œâ”€â”€ 101í˜¸ (user ëª¨ë“ˆ)
â”‚   â”œâ”€â”€ ê±°ì‹¤ (api íŒ¨í‚¤ì§€) - ê³µê°œ
â”‚   â””â”€â”€ ì¹¨ì‹¤ (internal íŒ¨í‚¤ì§€) - ë¹„ê³µê°œ
â”œâ”€â”€ 102í˜¸ (order ëª¨ë“ˆ)
â”‚   â”œâ”€â”€ ê±°ì‹¤ (api íŒ¨í‚¤ì§€) - ê³µê°œ
â”‚   â””â”€â”€ ì¹¨ì‹¤ (internal íŒ¨í‚¤ì§€) - ë¹„ê³µê°œ
â””â”€â”€ 103í˜¸ (payment ëª¨ë“ˆ)
    â”œâ”€â”€ ê±°ì‹¤ (api íŒ¨í‚¤ì§€) - ê³µê°œ
    â””â”€â”€ ì¹¨ì‹¤ (internal íŒ¨í‚¤ì§€) - ë¹„ê³µê°œ
```

**íŠ¹ì§•**:
- **ê° í˜¸ëŠ” ë…ë¦½ì ** - ëª¨ë“ˆ
- **ê±°ì‹¤ì€ ë°©ë¬¸ ê°€ëŠ¥** - exports
- **ì¹¨ì‹¤ì€ ë¹„ê³µê°œ** - internal
- **ë‹¤ë¥¸ í˜¸ ì´ìš© ì‹œ í—ˆê°€ í•„ìš”** - requires

---

## ğŸ“– ë¹„ìœ  3: ë„ì„œê´€ ì‹œìŠ¤í…œ

**ëª¨ë“ˆì€ ë„ì„œê´€ì˜ ëŒ€ì¶œ ì‹œìŠ¤í…œê³¼ ê°™ìŠµë‹ˆë‹¤.**

```java
// ë„ì„œê´€ (ëª¨ë“ˆ)
module library.system {
    // ëŒ€ì¶œ ê°€ëŠ¥í•œ ì±… (exports)
    exports library.api;

    // ì„œê³ ì— ìˆëŠ” ì±… (ë¹„ê³µê°œ)
    // library.internalì€ exports ì•ˆ í•¨
}

// ì´ìš©ì (ë‹¤ë¥¸ ëª¨ë“ˆ)
module user.app {
    // ë„ì„œê´€ ì´ìš© ì‹ ì²­ (requires)
    requires library.system;
}
```

---

## ğŸ”‘ ê¸°ë³¸ ë¬¸ë²•

### 1. module-info.java

**ëª¨ë“ˆì˜ ì„¤ì • íŒŒì¼ (ê° ëª¨ë“ˆë§ˆë‹¤ í•˜ë‚˜)**

```java
// src/com.myapp.core/module-info.java
module com.myapp.core {
    // ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ ì‚¬ìš©í•  íŒ¨í‚¤ì§€ ê³µê°œ
    exports com.myapp.core.api;

    // íŠ¹ì • ëª¨ë“ˆì—ë§Œ ê³µê°œ
    exports com.myapp.core.internal to com.myapp.service;

    // ë‹¤ë¥¸ ëª¨ë“ˆ ì˜ì¡´
    requires java.sql;
    requires java.logging;
}
```

---

### 2. ì£¼ìš” í‚¤ì›Œë“œ

```java
module com.example.myapp {
    // 1. exports - íŒ¨í‚¤ì§€ ê³µê°œ
    exports com.example.api;

    // 2. requires - ë‹¤ë¥¸ ëª¨ë“ˆ í•„ìš”
    requires java.sql;

    // 3. requires transitive - ì „ì´ ì˜ì¡´ì„±
    requires transitive java.logging;

    // 4. opens - ë¦¬í”Œë ‰ì…˜ í—ˆìš©
    opens com.example.model to com.fasterxml.jackson.databind;

    // 5. provides - ì„œë¹„ìŠ¤ ì œê³µ
    provides java.sql.Driver with com.mysql.jdbc.Driver;

    // 6. uses - ì„œë¹„ìŠ¤ ì‚¬ìš©
    uses java.sql.Driver;
}
```

---

### 3. í”„ë¡œì íŠ¸ êµ¬ì¡°

```
myapp/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ com.myapp.core/
â”‚   â”‚   â”œâ”€â”€ module-info.java
â”‚   â”‚   â””â”€â”€ com/myapp/core/
â”‚   â”‚       â”œâ”€â”€ api/
â”‚   â”‚       â”‚   â””â”€â”€ CoreApi.java
â”‚   â”‚       â””â”€â”€ internal/
â”‚   â”‚           â””â”€â”€ CoreImpl.java
â”‚   â”‚
â”‚   â”œâ”€â”€ com.myapp.service/
â”‚   â”‚   â”œâ”€â”€ module-info.java
â”‚   â”‚   â””â”€â”€ com/myapp/service/
â”‚   â”‚       â”œâ”€â”€ api/
â”‚   â”‚       â”‚   â””â”€â”€ ServiceApi.java
â”‚   â”‚       â””â”€â”€ internal/
â”‚   â”‚           â””â”€â”€ ServiceImpl.java
â”‚   â”‚
â”‚   â””â”€â”€ com.myapp.app/
â”‚       â”œâ”€â”€ module-info.java
â”‚       â””â”€â”€ com/myapp/app/
â”‚           â””â”€â”€ Main.java
```

---

## ğŸ’¡ ì‹¤ì „ ì˜ˆì œ

### ì˜ˆì œ 1: ê°„ë‹¨í•œ 3-Tier ì•„í‚¤í…ì²˜

```java
// ========== ëª¨ë“ˆ 1: Core (ê³µí†µ) ==========
// src/com.myapp.core/module-info.java
module com.myapp.core {
    exports com.myapp.core.model;
    exports com.myapp.core.util;
}

// src/com.myapp.core/com/myapp/core/model/User.java
package com.myapp.core.model;

public class User {
    private Long id;
    private String name;
    private String email;

    // getters, setters, constructor
}

// ========== ëª¨ë“ˆ 2: Service ==========
// src/com.myapp.service/module-info.java
module com.myapp.service {
    requires com.myapp.core;
    requires java.sql;

    exports com.myapp.service.api;
    // internal íŒ¨í‚¤ì§€ëŠ” exports ì•ˆ í•¨
}

// src/com.myapp.service/com/myapp/service/api/UserService.java
package com.myapp.service.api;

import com.myapp.core.model.User;
import java.util.Optional;

public interface UserService {
    Optional<User> findById(Long id);
    User save(User user);
    void delete(Long id);
}

// src/com.myapp.service/com/myapp/service/internal/UserServiceImpl.java
package com.myapp.service.internal;

import com.myapp.service.api.UserService;
import com.myapp.core.model.User;
import java.util.*;

public class UserServiceImpl implements UserService {
    private Map<Long, User> users = new HashMap<>();

    @Override
    public Optional<User> findById(Long id) {
        return Optional.ofNullable(users.get(id));
    }

    @Override
    public User save(User user) {
        users.put(user.getId(), user);
        return user;
    }

    @Override
    public void delete(Long id) {
        users.remove(id);
    }
}

// ========== ëª¨ë“ˆ 3: Application ==========
// src/com.myapp.app/module-info.java
module com.myapp.app {
    requires com.myapp.core;
    requires com.myapp.service;
}

// src/com.myapp.app/com/myapp/app/Main.java
package com.myapp.app;

import com.myapp.core.model.User;
import com.myapp.service.api.UserService;
// import com.myapp.service.internal.UserServiceImpl; // âŒ ì»´íŒŒì¼ ì—ëŸ¬!

public class Main {
    public static void main(String[] args) {
        // UserServiceë§Œ ì ‘ê·¼ ê°€ëŠ¥
        UserService service = ServiceFactory.createUserService();

        User user = new User(1L, "Alice", "alice@example.com");
        service.save(user);

        service.findById(1L)
            .ifPresent(u -> System.out.println("Found: " + u.getName()));
    }
}
```

---

### ì˜ˆì œ 2: ì „ì´ ì˜ì¡´ì„± (requires transitive)

```java
// ========== ëª¨ë“ˆ 1: API ==========
module com.myapp.api {
    requires transitive java.sql;  // ì „ì´ ì˜ì¡´ì„±
    exports com.myapp.api;
}

// ========== ëª¨ë“ˆ 2: Implementation ==========
module com.myapp.impl {
    requires com.myapp.api;
    // java.sqlì„ requires ì•ˆ í•´ë„ ë¨! (transitiveë¡œ ì „ë‹¬)
}
```

**ì „ì´ ì˜ì¡´ì„± ì‚¬ìš© ì‹œê¸°**:
- API ëª¨ë“ˆì´ ë‹¤ë¥¸ ëª¨ë“ˆì˜ íƒ€ì…ì„ public APIì— ë…¸ì¶œí•  ë•Œ

---

### ì˜ˆì œ 3: ì„œë¹„ìŠ¤ ë¡œë” íŒ¨í„´

```java
// ========== ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤ ëª¨ë“ˆ ==========
// module-info.java
module com.myapp.api {
    exports com.myapp.api;
}

// ServiceProvider.java
package com.myapp.api;

public interface ServiceProvider {
    String provide();
}

// ========== ì„œë¹„ìŠ¤ êµ¬í˜„ ëª¨ë“ˆ 1 ==========
// module-info.java
module com.myapp.impl1 {
    requires com.myapp.api;
    provides com.myapp.api.ServiceProvider
        with com.myapp.impl1.ServiceProviderImpl1;
}

// ServiceProviderImpl1.java
package com.myapp.impl1;

import com.myapp.api.ServiceProvider;

public class ServiceProviderImpl1 implements ServiceProvider {
    @Override
    public String provide() {
        return "Implementation 1";
    }
}

// ========== ì„œë¹„ìŠ¤ êµ¬í˜„ ëª¨ë“ˆ 2 ==========
// module-info.java
module com.myapp.impl2 {
    requires com.myapp.api;
    provides com.myapp.api.ServiceProvider
        with com.myapp.impl2.ServiceProviderImpl2;
}

// ========== ì• í”Œë¦¬ì¼€ì´ì…˜ ëª¨ë“ˆ ==========
// module-info.java
module com.myapp.app {
    requires com.myapp.api;
    uses com.myapp.api.ServiceProvider;
}

// Main.java
package com.myapp.app;

import com.myapp.api.ServiceProvider;
import java.util.ServiceLoader;

public class Main {
    public static void main(String[] args) {
        ServiceLoader<ServiceProvider> loader =
            ServiceLoader.load(ServiceProvider.class);

        loader.forEach(provider ->
            System.out.println(provider.provide())
        );
        // ì¶œë ¥:
        // Implementation 1
        // Implementation 2
    }
}
```

---

## ğŸ¯ ëª¨ë“ˆ ì‹œìŠ¤í…œì˜ ì¥ì 

### 1. ê°•ë ¥í•œ ìº¡ìŠí™”

```java
// âŒ Java 8 ì´ì „ - ëª¨ë“  public í´ë˜ìŠ¤ ì ‘ê·¼ ê°€ëŠ¥
// com.myapp.internal.SecretClass ì ‘ê·¼ ê°€ëŠ¥

// âœ… Java 9+ - exports í•˜ì§€ ì•Šìœ¼ë©´ ì ‘ê·¼ ë¶ˆê°€
module com.myapp {
    exports com.myapp.api;  // apië§Œ ê³µê°œ
    // internal íŒ¨í‚¤ì§€ëŠ” ìˆ¨ê¹€
}
```

---

### 2. ëª…í™•í•œ ì˜ì¡´ì„±

```java
// module-info.javaë¥¼ ë³´ë©´ ì˜ì¡´ì„±ì´ í•œëˆˆì—!
module com.myapp.service {
    requires com.myapp.core;
    requires java.sql;
    requires java.logging;
}
```

---

### 3. ì•ˆì •ì ì¸ API

```java
// ê³µê°œ APIë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì„ ì–¸
module com.myapp {
    exports com.myapp.api;  // ì´ê²ƒë§Œ ê³µê°œ API
    // ë‚´ë¶€ êµ¬í˜„ì€ ììœ ë¡­ê²Œ ë³€ê²½ ê°€ëŠ¥
}
```

---

### 4. ë” ì‘ì€ ëŸ°íƒ€ì„

```bash
# í•„ìš”í•œ ëª¨ë“ˆë§Œ í¬í•¨í•˜ì—¬ ì‘ì€ ì´ë¯¸ì§€ ìƒì„±
jlink --module-path $JAVA_HOME/jmods:mods \
      --add-modules com.myapp.app \
      --output myapp-runtime
```

---

## ğŸ“ í•µì‹¬ ìš”ì•½

### ëª¨ë“ˆ ì‹œìŠ¤í…œ 4ëŒ€ ê°œë…

1. **module-info.java**
   - ëª¨ë“ˆ ì„ ì–¸ íŒŒì¼
   - ê° ëª¨ë“ˆì˜ ë£¨íŠ¸ì— ìœ„ì¹˜

2. **exports**
   - íŒ¨í‚¤ì§€ ê³µê°œ
   - ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ ì‚¬ìš© ê°€ëŠ¥

3. **requires**
   - ë‹¤ë¥¸ ëª¨ë“ˆ ì˜ì¡´
   - ëª…í™•í•œ ì˜ì¡´ì„± ì„ ì–¸

4. **ê°•ë ¥í•œ ìº¡ìŠí™”**
   - exports ì•ˆ í•œ íŒ¨í‚¤ì§€ëŠ” ì™„ì „íˆ ìˆ¨ê¹€
   - ë¦¬í”Œë ‰ì…˜ìœ¼ë¡œë„ ì ‘ê·¼ ë¶ˆê°€ (opens ì œì™¸)

### ì£¼ìš” í‚¤ì›Œë“œ

```java
exports      // íŒ¨í‚¤ì§€ ê³µê°œ
requires     // ëª¨ë“ˆ ì˜ì¡´
opens        // ë¦¬í”Œë ‰ì…˜ í—ˆìš©
provides     // ì„œë¹„ìŠ¤ ì œê³µ
uses         // ì„œë¹„ìŠ¤ ì‚¬ìš©
transitive   // ì „ì´ ì˜ì¡´ì„±
```

**ë‹¤ìŒ Part 2**: ê¸°ì—… ì‚¬ë¡€ & ì£¼ë‹ˆì–´ ì‹¤ìˆ˜
