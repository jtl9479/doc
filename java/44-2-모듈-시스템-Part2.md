# 44ì¥ ëª¨ë“ˆ ì‹œìŠ¤í…œ (Java 9) - Part 2: ê¸°ì—… ì‚¬ë¡€ & ì£¼ë‹ˆì–´ ì‹¤ìˆ˜

## ğŸ“š ëª©ì°¨
1. [ê¸°ì—… ì‚¬ë¡€](#ê¸°ì—…-ì‚¬ë¡€)
2. [ì£¼ë‹ˆì–´ ì‹¤ìˆ˜ ì‹œë‚˜ë¦¬ì˜¤](#ì£¼ë‹ˆì–´-ì‹¤ìˆ˜-ì‹œë‚˜ë¦¬ì˜¤)
3. [ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ëµ](#ë§ˆì´ê·¸ë ˆì´ì…˜-ì „ëµ)

---

## ğŸ¢ ê¸°ì—… ì‚¬ë¡€

### ğŸ”· Netflix - ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ëª¨ë“ˆí™”

**ë°°ê²½**: ê±°ëŒ€í•œ ëª¨ë†€ë¦¬ìŠ¤ë¥¼ ëª¨ë“ˆë¡œ ë¶„ë¦¬

```java
// Before - ê±°ëŒ€í•œ JAR
netflix-app.jar (ëª¨ë“  ê¸°ëŠ¥ì´ í•˜ë‚˜ì—)

// After - ëª¨ë“ˆ ì‹œìŠ¤í…œ
module com.netflix.api {
    exports com.netflix.api.streaming;
    exports com.netflix.api.user;
}

module com.netflix.streaming {
    requires com.netflix.api;
    requires transitive com.netflix.core;

    exports com.netflix.streaming.service;
    // internal íŒ¨í‚¤ì§€ëŠ” ìˆ¨ê¹€
}

module com.netflix.recommendation {
    requires com.netflix.api;
    requires com.netflix.core;

    exports com.netflix.recommendation.engine;
}
```

**ì„±ê³¼**:
- ë¹Œë“œ ì‹œê°„ 40% ë‹¨ì¶•
- ëª…í™•í•œ ì˜ì¡´ì„± ê´€ë¦¬
- íŒ€ ê°„ ë…ë¦½ì  ê°œë°œ ê°€ëŠ¥

---

### ğŸ”· Oracle - JDK ìì²´ë¥¼ ëª¨ë“ˆí™”

**Java 9ë¶€í„° JDK ìì²´ê°€ ëª¨ë“ˆí™”ë¨**

```bash
# JDK ëª¨ë“ˆ ëª©ë¡ í™•ì¸
java --list-modules

# ì¶œë ¥:
java.base
java.sql
java.xml
java.desktop
...
```

```java
// ìµœì†Œ ëª¨ë“ˆë§Œ ì‚¬ìš©
module com.myapp {
    requires java.base;  // ê¸°ë³¸ ëª¨ë“ˆ (ìë™ í¬í•¨)
}

// í•„ìš”í•œ ëª¨ë“ˆë§Œ ì¶”ê°€
module com.myapp.db {
    requires java.base;
    requires java.sql;
}
```

**ì„±ê³¼**:
- Hello World ì‹¤í–‰ íŒŒì¼: 150MB â†’ 30MB (80% ê°ì†Œ!)
- ì‹œì‘ ì‹œê°„ ë‹¨ì¶•
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°ì†Œ

---

### ğŸ”· Spring Framework - ëª¨ë“ˆ ì§€ì›

**Spring 5.0+ì—ì„œ ëª¨ë“ˆ ì‹œìŠ¤í…œ ì§€ì›**

```java
// spring-core ëª¨ë“ˆ
module spring.core {
    exports org.springframework.core;
    exports org.springframework.util;

    requires transitive java.logging;
}

// spring-context ëª¨ë“ˆ
module spring.context {
    requires transitive spring.core;
    requires transitive spring.beans;

    exports org.springframework.context;
}

// ì• í”Œë¦¬ì¼€ì´ì…˜ ëª¨ë“ˆ
module com.myapp {
    requires spring.context;
    requires spring.web;

    opens com.myapp.controller to spring.core;  // ë¦¬í”Œë ‰ì…˜ í—ˆìš©
}
```

---

### ğŸ”· ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸ - ëª¨ë“ˆ ë¶„ë¦¬ ì „ëµ

**ë°°ê²½**: 100ë§Œ ë¼ì¸ ì´ìƒì˜ ë ˆê±°ì‹œ í”„ë¡œì íŠ¸

```java
// 1ë‹¨ê³„: API ëª¨ë“ˆ ë¶„ë¦¬
module com.company.api {
    exports com.company.api.user;
    exports com.company.api.order;
    exports com.company.api.payment;
}

// 2ë‹¨ê³„: Core ëª¨ë“ˆ
module com.company.core {
    requires transitive com.company.api;

    exports com.company.core.util;
    exports com.company.core.exception;
}

// 3ë‹¨ê³„: Service ëª¨ë“ˆë“¤
module com.company.user.service {
    requires com.company.core;
    requires java.sql;

    exports com.company.user.service.api;
}

module com.company.order.service {
    requires com.company.core;
    requires com.company.user.service;

    exports com.company.order.service.api;
}

module com.company.payment.service {
    requires com.company.core;
    requires com.company.order.service;

    exports com.company.payment.service.api;
}

// 4ë‹¨ê³„: Web ëª¨ë“ˆ
module com.company.web {
    requires com.company.user.service;
    requires com.company.order.service;
    requires com.company.payment.service;
}
```

**ì„±ê³¼**:
- ìˆœí™˜ ì˜ì¡´ì„± ì œê±°
- ë¹Œë“œ ì‹œê°„ 50% ë‹¨ì¶•
- íŒ€ë³„ ë…ë¦½ ê°œë°œ ê°€ëŠ¥
- ë²„ê·¸ ë°œìƒë¥  30% ê°ì†Œ

---

## ğŸš¨ ì£¼ë‹ˆì–´ ì‹¤ìˆ˜ ì‹œë‚˜ë¦¬ì˜¤

### âŒ ì‹¤ìˆ˜ 1: ìˆœí™˜ ì˜ì¡´ì„±

```java
// âŒ ì˜ëª»ëœ ì½”ë“œ
// module A
module com.myapp.user {
    requires com.myapp.order;  // order í•„ìš”
    exports com.myapp.user;
}

// module B
module com.myapp.order {
    requires com.myapp.user;  // user í•„ìš” â†’ ìˆœí™˜!
    exports com.myapp.order;
}

// ì»´íŒŒì¼ ì—ëŸ¬:
// cyclic dependence involving com.myapp.user

// âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ - ê³µí†µ ëª¨ë“ˆë¡œ ë¶„ë¦¬
module com.myapp.common {
    exports com.myapp.common.model;
}

module com.myapp.user {
    requires com.myapp.common;
    exports com.myapp.user;
}

module com.myapp.order {
    requires com.myapp.common;
    requires com.myapp.user;  // í•œ ë°©í–¥ë§Œ
    exports com.myapp.order;
}
```

**êµí›ˆ**: ëª¨ë“ˆ ê°„ ìˆœí™˜ ì˜ì¡´ì„± ê¸ˆì§€, ê³µí†µ ëª¨ë“ˆë¡œ ë¶„ë¦¬

---

### âŒ ì‹¤ìˆ˜ 2: íŒ¨í‚¤ì§€ ë¶„í•  (Split Package)

```java
// âŒ ì˜ëª»ëœ ì½”ë“œ
// module A
module com.myapp.service1 {
    exports com.myapp.util;  // util íŒ¨í‚¤ì§€ ê³µê°œ
}
// com/myapp/util/StringUtils.java

// module B
module com.myapp.service2 {
    exports com.myapp.util;  // ê°™ì€ íŒ¨í‚¤ì§€!
}
// com/myapp/util/DateUtils.java

// ëŸ°íƒ€ì„ ì—ëŸ¬:
// Package com.myapp.util is declared in modules
// com.myapp.service1 and com.myapp.service2

// âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ - íŒ¨í‚¤ì§€ ë¶„ë¦¬
module com.myapp.service1 {
    exports com.myapp.service1.util;
}

module com.myapp.service2 {
    exports com.myapp.service2.util;
}

// ë˜ëŠ” ê³µí†µ ëª¨ë“ˆë¡œ
module com.myapp.common {
    exports com.myapp.common.util;
}
```

**êµí›ˆ**: í•œ íŒ¨í‚¤ì§€ëŠ” í•œ ëª¨ë“ˆì—ë§Œ

---

### âŒ ì‹¤ìˆ˜ 3: exports vs opens í˜¼ë™

```java
// âŒ ì˜ëª»ëœ ì½”ë“œ
module com.myapp.model {
    exports com.myapp.model;  // ê³µê°œ
}

// ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ ë¦¬í”Œë ‰ì…˜ ì‚¬ìš©
Class<?> clazz = Class.forName("com.myapp.model.User");
Field field = clazz.getDeclaredField("privateField");
field.setAccessible(true);  // IllegalAccessException!

// âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ - opens ì‚¬ìš©
module com.myapp.model {
    exports com.myapp.model;  // ì¼ë°˜ ì ‘ê·¼
    opens com.myapp.model to com.fasterxml.jackson.databind;  // ë¦¬í”Œë ‰ì…˜
}

// ë˜ëŠ” ëª¨ë“  ëª¨ë“ˆì— open
module com.myapp.model {
    exports com.myapp.model;
    opens com.myapp.model;  // ëª¨ë“  ëª¨ë“ˆì— ë¦¬í”Œë ‰ì…˜ í—ˆìš©
}
```

**êµí›ˆ**:
- **exports**: ì¼ë°˜ ì ‘ê·¼
- **opens**: ë¦¬í”Œë ‰ì…˜ í—ˆìš©

---

### âŒ ì‹¤ìˆ˜ 4: transitive ë‚¨ìš©

```java
// âŒ ì˜ëª»ëœ ì½”ë“œ - ëª¨ë“  ì˜ì¡´ì„±ì„ transitiveë¡œ
module com.myapp.service {
    requires transitive java.sql;
    requires transitive java.logging;
    requires transitive java.xml;
    requires transitive com.myapp.core;
}

// âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ - í•„ìš”í•  ë•Œë§Œ transitive
module com.myapp.service {
    requires java.sql;          // ë‚´ë¶€ ì‚¬ìš©
    requires java.logging;      // ë‚´ë¶€ ì‚¬ìš©

    // public APIì— ë…¸ì¶œë˜ëŠ” ê²ƒë§Œ transitive
    requires transitive com.myapp.core;
}
```

**transitive ì‚¬ìš© ì¡°ê±´**:
- public APIì— ë‹¤ë¥¸ ëª¨ë“ˆì˜ íƒ€ì…ì´ ë…¸ì¶œë  ë•Œë§Œ

---

### âŒ ì‹¤ìˆ˜ 5: Automatic Moduleê³¼ì˜ í˜¼ìš©

```java
// âŒ ë¬¸ì œê°€ ë˜ëŠ” ìƒí™©
// ì¼ë°˜ JAR (ëª¨ë“ˆ ì•„ë‹˜)
gson-2.8.jar

// Named Module
module com.myapp {
    requires gson;  // Automatic Moduleë¡œ ì¸ì‹
}

// ìœ„í—˜:
// - gson-2.8.jarì˜ ëª¨ë“  íŒ¨í‚¤ì§€ê°€ exportsë¨
// - ëª…í™•í•œ ì˜ì¡´ì„± ê´€ë¦¬ ë¶ˆê°€

// âœ… ì˜¬ë°”ë¥¸ ì ‘ê·¼
// 1. ëª¨ë“ˆí™”ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
module com.myapp {
    requires com.google.gson;  // ëª…ì‹œì  ëª¨ë“ˆ
}

// 2. ë˜ëŠ” --add-modulesë¡œ ëª…ì‹œ
java --add-modules=gson ...
```

**êµí›ˆ**: ê°€ëŠ¥í•˜ë©´ ëª¨ë“ˆí™”ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©

---

## ğŸ“Š ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ëµ

### 1ë‹¨ê³„: í˜„ì¬ ìƒíƒœ ë¶„ì„

```bash
# 1. ì˜ì¡´ì„± ë¶„ì„
jdeps --module-path libs \
      --print-module-deps \
      myapp.jar

# 2. JDK ë‚´ë¶€ API ì‚¬ìš© í™•ì¸
jdeps --jdk-internals myapp.jar

# 3. íŒ¨í‚¤ì§€ ì˜ì¡´ì„± í™•ì¸
jdeps -verbose:class myapp.jar
```

---

### 2ë‹¨ê³„: Bottom-Up ë§ˆì´ê·¸ë ˆì´ì…˜

```java
// Step 1: ê°€ì¥ í•˜ìœ„ ëª¨ë“ˆë¶€í„° (Core)
module com.myapp.core {
    exports com.myapp.core.util;
    exports com.myapp.core.model;
}

// Step 2: ì¤‘ê°„ ëª¨ë“ˆ (Service)
module com.myapp.service {
    requires com.myapp.core;
    exports com.myapp.service.api;
}

// Step 3: ìµœìƒìœ„ ëª¨ë“ˆ (Application)
module com.myapp.app {
    requires com.myapp.service;
}
```

---

### 3ë‹¨ê³„: Unnamed Module í™œìš©

```java
// ì•„ì§ ëª¨ë“ˆí™” ì•ˆ ëœ ì½”ë“œëŠ” classpathì—
javac --module-path mods \
      --class-path legacy-libs/* \
      -d out \
      src/com.myapp/module-info.java \
      src/com.myapp/com/myapp/*.java

// Unnamed Moduleì—ì„œëŠ” Named Module ì ‘ê·¼ ê°€ëŠ¥
// Named Moduleì—ì„œëŠ” Unnamed Module ì ‘ê·¼ ë¶ˆê°€
```

---

### 4ë‹¨ê³„: ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜

```bash
# Phase 1: API ëª¨ë“ˆë¶€í„°
create module com.myapp.api

# Phase 2: Core ëª¨ë“ˆ
create module com.myapp.core

# Phase 3: Service ëª¨ë“ˆë“¤
create module com.myapp.user.service
create module com.myapp.order.service

# Phase 4: Web/App ëª¨ë“ˆ
create module com.myapp.web
```

---

## ğŸ¯ ì‹¤ë¬´ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ëª¨ë“ˆ ì„¤ê³„ ì›ì¹™

```
âœ… ë‹¨ì¼ ì±…ì„ ì›ì¹™
   - í•œ ëª¨ë“ˆì€ í•œ ê°€ì§€ ì±…ì„

âœ… ëª…í™•í•œ API
   - exportsëŠ” ìµœì†Œí•œìœ¼ë¡œ

âœ… ì•ˆì •ì ì¸ ì˜ì¡´ì„±
   - ìˆœí™˜ ì˜ì¡´ì„± ì œê±°

âœ… ëŠìŠ¨í•œ ê²°í•©
   - ì¸í„°í˜ì´ìŠ¤ í™œìš©
```

### ë§ˆì´ê·¸ë ˆì´ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
âœ… ì˜ì¡´ì„± ë¶„ì„ ì™„ë£Œ
âœ… JDK ë‚´ë¶€ API ì‚¬ìš© ì œê±°
âœ… ìˆœí™˜ ì˜ì¡´ì„± í•´ê²°
âœ… íŒ¨í‚¤ì§€ ë¶„í•  ë¬¸ì œ í•´ê²°
âœ… í…ŒìŠ¤íŠ¸ ì½”ë“œ ëª¨ë“ˆí™”
âœ… ë¹Œë“œ ë„êµ¬ ì„¤ì • (Maven/Gradle)
```

---

## ğŸ“ í•µì‹¬ ìš”ì•½

### ëª¨ë“ˆ ì‹œìŠ¤í…œ DO & DON'T

```
âœ… DO
- ëª…í™•í•œ API ì„¤ê³„
- ìˆœí™˜ ì˜ì¡´ì„± ì œê±°
- í•„ìš”í•œ ê²ƒë§Œ exports
- Bottom-Up ë§ˆì´ê·¸ë ˆì´ì…˜

âŒ DON'T
- ìˆœí™˜ ì˜ì¡´ì„± ìƒì„±
- íŒ¨í‚¤ì§€ ë¶„í• 
- transitive ë‚¨ìš©
- ëª¨ë“  íŒ¨í‚¤ì§€ exports
```

**ë‹¤ìŒ Part 3**: ì„±ëŠ¥ ìµœì í™” & ë©´ì ‘ ì§ˆë¬¸
