# 30ì¥: ìë™ ì„¤ì • ì›ë¦¬ - Spring Bootì˜ ë§ˆë²•ì„ íŒŒí—¤ì¹˜ë‹¤

> **"ìë™ìœ¼ë¡œ ëŒì•„ê°€ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ê·¸ ì•ˆì—ëŠ” ì •êµí•œ ë©”ì»¤ë‹ˆì¦˜ì´ ìˆ¨ì–´ìˆìŠµë‹ˆë‹¤"**

---

## ğŸ“‹ í•™ìŠµ ëª©í‘œ

ì´ ì¥ì„ í•™ìŠµí•˜ë©´ ë‹¤ìŒì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- Spring Boot ìë™ ì„¤ì •ì˜ ë‚´ë¶€ ë™ì‘ ì›ë¦¬ë¥¼ ì´í•´í•©ë‹ˆë‹¤
- @Conditional ì• ë…¸í…Œì´ì…˜ì˜ ë‹¤ì–‘í•œ í™œìš©ë²•ì„ ìµí™ë‹ˆë‹¤
- ì»¤ìŠ¤í…€ ìë™ ì„¤ì •ì„ ì§ì ‘ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤
- ìë™ ì„¤ì • ë””ë²„ê¹… ë° ë¬¸ì œ í•´ê²° ë°©ë²•ì„ ìŠµë“í•©ë‹ˆë‹¤
- spring.factoriesì™€ AutoConfiguration.importsë¥¼ ì´í•´í•©ë‹ˆë‹¤

**ì˜ˆìƒ í•™ìŠµ ì‹œê°„**: 3-4ì‹œê°„
**ë‚œì´ë„**: â­â­â­â­ (ì¤‘ê³ ê¸‰)

---

## ğŸ¤” ì™œ ìë™ ì„¤ì • ì›ë¦¬ë¥¼ ì•Œì•„ì•¼ í•˜ëŠ”ê°€?

### ë¬¸ì œ ìƒí™©: ë¸”ë™ë°•ìŠ¤ì˜ í•¨ì •

#### ë¬¸ì œ 1: ì˜ˆìƒì¹˜ ëª»í•œ Bean ì¶©ëŒ

```java
// ê°œë°œìê°€ ì‘ì„±í•œ DataSource
@Configuration
public class MyConfig {
    @Bean
    public DataSource dataSource() {
        return new HikariDataSource();  // ë‚´ê°€ ë§Œë“  DataSource
    }
}

// ë¬¸ì œ ë°œìƒ!
// Spring Bootë„ DataSourceë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•˜ë ¤ê³  í•¨
// â†’ ì–´ë–¤ Beanì´ ì‚¬ìš©ë ê¹Œ?
// â†’ ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ ë™ì‘
```

**ê°œë°œìì˜ í˜¼ë€:**
- "ë‚´ê°€ ë§Œë“  Beanì´ ë¬´ì‹œë‹¹í–ˆì–´ìš”"
- "ì™œ ì´ ì„¤ì •ì´ ì ìš© ì•ˆ ë˜ì£ ?"
- "ìë™ ì„¤ì •ì„ ì–´ë–»ê²Œ ë„ë‚˜ìš”?"

#### ë¬¸ì œ 2: ë””ë²„ê¹… ì–´ë ¤ì›€

```
ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ì‹¤íŒ¨:
Error creating bean with name 'dataSource'

// ë¡œê·¸ 100ì¤„...
// ì–´ë””ì„œ ë¬´ì—‡ì´ ì˜ëª»ëœ ê±¸ê¹Œ?
// ìë™ ì„¤ì •? ë‚´ ì„¤ì •? ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¬¸ì œ?
```

#### ë¬¸ì œ 3: ì„±ëŠ¥ ì´ìŠˆ

```java
// í•„ìš” ì—†ëŠ” ìë™ ì„¤ì •ì´ ë¡œë”©ë˜ì–´ ì‹œì‘ ì‹œê°„ ì¦ê°€
// ì˜ˆ: MongoDBë¥¼ ì•ˆ ì“°ëŠ”ë° MongoDB ìë™ ì„¤ì •ì´ ì‹¤í–‰ë¨
```

### ìë™ ì„¤ì • ì›ë¦¬ë¥¼ ì•Œë©´

```java
// âœ… ì •í™•í•œ ì œì–´
@SpringBootApplication(exclude = {
    DataSourceAutoConfiguration.class  // ìë™ ì„¤ì • ì œì™¸
})

// âœ… ì¡°ê±´ë¶€ Bean ìƒì„±
@Configuration
@ConditionalOnMissingBean(DataSource.class)  // ì—†ì„ ë•Œë§Œ ìƒì„±
public class MyConfig {
    @Bean
    public DataSource dataSource() {
        return new HikariDataSource();
    }
}

// âœ… ë””ë²„ê¹… ëŠ¥ë ¥
// --debug ì˜µì…˜ìœ¼ë¡œ ì–´ë–¤ ìë™ ì„¤ì •ì´ ì ìš©ë˜ì—ˆëŠ”ì§€ í™•ì¸
java -jar app.jar --debug
```

---

## ğŸŒ ì‹¤ìƒí™œ ë¹„ìœ ë¡œ ì´í•´í•˜ëŠ” ìë™ ì„¤ì •

### ë¹„ìœ  1: ìŠ¤ë§ˆíŠ¸ ì˜¨ë„ ì¡°ì ˆê¸°

**ì „í†µ ë°©ì‹ (ìˆ˜ë™ ì„¤ì •):**
```
ë§¤ì¼ ì•„ì¹¨ 6ì‹œ: ë‚œë°© 22ë„ë¡œ ì„¤ì •
ë§¤ì¼ ì˜¤ì „ 9ì‹œ: ë‚œë°© 18ë„ë¡œ ë‚®ì¶¤
ë§¤ì¼ ì˜¤í›„ 6ì‹œ: ë‚œë°© 23ë„ë¡œ ì˜¬ë¦¼
ë§¤ì¼ ë°¤ 11ì‹œ: ë‚œë°© 20ë„ë¡œ ë‚®ì¶¤
â†’ ë§¤ë²ˆ ìˆ˜ë™ìœ¼ë¡œ ì¡°ì ˆ
```

**ìë™ ì„¤ì • (ìŠ¤ë§ˆíŠ¸ ì˜¨ë„ ì¡°ì ˆê¸°):**
```
ì„¼ì„œê°€ ê°ì§€:
- ì‚¬ëŒì´ ìˆëŠ”ê°€? â†’ ë‚œë°© ON
- ë°– ì˜¨ë„ëŠ”? â†’ ì ì • ì˜¨ë„ ìë™ ê³„ì‚°
- ì‹œê°„ëŒ€ëŠ”? â†’ ìˆ˜ë©´/í™œë™ ëª¨ë“œ ìë™ ì „í™˜
â†’ ì¡°ê±´ì— ë”°ë¼ ìë™ ì¡°ì ˆ
```

**Spring Boot ìë™ ì„¤ì •:**
```java
@ConditionalOnClass(DataSource.class)  // DataSource í´ë˜ìŠ¤ ìˆìœ¼ë©´
@ConditionalOnMissingBean  // DataSource Bean ì—†ìœ¼ë©´
public class DataSourceAutoConfiguration {
    @Bean
    public DataSource dataSource() {
        // ìë™ìœ¼ë¡œ DataSource ìƒì„±
    }
}
```

### ë¹„ìœ  2: ìë™ ì£¼ì°¨ ì‹œìŠ¤í…œ

**ìˆ˜ë™ ì£¼ì°¨:**
```
1. ì£¼ì°¨ ê³µê°„ ì°¾ê¸°
2. ê°ë„ ê³„ì‚°
3. í•¸ë“¤ ì¡°ì‘
4. ì „ì§„/í›„ì§„ ë°˜ë³µ
5. ë¯¸ì„¸ ì¡°ì •
â†’ ìš´ì „ìê°€ ëª¨ë“  ê²ƒì„ ì§ì ‘
```

**ìë™ ì£¼ì°¨:**
```
ì‹œìŠ¤í…œì´ íŒë‹¨:
- ì£¼ì°¨ ê³µê°„ í¬ê¸° ì¶©ë¶„? â†’ YES â†’ ìë™ ì£¼ì°¨ ì‹œì‘
- ì£¼ì°¨ ê³µê°„ í¬ê¸° ì¶©ë¶„? â†’ NO â†’ "ê³µê°„ ë¶€ì¡±" ì•Œë¦¼
- ì¥ì• ë¬¼ ê°ì§€? â†’ YES â†’ ì¦‰ì‹œ ì •ì§€
â†’ ì¡°ê±´ íŒë‹¨ í›„ ìë™ ì‹¤í–‰
```

**@Conditional ë™ì‘:**
```java
@Configuration
@ConditionalOnClass(name = "javax.sql.DataSource")  // ê³µê°„ ìˆë‚˜?
@ConditionalOnMissingBean(DataSource.class)  // ì´ë¯¸ ì£¼ì°¨ëœ ì°¨ ì—†ë‚˜?
public class AutoConfig {
    @Bean
    public DataSource dataSource() {
        return new HikariDataSource();  // ìë™ ì£¼ì°¨
    }
}
```

### ë¹„ìœ  3: ì‹ë‹¹ ì£¼ë°©ì˜ ìë™í™”

**ì „í†µ ì£¼ë°©:**
```
ì£¼ë¬¸: "íŒŒìŠ¤íƒ€ 1ê°œ"
â†’ ì…°í”„ê°€ ì§ì ‘:
   1. ëƒ„ë¹„ì— ë¬¼ ë“ì´ê¸°
   2. ë©´ ì‚¶ê¸°
   3. ì†ŒìŠ¤ ë§Œë“¤ê¸°
   4. í”Œë ˆì´íŒ…
```

**ìë™í™” ì£¼ë°©:**
```
ì£¼ë¬¸: "íŒŒìŠ¤íƒ€ 1ê°œ"
â†’ ì‹œìŠ¤í…œ íŒë‹¨:
   - ë©´ ì¬ê³  ìˆë‚˜? â†’ YES â†’ ìë™ ì¡°ë¦¬ ì‹œì‘
   - íŒŒìŠ¤íƒ€ ì†ŒìŠ¤ ìˆë‚˜? â†’ YES â†’ ì†ŒìŠ¤ ì¤€ë¹„
   - í† í•‘ ìˆë‚˜? â†’ NO â†’ ê¸°ë³¸ íŒŒìŠ¤íƒ€ë§Œ ì œê³µ
â†’ ì¡°ê±´ì— ë”°ë¼ ìë™ ì²˜ë¦¬
```

**spring.factories ë©”ì»¤ë‹ˆì¦˜:**
```
META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports

// ì£¼ë°©ì˜ ë ˆì‹œí”¼ë¶
DataSourceAutoConfiguration
JpaAutoConfiguration
WebMvcAutoConfiguration
// í•„ìš”í•œ ê²ƒë§Œ ìë™ìœ¼ë¡œ ì‹¤í–‰
```

---

## ğŸ’¡ ìë™ ì„¤ì • í•µì‹¬ ê°œë…

### 1ï¸âƒ£ ì´ˆê¸‰: @EnableAutoConfigurationì˜ ë™ì‘

#### ë™ì‘ íë¦„

```
ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘
     â†“
@SpringBootApplication ì²˜ë¦¬
     â†“
@EnableAutoConfiguration í™œì„±í™”
     â†“
AutoConfigurationImportSelector ì‹¤í–‰
     â†“
spring.factories íŒŒì¼ ì½ê¸°
     â†“
ìë™ ì„¤ì • í´ë˜ìŠ¤ ëª©ë¡ ë¡œë“œ
     â†“
@Conditional ì¡°ê±´ í‰ê°€
     â†“
ì¡°ê±´ ë§Œì¡±í•˜ëŠ” Beanë§Œ ìƒì„±
```

#### spring.factories íŒŒì¼ êµ¬ì¡°

**Spring Boot 3.0 ì´ì „:**
```properties
# META-INF/spring.factories
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration
```

**Spring Boot 3.0 ì´í›„:**
```
# META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports
org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration
org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration
org.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration
```

#### ìë™ ì„¤ì • í´ë˜ìŠ¤ ì˜ˆì‹œ

```java
@Configuration(proxyBeanMethods = false)
@ConditionalOnClass({ DataSource.class, EmbeddedDatabaseType.class })
@ConditionalOnMissingBean(type = "io.r2dbc.spi.ConnectionFactory")
@EnableConfigurationProperties(DataSourceProperties.class)
@Import({ DataSourcePoolMetadataProvidersConfiguration.class,
          DataSourceInitializationConfiguration.class })
public class DataSourceAutoConfiguration {

    @Configuration(proxyBeanMethods = false)
    @Conditional(EmbeddedDatabaseCondition.class)
    @ConditionalOnMissingBean({ DataSource.class, XADataSource.class })
    @Import(EmbeddedDataSourceConfiguration.class)
    protected static class EmbeddedDatabaseConfiguration {
    }

    @Configuration(proxyBeanMethods = false)
    @Conditional(PooledDataSourceCondition.class)
    @ConditionalOnMissingBean({ DataSource.class, XADataSource.class })
    @Import({ DataSourceConfiguration.Hikari.class,
              DataSourceConfiguration.Tomcat.class,
              DataSourceConfiguration.Dbcp2.class })
    protected static class PooledDataSourceConfiguration {
    }
}
```

### 2ï¸âƒ£ ì¤‘ê¸‰: @Conditional ì• ë…¸í…Œì´ì…˜ ì™„ì „ ì •ë³µ

#### ì£¼ìš” @Conditional ì• ë…¸í…Œì´ì…˜

| ì• ë…¸í…Œì´ì…˜ | ì¡°ê±´ | ì‚¬ìš© ì˜ˆì‹œ |
|----------|------|----------|
| `@ConditionalOnClass` | í´ë˜ìŠ¤íŒ¨ìŠ¤ì— íŠ¹ì • í´ë˜ìŠ¤ ì¡´ì¬ | `@ConditionalOnClass(DataSource.class)` |
| `@ConditionalOnMissingClass` | í´ë˜ìŠ¤íŒ¨ìŠ¤ì— íŠ¹ì • í´ë˜ìŠ¤ ì—†ìŒ | `@ConditionalOnMissingClass("com.example.Custom")` |
| `@ConditionalOnBean` | íŠ¹ì • íƒ€ì…ì˜ Bean ì¡´ì¬ | `@ConditionalOnBean(DataSource.class)` |
| `@ConditionalOnMissingBean` | íŠ¹ì • íƒ€ì…ì˜ Bean ì—†ìŒ | `@ConditionalOnMissingBean(DataSource.class)` |
| `@ConditionalOnProperty` | í”„ë¡œí¼í‹°ê°€ íŠ¹ì • ê°’ | `@ConditionalOnProperty(name="app.enabled", havingValue="true")` |
| `@ConditionalOnResource` | íŠ¹ì • ë¦¬ì†ŒìŠ¤ ì¡´ì¬ | `@ConditionalOnResource(resources="classpath:config.yml")` |
| `@ConditionalOnWebApplication` | ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ | `@ConditionalOnWebApplication` |
| `@ConditionalOnExpression` | SpEL í‘œí˜„ì‹ | `@ConditionalOnExpression("${app.enabled:false}")` |

#### ì‹¤ì „ ì˜ˆì œ

**ì˜ˆì œ 1: í´ë˜ìŠ¤ ì¡´ì¬ ì—¬ë¶€**

```java
@Configuration
@ConditionalOnClass(name = "redis.clients.jedis.Jedis")
public class RedisAutoConfiguration {

    @Bean
    @ConditionalOnMissingBean
    public RedisTemplate<Object, Object> redisTemplate(
            RedisConnectionFactory connectionFactory) {
        RedisTemplate<Object, Object> template = new RedisTemplate<>();
        template.setConnectionFactory(connectionFactory);
        return template;
    }
}
```

**ì˜ˆì œ 2: Bean ì¡´ì¬ ì—¬ë¶€**

```java
@Configuration
public class DataSourceConfig {

    // 1ìˆœìœ„: ê°œë°œìê°€ ì§ì ‘ ë§Œë“  DataSource ì‚¬ìš©
    // (ì´ë¯¸ ìˆìœ¼ë©´ ì•„ë˜ Beanì€ ìƒì„± ì•ˆ ë¨)

    // 2ìˆœìœ„: ìë™ ì„¤ì •
    @Bean
    @ConditionalOnMissingBean(DataSource.class)
    public DataSource dataSource() {
        return DataSourceBuilder.create().build();
    }
}
```

**ì˜ˆì œ 3: í”„ë¡œí¼í‹° ê¸°ë°˜ ì¡°ê±´**

```java
@Configuration
@ConditionalOnProperty(
    prefix = "app.cache",
    name = "enabled",
    havingValue = "true",
    matchIfMissing = false  // í”„ë¡œí¼í‹° ì—†ìœ¼ë©´ false
)
public class CacheConfig {

    @Bean
    public CacheManager cacheManager() {
        return new ConcurrentMapCacheManager("users", "products");
    }
}
```

```yaml
# application.yml
app:
  cache:
    enabled: true  # ì´ ê°’ì´ trueì¼ ë•Œë§Œ CacheConfig í™œì„±í™”
```

**ì˜ˆì œ 4: ë³µí•© ì¡°ê±´**

```java
@Configuration
@ConditionalOnClass(DataSource.class)
@ConditionalOnProperty(name = "spring.datasource.url")
public class DatabaseConfig {

    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnProperty(name = "app.database.pool", havingValue = "hikari")
    public DataSource hikariDataSource() {
        return new HikariDataSource();
    }

    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnProperty(name = "app.database.pool", havingValue = "tomcat")
    public DataSource tomcatDataSource() {
        return new org.apache.tomcat.jdbc.pool.DataSource();
    }
}
```

### 3ï¸âƒ£ ê³ ê¸‰: ì»¤ìŠ¤í…€ ìë™ ì„¤ì • ë§Œë“¤ê¸°

#### ì‹œë‚˜ë¦¬ì˜¤: íšŒì‚¬ ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬ ìë™ ì„¤ì •

**ìš”êµ¬ì‚¬í•­:**
- ëª¨ë“  í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê³µí†µ ê¸°ëŠ¥ ìë™ ì„¤ì •
- API í´ë¼ì´ì–¸íŠ¸ ìë™ ìƒì„±
- ë¡œê¹… ì„¤ì • ìë™ ì ìš©

#### Step 1: í”„ë¡œí¼í‹° í´ë˜ìŠ¤ ì‘ì„±

```java
package com.company.autoconfigure;

import org.springframework.boot.context.properties.ConfigurationProperties;

@ConfigurationProperties(prefix = "company.api")
public class CompanyApiProperties {

    /**
     * API ì„œë²„ URL
     */
    private String baseUrl = "https://api.company.com";

    /**
     * íƒ€ì„ì•„ì›ƒ (ms)
     */
    private int timeout = 5000;

    /**
     * ì¬ì‹œë„ íšŸìˆ˜
     */
    private int retryCount = 3;

    /**
     * API í™œì„±í™” ì—¬ë¶€
     */
    private boolean enabled = true;

    // Getter, Setter
    public String getBaseUrl() { return baseUrl; }
    public void setBaseUrl(String baseUrl) { this.baseUrl = baseUrl; }
    public int getTimeout() { return timeout; }
    public void setTimeout(int timeout) { this.timeout = timeout; }
    public int getRetryCount() { return retryCount; }
    public void setRetryCount(int retryCount) { this.retryCount = retryCount; }
    public boolean isEnabled() { return enabled; }
    public void setEnabled(boolean enabled) { this.enabled = enabled; }
}
```

#### Step 2: API í´ë¼ì´ì–¸íŠ¸ ì‘ì„±

```java
package com.company.autoconfigure;

import org.springframework.web.client.RestTemplate;

public class CompanyApiClient {

    private final RestTemplate restTemplate;
    private final CompanyApiProperties properties;

    public CompanyApiClient(RestTemplate restTemplate, CompanyApiProperties properties) {
        this.restTemplate = restTemplate;
        this.properties = properties;
    }

    public <T> T get(String path, Class<T> responseType) {
        String url = properties.getBaseUrl() + path;
        return restTemplate.getForObject(url, responseType);
    }

    public <T> T post(String path, Object request, Class<T> responseType) {
        String url = properties.getBaseUrl() + path;
        return restTemplate.postForObject(url, request, responseType);
    }
}
```

#### Step 3: ìë™ ì„¤ì • í´ë˜ìŠ¤ ì‘ì„±

```java
package com.company.autoconfigure;

import org.springframework.boot.autoconfigure.AutoConfiguration;
import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;
import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.http.client.ClientHttpRequestFactory;
import org.springframework.http.client.SimpleClientHttpRequestFactory;
import org.springframework.web.client.RestTemplate;

@AutoConfiguration
@ConditionalOnClass(RestTemplate.class)
@ConditionalOnProperty(
    prefix = "company.api",
    name = "enabled",
    havingValue = "true",
    matchIfMissing = true
)
@EnableConfigurationProperties(CompanyApiProperties.class)
public class CompanyApiAutoConfiguration {

    @Bean
    @ConditionalOnMissingBean
    public RestTemplate companyRestTemplate(CompanyApiProperties properties) {
        RestTemplate restTemplate = new RestTemplate();
        restTemplate.setRequestFactory(clientHttpRequestFactory(properties));
        return restTemplate;
    }

    private ClientHttpRequestFactory clientHttpRequestFactory(CompanyApiProperties properties) {
        SimpleClientHttpRequestFactory factory = new SimpleClientHttpRequestFactory();
        factory.setConnectTimeout(properties.getTimeout());
        factory.setReadTimeout(properties.getTimeout());
        return factory;
    }

    @Bean
    @ConditionalOnMissingBean
    public CompanyApiClient companyApiClient(
            RestTemplate restTemplate,
            CompanyApiProperties properties) {
        return new CompanyApiClient(restTemplate, properties);
    }
}
```

#### Step 4: AutoConfiguration.imports íŒŒì¼ ìƒì„±

```
# src/main/resources/META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports
com.company.autoconfigure.CompanyApiAutoConfiguration
```

#### Step 5: ì‚¬ìš©í•˜ê¸°

**1. ë¼ì´ë¸ŒëŸ¬ë¦¬ ë°°í¬**
```gradle
// company-spring-boot-starter í”„ë¡œì íŠ¸
dependencies {
    implementation 'org.springframework.boot:spring-boot-starter'
    implementation 'org.springframework.boot:spring-boot-starter-web'
}
```

**2. ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©**
```gradle
// ì‹¤ì œ ì• í”Œë¦¬ì¼€ì´ì…˜ í”„ë¡œì íŠ¸
dependencies {
    implementation 'com.company:company-spring-boot-starter:1.0.0'
}
```

```yaml
# application.yml
company:
  api:
    base-url: https://api.company.com
    timeout: 10000
    retry-count: 5
    enabled: true
```

```java
@RestController
@RequiredArgsConstructor
public class MyController {

    private final CompanyApiClient apiClient;  // ìë™ ì£¼ì…!

    @GetMapping("/data")
    public MyData getData() {
        return apiClient.get("/v1/data", MyData.class);
    }
}
```

---

## ğŸ› ï¸ ê¸°ë³¸ ì‹¤ìŠµ

### ì‹¤ìŠµ 1: ìë™ ì„¤ì • ë””ë²„ê¹…

#### Step 1: ë””ë²„ê·¸ ëª¨ë“œ í™œì„±í™”

```yaml
# application.yml
debug: true
```

ë˜ëŠ”

```bash
java -jar app.jar --debug
```

#### Step 2: ë¡œê·¸ í™•ì¸

```
============================
CONDITIONS EVALUATION REPORT
============================

Positive matches:
-----------------

DataSourceAutoConfiguration matched:
   - @ConditionalOnClass found required classes 'javax.sql.DataSource' (OnClassCondition)

JpaRepositoriesAutoConfiguration matched:
   - @ConditionalOnClass found required class 'org.springframework.data.jpa.repository.JpaRepository' (OnClassCondition)

Negative matches:
-----------------

MongoAutoConfiguration:
   Did not match:
      - @ConditionalOnClass did not find required class 'com.mongodb.client.MongoClient' (OnClassCondition)

RedisAutoConfiguration:
   Did not match:
      - @ConditionalOnClass did not find required class 'org.springframework.data.redis.core.RedisOperations' (OnClassCondition)
```

#### Step 3: íŠ¹ì • ìë™ ì„¤ì • ì œì™¸

```java
@SpringBootApplication(exclude = {
    DataSourceAutoConfiguration.class,
    HibernateJpaAutoConfiguration.class
})
public class MyApplication {
    public static void main(String[] args) {
        SpringApplication.run(MyApplication.class, args);
    }
}
```

ë˜ëŠ”

```yaml
spring:
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration
```

---

### ì‹¤ìŠµ 2: ì¡°ê±´ë¶€ Bean ìƒì„±

```java
@Configuration
public class ConditionalConfig {

    // 1. ê°œë°œ í™˜ê²½ì—ì„œë§Œ H2 ì½˜ì†” í™œì„±í™”
    @Bean
    @Profile("dev")
    @ConditionalOnClass(name = "org.h2.server.web.WebServlet")
    public ServletRegistrationBean<WebServlet> h2Console() {
        String path = "/h2-console";
        WebServlet servlet = new WebServlet();
        ServletRegistrationBean<WebServlet> registration =
            new ServletRegistrationBean<>(servlet, path + "/*");
        registration.setLoadOnStartup(1);
        return registration;
    }

    // 2. Redisê°€ ìˆì„ ë•Œë§Œ ìºì‹œ ë§¤ë‹ˆì € ìƒì„±
    @Bean
    @ConditionalOnClass(RedisConnectionFactory.class)
    @ConditionalOnMissingBean(CacheManager.class)
    public CacheManager redisCacheManager(RedisConnectionFactory connectionFactory) {
        RedisCacheConfiguration config = RedisCacheConfiguration.defaultCacheConfig()
            .entryTtl(Duration.ofMinutes(10));

        return RedisCacheManager.builder(connectionFactory)
            .cacheDefaults(config)
            .build();
    }

    // 3. í”„ë¡œí¼í‹° ê¸°ë°˜ ì¡°ê±´
    @Bean
    @ConditionalOnProperty(name = "app.feature.new-ui", havingValue = "true")
    public NewUiService newUiService() {
        return new NewUiService();
    }

    @Bean
    @ConditionalOnProperty(name = "app.feature.new-ui", havingValue = "false", matchIfMissing = true)
    public OldUiService oldUiService() {
        return new OldUiService();
    }
}
```

---

### ì‹¤ìŠµ 3: ì»¤ìŠ¤í…€ Condition ë§Œë“¤ê¸°

```java
// 1. Condition ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
public class LinuxCondition implements Condition {

    @Override
    public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {
        String osName = context.getEnvironment().getProperty("os.name");
        return osName != null && osName.toLowerCase().contains("linux");
    }
}

// 2. ì‚¬ìš©
@Configuration
public class OsSpecificConfig {

    @Bean
    @Conditional(LinuxCondition.class)
    public CommandLineRunner linuxRunner() {
        return args -> System.out.println("Running on Linux!");
    }

    @Bean
    @ConditionalOnProperty(name = "os.name", havingValue = "Windows")
    public CommandLineRunner windowsRunner() {
        return args -> System.out.println("Running on Windows!");
    }
}
```

---

## ğŸ‘¨â€ğŸ’» ì£¼ë‹ˆì–´ ê°œë°œì ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤: "ìë™ ì„¤ì • ì¶©ëŒ í•´ê²°"

**ìƒí™©:**
```
í”„ë¡œì íŠ¸ì— Spring Security ì˜ì¡´ì„± ì¶”ê°€ í›„
ëª¨ë“  APIê°€ 401 Unauthorized ì—ëŸ¬ ë°œìƒ

ì›ì¸: Spring Security ìë™ ì„¤ì •ì´ í™œì„±í™”ë˜ì–´
      ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ì— ì¸ì¦ ìš”êµ¬
```

#### í•´ê²° ê³¼ì •

**1ë‹¨ê³„: ë¬¸ì œ íŒŒì•…**
```bash
# ë””ë²„ê·¸ ëª¨ë“œë¡œ ì‹¤í–‰
java -jar app.jar --debug | grep Security

# ê²°ê³¼
SecurityAutoConfiguration matched:
   - @ConditionalOnClass found required class 'org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration'
```

**2ë‹¨ê³„: ìë™ ì„¤ì • í™•ì¸**
```java
// SecurityAutoConfigurationì´ ìë™ìœ¼ë¡œ ìƒì„±í•œ ê²ƒ
@Bean
@ConditionalOnMissingBean
public SecurityFilterChain defaultSecurityFilterChain(HttpSecurity http) {
    http.authorizeHttpRequests(auth -> auth.anyRequest().authenticated());
    // ëª¨ë“  ìš”ì²­ì— ì¸ì¦ í•„ìš”!
    return http.build();
}
```

**3ë‹¨ê³„: í•´ê²° ë°©ë²• ì„ íƒ**

**ë°©ë²• 1: ìë™ ì„¤ì • ì œì™¸ (ë¹„ì¶”ì²œ)**
```java
@SpringBootApplication(exclude = SecurityAutoConfiguration.class)
```

**ë°©ë²• 2: ì»¤ìŠ¤í…€ ì„¤ì •ìœ¼ë¡œ ì˜¤ë²„ë¼ì´ë“œ (ê¶Œì¥)**
```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/api/public/**").permitAll()  // ê³µê°œ API
                .requestMatchers("/api/admin/**").hasRole("ADMIN")
                .anyRequest().authenticated()
            )
            .csrf(csrf -> csrf.disable())  // ê°œë°œ ë‹¨ê³„ì—ì„œë§Œ
            .formLogin(form -> form.disable());

        return http.build();
    }
}
```

**ê²°ê³¼:**
- ê³µê°œ APIëŠ” ì¸ì¦ ì—†ì´ ì ‘ê·¼ ê°€ëŠ¥
- ê´€ë¦¬ì APIëŠ” ADMIN ê¶Œí•œ í•„ìš”
- ë‚˜ë¨¸ì§€ëŠ” ì¸ì¦ í•„ìš”

---

## ğŸ¢ ê¸°ì—… ì‚¬ë¡€: Spotify

### ë°°ê²½

SpotifyëŠ” ìˆ˜ì²œ ê°œì˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ ìš´ì˜í•˜ë©°, ê³µí†µ ê¸°ëŠ¥ì„ ìë™ ì„¤ì •ìœ¼ë¡œ í‘œì¤€í™”í–ˆìŠµë‹ˆë‹¤.

**ìš”êµ¬ì‚¬í•­:**
- ëª¨ë“  ì„œë¹„ìŠ¤ì— ê³µí†µ ë¡œê¹…, ë©”íŠ¸ë¦­, íŠ¸ë ˆì´ì‹± ì ìš©
- ê°œë°œìê°€ ë³„ë„ ì„¤ì • ì—†ì´ ì‚¬ìš© ê°€ëŠ¥
- íŒ€ë³„ ì»¤ìŠ¤í„°ë§ˆì´ì§• í—ˆìš©

### í•´ê²°ì±…: ì»¤ìŠ¤í…€ ìŠ¤íƒ€í„°

```java
// spotify-spring-boot-starter
@AutoConfiguration
@ConditionalOnProperty(name = "spotify.features.enabled", havingValue = "true", matchIfMissing = true)
@EnableConfigurationProperties(SpotifyProperties.class)
public class SpotifyAutoConfiguration {

    @Bean
    @ConditionalOnMissingBean
    public SpotifyMetricsCollector metricsCollector() {
        return new SpotifyMetricsCollector();
    }

    @Bean
    @ConditionalOnClass(name = "io.opentelemetry.api.trace.Tracer")
    public SpotifyTracingInterceptor tracingInterceptor() {
        return new SpotifyTracingInterceptor();
    }

    @Bean
    @ConditionalOnProperty(name = "spotify.logging.enhanced", havingValue = "true")
    public EnhancedLoggingAspect loggingAspect() {
        return new EnhancedLoggingAspect();
    }
}
```

**íš¨ê³¼:**
- ì‹ ê·œ ì„œë¹„ìŠ¤ ìƒì„± ì‹œê°„ 50% ë‹¨ì¶•
- í‘œì¤€í™”ë¡œ ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ
- ì˜¨ë³´ë”© ì‹œê°„ 70% ê°ì†Œ

---

## â“ FAQ

### Q1. ìë™ ì„¤ì •ì´ ì ìš©ë˜ì§€ ì•Šì•„ìš”

**A:** ì¡°ê±´ì„ í™•ì¸í•˜ì„¸ìš”.

```bash
# ë””ë²„ê·¸ ëª¨ë“œë¡œ í™•ì¸
java -jar app.jar --debug | grep -A 5 "YourAutoConfiguration"

# Negative matches ì„¹ì…˜ í™•ì¸
Negative matches:
-----------------
YourAutoConfiguration:
   Did not match:
      - @ConditionalOnClass did not find required class 'com.example.Required'
```

**í•´ê²°:**
1. í•„ìš”í•œ ì˜ì¡´ì„± ì¶”ê°€
2. í”„ë¡œí¼í‹° ê°’ í™•ì¸
3. @ComponentScan ë²”ìœ„ í™•ì¸

### Q2. ë‚´ Beanì´ ìë™ ì„¤ì • Beanì— ì˜í•´ ë¬´ì‹œë‹¹í•´ìš”

**A:** Bean ìƒì„± ìˆœì„œ ë¬¸ì œì…ë‹ˆë‹¤.

```java
// âŒ ë¬¸ì œ ìƒí™©
@Configuration
public class MyConfig {
    @Bean
    public DataSource myDataSource() {
        // ìë™ ì„¤ì •ì´ ë¨¼ì € ì‹¤í–‰ë˜ì–´ ì´ Beanì´ ë¬´ì‹œë¨
    }
}

// âœ… í•´ê²° ë°©ë²• 1: @Primary
@Bean
@Primary
public DataSource myDataSource() {
    return new HikariDataSource();
}

// âœ… í•´ê²° ë°©ë²• 2: ìë™ ì„¤ì • ì œì™¸
@SpringBootApplication(exclude = DataSourceAutoConfiguration.class)
```

### Q3. ìë™ ì„¤ì •ì˜ ìˆœì„œë¥¼ ì œì–´í•  ìˆ˜ ìˆë‚˜ìš”?

**A:** `@AutoConfigureBefore`, `@AutoConfigureAfter` ì‚¬ìš©

```java
@AutoConfiguration
@AutoConfigureBefore(DataSourceAutoConfiguration.class)
public class MyAutoConfiguration {
    // DataSourceAutoConfiguration ë³´ë‹¤ ë¨¼ì € ì‹¤í–‰
}

@AutoConfiguration
@AutoConfigureAfter(RedisAutoConfiguration.class)
public class CacheAutoConfiguration {
    // RedisAutoConfiguration ì´í›„ ì‹¤í–‰
}
```

### Q4. @ConditionalOnMissingBeanì€ ì •í™•íˆ ì–¸ì œ í‰ê°€ë˜ë‚˜ìš”?

**A:** ì„¤ì • í´ë˜ìŠ¤ ì²˜ë¦¬ ì‹œì ì— í‰ê°€ë©ë‹ˆë‹¤.

```java
@Configuration
public class Config1 {
    @Bean
    @ConditionalOnMissingBean
    public MyService myService() {
        return new MyServiceImpl1();
    }
}

@Configuration
@DependsOn("config1")  // ìˆœì„œ ë³´ì¥ ì•ˆ ë¨!
public class Config2 {
    @Bean
    @ConditionalOnMissingBean
    public MyService myService() {
        return new MyServiceImpl2();  // ë‘˜ ì¤‘ í•˜ë‚˜ë§Œ ìƒì„±ë¨
    }
}
```

**í•´ê²°:**
```java
// í•œ ê³³ì—ì„œ ê´€ë¦¬
@Configuration
public class UnifiedConfig {

    @Bean
    @ConditionalOnProperty(name = "my.service.type", havingValue = "impl1")
    public MyService myService1() {
        return new MyServiceImpl1();
    }

    @Bean
    @ConditionalOnProperty(name = "my.service.type", havingValue = "impl2", matchIfMissing = true)
    public MyService myService2() {
        return new MyServiceImpl2();
    }
}
```

### Q5. ì„±ëŠ¥ì„ ìœ„í•´ ìë™ ì„¤ì •ì„ ìµœì í™”í•˜ë ¤ë©´?

**A:** ë¶ˆí•„ìš”í•œ ìë™ ì„¤ì • ì œì™¸

```java
@SpringBootApplication(exclude = {
    MongoAutoConfiguration.class,        // MongoDB ì•ˆ ì“°ë©´
    RedisAutoConfiguration.class,        // Redis ì•ˆ ì“°ë©´
    KafkaAutoConfiguration.class,        // Kafka ì•ˆ ì“°ë©´
    ElasticsearchDataAutoConfiguration.class  // Elasticsearch ì•ˆ ì“°ë©´
})
```

```yaml
# ë˜ëŠ” application.yml
spring:
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration
      - org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
```

---

## ğŸ’¼ ë©´ì ‘ ì§ˆë¬¸ TOP 5

### â­ ì´ˆê¸‰ 1: Spring Boot ìë™ ì„¤ì •ì€ ì–´ë–»ê²Œ ë™ì‘í•˜ë‚˜ìš”?

**ë‹µë³€:**

```
1. @EnableAutoConfiguration ì²˜ë¦¬
2. AutoConfigurationImportSelector ì‹¤í–‰
3. spring.factories ë˜ëŠ” AutoConfiguration.imports ì½ê¸°
4. ìë™ ì„¤ì • í´ë˜ìŠ¤ ë¡œë“œ
5. @Conditional ì¡°ê±´ í‰ê°€
6. ì¡°ê±´ ë§Œì¡± ì‹œ Bean ìƒì„±
```

### â­ ì´ˆê¸‰ 2: @ConditionalOnMissingBeanì˜ ìš©ë„ëŠ”?

**ë‹µë³€:**
ê°œë°œìê°€ ì§ì ‘ Beanì„ ì •ì˜í•˜ì§€ ì•Šì•˜ì„ ë•Œë§Œ ìë™ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ì¡°ê±´ì…ë‹ˆë‹¤.

```java
@Bean
@ConditionalOnMissingBean(DataSource.class)
public DataSource dataSource() {
    // ê°œë°œìê°€ DataSourceë¥¼ ë§Œë“¤ì§€ ì•Šì•˜ì„ ë•Œë§Œ ì‹¤í–‰
    return DataSourceBuilder.create().build();
}
```

### â­â­ ì¤‘ê¸‰ 1: ìë™ ì„¤ì • í´ë˜ìŠ¤ë¥¼ ë§Œë“œëŠ” ë°©ë²•ì€?

**ë‹µë³€:**

```java
// 1. ìë™ ì„¤ì • í´ë˜ìŠ¤ ì‘ì„±
@AutoConfiguration
@ConditionalOnClass(MyService.class)
@EnableConfigurationProperties(MyProperties.class)
public class MyAutoConfiguration {
    @Bean
    public MyService myService() {
        return new MyService();
    }
}

// 2. AutoConfiguration.imports íŒŒì¼ ìƒì„±
// META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports
com.example.MyAutoConfiguration
```

### â­â­ ì¤‘ê¸‰ 2: ì—¬ëŸ¬ @Conditionalì„ ì¡°í•©í•˜ë©´ ANDì¸ê°€ ORì¸ê°€?

**ë‹µë³€:**
**AND ì¡°ê±´**ì…ë‹ˆë‹¤. ëª¨ë“  ì¡°ê±´ì´ ë§Œì¡±í•´ì•¼ Beanì´ ìƒì„±ë©ë‹ˆë‹¤.

```java
@Configuration
@ConditionalOnClass(DataSource.class)         // AND
@ConditionalOnProperty(name = "app.enabled")  // AND
@ConditionalOnMissingBean(DataSource.class)   // AND
public class MyConfig {
    // 3ê°œ ì¡°ê±´ ëª¨ë‘ ë§Œì¡±í•´ì•¼ í™œì„±í™”
}
```

### â­â­ ì¤‘ê¸‰ 3: ìë™ ì„¤ì • ë””ë²„ê¹… ë°©ë²•ì€?

**ë‹µë³€:**

```bash
# 1. ë””ë²„ê·¸ ëª¨ë“œ
java -jar app.jar --debug

# 2. Actuator ì‚¬ìš©
# build.gradle
implementation 'org.springframework.boot:spring-boot-starter-actuator'

# í™•ì¸
curl http://localhost:8080/actuator/conditions

# 3. ë¡œê·¸ ë ˆë²¨ ì¡°ì •
logging:
  level:
    org.springframework.boot.autoconfigure: DEBUG
```

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

ìë™ ì„¤ì • ì›ë¦¬ë¥¼ ë§ˆì³¤ë‹¤ë©´:

1. **31ì¥: í”„ë¡œí¼í‹° ê´€ë¦¬** - ì™¸ë¶€ ì„¤ì • ì™„ë²½ ì´í•´
2. **32ì¥: Actuator** - ìš´ì˜ ëª¨ë‹ˆí„°ë§
3. **ì»¤ìŠ¤í…€ ìŠ¤íƒ€í„° ê°œë°œ** - ì‚¬ë‚´ í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì œì‘

---

**ğŸ“ í•™ìŠµ ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸:**

- [ ] @EnableAutoConfiguration ë™ì‘ ì›ë¦¬ ì´í•´
- [ ] spring.factories íŒŒì¼ ì—­í•  íŒŒì•…
- [ ] @Conditional ì• ë…¸í…Œì´ì…˜ í™œìš©
- [ ] ì»¤ìŠ¤í…€ ìë™ ì„¤ì • í´ë˜ìŠ¤ ì‘ì„±
- [ ] ìë™ ì„¤ì • ë””ë²„ê¹… ë°©ë²• ìŠµë“
- [ ] Bean ì¶©ëŒ ë¬¸ì œ í•´ê²° ëŠ¥ë ¥

**ë‹¤ìŒ ì¥ì—ì„œëŠ” í”„ë¡œí¼í‹° ê´€ë¦¬ì™€ ì™¸ë¶€ ì„¤ì •ì„ ë§ˆìŠ¤í„°í•©ë‹ˆë‹¤!** ğŸš€
