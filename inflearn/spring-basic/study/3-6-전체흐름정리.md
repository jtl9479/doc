# 3-6. ì „ì²´ íë¦„ ì •ë¦¬

**ì¶œì²˜**: ì¸í”„ëŸ° - ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ ê¸°ë³¸í¸
**ì±•í„°**: 3. ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ ì´í•´2 - ê°ì²´ ì§€í–¥ ì›ë¦¬ ì ìš©

---

## í•™ìŠµ ëª©í‘œ

- [ ] ì§€ê¸ˆê¹Œì§€ì˜ ì „ì²´ íë¦„ì„ ì •ë¦¬í•  ìˆ˜ ìˆë‹¤
- [ ] ê° ë‹¨ê³„ë³„ ê°œì„  ì‚¬í•­ì„ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤
- [ ] Before/After ë¹„êµë¥¼ í†µí•´ ê°œì„  íš¨ê³¼ë¥¼ ì´í•´í•œë‹¤

---

## ì§€ê¸ˆê¹Œì§€ì˜ íë¦„ ìš”ì•½

### 1ë‹¨ê³„: ìƒˆë¡œìš´ í• ì¸ ì •ì±… ê°œë°œ

**ëª©í‘œ**: ì •ë¥ % í• ì¸ ì •ì±… ì¶”ê°€

**ê²°ê³¼**:
- âœ… ë‹¤í˜•ì„± ë•ë¶„ì— ìƒˆë¡œìš´ ì •ë¥  í• ì¸ ì •ì±… ì½”ë“œë¥¼ ì¶”ê°€ë¡œ ê°œë°œí•˜ëŠ” ê²ƒ ìì²´ëŠ” ì•„ë¬´ ë¬¸ì œê°€ ì—†ìŒ

**êµ¬í˜„**:
```java
public class RateDiscountPolicy implements DiscountPolicy {
    private int discountPercent = 10;

    @Override
    public int discount(Member member, int price) {
        if (member.getGrade() == Grade.VIP) {
            return price * discountPercent / 100;
        } else {
            return 0;
        }
    }
}
```

---

### 2ë‹¨ê³„: ìƒˆë¡œìš´ í• ì¸ ì •ì±… ì ìš©ê³¼ ë¬¸ì œì 

**ëª©í‘œ**: ê°œë°œí•œ ì •ë¥  í• ì¸ ì •ì±…ì„ ì‹¤ì œë¡œ ì ìš©

**ë¬¸ì œ ë°œê²¬**:
- âŒ ìƒˆë¡œ ê°œë°œí•œ ì •ë¥  í• ì¸ ì •ì±…ì„ ì ìš©í•˜ë ¤ê³  í•˜ë‹ˆ **í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ**ì¸ ì£¼ë¬¸ ì„œë¹„ìŠ¤ êµ¬í˜„ì²´ë„ í•¨ê»˜ ë³€ê²½í•´ì•¼ í•¨
- âŒ ì£¼ë¬¸ ì„œë¹„ìŠ¤ í´ë¼ì´ì–¸íŠ¸ê°€ ì¸í„°í˜ì´ìŠ¤ì¸ `DiscountPolicy` ë¿ë§Œ ì•„ë‹ˆë¼, êµ¬ì²´ í´ë˜ìŠ¤ì¸ `FixDiscountPolicy`ë„ í•¨ê»˜ ì˜ì¡´ â†’ **DIP ìœ„ë°˜**

**ë¬¸ì œ ì½”ë“œ**:
```java
public class OrderServiceImpl implements OrderService {
    // DIP ìœ„ë°˜: ì¸í„°í˜ì´ìŠ¤ + êµ¬ì²´ í´ë˜ìŠ¤ ì˜ì¡´
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
}
```

**DIP ìœ„ë°˜ ë‹¤ì´ì–´ê·¸ë¨**:
```mermaid
classDiagram
    class OrderServiceImpl
    class DiscountPolicy {
        <<interface>>
    }
    class FixDiscountPolicy

    OrderServiceImpl --> DiscountPolicy : ì¶”ìƒ ì˜ì¡´
    OrderServiceImpl --> FixDiscountPolicy : êµ¬ì²´ ì˜ì¡´ (DIP ìœ„ë°˜!)
    DiscountPolicy <|.. FixDiscountPolicy
```

---

### 3ë‹¨ê³„: ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬

**ëª©í‘œ**: DIP ìœ„ë°˜ ë¬¸ì œ í•´ê²°

**í•´ê²° ë°©ë²•**:
- ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í•˜ë‚˜ì˜ **ê³µì—°**ìœ¼ë¡œ ìƒê°
- ê¸°ì¡´ì—ëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ì˜ì¡´í•˜ëŠ” ì„œë²„ êµ¬í˜„ ê°ì²´ë¥¼ ì§ì ‘ ìƒì„±í•˜ê³ , ì‹¤í–‰í•¨
- ë¹„ìœ ë¥¼ í•˜ë©´ ê¸°ì¡´ì—ëŠ” ë‚¨ì ì£¼ì¸ê³µ ë°°ìš°ê°€ ê³µì—°ë„ í•˜ê³ , ë™ì‹œì— ì—¬ì ì£¼ì¸ê³µë„ ì§ì ‘ ì´ˆë¹™í•˜ëŠ” **ë‹¤ì–‘í•œ ì±…ì„**ì„ ê°€ì§€ê³  ìˆìŒ

**ê³µì—° ê¸°íšì AppConfig ë“±ì¥**:
- ê³µì—°ì„ êµ¬ì„±í•˜ê³ , ë‹´ë‹¹ ë°°ìš°ë¥¼ ì„­ì™¸í•˜ê³ , ì§€ì •í•˜ëŠ” ì±…ì„ì„ ë‹´ë‹¹í•˜ëŠ” ë³„ë„ì˜ **ê³µì—° ê¸°íšì**ê°€ ë‚˜ì˜¬ ì‹œì 
- AppConfigëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì „ì²´ ë™ì‘ ë°©ì‹ì„ **êµ¬ì„±(config)**í•˜ê¸° ìœ„í•´, **êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±**í•˜ê³ , **ì—°ê²°**í•˜ëŠ” ì±…ì„
- ì´ì œë¶€í„° í´ë¼ì´ì–¸íŠ¸ ê°ì²´ëŠ” ìì‹ ì˜ ì—­í• ì„ ì‹¤í–‰í•˜ëŠ” ê²ƒë§Œ ì§‘ì¤‘, ê¶Œí•œì´ ì¤„ì–´ë“¬(**ì±…ì„ì´ ëª…í™•**í•´ì§)

**AppConfig ì½”ë“œ**:
```java
public class AppConfig {
    public MemberService memberService() {
        return new MemberServiceImpl(new MemoryMemberRepository());
    }

    public OrderService orderService() {
        return new OrderServiceImpl(
            new MemoryMemberRepository(),
            new FixDiscountPolicy()
        );
    }
}
```

**ìƒì„±ì ì£¼ì…**:
```java
public class OrderServiceImpl implements OrderService {
    // ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´ - DIP ì¤€ìˆ˜!
    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    // ìƒì„±ìë¥¼ í†µí•´ ì™¸ë¶€ì—ì„œ ì£¼ì…
    public OrderServiceImpl(MemberRepository memberRepository,
                           DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
}
```

**ê°œì„  íš¨ê³¼**:
- âœ… `OrderServiceImpl`ì€ `DiscountPolicy` ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´
- âœ… `OrderServiceImpl` ì…ì¥ì—ì„œ ìƒì„±ìë¥¼ í†µí•´ ì–´ë–¤ êµ¬í˜„ ê°ì²´ê°€ ë“¤ì–´ì˜¬ì§€(ì£¼ì…ë ì§€)ëŠ” ì•Œ ìˆ˜ ì—†ìŒ
- âœ… `OrderServiceImpl`ì˜ ìƒì„±ìë¥¼ í†µí•´ì„œ ì–´ë–¤ êµ¬í˜„ ê°ì²´ë¥¼ ì£¼ì…í• ì§€ëŠ” ì˜¤ì§ ì™¸ë¶€(`AppConfig`)ì—ì„œ ê²°ì •
- âœ… `OrderServiceImpl`ì€ ì´ì œë¶€í„° **ì‹¤í–‰ì—ë§Œ ì§‘ì¤‘**

---

### 4ë‹¨ê³„: AppConfig ë¦¬íŒ©í„°ë§

**ëª©í‘œ**: ì¤‘ë³µ ì œê±° ë° ì—­í• ê³¼ êµ¬í˜„ ëª…í™•íˆ ë¶„ë¦¬

**ë¬¸ì œì **:
- `new MemoryMemberRepository()`ê°€ ì¤‘ë³µ
- ì—­í• ì— ë”°ë¥¸ êµ¬í˜„ì´ ì˜ ì•ˆë³´ì„

**ë¦¬íŒ©í„°ë§ í›„**:
```java
public class AppConfig {
    // ì—­í• : íšŒì› ì„œë¹„ìŠ¤
    public MemberService memberService() {
        return new MemberServiceImpl(memberRepository());
    }

    // ì—­í• : ì£¼ë¬¸ ì„œë¹„ìŠ¤
    public OrderService orderService() {
        return new OrderServiceImpl(
            memberRepository(),
            discountPolicy()
        );
    }

    // ì—­í• : íšŒì› ì €ì¥ì†Œ
    public MemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }

    // ì—­í• : í• ì¸ ì •ì±…
    public DiscountPolicy discountPolicy() {
        return new FixDiscountPolicy();
    }
}
```

**ê°œì„  íš¨ê³¼**:
- âœ… `new MemoryMemberRepository()` ì¤‘ë³µ ì œê±°
- âœ… `MemoryMemberRepository`ë¥¼ ë‹¤ë¥¸ êµ¬í˜„ì²´ë¡œ ë³€ê²½í•  ë•Œ **í•œ ë¶€ë¶„ë§Œ** ë³€ê²½í•˜ë©´ ë¨
- âœ… `AppConfig`ë¥¼ ë³´ë©´ **ì—­í• **ê³¼ **êµ¬í˜„ í´ë˜ìŠ¤**ê°€ í•œëˆˆì— ë“¤ì–´ì˜´
- âœ… ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ êµ¬ì„±ì´ ì–´ë–»ê²Œ ë˜ì–´ìˆëŠ”ì§€ ë¹ ë¥´ê²Œ íŒŒì•…í•  ìˆ˜ ìˆìŒ

---

### 5ë‹¨ê³„: ìƒˆë¡œìš´ êµ¬ì¡°ì™€ í• ì¸ ì •ì±… ì ìš©

**ëª©í‘œ**: ì •ì•¡ í• ì¸ ì •ì±… â†’ ì •ë¥ % í• ì¸ ì •ì±…ìœ¼ë¡œ ë³€ê²½

**ì§ˆë¬¸**: ì–´ë–¤ ë¶€ë¶„ë§Œ ë³€ê²½í•˜ë©´ ë ê¹Œ?

**ì •ë‹µ**: âœ… **AppConfigì˜ `discountPolicy()` ë©”ì„œë“œë§Œ ë³€ê²½!**

**ì‚¬ìš© ì˜ì—­ê³¼ êµ¬ì„± ì˜ì—­ ë¶„ë¦¬**:
```mermaid
graph TB
    subgraph "ì‚¬ìš© ì˜ì—­ - ë³€ê²½ ì—†ìŒ"
        A[OrderServiceImpl]
        B[DiscountPolicy<br/>interface]
        A --> B
    end

    subgraph "êµ¬ì„± ì˜ì—­ - ë³€ê²½ ìˆìŒ"
        C[AppConfig]
    end

    subgraph "êµ¬í˜„ì²´"
        D[FixDiscountPolicy<br/>ì´ì „]
        E[RateDiscountPolicy<br/>ë³€ê²½]
    end

    C -.X ì´ì „.-> D
    C -.O ë³€ê²½.-> E
    E -.-> B

    style A fill:#ccffcc
    style C fill:#ffcccc
    style E fill:#ffffcc
```

**ì½”ë“œ ë³€ê²½ - ë”± í•œ ì¤„!**:
```java
public class AppConfig {
    public DiscountPolicy discountPolicy() {
        // return new FixDiscountPolicy();      // ì •ì•¡ í• ì¸ (ì´ì „)
        return new RateDiscountPolicy();        // ì •ë¥  í• ì¸ (ë³€ê²½)
    }
}
```

**ê°œì„  íš¨ê³¼**:
- âœ… ì´ì œ í• ì¸ ì •ì±…ì„ ë³€ê²½í•´ë„, ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ **êµ¬ì„± ì—­í• **ì„ ë‹´ë‹¹í•˜ëŠ” `AppConfig`ë§Œ ë³€ê²½í•˜ë©´ ë¨
- âœ… í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì¸ `OrderServiceImpl`ë¥¼ í¬í•¨í•´ì„œ **ì‚¬ìš© ì˜ì—­**ì˜ ì–´ë–¤ ì½”ë“œë„ ë³€ê²½í•  í•„ìš”ê°€ ì—†ìŒ
- âœ… **êµ¬ì„± ì˜ì—­**ì€ ë‹¹ì—°íˆ ë³€ê²½ë¨ (êµ¬ì„± ì—­í• ì„ ë‹´ë‹¹í•˜ëŠ” AppConfigë¥¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë¼ëŠ” ê³µì—°ì˜ ê¸°íšìë¡œ ìƒê°í•˜ì)

---

## Before / After ë¹„êµ

### Before: ë¬¸ì œê°€ ìˆë˜ êµ¬ì¡°

**ì½”ë“œ**:
```java
public class OrderServiceImpl implements OrderService {
    // DIP ìœ„ë°˜: êµ¬ì²´ í´ë˜ìŠ¤ì— ì˜ì¡´
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
}
```

**ë¬¸ì œì **:
- âŒ DIP ìœ„ë°˜: ì¶”ìƒí™”(ì¸í„°í˜ì´ìŠ¤) + êµ¬ì²´í™”(êµ¬í˜„ í´ë˜ìŠ¤) ëª¨ë‘ ì˜ì¡´
- âŒ OCP ìœ„ë°˜: ê¸°ëŠ¥ í™•ì¥ ì‹œ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ë³€ê²½ í•„ìš”
- âŒ í´ë¼ì´ì–¸íŠ¸ê°€ ë„ˆë¬´ ë§ì€ ì±…ì„ì„ ê°€ì§

---

### After: ê°œì„ ëœ êµ¬ì¡°

**ì½”ë“œ**:
```java
// í´ë¼ì´ì–¸íŠ¸: ì‹¤í–‰ì—ë§Œ ì§‘ì¤‘
public class OrderServiceImpl implements OrderService {
    // DIP ì¤€ìˆ˜: ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´
    private final DiscountPolicy discountPolicy;

    public OrderServiceImpl(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }
}

// AppConfig: ê°ì²´ ìƒì„±ê³¼ ì—°ê²° ë‹´ë‹¹
public class AppConfig {
    public DiscountPolicy discountPolicy() {
        return new RateDiscountPolicy();  // ì—¬ê¸°ë§Œ ë³€ê²½!
    }
}
```

**ê°œì„  íš¨ê³¼**:
- âœ… DIP ì¤€ìˆ˜: ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´
- âœ… OCP ì¤€ìˆ˜: í™•ì¥ì— ì—´ë ¤ìˆê³  ë³€ê²½ì— ë‹«í˜€ìˆìŒ
- âœ… ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬: ì‹¤í–‰ ì±…ì„ / êµ¬ì„± ì±…ì„ ëª…í™•íˆ ë¶„ë¦¬
- âœ… ì—­í• ê³¼ êµ¬í˜„ ë¶„ë¦¬: ì½”ë“œì˜ ê°€ë…ì„± í–¥ìƒ

---

## ì „ì²´ íë¦„ ë‹¤ì´ì–´ê·¸ë¨

```mermaid
graph TB
    subgraph "1. ì´ˆê¸° ë¬¸ì œ"
        A1[OrderServiceImpl]
        A2[FixDiscountPolicy]
        A1 -->|ì§ì ‘ ìƒì„± ë° ì˜ì¡´| A2
        A1_note[DIP, OCP ìœ„ë°˜]
    end

    subgraph "2. AppConfig ë„ì…"
        B1[AppConfig]
        B2[OrderServiceImpl]
        B3[FixDiscountPolicy]
        B1 -.ìƒì„±.-> B2
        B1 -.ìƒì„±.-> B3
        B1 -.ì£¼ì….-> B2
        B2_note[DIP ì¤€ìˆ˜]
    end

    subgraph "3. ì •ì±… ë³€ê²½"
        C1[AppConfig]
        C2[OrderServiceImpl<br/>ë³€ê²½ ì—†ìŒ!]
        C3[RateDiscountPolicy]
        C1 -.ìƒì„±.-> C2
        C1 -.ìƒì„±.-> C3
        C1 -.ì£¼ì….-> C2
        C3_note[OCP ì¤€ìˆ˜]
    end

    style A1 fill:#ffcccc
    style B2 fill:#ccffcc
    style C2 fill:#ccffcc
```

---

## ğŸ’¡ í•µì‹¬ ì •ë¦¬

### AppConfigì˜ ì—­í• 

**ê³µì—° ê¸°íšìë¡œì„œ**:
1. ê³µì—°ì„ êµ¬ì„±
2. ë‹´ë‹¹ ë°°ìš°ë¥¼ ì„­ì™¸
3. ì—­í• ì— ë§ëŠ” ë°°ìš°ë¥¼ ì§€ì •
4. ë°°ìš° êµì²´ëŠ” ê¸°íšìì˜ ëª«

**ì½”ë“œë¡œì„œ**:
1. êµ¬í˜„ ê°ì²´ ìƒì„±
2. ìƒì„±ìë¥¼ í†µí•´ ì˜ì¡´ê´€ê³„ ì£¼ì…(ì—°ê²°)
3. ì „ì²´ êµ¬ì„± ì±…ì„

### í´ë¼ì´ì–¸íŠ¸(ServiceImpl)ì˜ ì—­í• 

**ë°°ìš°ë¡œì„œ**:
- ìì‹ ì˜ ì—­í• (ë°°ì—­)ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì—ë§Œ ì§‘ì¤‘
- ì–´ë–¤ ìƒëŒ€ì—­(êµ¬í˜„ì²´)ì´ ì„ íƒë˜ë”ë¼ë„ ë˜‘ê°™ì´ ê³µì—° ê°€ëŠ¥

**ì½”ë“œë¡œì„œ**:
- ë‹´ë‹¹ **ê¸°ëŠ¥ì„ ì‹¤í–‰í•˜ëŠ” ì±…ì„**ë§Œ
- ì–´ë–¤ êµ¬í˜„ ê°ì²´ê°€ ì£¼ì…ë ì§€ëŠ” ì•Œ í•„ìš” ì—†ìŒ
- **ì‹¤í–‰ì—ë§Œ ì§‘ì¤‘**

---

## ë³€ê²½ì˜ íë¦„

```mermaid
sequenceDiagram
    participant ìš”êµ¬ì‚¬í•­
    participant AppConfig
    participant OrderServiceImpl
    participant DiscountPolicy

    ìš”êµ¬ì‚¬í•­->>AppConfig: í• ì¸ ì •ì±… ë³€ê²½ ìš”ì²­
    AppConfig->>AppConfig: discountPolicy() ìˆ˜ì •
    Note over AppConfig: return new RateDiscountPolicy()
    AppConfig->>OrderServiceImpl: RateDiscountPolicy ì£¼ì…
    Note over OrderServiceImpl: ì½”ë“œ ë³€ê²½ ì—†ìŒ!
    OrderServiceImpl->>DiscountPolicy: discount() í˜¸ì¶œ
    DiscountPolicy-->>OrderServiceImpl: 10% í• ì¸ ê²°ê³¼
```

---

## ì •ë¦¬

### ê°œì„ ëœ ì„¤ê³„ì˜ ì¥ì 

**1. ë‹¨ì¼ ì±…ì„ ì›ì¹™ (SRP)**:
- AppConfig: ê°ì²´ ìƒì„± ë° ì—°ê²°
- OrderServiceImpl: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰

**2. ì˜ì¡´ê´€ê³„ ì—­ì „ ì›ì¹™ (DIP)**:
- í´ë¼ì´ì–¸íŠ¸ ì½”ë“œê°€ ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´
- êµ¬ì²´ í´ë˜ìŠ¤ëŠ” ì „í˜€ ëª°ë¼ë„ ë¨

**3. ê°œë°©-íì‡„ ì›ì¹™ (OCP)**:
- ì†Œí”„íŠ¸ì›¨ì–´ ìš”ì†Œë¥¼ ìƒˆë¡­ê²Œ í™•ì¥
- ì‚¬ìš© ì˜ì—­ì˜ ë³€ê²½ì€ ë‹«í˜€ ìˆìŒ

**4. ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬**:
- ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì—°ê²°í•˜ëŠ” ì—­í• 
- ì‹¤í–‰í•˜ëŠ” ì—­í• 
- ê´€ì‹¬ì‚¬ê°€ ëª…í™•íˆ ë¶„ë¦¬ë¨

---

## ğŸ“š ì „ì²´ íë¦„ ì‹¬ì¸µ ë¶„ì„

> **5ë‹¨ê³„ ê°œì„  ê³¼ì •ì„ ë‹¨ê³„ë³„ë¡œ ìƒì„¸íˆ ì´í•´í•˜ê¸°**

### 1ë‹¨ê³„ ì‹¬ì¸µ ë¶„ì„: ìƒˆë¡œìš´ í• ì¸ ì •ì±… ê°œë°œ

#### ë°°ê²½ê³¼ ìš”êµ¬ì‚¬í•­

**ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ ë³€ê²½**:
```
ê¸°íšíŒ€: "ê³ ì • ê¸ˆì•¡ í• ì¸ì€ VIP ê³ ê°ì—ê²Œ ë§¤ë ¥ì´ ì—†ì–´ìš”.
        êµ¬ë§¤ ê¸ˆì•¡ì˜ 10%ë¥¼ í• ì¸í•´ì£¼ëŠ” ì •ë¥  í• ì¸ìœ¼ë¡œ ë°”ê¿”ì£¼ì„¸ìš”!"
```

**ê°œë°œì ê´€ì **:
- ê¸°ì¡´: `FixDiscountPolicy` (1000ì› ê³ ì • í• ì¸)
- ì‹ ê·œ: `RateDiscountPolicy` (10% ì •ë¥  í• ì¸)

#### ë‹¤í˜•ì„±ì˜ í˜

**ì¸í„°í˜ì´ìŠ¤ ë•ë¶„ì— ìƒˆ êµ¬í˜„ì²´ ì¶”ê°€ ê°€ëŠ¥**:

```mermaid
classDiagram
    class DiscountPolicy {
        <<interface>>
        +discount(Member, int) int
    }

    class FixDiscountPolicy {
        -discountFixAmount: int
        +discount(Member, int) int
    }

    class RateDiscountPolicy {
        -discountPercent: int
        +discount(Member, int) int
    }

    DiscountPolicy <|.. FixDiscountPolicy
    DiscountPolicy <|.. RateDiscountPolicy

    style RateDiscountPolicy fill:#ffffcc
```

**ìƒˆ êµ¬í˜„ì²´ ì¶”ê°€ ì½”ë“œ**:

```java
public class RateDiscountPolicy implements DiscountPolicy {

    private int discountPercent = 10; // 10% í• ì¸

    @Override
    public int discount(Member member, int price) {
        if (member.getGrade() == Grade.VIP) {
            // ê°€ê²©ì˜ 10%ë¥¼ í• ì¸
            return price * discountPercent / 100;
        } else {
            return 0;
        }
    }
}
```

**ë™ì‘ ë¹„êµ**:

| ìƒí™© | FixDiscountPolicy | RateDiscountPolicy |
|------|-------------------|-------------------|
| **VIP íšŒì›, 10,000ì› êµ¬ë§¤** | 1,000ì› í• ì¸ | 1,000ì› í• ì¸ (10%) |
| **VIP íšŒì›, 20,000ì› êµ¬ë§¤** | 1,000ì› í• ì¸ | 2,000ì› í• ì¸ (10%) |
| **VIP íšŒì›, 50,000ì› êµ¬ë§¤** | 1,000ì› í• ì¸ | 5,000ì› í• ì¸ (10%) |
| **ì¼ë°˜ íšŒì›, 10,000ì› êµ¬ë§¤** | 0ì› í• ì¸ | 0ì› í• ì¸ |

**í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±**:

```java
class RateDiscountPolicyTest {

    RateDiscountPolicy discountPolicy = new RateDiscountPolicy();

    @Test
    @DisplayName("VIPëŠ” 10% í• ì¸ì´ ì ìš©ë˜ì–´ì•¼ í•œë‹¤")
    void vip_o() {
        // given
        Member member = new Member(1L, "memberVIP", Grade.VIP);

        // when
        int discount = discountPolicy.discount(member, 10000);

        // then
        assertThat(discount).isEqualTo(1000);
    }

    @Test
    @DisplayName("VIPê°€ ì•„ë‹ˆë©´ í• ì¸ì´ ì ìš©ë˜ì§€ ì•Šì•„ì•¼ í•œë‹¤")
    void vip_x() {
        // given
        Member member = new Member(2L, "memberBASIC", Grade.BASIC);

        // when
        int discount = discountPolicy.discount(member, 10000);

        // then
        assertThat(discount).isEqualTo(0);
    }
}
```

**1ë‹¨ê³„ ê²°ë¡ **:
- âœ… ë‹¤í˜•ì„± ë•ë¶„ì— ìƒˆ êµ¬í˜„ì²´ ì¶”ê°€ëŠ” ë¬¸ì œì—†ìŒ
- âœ… ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í†µê³¼
- âš ï¸ **í•˜ì§€ë§Œ ì‹¤ì œ ì ìš© ì‹œ ë¬¸ì œ ë°œìƒ!** â†’ 2ë‹¨ê³„ë¡œ ì´ì–´ì§

---

### 2ë‹¨ê³„ ì‹¬ì¸µ ë¶„ì„: ìƒˆë¡œìš´ í• ì¸ ì •ì±… ì ìš©ê³¼ ë¬¸ì œì 

#### ì‹¤ì œ ì ìš© ì‹œë„

**OrderServiceImpl ë³€ê²½ ì‹œë„**:

```java
public class OrderServiceImpl implements OrderService {

    // ë³€ê²½ ì „
    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

    // ë³€ê²½ í›„
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();

    // ...
}
```

**ë¬¸ì œ ë°œê²¬**: "ì–´? í´ë¼ì´ì–¸íŠ¸ ì½”ë“œë¥¼ ìˆ˜ì •í•´ì•¼ í•˜ë„¤?"

#### ë¬¸ì œ ë¶„ì„: DIP ìœ„ë°˜

**ì½”ë“œ ì˜ì¡´ê´€ê³„ ë¶„ì„**:

```java
public class OrderServiceImpl implements OrderService {

    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    //            â†‘                                      â†‘
    //       ì¸í„°í˜ì´ìŠ¤ ì˜ì¡´                        êµ¬ì²´ í´ë˜ìŠ¤ ì˜ì¡´
    //       (ì¶”ìƒ ì˜ì¡´)                           (êµ¬ì²´ ì˜ì¡´)
}
```

**ì˜ì¡´ê´€ê³„ ë‹¤ì´ì–´ê·¸ë¨**:

```mermaid
graph TB
    subgraph "OrderServiceImpl ë‚´ë¶€"
    A[OrderServiceImpl]
    end

    subgraph "ì¶”ìƒ ë ˆë²¨"
    B[DiscountPolicy<br/>interface]
    end

    subgraph "êµ¬ì²´ ë ˆë²¨"
    C[FixDiscountPolicy]
    D[RateDiscountPolicy]
    end

    A -->|1. ì¸í„°í˜ì´ìŠ¤ ì˜ì¡´<br/>ì¶”ìƒ ì˜ì¡´| B
    A -.->|2. êµ¬ì²´ í´ë˜ìŠ¤ ì˜ì¡´<br/>DIP ìœ„ë°˜!| C

    B <|.. C
    B <|.. D

    style A fill:#ffcccc
    style C fill:#ffcccc
```

**DIP ìœ„ë°˜ ìƒì„¸ ë¶„ì„**:

| ì›ì¹™ | ë‚´ìš© | í˜„ì¬ ìƒíƒœ |
|------|------|----------|
| **DIP** | í”„ë¡œê·¸ë˜ë¨¸ëŠ” "ì¶”ìƒí™”ì— ì˜ì¡´í•´ì•¼ì§€, êµ¬ì²´í™”ì— ì˜ì¡´í•˜ë©´ ì•ˆëœë‹¤" | âŒ `DiscountPolicy` (ì¶”ìƒ) + `FixDiscountPolicy` (êµ¬ì²´) ë‘˜ ë‹¤ ì˜ì¡´ |
| **OCP** | ì†Œí”„íŠ¸ì›¨ì–´ ìš”ì†ŒëŠ” í™•ì¥ì—ëŠ” ì—´ë ¤ ìˆìœ¼ë‚˜ ë³€ê²½ì—ëŠ” ë‹«í˜€ ìˆì–´ì•¼ í•œë‹¤ | âŒ ì •ì±… ë³€ê²½ ì‹œ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ(`OrderServiceImpl`) ë³€ê²½ í•„ìš” |

#### ë¬¸ì œ ë°œìƒ ì‹œë‚˜ë¦¬ì˜¤

**ì‹œë‚˜ë¦¬ì˜¤ 1: FixDiscountPolicy â†’ RateDiscountPolicy ë³€ê²½**

```java
// Before
private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

// After
private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
```

**ì˜í–¥ë°›ëŠ” ì½”ë“œ**:
- âŒ `OrderServiceImpl.java` ìˆ˜ì • í•„ìš”
- âŒ ì»´íŒŒì¼ ë‹¤ì‹œ í•„ìš”
- âŒ ë°°í¬ ë‹¤ì‹œ í•„ìš”
- âŒ í…ŒìŠ¤íŠ¸ ë‹¤ì‹œ í•„ìš”

**ì‹œë‚˜ë¦¬ì˜¤ 2: ë§Œì•½ ì—¬ëŸ¬ ê³³ì—ì„œ ì‚¬ìš©í•œë‹¤ë©´?**

```java
// OrderServiceImpl.java
private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

// OrderController.java (ë§Œì•½ ìˆë‹¤ë©´)
private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

// OrderBatch.java (ë§Œì•½ ìˆë‹¤ë©´)
private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

// ... ëª¨ë“  ê³³ì„ ìˆ˜ì •í•´ì•¼ í•¨!
```

**ë¬¸ì œì˜ ë³¸ì§ˆ**:
```
í´ë¼ì´ì–¸íŠ¸(OrderServiceImpl)ê°€ ë„ˆë¬´ ë§ì€ ê²ƒì„ ì•Œê³  ìˆë‹¤!
- ìì‹ ì´ ì‚¬ìš©í•  ì¸í„°í˜ì´ìŠ¤(DiscountPolicy)ë¥¼ ì•Œê³ 
- ì–´ë–¤ êµ¬ì²´ í´ë˜ìŠ¤(FixDiscountPolicy)ë¥¼ ì‚¬ìš©í• ì§€ë„ ì§ì ‘ ê²°ì •
â†’ ì±…ì„ ê³¼ë‹¤!
```

#### í•´ê²° ë°©í–¥

**ì´ìƒì ì¸ ì½”ë“œ**:

```java
public class OrderServiceImpl implements OrderService {

    // ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´ - DIP ì¤€ìˆ˜!
    private final DiscountPolicy discountPolicy;

    // êµ¬ì²´ í´ë˜ìŠ¤ëŠ” ì–´ë””ì„œ? â†’ ì™¸ë¶€ì—ì„œ ì£¼ì…ë°›ì!
}
```

**ì§ˆë¬¸**: "ê·¸ëŸ¼ ëˆ„ê°€ êµ¬ì²´ í´ë˜ìŠ¤ë¥¼ ê²°ì •í•˜ê³  ì£¼ì…í•´ì£¼ì§€?"
**ë‹µ**: "AppConfig ë“±ì¥!" â†’ 3ë‹¨ê³„ë¡œ ì´ì–´ì§

---

### 3ë‹¨ê³„ ì‹¬ì¸µ ë¶„ì„: ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬

#### ê³µì—° ë¹„ìœ  ì‹¬í™”

**ì˜ëª»ëœ êµ¬ì¡° (í˜„ì¬)**:

```mermaid
sequenceDiagram
    participant ê´€ê°
    participant ë¡œë¯¸ì˜¤ë°°ìš°
    participant ì¤„ë¦¬ì—£ë°°ìš°

    Note over ë¡œë¯¸ì˜¤ë°°ìš°: 1. ì¤„ë¦¬ì—£ ë°°ìš° ì„­ì™¸<br/>2. ì¶œì—°ë£Œ í˜‘ìƒ<br/>3. ìŠ¤ì¼€ì¤„ ì¡°ìœ¨

    ê´€ê°->>ë¡œë¯¸ì˜¤ë°°ìš°: ê³µì—° ì‹œì‘!
    ë¡œë¯¸ì˜¤ë°°ìš°->>ë¡œë¯¸ì˜¤ë°°ìš°: ì¤„ë¦¬ì—£ ë°°ìš° ì„­ì™¸ (ê³¼ë‹¤í•œ ì±…ì„!)
    ë¡œë¯¸ì˜¤ë°°ìš°->>ì¤„ë¦¬ì—£ë°°ìš°: í•¨ê»˜ ê³µì—°

    Note over ë¡œë¯¸ì˜¤ë°°ìš°: ë¬¸ì œ: ë¡œë¯¸ì˜¤ ë°°ìš°ê°€<br/>ë„ˆë¬´ ë§ì€ ì¼ì„ í•¨!
```

**ì˜¬ë°”ë¥¸ êµ¬ì¡° (ëª©í‘œ)**:

```mermaid
sequenceDiagram
    participant ê´€ê°
    participant ê³µì—°ê¸°íšì
    participant ë¡œë¯¸ì˜¤ë°°ìš°
    participant ì¤„ë¦¬ì—£ë°°ìš°

    Note over ê³µì—°ê¸°íšì: 1. ë°°ìš° ì„­ì™¸<br/>2. ì¶œì—°ë£Œ í˜‘ìƒ<br/>3. ìŠ¤ì¼€ì¤„ ì¡°ìœ¨

    ê³µì—°ê¸°íšì->>ë¡œë¯¸ì˜¤ë°°ìš°: ì„­ì™¸ ë° ë°°ì¹˜
    ê³µì—°ê¸°íšì->>ì¤„ë¦¬ì—£ë°°ìš°: ì„­ì™¸ ë° ë°°ì¹˜

    ê´€ê°->>ë¡œë¯¸ì˜¤ë°°ìš°: ê³µì—° ì‹œì‘!
    ë¡œë¯¸ì˜¤ë°°ìš°->>ì¤„ë¦¬ì—£ë°°ìš°: í•¨ê»˜ ê³µì—°

    Note over ë¡œë¯¸ì˜¤ë°°ìš°: ê°œì„ : ë¡œë¯¸ì˜¤ ë°°ìš°ëŠ”<br/>ì—°ê¸°ë§Œ ì§‘ì¤‘!
```

#### AppConfig ì„¤ê³„ ì›ì¹™

**AppConfigì˜ ì±…ì„**:

```java
/**
 * AppConfig: ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì„± ë‹´ë‹¹
 *
 * ì±…ì„:
 * 1. êµ¬í˜„ ê°ì²´ ìƒì„±
 * 2. ì˜ì¡´ê´€ê³„ ì—°ê²° (ìƒì„±ì ì£¼ì…)
 * 3. ì „ì²´ êµ¬ì„± ê´€ë¦¬
 */
public class AppConfig {

    // íšŒì› ì„œë¹„ìŠ¤ êµ¬ì„±
    public MemberService memberService() {
        return new MemberServiceImpl(memberRepository());
    }

    // ì£¼ë¬¸ ì„œë¹„ìŠ¤ êµ¬ì„±
    public OrderService orderService() {
        return new OrderServiceImpl(
            memberRepository(),
            discountPolicy()
        );
    }

    // íšŒì› ì €ì¥ì†Œ êµ¬ì„±
    public MemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }

    // í• ì¸ ì •ì±… êµ¬ì„±
    public DiscountPolicy discountPolicy() {
        return new FixDiscountPolicy();  // ì—¬ê¸°ë§Œ ë³€ê²½í•˜ë©´ ë¨!
    }
}
```

#### ìƒì„±ì ì£¼ì… ìƒì„¸ ë¶„ì„

**Before: ì§ì ‘ ìƒì„±**:

```java
public class OrderServiceImpl implements OrderService {

    // ë‚´ê°€ ì§ì ‘ ê²°ì •
    private final MemberRepository memberRepository
        = new MemoryMemberRepository();
    private final DiscountPolicy discountPolicy
        = new FixDiscountPolicy();

    // ë¬¸ì œì :
    // 1. êµ¬ì²´ í´ë˜ìŠ¤ì— ì˜ì¡´ (DIP ìœ„ë°˜)
    // 2. ë³€ê²½ ì‹œ ì´ ì½”ë“œ ìˆ˜ì • í•„ìš” (OCP ìœ„ë°˜)
    // 3. í…ŒìŠ¤íŠ¸ ì‹œ Mock ì£¼ì… ë¶ˆê°€ëŠ¥
}
```

**After: ìƒì„±ì ì£¼ì…**:

```java
public class OrderServiceImpl implements OrderService {

    // ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´
    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    // ìƒì„±ìë¥¼ í†µí•´ ì™¸ë¶€ì—ì„œ ì£¼ì…
    public OrderServiceImpl(MemberRepository memberRepository,
                           DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    // ì¥ì :
    // 1. ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´ (DIP ì¤€ìˆ˜)
    // 2. ë³€ê²½ ì‹œ ì´ ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš” (OCP ì¤€ìˆ˜)
    // 3. í…ŒìŠ¤íŠ¸ ì‹œ Mock ì£¼ì… ê°€ëŠ¥
}
```

**ì‹¤í–‰ íë¦„ ìƒì„¸**:

```java
// 1. AppConfig ìƒì„±
AppConfig appConfig = new AppConfig();

// 2. orderService() ë©”ì„œë“œ í˜¸ì¶œ
OrderService orderService = appConfig.orderService();

// 3. AppConfig ë‚´ë¶€ ë™ì‘ (ë‹¨ê³„ë³„ ë¶„ì„)

// 3-1. memberRepository() í˜¸ì¶œ
MemberRepository memberRepository = new MemoryMemberRepository();  // @x001

// 3-2. discountPolicy() í˜¸ì¶œ
DiscountPolicy discountPolicy = new FixDiscountPolicy();  // @x002

// 3-3. OrderServiceImpl ìƒì„± ë° ì£¼ì…
OrderServiceImpl orderServiceImpl = new OrderServiceImpl(
    memberRepository,  // @x001 ì°¸ì¡° ì „ë‹¬
    discountPolicy     // @x002 ì°¸ì¡° ì „ë‹¬
);

// 3-4. OrderServiceImpl ìƒì„±ì ë‚´ë¶€
public OrderServiceImpl(MemberRepository memberRepository,
                       DiscountPolicy discountPolicy) {
    this.memberRepository = memberRepository;  // @x001 ì €ì¥
    this.discountPolicy = discountPolicy;      // @x002 ì €ì¥
}

// 4. OrderService íƒ€ì…ìœ¼ë¡œ ë°˜í™˜
return orderServiceImpl;  // @x003
```

**ë©”ëª¨ë¦¬ ìƒíƒœ**:

```
Heap Memory:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MemoryMemberRepository @x001                â”‚
â”‚   - store: Map<Long, Member>                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FixDiscountPolicy @x002                     â”‚
â”‚   - discountFixAmount: 1000                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OrderServiceImpl @x003                      â”‚
â”‚   - memberRepository: @x001 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   - discountPolicy: @x002 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”˜
                                      â”‚   â”‚
                                      â†“   â†“
                                    ì°¸ì¡° ê´€ê³„
```

#### ì±…ì„ ë¶„ë¦¬ íš¨ê³¼

**Before: ì±…ì„ ê³¼ë‹¤**:

```mermaid
graph TB
    A[OrderServiceImpl]

    A --> A1[ì±…ì„ 1:<br/>ê°ì²´ ìƒì„±]
    A --> A2[ì±…ì„ 2:<br/>ì˜ì¡´ê´€ê³„ ì„¤ì •]
    A --> A3[ì±…ì„ 3:<br/>ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰]

    style A fill:#ffcccc
```

**After: ì±…ì„ ë¶„ë¦¬**:

```mermaid
graph TB
    subgraph "AppConfig"
    B[AppConfig]
    B --> B1[ì±…ì„ 1:<br/>ê°ì²´ ìƒì„±]
    B --> B2[ì±…ì„ 2:<br/>ì˜ì¡´ê´€ê³„ ì„¤ì •]
    end

    subgraph "OrderServiceImpl"
    C[OrderServiceImpl]
    C --> C1[ì±…ì„ 3:<br/>ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰]
    end

    style B fill:#ccffcc
    style C fill:#cce5ff
```

---

### 4ë‹¨ê³„ ì‹¬ì¸µ ë¶„ì„: AppConfig ë¦¬íŒ©í„°ë§

#### ë¦¬íŒ©í„°ë§ ì „ ë¬¸ì œì 

**ë¬¸ì œ 1: ì¤‘ë³µ ì½”ë“œ**:

```java
public class AppConfig {

    public MemberService memberService() {
        return new MemberServiceImpl(
            new MemoryMemberRepository()  // â† ì¤‘ë³µ 1
        );
    }

    public OrderService orderService() {
        return new OrderServiceImpl(
            new MemoryMemberRepository(),  // â† ì¤‘ë³µ 2
            new FixDiscountPolicy()
        );
    }
}
```

**ì¤‘ë³µì˜ ë¬¸ì œ**:
- `MemoryMemberRepository`ë¥¼ `JdbcMemberRepository`ë¡œ ë³€ê²½í•˜ë ¤ë©´?
- 2ê³³ì„ ëª¨ë‘ ìˆ˜ì •í•´ì•¼ í•¨
- ì‹¤ìˆ˜ë¡œ í•œ ê³³ë§Œ ë³€ê²½í•  ìœ„í—˜

**ë¬¸ì œ 2: ì—­í• ì´ ëª…í™•í•˜ì§€ ì•ŠìŒ**:

```java
// ì§ˆë¬¸: ì´ ì½”ë“œë§Œ ë³´ê³  ì–´ë–¤ Repositoryë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ í•œëˆˆì— ë³´ì´ë‚˜ìš”?
public MemberService memberService() {
    return new MemberServiceImpl(new MemoryMemberRepository());
}

// ì§ˆë¬¸: ì´ ì½”ë“œë§Œ ë³´ê³  ì–´ë–¤ DiscountPolicyë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ í•œëˆˆì— ë³´ì´ë‚˜ìš”?
public OrderService orderService() {
    return new OrderServiceImpl(
        new MemoryMemberRepository(),
        new FixDiscountPolicy()
    );
}
```

#### ë¦¬íŒ©í„°ë§ ê³¼ì •

**Step 1: ì¤‘ë³µ ì œê±° - ë©”ì„œë“œ ì¶”ì¶œ**:

```java
public class AppConfig {

    public MemberService memberService() {
        return new MemberServiceImpl(memberRepository());  // ë©”ì„œë“œ í˜¸ì¶œë¡œ ë³€ê²½
    }

    public OrderService orderService() {
        return new OrderServiceImpl(
            memberRepository(),  // ë©”ì„œë“œ í˜¸ì¶œë¡œ ë³€ê²½
            discountPolicy()     // ë©”ì„œë“œ í˜¸ì¶œë¡œ ë³€ê²½
        );
    }

    // ì¶”ì¶œ: íšŒì› ì €ì¥ì†Œ ì—­í• 
    public MemberRepository memberRepository() {
        return new MemoryMemberRepository();  // êµ¬í˜„ì²´ëŠ” ì—¬ê¸°ë§Œ!
    }

    // ì¶”ì¶œ: í• ì¸ ì •ì±… ì—­í• 
    public DiscountPolicy discountPolicy() {
        return new FixDiscountPolicy();  // êµ¬í˜„ì²´ëŠ” ì—¬ê¸°ë§Œ!
    }
}
```

**Step 2: ì—­í• ê³¼ êµ¬í˜„ ëª…í™•íˆ ë¶„ë¦¬**:

```java
public class AppConfig {

    //========== ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì„± ==========//

    /**
     * ì—­í• : íšŒì› ì„œë¹„ìŠ¤
     * êµ¬í˜„: MemberServiceImpl + MemoryMemberRepository
     */
    public MemberService memberService() {
        return new MemberServiceImpl(memberRepository());
    }

    /**
     * ì—­í• : ì£¼ë¬¸ ì„œë¹„ìŠ¤
     * êµ¬í˜„: OrderServiceImpl + MemoryMemberRepository + FixDiscountPolicy
     */
    public OrderService orderService() {
        return new OrderServiceImpl(
            memberRepository(),
            discountPolicy()
        );
    }

    //========== ì¸í”„ë¼ êµ¬ì„± ==========//

    /**
     * ì—­í• : íšŒì› ì €ì¥ì†Œ
     * êµ¬í˜„: MemoryMemberRepository (ë‚˜ì¤‘ì— ë³€ê²½ ê°€ëŠ¥)
     */
    public MemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }

    /**
     * ì—­í• : í• ì¸ ì •ì±…
     * êµ¬í˜„: FixDiscountPolicy (ë‚˜ì¤‘ì— ë³€ê²½ ê°€ëŠ¥)
     */
    public DiscountPolicy discountPolicy() {
        return new FixDiscountPolicy();
    }
}
```

#### ë¦¬íŒ©í„°ë§ íš¨ê³¼ ë¹„êµ

**ë³€ê²½ ì‹œë‚˜ë¦¬ì˜¤ 1: Repository ë³€ê²½**

```java
// Before ë¦¬íŒ©í„°ë§: 2ê³³ ìˆ˜ì • í•„ìš”
public MemberService memberService() {
    return new MemberServiceImpl(new JdbcMemberRepository());  // ìˆ˜ì • 1
}

public OrderService orderService() {
    return new OrderServiceImpl(
        new JdbcMemberRepository(),  // ìˆ˜ì • 2
        new FixDiscountPolicy()
    );
}

// After ë¦¬íŒ©í„°ë§: 1ê³³ë§Œ ìˆ˜ì •
public MemberRepository memberRepository() {
    // return new MemoryMemberRepository();
    return new JdbcMemberRepository();  // ì—¬ê¸°ë§Œ ìˆ˜ì •!
}
```

**ë³€ê²½ ì‹œë‚˜ë¦¬ì˜¤ 2: ì •ì±… ë³€ê²½**

```java
// After ë¦¬íŒ©í„°ë§
public DiscountPolicy discountPolicy() {
    // return new FixDiscountPolicy();
    return new RateDiscountPolicy();  // ì—¬ê¸°ë§Œ ìˆ˜ì •!
}
```

**ê°€ë…ì„± ë¹„êµ**:

```mermaid
graph TB
    subgraph "ë¦¬íŒ©í„°ë§ ì „: êµ¬í˜„ì´ ì„ì—¬ìˆìŒ"
    A1[memberService]
    A2[orderService]
    A1 -.-> A3[new MemoryMemberRepository]
    A2 -.-> A4[new MemoryMemberRepository]
    A2 -.-> A5[new FixDiscountPolicy]
    end

    subgraph "ë¦¬íŒ©í„°ë§ í›„: ì—­í• ê³¼ êµ¬í˜„ ë¶„ë¦¬"
    B1[memberService]
    B2[orderService]
    B3[memberRepository]
    B4[discountPolicy]

    B1 --> B3
    B2 --> B3
    B2 --> B4

    B3 -.êµ¬í˜„.-> B5[MemoryMemberRepository]
    B4 -.êµ¬í˜„.-> B6[FixDiscountPolicy]
    end

    style A1 fill:#ffcccc
    style A2 fill:#ffcccc
    style B1 fill:#ccffcc
    style B2 fill:#ccffcc
    style B3 fill:#e1f5ff
    style B4 fill:#e1f5ff
```

---

### 5ë‹¨ê³„ ì‹¬ì¸µ ë¶„ì„: ìƒˆë¡œìš´ êµ¬ì¡°ì™€ í• ì¸ ì •ì±… ì ìš©

#### ì‚¬ìš© ì˜ì—­ê³¼ êµ¬ì„± ì˜ì—­ì˜ ë¶„ë¦¬

**í•µì‹¬ ê°œë…**:
```
ì• í”Œë¦¬ì¼€ì´ì…˜ = ì‚¬ìš© ì˜ì—­ + êµ¬ì„± ì˜ì—­

ì‚¬ìš© ì˜ì—­: ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìˆ˜í–‰í•˜ëŠ” ì½”ë“œ
êµ¬ì„± ì˜ì—­: ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì—°ê²°í•˜ëŠ” ì„¤ì • ì½”ë“œ
```

**ì˜ì—­ ë¶„ë¦¬ ë‹¤ì´ì–´ê·¸ë¨**:

```mermaid
graph TB
    subgraph "ì‚¬ìš© ì˜ì—­ (ë³€ê²½ ì—†ìŒ)"
        A1[MemberServiceImpl]
        A2[OrderServiceImpl]
        A3[MemberRepository<br/>interface]
        A4[DiscountPolicy<br/>interface]

        A1 --> A3
        A2 --> A3
        A2 --> A4
    end

    subgraph "êµ¬ì„± ì˜ì—­ (ë³€ê²½ ìˆìŒ)"
        B[AppConfig]
    end

    subgraph "êµ¬í˜„ì²´ (êµì²´ ê°€ëŠ¥)"
        C1[MemoryMemberRepository]
        C2[FixDiscountPolicy]
        C3[RateDiscountPolicy]
    end

    B -.ìƒì„± ë° ì£¼ì….-> A1
    B -.ìƒì„± ë° ì£¼ì….-> A2
    B -.ìƒì„±.-> C1
    B -.ìƒì„±.-> C2
    B -.ìƒì„±.-> C3

    style A1 fill:#ccffcc
    style A2 fill:#ccffcc
    style B fill:#ffffcc
```

#### ì •ì±… ë³€ê²½ ì‹¤ìŠµ

**ìš”êµ¬ì‚¬í•­**: ì •ì•¡ í• ì¸ â†’ ì •ë¥  í• ì¸

**ë³€ê²½ ì „ ì „ì²´ ì½”ë“œ**:

```java
// ========== êµ¬ì„± ì˜ì—­ ==========
public class AppConfig {
    public DiscountPolicy discountPolicy() {
        return new FixDiscountPolicy();  // ì •ì•¡ í• ì¸
    }
}

// ========== ì‚¬ìš© ì˜ì—­ ==========
public class OrderServiceImpl implements OrderService {
    private final DiscountPolicy discountPolicy;

    public OrderServiceImpl(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice);
        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

**ë³€ê²½: ë”± í•œ ì¤„ë§Œ ìˆ˜ì •!**

```java
// ========== êµ¬ì„± ì˜ì—­ - ìˆ˜ì • ==========
public class AppConfig {
    public DiscountPolicy discountPolicy() {
        // return new FixDiscountPolicy();     // ì •ì•¡ í• ì¸ (ì´ì „)
        return new RateDiscountPolicy();       // ì •ë¥  í• ì¸ (ë³€ê²½)
    }
}

// ========== ì‚¬ìš© ì˜ì—­ - ìˆ˜ì • ì—†ìŒ! ==========
public class OrderServiceImpl implements OrderService {
    // ì´ ì½”ë“œëŠ” ì „í˜€ ê±´ë“œë¦¬ì§€ ì•ŠìŒ!
    private final DiscountPolicy discountPolicy;

    public OrderServiceImpl(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice);  // ê·¸ëŒ€ë¡œ!
        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

#### ë³€ê²½ ì˜í–¥ ë²”ìœ„ ìƒì„¸ ë¶„ì„

**Before AppConfig (ë§ì€ íŒŒì¼ ìˆ˜ì • í•„ìš”)**:

```
ë³€ê²½ ì˜í–¥ ë²”ìœ„:
â”œâ”€â”€ OrderServiceImpl.java âŒ ìˆ˜ì • í•„ìš”
â”œâ”€â”€ OrderApp.java âŒ ìˆ˜ì • í•„ìš”
â”œâ”€â”€ OrderServiceTest.java âŒ ìˆ˜ì • í•„ìš”
â”œâ”€â”€ OrderController.java âŒ ìˆ˜ì • í•„ìš”
â””â”€â”€ ... ê¸°íƒ€ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ê³³ âŒ ìˆ˜ì • í•„ìš”
```

**After AppConfig (í•œ íŒŒì¼ë§Œ ìˆ˜ì •)**:

```
ë³€ê²½ ì˜í–¥ ë²”ìœ„:
â”œâ”€â”€ AppConfig.java âœ… ìˆ˜ì • (1ê³³ë§Œ!)
â”œâ”€â”€ OrderServiceImpl.java â­• ìˆ˜ì • ë¶ˆí•„ìš”
â”œâ”€â”€ OrderApp.java â­• ìˆ˜ì • ë¶ˆí•„ìš”
â”œâ”€â”€ OrderServiceTest.java â­• ìˆ˜ì • ë¶ˆí•„ìš”
â”œâ”€â”€ OrderController.java â­• ìˆ˜ì • ë¶ˆí•„ìš”
â””â”€â”€ ... ê¸°íƒ€ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ê³³ â­• ìˆ˜ì • ë¶ˆí•„ìš”
```

**ì‹¤í–‰ íë¦„ ë¹„êµ**:

```mermaid
sequenceDiagram
    participant Client as í´ë¼ì´ì–¸íŠ¸
    participant Config as AppConfig
    participant Service as OrderServiceImpl
    participant Policy as DiscountPolicy

    Note over Config: discountPolicy() ë³€ê²½<br/>FixDiscountPolicy â†’ RateDiscountPolicy

    Client->>Config: orderService() í˜¸ì¶œ
    Config->>Service: new OrderServiceImpl(RateDiscountPolicy)
    Note over Service: RateDiscountPolicy ì£¼ì…ë°›ìŒ<br/>(ì½”ë“œ ë³€ê²½ ì—†ìŒ!)

    Client->>Service: createOrder() í˜¸ì¶œ
    Service->>Policy: discount() í˜¸ì¶œ
    Note over Policy: RateDiscountPolicy.discount()<br/>10% í• ì¸ ê³„ì‚°
    Policy-->>Service: í• ì¸ ê¸ˆì•¡ ë°˜í™˜
    Service-->>Client: Order ë°˜í™˜
```

#### OCP ì›ì¹™ ì¤€ìˆ˜ í™•ì¸

**OCP (Open-Closed Principle)**:
> ì†Œí”„íŠ¸ì›¨ì–´ ìš”ì†ŒëŠ” í™•ì¥ì—ëŠ” ì—´ë ¤ ìˆìœ¼ë‚˜ ë³€ê²½ì—ëŠ” ë‹«í˜€ ìˆì–´ì•¼ í•œë‹¤

**í™•ì¥ì— ì—´ë ¤ìˆë‹¤**:
```java
// ìƒˆë¡œìš´ ì •ì±…ì„ ì–¼ë§ˆë“ ì§€ ì¶”ê°€ ê°€ëŠ¥
public class SeasonDiscountPolicy implements DiscountPolicy { ... }
public class BirthdayDiscountPolicy implements DiscountPolicy { ... }
```

**ë³€ê²½ì— ë‹«í˜€ìˆë‹¤**:
```java
// ì‚¬ìš© ì˜ì—­(OrderServiceImpl)ì€ ì „í˜€ ìˆ˜ì •í•˜ì§€ ì•ŠìŒ
public class OrderServiceImpl implements OrderService {
    private final DiscountPolicy discountPolicy;  // ê·¸ëŒ€ë¡œ!
    // ...
}
```

**ë¹„êµí‘œ**:

| í•­ëª© | Before AppConfig | After AppConfig |
|------|------------------|-----------------|
| **ìƒˆ ì •ì±… ì¶”ê°€** | ê°€ëŠ¥ | ê°€ëŠ¥ âœ… |
| **ì‚¬ìš© ì˜ì—­ ìˆ˜ì •** | í•„ìš” âŒ | ë¶ˆí•„ìš” âœ… |
| **êµ¬ì„± ì˜ì—­ ìˆ˜ì •** | í•„ìš” | í•„ìš” |
| **OCP ì¤€ìˆ˜** | ìœ„ë°˜ âŒ | ì¤€ìˆ˜ âœ… |

---

## ğŸ“Š 5ë‹¨ê³„ ì „ì²´ íë¦„ í•œëˆˆì— ë³´ê¸°

### íƒ€ì„ë¼ì¸ ë‹¤ì´ì–´ê·¸ë¨

```mermaid
gantt
    title 5ë‹¨ê³„ ê°œì„  ê³¼ì •
    dateFormat X
    axisFormat %s

    section 1ë‹¨ê³„
    ìƒˆ ì •ì±… ê°œë°œ : 0, 1

    section 2ë‹¨ê³„
    ë¬¸ì œ ë°œê²¬ : 1, 2

    section 3ë‹¨ê³„
    AppConfig ë„ì… : 2, 3

    section 4ë‹¨ê³„
    ë¦¬íŒ©í„°ë§ : 3, 4

    section 5ë‹¨ê³„
    ì •ì±… ì ìš© : 4, 5
```

### ê° ë‹¨ê³„ë³„ í•µì‹¬ í‚¤ì›Œë“œ

| ë‹¨ê³„ | í•µì‹¬ í‚¤ì›Œë“œ | ìƒíƒœ |
|------|------------|------|
| **1ë‹¨ê³„** | ë‹¤í˜•ì„±, ì¸í„°í˜ì´ìŠ¤, ìƒˆ êµ¬í˜„ì²´ | âœ… ê°œë°œ ì™„ë£Œ |
| **2ë‹¨ê³„** | DIP ìœ„ë°˜, OCP ìœ„ë°˜, ë¬¸ì œ ë°œê²¬ | âš ï¸ ë¬¸ì œ ì¸ì‹ |
| **3ë‹¨ê³„** | AppConfig, ìƒì„±ì ì£¼ì…, ê´€ì‹¬ì‚¬ ë¶„ë¦¬ | âœ… DIP í•´ê²° |
| **4ë‹¨ê³„** | ë¦¬íŒ©í„°ë§, ì¤‘ë³µ ì œê±°, ì—­í•  ë¶„ë¦¬ | âœ… ê°€ë…ì„± ê°œì„  |
| **5ë‹¨ê³„** | ì •ì±… ì ìš©, ì‚¬ìš©/êµ¬ì„± ë¶„ë¦¬, OCP ì¤€ìˆ˜ | âœ… OCP í•´ê²° |

### ì½”ë“œ ì§„í™” ê³¼ì •

**1ë‹¨ê³„: ìƒˆ ì •ì±… ê°œë°œ**
```java
âœ… class RateDiscountPolicy implements DiscountPolicy { ... }
```

**2ë‹¨ê³„: ë¬¸ì œ ë°œê²¬**
```java
âŒ private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
   // DIP ìœ„ë°˜! OCP ìœ„ë°˜!
```

**3ë‹¨ê³„: AppConfig ë„ì…**
```java
âœ… class AppConfig {
    public DiscountPolicy discountPolicy() {
        return new FixDiscountPolicy();
    }
}
âœ… class OrderServiceImpl {
    private final DiscountPolicy discountPolicy;  // ì¸í„°í˜ì´ìŠ¤ë§Œ ì˜ì¡´!
}
```

**4ë‹¨ê³„: ë¦¬íŒ©í„°ë§**
```java
âœ… class AppConfig {
    // ì—­í• ê³¼ êµ¬í˜„ ëª…í™•íˆ ë¶„ë¦¬
    public DiscountPolicy discountPolicy() { return new FixDiscountPolicy(); }
    public MemberRepository memberRepository() { return new MemoryMemberRepository(); }
}
```

**5ë‹¨ê³„: ì •ì±… ì ìš©**
```java
âœ… class AppConfig {
    public DiscountPolicy discountPolicy() {
        return new RateDiscountPolicy();  // ë”± í•œ ì¤„ë§Œ ë³€ê²½!
    }
}
```

---

## ğŸ¯ í•µì‹¬ ê°œë… ì •ë¦¬

### 1. ì‚¬ìš© ì˜ì—­ vs êµ¬ì„± ì˜ì—­

**ì‚¬ìš© ì˜ì—­ (Using Area)**:
- **ì—­í• **: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
- **ë³€ê²½ ë¹ˆë„**: ë‚®ìŒ
- **ì˜ˆì‹œ**: `OrderServiceImpl`, `MemberServiceImpl`
- **íŠ¹ì§•**: ì•ˆì •ì , DIP ì¤€ìˆ˜

**êµ¬ì„± ì˜ì—­ (Configuration Area)**:
- **ì—­í• **: ê°ì²´ ìƒì„± ë° ì—°ê²°
- **ë³€ê²½ ë¹ˆë„**: ë†’ìŒ (ìš”êµ¬ì‚¬í•­ ë³€ê²½ ì‹œ)
- **ì˜ˆì‹œ**: `AppConfig`
- **íŠ¹ì§•**: ìœ ì—°í•¨, ë³€ê²½ ì§‘ì¤‘

### 2. ì œì–´ì˜ íë¦„

**Before**:
```
OrderServiceImpl â†’ (ì§ì ‘ ìƒì„±) â†’ FixDiscountPolicy
```

**After**:
```
AppConfig â†’ (ìƒì„± ë° ì£¼ì…) â†’ OrderServiceImpl
         â†’ (ìƒì„±) â†’ RateDiscountPolicy

OrderServiceImpl â†’ (ì‚¬ìš©ë§Œ) â†’ DiscountPolicy (ì¸í„°í˜ì´ìŠ¤)
```

### 3. ì˜ì¡´ê´€ê³„ ë³€í™”

**Before: ì»´íŒŒì¼ ì˜ì¡´ê´€ê³„ = ëŸ°íƒ€ì„ ì˜ì¡´ê´€ê³„**
```java
// ì»´íŒŒì¼ ì‹œì 
OrderServiceImpl â†’ DiscountPolicy (ì¸í„°í˜ì´ìŠ¤)
                â†’ FixDiscountPolicy (êµ¬ì²´ í´ë˜ìŠ¤) âŒ

// ëŸ°íƒ€ì„ ì‹œì 
OrderServiceImpl â†’ FixDiscountPolicy ì¸ìŠ¤í„´ìŠ¤
```

**After: ì»´íŒŒì¼ ì˜ì¡´ê´€ê³„ â‰  ëŸ°íƒ€ì„ ì˜ì¡´ê´€ê³„**
```java
// ì»´íŒŒì¼ ì‹œì 
OrderServiceImpl â†’ DiscountPolicy (ì¸í„°í˜ì´ìŠ¤ë§Œ) âœ…

// ëŸ°íƒ€ì„ ì‹œì  (AppConfigê°€ ê²°ì •)
OrderServiceImpl â†’ RateDiscountPolicy ì¸ìŠ¤í„´ìŠ¤
```

---

## ğŸ“ ì‹¤ìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì´í•´ë„ ì ê²€

- [ ] 1ë‹¨ê³„: ìƒˆ í• ì¸ ì •ì±…ì„ ì™œ ì‰½ê²Œ ì¶”ê°€í•  ìˆ˜ ìˆì—ˆëŠ”ê°€?
- [ ] 2ë‹¨ê³„: DIP ìœ„ë°˜ì´ ë¬´ì—‡ì¸ì§€ ì„¤ëª…í•  ìˆ˜ ìˆëŠ”ê°€?
- [ ] 2ë‹¨ê³„: OCP ìœ„ë°˜ì´ ë¬´ì—‡ì¸ì§€ ì„¤ëª…í•  ìˆ˜ ìˆëŠ”ê°€?
- [ ] 3ë‹¨ê³„: AppConfigì˜ ì—­í• ì„ ì„¤ëª…í•  ìˆ˜ ìˆëŠ”ê°€?
- [ ] 3ë‹¨ê³„: ìƒì„±ì ì£¼ì…ì˜ ì¥ì ì„ ì„¤ëª…í•  ìˆ˜ ìˆëŠ”ê°€?
- [ ] 4ë‹¨ê³„: ì™œ ë¦¬íŒ©í„°ë§ì´ í•„ìš”í–ˆëŠ”ì§€ ì„¤ëª…í•  ìˆ˜ ìˆëŠ”ê°€?
- [ ] 5ë‹¨ê³„: ì‚¬ìš© ì˜ì—­ê³¼ êµ¬ì„± ì˜ì—­ì˜ ì°¨ì´ë¥¼ ì„¤ëª…í•  ìˆ˜ ìˆëŠ”ê°€?
- [ ] 5ë‹¨ê³„: OCPê°€ ì–´ë–»ê²Œ ì§€ì¼œì¡ŒëŠ”ì§€ ì„¤ëª…í•  ìˆ˜ ìˆëŠ”ê°€?

### ì½”ë“œ ì‘ì„± ì‹¤ìŠµ

**ì‹¤ìŠµ 1: ìƒˆë¡œìš´ ì •ì±… ì¶”ê°€**
```java
// TODO: VIP íšŒì›ì—ê²Œ ìƒì¼ ë‹¬ì— ì¶”ê°€ 20% í• ì¸ì„ ì œê³µí•˜ëŠ” ì •ì±… ì¶”ê°€
// 1. BirthdayDiscountPolicy í´ë˜ìŠ¤ ì‘ì„±
// 2. AppConfigì—ì„œ ì ìš©
// 3. OrderServiceImplì€ ìˆ˜ì •í•˜ì§€ ì•Šê³  ë™ì‘í•˜ëŠ”ì§€ í™•ì¸

public class BirthdayDiscountPolicy implements DiscountPolicy {
    // TODO: êµ¬í˜„
}
```

**ì‹¤ìŠµ 2: Repository ë³€ê²½**
```java
// TODO: MemoryMemberRepositoryë¥¼ JdbcMemberRepositoryë¡œ ë³€ê²½
// 1. JdbcMemberRepository í´ë˜ìŠ¤ ì‘ì„±
// 2. AppConfigì˜ ì–´ëŠ ë¶€ë¶„ì„ ìˆ˜ì •í•´ì•¼ í•˜ëŠ”ê°€?
// 3. ëª‡ êµ°ë°ë¥¼ ìˆ˜ì •í•´ì•¼ í•˜ëŠ”ê°€?

public class JdbcMemberRepository implements MemberRepository {
    // TODO: êµ¬í˜„
}
```

**ì‹¤ìŠµ 3: ë‹¤ì¤‘ ì •ì±… ì ìš©**
```java
// TODO: í• ì¸ ì •ì±…ì„ ì—¬ëŸ¬ ê°œ ì¡°í•©í•˜ëŠ” ê¸°ëŠ¥ ì¶”ê°€
// ì˜ˆ: VIPëŠ” ì •ë¥  í• ì¸ + ì¿ í° í• ì¸
// 1. CompositeDiscountPolicy í´ë˜ìŠ¤ ì‘ì„±
// 2. AppConfigì—ì„œ ì ìš©

public class CompositeDiscountPolicy implements DiscountPolicy {
    private final List<DiscountPolicy> policies;
    // TODO: êµ¬í˜„
}
```

---

## â“ ì‹¬í™” FAQ

**Q1. AppConfigì—ì„œ ë§¤ë²ˆ newë¥¼ í•˜ëŠ”ë°, ì„±ëŠ¥ìƒ ë¬¸ì œëŠ” ì—†ë‚˜ìš”?**

A1. í˜„ì¬ ì½”ë“œì˜ ë¬¸ì œ:
```java
public MemberService memberService() {
    return new MemberServiceImpl(memberRepository());
}

public OrderService orderService() {
    return new OrderServiceImpl(
        memberRepository(),  // ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤
        discountPolicy()
    );
}

public MemberRepository memberRepository() {
    return new MemoryMemberRepository();  // ë§¤ë²ˆ ìƒˆë¡œ ìƒì„±!
}
```

**ë¬¸ì œì **: `memberService()`ì™€ `orderService()`ë¥¼ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ê°ê° ë‹¤ë¥¸ `MemoryMemberRepository` ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë¨

**í•´ê²°ì±… ë¯¸ë¦¬ë³´ê¸°** (ë‹¤ìŒ ì±•í„°):
```java
// ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ì‚¬ìš© ì‹œ
@Configuration
public class AppConfig {

    @Bean
    public MemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }
}
// â†’ ìŠ¤í”„ë§ì´ ì‹±ê¸€í†¤ìœ¼ë¡œ ê´€ë¦¬í•´ì¤Œ!
```

**Q2. ìƒì„±ìê°€ ë§ì•„ì§€ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?**

A2. ìƒì„±ì íŒŒë¼ë¯¸í„°ê°€ ë§ì„ ë•Œ:
```java
// ë¬¸ì œ: ìƒì„±ì íŒŒë¼ë¯¸í„°ê°€ ë„ˆë¬´ ë§ìŒ
public OrderServiceImpl(
    MemberRepository memberRepository,
    DiscountPolicy discountPolicy,
    DeliveryPolicy deliveryPolicy,
    PaymentPolicy paymentPolicy,
    NotificationService notificationService
) {
    // ...
}
```

**í•´ê²° ë°©ë²•**:
1. **ë¹Œë” íŒ¨í„´** ì‚¬ìš©
2. **ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬** (ISP ì›ì¹™)
3. **í´ë˜ìŠ¤ ë¶„ë¦¬** (ì±…ì„ì´ ë„ˆë¬´ ë§ì€ ê²ƒì€ ì•„ë‹Œì§€ ê²€í† )

**Q3. í…ŒìŠ¤íŠ¸í•  ë•ŒëŠ” ì–´ë–»ê²Œ í•˜ë‚˜ìš”?**

A3. ìƒì„±ì ì£¼ì… ë•ë¶„ì— í…ŒìŠ¤íŠ¸ê°€ ì‰¬ì›Œì§:
```java
class OrderServiceTest {

    @Test
    void createOrder() {
        // given: Mock ê°ì²´ ìƒì„±
        MemberRepository mockRepository = new MockMemberRepository();
        DiscountPolicy mockPolicy = new MockDiscountPolicy();

        // when: Mockì„ ì£¼ì…í•˜ì—¬ í…ŒìŠ¤íŠ¸
        OrderService orderService = new OrderServiceImpl(
            mockRepository,
            mockPolicy
        );

        // then: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰
        Order order = orderService.createOrder(1L, "item", 10000);
        assertThat(order.getDiscountPrice()).isEqualTo(1000);
    }
}
```

**Q4. AppConfigê°€ ì»¤ì§€ë©´ ì–´ë–»ê²Œ ê´€ë¦¬í•˜ë‚˜ìš”?**

A4. ì„¤ì •ì„ ë¶„ë¦¬:
```java
// AppConfigê°€ ì»¤ì§ˆ ê²½ìš°

@Configuration
public class AppConfig {
    // ë©”ì¸ ì„¤ì •ë§Œ
}

@Configuration
public class InfraConfig {
    // ì¸í”„ë¼ ê´€ë ¨ ì„¤ì • (DB, Cache ë“±)
}

@Configuration
public class ServiceConfig {
    // ì„œë¹„ìŠ¤ ê´€ë ¨ ì„¤ì •
}
```

---

## ë‹¤ìŒ í•™ìŠµ

â¡ï¸ **[3-7. ì¢‹ì€ ê°ì²´ ì§€í–¥ ì„¤ê³„ì˜ 5ê°€ì§€ ì›ì¹™ì˜ ì ìš©](./3-7-ì¢‹ì€ê°ì²´ì§€í–¥ì„¤ê³„ì˜5ê°€ì§€ì›ì¹™ì˜ì ìš©.md)**
- SRP, DIP, OCP ì›ì¹™ ìƒì„¸ ë¶„ì„
- ê° ì›ì¹™ì´ ì–´ë–»ê²Œ ì ìš©ë˜ì—ˆëŠ”ì§€ í™•ì¸
- SOLID ì›ì¹™ì˜ ì‹¤ì „ ì ìš©
