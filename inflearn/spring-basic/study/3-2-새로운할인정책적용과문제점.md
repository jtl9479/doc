# 3-2. μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ 

**μ¶μ²**: μΈν”„λ° - μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ κΈ°λ³ΈνΈ
**μ±•ν„°**: 3. μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ μ΄ν•΄2 - κ°μ²΄ μ§€ν–¥ μ›λ¦¬ μ μ©

---

## ν•™μµ λ©ν‘

- [ ] ν• μΈ μ •μ±… μ μ© μ‹ λ°μƒν•λ” λ¬Έμ μ μ„ νμ•…ν•  μ μλ‹¤
- [ ] DIP(μμ΅΄κ΄€κ³„ μ—­μ „ μ›μΉ™) μ„λ° μ‚¬λ΅€λ¥Ό μ΄ν•΄ν•λ‹¤
- [ ] OCP(κ°λ°©-νμ‡„ μ›μΉ™) μ„λ° μ‚¬λ΅€λ¥Ό μ΄ν•΄ν•λ‹¤
- [ ] λ‹¤ν•μ„±λ§μΌλ΅λ” OCP, DIPλ¥Ό μ§€ν‚¬ μ μ—†μμ„ κΉ¨λ‹«λ”λ‹¤

---

## ν• μΈ μ •μ±… μ μ©ν•κΈ°

### κΈ°μ΅΄ μ½”λ“ λ³€κ²½

**OrderServiceImpl μμ •**:

```java
public class OrderServiceImpl implements OrderService {

    // κΈ°μ΅΄: κ³ μ • κΈμ•΅ ν• μΈ
    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

    // λ³€κ²½: μ •λ¥  ν• μΈ
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
}
```

### λ¬Έμ  λ°κ²¬!

**μ°λ¦¬κ°€ κΈ°λ€ν–λ κ²ƒ**:
> "μ—­ν• κ³Ό κµ¬ν„μ„ μ¶©μ‹¤ν•κ² λ¶„λ¦¬ν–μΌλ‹ κ΄μ°®μ„ κ±°μ•Ό!"

**μ‹¤μ  μƒν™©**:
> β ν΄λΌμ΄μ–ΈνΈ μ½”λ“(`OrderServiceImpl`)λ¥Ό λ³€κ²½ν•΄μ•Ό ν•¨
> β SOLID μ›μΉ™μ„ μ„λ°ν•κ³  μμ—μ

---

## λ¬Έμ μ  λ¶„μ„

### β… μν• κ²ƒλ“¤

1. **μ—­ν• κ³Ό κµ¬ν„ μ¶©μ‹¤ν λ¶„λ¦¬** β…
   - μΈν„°νμ΄μ¤(`DiscountPolicy`)μ™€ κµ¬ν„ ν΄λμ¤ λ¶„λ¦¬

2. **λ‹¤ν•μ„± ν™μ©** β…
   - μΈν„°νμ΄μ¤μ™€ κµ¬ν„ κ°μ²΄ λ¶„λ¦¬

3. **OCP, DIP κ°™μ€ κ°μ²΄μ§€ν–¥ μ„¤κ³„ μ›μΉ™ μ¤€μ?** β
   - κ·Έλ ‡κ² λ³΄μ΄μ§€λ§... **μ‚¬μ‹¤μ€ μ•„λ‹λ‹¤!**

---

### β DIP μ„λ° - μμ΅΄κ΄€κ³„ μ—­μ „ μ›μΉ™

**DIP μ›μΉ™**:
> "ν”„λ΅κ·Έλλ¨Έλ” μ¶”μƒν™”μ— μμ΅΄ν•΄μ•Όμ§€, κµ¬μ²΄ν™”μ— μμ΅΄ν•λ©΄ μ•λλ‹¤."

#### κΈ°λ€ν–λ μμ΅΄κ΄€κ³„

```mermaid
classDiagram
    class OrderServiceImpl
    class DiscountPolicy {
        <<interface>>
    }
    class FixDiscountPolicy
    class RateDiscountPolicy

    OrderServiceImpl --> DiscountPolicy
    DiscountPolicy <|.. FixDiscountPolicy
    DiscountPolicy <|.. RateDiscountPolicy
```

> "λ‹¨μν `DiscountPolicy` μΈν„°νμ΄μ¤λ§ μμ΅΄ν•λ‹¤κ³  μƒκ°ν–λ‹¤."

#### μ‹¤μ  μμ΅΄κ΄€κ³„

```mermaid
classDiagram
    class OrderServiceImpl
    class DiscountPolicy {
        <<interface>>
    }
    class FixDiscountPolicy
    class RateDiscountPolicy

    OrderServiceImpl --> DiscountPolicy : μ¶”μƒ μμ΅΄
    OrderServiceImpl --> FixDiscountPolicy : κµ¬μ²΄ μμ΅΄ (DIP μ„λ°!)
    DiscountPolicy <|.. FixDiscountPolicy
    DiscountPolicy <|.. RateDiscountPolicy
```

**λ¬Έμ μ **:
- `OrderServiceImpl`μ΄ `DiscountPolicy` **μΈν„°νμ΄μ¤**μ— μμ΅΄ β…
- λ™μ‹μ— `FixDiscountPolicy` **κµ¬μ²΄ ν΄λμ¤**μ—λ„ μμ΅΄ β

**μ½”λ“λ΅ ν™•μΈ**:
```java
public class OrderServiceImpl implements OrderService {

    // μ¶”μƒ(μΈν„°νμ΄μ¤) μμ΅΄: DiscountPolicy
    private final DiscountPolicy discountPolicy

    // κµ¬μ²΄(κµ¬ν„) ν΄λμ¤ μμ΅΄: FixDiscountPolicy - DIP μ„λ°!
        = new FixDiscountPolicy();
}
```

---

### β OCP μ„λ° - κ°λ°©-νμ‡„ μ›μΉ™

**OCP μ›μΉ™**:
> "μ†ν”„νΈμ›¨μ–΄ μ”μ†λ” ν™•μ¥μ—λ” μ—΄λ ¤ μμΌλ‚ λ³€κ²½μ—λ” λ‹«ν€ μμ–΄μ•Ό ν•λ‹¤."

#### μ •μ±… λ³€κ²½ μ‹λ‚λ¦¬μ¤

```mermaid
graph TB
    subgraph "μ‚¬μ© μμ—­"
        A[OrderServiceImpl]
        B[DiscountPolicy<br/>interface]
        A --> B
    end

    subgraph "κµ¬ν„ μμ—­"
        C[FixDiscountPolicy<br/>μ΄μ „]
        D[RateDiscountPolicy<br/>λ³€κ²½]
        B -.-> C
        B -.-> D
    end

    A -.μ½”λ“ μμ • ν•„μ”!<br/>OCP μ„λ°.-> D

    style A fill:#ffcccc
    style D fill:#ffffcc
```

**λ¬Έμ μ **:
- κΈ°λ¥μ„ **ν™•μ¥**(μƒλ΅μ΄ ν• μΈ μ •μ±… μ¶”κ°€)ν–μ„ λ•
- ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ¥Ό **λ³€κ²½**ν•΄μ•Ό ν•¨
- **OCP μ„λ°!**

**μ½”λ“ λ³€κ²½ ν•„μ”**:
```java
// μ†μ¤ μ½”λ“λ¥Ό μ§μ ‘ μμ •ν•΄μ•Ό ν•¨!
// private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
```

---

## μ™ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ¥Ό λ³€κ²½ν•΄μ•Ό ν• κΉ?

### μμ΅΄κ΄€κ³„ λ‹¤μ΄μ–΄κ·Έλ¨μΌλ΅ λ¶„μ„

#### μ‹¤μ  μμ΅΄κ΄€κ³„

```mermaid
graph LR
    A[OrderServiceImpl<br/>ν΄λΌμ΄μ–ΈνΈ]
    B[DiscountPolicy<br/>interface]
    C[FixDiscountPolicy<br/>κµ¬μ²΄ ν΄λμ¤]

    A -->|μ¶”μƒ μμ΅΄| B
    A -->|κµ¬μ²΄ μμ΅΄<br/>λ¬Έμ !| C
    C -.κµ¬ν„.-> B

    style A fill:#ffcccc
    style C fill:#ffcccc
```

**λ¬Έμ μ κ·Όλ³Έ μ›μΈ**:
- ν΄λΌμ΄μ–ΈνΈ(`OrderServiceImpl`)κ°€ μΈν„°νμ΄μ¤μ™€ κµ¬ν„ ν΄λμ¤λ¥Ό **λ™μ‹μ— μμ΅΄**
- κµ¬μ²΄ ν΄λμ¤λ¥Ό λ³€κ²½ν•  λ• ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ„ ν•¨κ» λ³€κ²½ ν•„μ”

---

## ν•΄κ²° λ°©μ• λ¨μƒ‰

### μ‹λ„ 1: μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ λ³€κ²½

**μ½”λ“ μμ •**:
```java
public class OrderServiceImpl implements OrderService {

    // μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ - DIP μ¤€μ!
    private DiscountPolicy discountPolicy;
}
```

**μμ΅΄κ΄€κ³„ λ‹¤μ΄μ–΄κ·Έλ¨**:
```mermaid
classDiagram
    class OrderServiceImpl
    class DiscountPolicy {
        <<interface>>
    }
    class FixDiscountPolicy
    class RateDiscountPolicy

    OrderServiceImpl --> DiscountPolicy
    DiscountPolicy <|.. FixDiscountPolicy
    DiscountPolicy <|.. RateDiscountPolicy

    note for OrderServiceImpl "κµ¬μ²΄ ν΄λμ¤ μμ΅΄ μ κ±°!"
```

**μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ„¤κ³„ λ³€κ²½**:
- β… DIP μ¤€μ
- β… κµ¬μ²΄ ν΄λμ¤λ¥Ό μ „ν€ λ¨λ¦„

### μƒλ΅μ΄ λ¬Έμ  λ°μƒ!

**μ‹¤ν–‰ κ²°κ³Ό**:
```
NullPointerException (NPE) λ°μƒ!
```

**λ¬Έμ μ **:
- κµ¬ν„μ²΄κ°€ μ—†μΌλ―€λ΅ μ½”λ“ μ‹¤ν–‰ λ¶κ°€
- `discountPolicy`κ°€ `null` μƒνƒ

---

## ν•΄κ²°μ±…

### λ„κµ°κ°€κ°€ ν•„μ”ν•λ‹¤

**λ¬Έμ  μ •μ**:
> μ΄ λ¬Έμ λ¥Ό ν•΄κ²°ν•λ ¤λ©΄ **λ„κµ°κ°€**κ°€ ν΄λΌμ΄μ–ΈνΈμΈ `OrderServiceImpl`μ—κ² `DiscountPolicy`μ κµ¬ν„ κ°μ²΄λ¥Ό λ€μ‹  μƒμ„±ν•κ³  μ£Όμ…ν•΄μ£Όμ–΄μ•Ό ν•λ‹¤.

**ν•„μ”ν• κ²ƒ**:
- κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•λ” **μ™Έλ¶€μ λ„κµ°κ°€**
- ν΄λΌμ΄μ–ΈνΈμ—κ² μμ΅΄κ΄€κ³„λ¥Ό μ£Όμ…ν•λ” **μ™Έλ¶€μ λ„κµ°κ°€**

> π’΅ μ΄κ²ƒμ΄ λ°”λ΅ λ‹¤μ μ„Ήμ…μ **κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬**!

---

## π’΅ ν•µμ‹¬ κΉ¨λ‹¬μ

### λ‹¤ν•μ„±λ§μΌλ΅λ” λ¶€μ΅±ν•λ‹¤

**μ°λ¦¬κ°€ λ°°μ΄ κ²ƒ**:
1. β λ‹¤ν•μ„±λ§μΌλ΅λ” OCP, DIPλ¥Ό μ§€ν‚¬ μ μ—†μ
2. β ν΄λΌμ΄μ–ΈνΈ μ½”λ“κ°€ κµ¬μ²΄ ν΄λμ¤λ¥Ό μ§μ ‘ μ„ νƒν•λ©΄ DIP μ„λ°
3. β κµ¬ν„ κ°μ²΄ λ³€κ²½ μ‹ ν΄λΌμ΄μ–ΈνΈ μ½”λ“ λ³€κ²½ ν•„μ” = OCP μ„λ°

### κ·Όλ³Έμ μΈ λ¬Έμ 

**`OrderServiceImpl`μ μ±…μ„μ΄ λ„λ¬΄ λ§μ**:
1. μ£Όλ¬Έ λ΅μ§ μ‹¤ν–‰ (μμ‹ μ μ—­ν• ) β…
2. ν• μΈ μ •μ±… κµ¬ν„ κ°μ²΄ μ„ νƒ (λ‚¨μ μ—­ν• ) β
3. ν• μΈ μ •μ±… κµ¬ν„ κ°μ²΄ μƒμ„± (λ‚¨μ μ—­ν• ) β

---

## μ •λ¦¬

### λ¬Έμ μ  μ”μ•½

| μ›μΉ™ | μ„λ° λ‚΄μ© | κ²°κ³Ό |
|------|----------|------|
| **DIP** | μ¶”μƒν™” + κµ¬μ²΄ν™” λ¨λ‘ μμ΅΄ | κµ¬ν„μ²΄ λ³€κ²½ μ‹ ν΄λΌμ΄μ–ΈνΈ μ½”λ“ μμ • ν•„μ” |
| **OCP** | ν™•μ¥ μ‹ ν΄λΌμ΄μ–ΈνΈ μ½”λ“ λ³€κ²½ | λ³€κ²½μ— λ‹«ν€μμ§€ μ•μ |

### ν•΄κ²° λ°©ν–¥

**ν•„μ”ν• κ²ƒ**:
- κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ£Όμ…ν•΄μ£Όλ” **μ™Έλ¶€μ μ΅΄μ¬**
- ν΄λΌμ΄μ–ΈνΈλ” μ‹¤ν–‰μ—λ§ μ§‘μ¤‘
- μ΄κ²ƒμ΄ λ°”λ΅ **κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬**

---

## λ©΄μ ‘ μ§λ¬Έ

**Q. λ‹¤ν•μ„±λ§ μμΌλ©΄ OCP, DIPλ¥Ό μ§€ν‚¬ μ μλ‚μ”?**

<details>
<summary>λ‹µμ• λ³΄κΈ°</summary>

**λ‹µμ•**: μ•„λ‹μ¤, λ‹¤ν•μ„±λ§μΌλ΅λ” OCPμ™€ DIPλ¥Ό μ§€ν‚¬ μ μ—†μµλ‹λ‹¤.

**μ΄μ **:
- ν΄λΌμ΄μ–ΈνΈκ°€ κµ¬ν„ ν΄λμ¤λ¥Ό μ§μ ‘ μ„ νƒ(`new FixDiscountPolicy()`)ν•λ©΄ κµ¬μ²΄ ν΄λμ¤μ— μμ΅΄ν•κ² λ¨ (DIP μ„λ°)
- κµ¬ν„ ν΄λμ¤ λ³€κ²½ μ‹ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ„ λ³€κ²½ν•΄μ•Ό ν•¨ (OCP μ„λ°)

**ν•΄κ²°μ±…**:
- μ™Έλ¶€μ—μ„ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ£Όμ…ν•λ” **DI(μμ΅΄κ΄€κ³„ μ£Όμ…)** ν•„μ”
- AppConfig κ°™μ€ **κµ¬μ„± μμ—­**μ΄ ν•„μ”

</details>

---

## λ‹¤μ ν•™μµ

β΅οΈ **[3-3. κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬](./3-3-κ΄€μ‹¬μ‚¬μλ¶„λ¦¬.md)**
- μ• ν”λ¦¬μΌ€μ΄μ…μ„ κ³µμ—°μ— λΉ„μ 
- κ³µμ—° κΈ°νμ(AppConfig) λ“±μ¥
- μƒμ„±μ μ£Όμ…μ„ ν†µν• μμ΅΄κ΄€κ³„ μ£Όμ…
