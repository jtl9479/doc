# 3-3. ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬

**ì¶œì²˜**: ì¸í”„ëŸ° - ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ ê¸°ë³¸í¸
**ì±•í„°**: 3. ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ ì´í•´2 - ê°ì²´ ì§€í–¥ ì›ë¦¬ ì ìš©

---

## í•™ìŠµ ëª©í‘œ

- [ ] ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬ ê°œë…ì„ ì´í•´í•œë‹¤
- [ ] AppConfigì˜ ì—­í• ê³¼ í•„ìš”ì„±ì„ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤
- [ ] ìƒì„±ì ì£¼ì… ë°©ì‹ì„ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤
- [ ] DI(ì˜ì¡´ê´€ê³„ ì£¼ì…) ê°œë…ì„ ì´í•´í•œë‹¤

---

## ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê³µì—°ìœ¼ë¡œ ë¹„ìœ í•˜ê¸°

### ì˜ëª»ëœ ì„¤ê³„ (í˜„ì¬ ìƒí™©)

**ë¡œë¯¸ì˜¤ì™€ ì¤„ë¦¬ì—£ ê³µì—° ì˜ˆì‹œ**:

```mermaid
graph LR
    A[ë¡œë¯¸ì˜¤ ì—­í• <br/>ë ˆì˜¤ë‚˜ë¥´ë„ ë””ì¹´í”„ë¦¬ì˜¤]
    B[ì¤„ë¦¬ì—£ ì—­í• <br/>?]

    A -->|ì§ì ‘ ì„­ì™¸!| B

    style A fill:#ffcccc
```

**ë¬¸ì œì **:
- ë¡œë¯¸ì˜¤ ì—­í• (ì¸í„°í˜ì´ìŠ¤)ì„ í•˜ëŠ” ë””ì¹´í”„ë¦¬ì˜¤(êµ¬í˜„ì²´, ë°°ìš°)ê°€
- ì¤„ë¦¬ì—£ ì—­í• (ì¸í„°í˜ì´ìŠ¤)ì„ í•  ì—¬ë°°ìš°(êµ¬í˜„ì²´, ë°°ìš°)ë¥¼ **ì§ì ‘ ì´ˆë¹™**
- ë°°ìš°ê°€ **ê³µì—°ë„ í•˜ê³ , ì„­ì™¸ë„ í•˜ëŠ”** ë‹¤ì–‘í•œ ì±…ì„ì„ ê°€ì§

### ì˜¬ë°”ë¥¸ ì„¤ê³„ (ê°œì„  ë°©í–¥)

**ê³µì—° ê¸°íšìì˜ ì—­í• **:

```mermaid
graph TB
    A[ê³µì—° ê¸°íšì]
    B[ë¡œë¯¸ì˜¤ ì—­í• <br/>ë””ì¹´í”„ë¦¬ì˜¤]
    C[ì¤„ë¦¬ì—£ ì—­í• <br/>ê¹€íƒœí¬]

    A -.ì„­ì™¸.-> B
    A -.ì„­ì™¸.-> C
    B -->|ê³µì—°| C

    style A fill:#e1f5ff
```

**ê°œì„ ëœ ì **:
- ë°°ìš°ëŠ” ë³¸ì¸ì˜ **ì—­í• (ë°°ì—­)ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì—ë§Œ ì§‘ì¤‘**
- ë””ì¹´í”„ë¦¬ì˜¤ëŠ” ì–´ë–¤ ì—¬ì ì£¼ì¸ê³µì´ ì„ íƒë˜ë”ë¼ë„ **ë˜‘ê°™ì´ ê³µì—° ê°€ëŠ¥**
- **ê³µì—° ê¸°íšì**ê°€ ë‹´ë‹¹ ë°°ìš°ë¥¼ ì„­ì™¸í•˜ê³ , ì—­í• ì— ë§ëŠ” ë°°ìš°ë¥¼ ì§€ì •

---

## ê´€ì‹¬ì‚¬ ë¶„ë¦¬í•˜ê¸°

### í•„ìš”í•œ ê²ƒ

**ê³µì—° ê¸°íšìì²˜ëŸ¼**:
- ê³µì—°ì„ êµ¬ì„±í•˜ê³ 
- ë‹´ë‹¹ ë°°ìš°ë¥¼ ì„­ì™¸í•˜ê³ 
- ì—­í• ì— ë§ëŠ” ë°°ìš°ë¥¼ ì§€ì •í•˜ëŠ”
- **ë³„ë„ì˜ ì±…ì„ì„ ë‹´ë‹¹í•˜ëŠ” ì¡´ì¬**

### AppConfig ë“±ì¥

**ì—­í• **:
- ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì „ì²´ ë™ì‘ ë°©ì‹ì„ **êµ¬ì„±(config)**
- **êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±**í•˜ê³ , **ì—°ê²°**í•˜ëŠ” ì±…ì„ì„ ê°€ì§€ëŠ” ë³„ë„ì˜ ì„¤ì • í´ë˜ìŠ¤

---

## AppConfig êµ¬í˜„

### AppConfig ì½”ë“œ

**AppConfig.java**:

```java
package hello.core;

import hello.core.discount.FixDiscountPolicy;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.member.MemoryMemberRepository;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;

public class AppConfig {

    public MemberService memberService() {
        return new MemberServiceImpl(new MemoryMemberRepository());
    }

    public OrderService orderService() {
        return new OrderServiceImpl(
            new MemoryMemberRepository(),
            new FixDiscountPolicy()
        );
    }
}
```

### AppConfigì˜ ì—­í• 

**1. êµ¬í˜„ ê°ì²´ ìƒì„±**:
- `MemberServiceImpl`
- `MemoryMemberRepository`
- `OrderServiceImpl`
- `FixDiscountPolicy`

**2. ìƒì„±ìë¥¼ í†µí•´ ì˜ì¡´ê´€ê³„ ì£¼ì…(ì—°ê²°)**:
- `MemberServiceImpl` â†’ `MemoryMemberRepository`
- `OrderServiceImpl` â†’ `MemoryMemberRepository`, `FixDiscountPolicy`

---

## ìƒì„±ì ì£¼ì… ì ìš©

### MemberServiceImpl ë³€ê²½

**ë³€ê²½ ì „ - ì§ì ‘ ìƒì„±**:
```java
public class MemberServiceImpl implements MemberService {

    // êµ¬ì²´ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ìƒì„± - DIP ìœ„ë°˜!
    private final MemberRepository memberRepository
        = new MemoryMemberRepository();

    public void join(Member member) {
        memberRepository.save(member);
    }

    public Member findMember(Long memberId) {
        return memberRepository.findById(memberId);
    }
}
```

**ë³€ê²½ í›„ - ìƒì„±ì ì£¼ì…**:
```java
package hello.core.member;

public class MemberServiceImpl implements MemberService {

    // ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´ - DIP ì¤€ìˆ˜!
    private final MemberRepository memberRepository;

    // ìƒì„±ìë¥¼ í†µí•´ êµ¬í˜„ ê°ì²´ ì£¼ì…
    public MemberServiceImpl(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    public void join(Member member) {
        memberRepository.save(member);
    }

    public Member findMember(Long memberId) {
        return memberRepository.findById(memberId);
    }
}
```

**ê°œì„  íš¨ê³¼**:
- âœ… `MemoryMemberRepository`ë¥¼ ì˜ì¡´í•˜ì§€ ì•ŠìŒ
- âœ… `MemberRepository` ì¸í„°í˜ì´ìŠ¤ë§Œ ì˜ì¡´
- âœ… ì–´ë–¤ êµ¬í˜„ ê°ì²´ê°€ ì£¼ì…ë ì§€ëŠ” ì™¸ë¶€(`AppConfig`)ì—ì„œ ê²°ì •
- âœ… **ì˜ì¡´ê´€ê³„ì— ëŒ€í•œ ê³ ë¯¼ì€ ì™¸ë¶€ì— ë§¡ê¸°ê³  ì‹¤í–‰ì—ë§Œ ì§‘ì¤‘**

---

### OrderServiceImpl ë³€ê²½

**ë³€ê²½ í›„ - ìƒì„±ì ì£¼ì…**:
```java
package hello.core.order;

import hello.core.discount.DiscountPolicy;
import hello.core.member.Member;
import hello.core.member.MemberRepository;

public class OrderServiceImpl implements OrderService {

    // ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´ - DIP ì¤€ìˆ˜!
    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    // ìƒì„±ìë¥¼ í†µí•´ êµ¬í˜„ ê°ì²´ ì£¼ì…
    public OrderServiceImpl(MemberRepository memberRepository,
                           DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice);

        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

**ê°œì„  íš¨ê³¼**:
- âœ… `FixDiscountPolicy`ë¥¼ ì˜ì¡´í•˜ì§€ ì•ŠìŒ
- âœ… `DiscountPolicy` ì¸í„°í˜ì´ìŠ¤ë§Œ ì˜ì¡´
- âœ… ì–´ë–¤ êµ¬í˜„ ê°ì²´ê°€ ì£¼ì…ë ì§€ëŠ” ì™¸ë¶€ì—ì„œ ê²°ì •
- âœ… **ì‹¤í–‰ì—ë§Œ ì§‘ì¤‘**

---

## í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

### ì „ì²´ êµ¬ì¡°

```mermaid
classDiagram
    class MemberService {
        <<interface>>
    }
    class MemberServiceImpl {
        -MemberRepository memberRepository
        +MemberServiceImpl(MemberRepository)
    }
    class MemberRepository {
        <<interface>>
    }
    class MemoryMemberRepository {
        +save()
        +findById()
    }
    class AppConfig {
        +memberService()
        +orderService()
    }

    MemberService <|.. MemberServiceImpl
    MemberServiceImpl --> MemberRepository
    MemberRepository <|.. MemoryMemberRepository
    AppConfig ..> MemberServiceImpl : ìƒì„±
    AppConfig ..> MemoryMemberRepository : ìƒì„±
```

**ì—­í•  ë¶„ë¦¬**:
- `AppConfig`: ê°ì²´ ìƒì„±ê³¼ ì—°ê²°
- `MemberServiceImpl`: ì‹¤í–‰ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)

---

## ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

### íšŒì› ê°ì²´ ì¸ìŠ¤í„´ìŠ¤

```mermaid
graph TB
    A[appConfig]
    B[memoryMemberRepository<br/>x001]
    C[memberServiceImpl]

    A -.1. ìƒì„±.-> B
    A -.2. ìƒì„± + ì£¼ì…<br/>memoryMemberRepository x001.-> C
    C --> B

    style A fill:#e1f5ff
    style B fill:#fff5e1
    style C fill:#f5e1ff
```

**íë¦„**:
1. `appConfig`ê°€ `memoryMemberRepository` ê°ì²´ ìƒì„±
2. `appConfig`ê°€ `memberServiceImpl` ìƒì„±í•˜ë©´ì„œ ìƒì„±ìë¡œ `memoryMemberRepository` ì°¸ì¡°ê°’ ì „ë‹¬
3. `memberServiceImpl` ì…ì¥ì—ì„œëŠ” ì˜ì¡´ê´€ê³„ë¥¼ ì™¸ë¶€ì—ì„œ ì£¼ì…ë°›ëŠ” ê²ƒ

---

## DI (Dependency Injection)

### ì˜ì¡´ê´€ê³„ ì£¼ì…

**í´ë¼ì´ì–¸íŠ¸ ì…ì¥ì—ì„œ**:
- `memberServiceImpl` ì…ì¥ì—ì„œ ë³´ë©´
- ì˜ì¡´ê´€ê³„ë¥¼ ë§ˆì¹˜ **ì™¸ë¶€ì—ì„œ ì£¼ì…í•´ì£¼ëŠ” ê²ƒ** ê°™ìŒ

**ìš©ì–´**:
- **DI (Dependency Injection)**
- ìš°ë¦¬ë§ë¡œ **ì˜ì¡´ê´€ê³„ ì£¼ì…** ë˜ëŠ” **ì˜ì¡´ì„± ì£¼ì…**

---

## AppConfig ì‹¤í–‰

### MemberApp ë³€ê²½

**ë³€ê²½ ì „**:
```java
public class MemberApp {
    public static void main(String[] args) {
        MemberService memberService = new MemberServiceImpl();
        // ...
    }
}
```

**ë³€ê²½ í›„**:
```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;

public class MemberApp {

    public static void main(String[] args) {
        // AppConfigë¥¼ í†µí•´ MemberService ì¡°íšŒ
        AppConfig appConfig = new AppConfig();
        MemberService memberService = appConfig.memberService();

        Member member = new Member(1L, "memberA", Grade.VIP);
        memberService.join(member);

        Member findMember = memberService.findMember(1L);
        System.out.println("new member = " + member.getName());
        System.out.println("find Member = " + findMember.getName());
    }
}
```

---

### OrderApp ë³€ê²½

**ë³€ê²½ í›„**:
```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.order.Order;
import hello.core.order.OrderService;

public class OrderApp {

    public static void main(String[] args) {
        // AppConfigë¥¼ í†µí•´ Service ì¡°íšŒ
        AppConfig appConfig = new AppConfig();
        MemberService memberService = appConfig.memberService();
        OrderService orderService = appConfig.orderService();

        long memberId = 1L;
        Member member = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 10000);

        System.out.println("order = " + order);
    }
}
```

---

### í…ŒìŠ¤íŠ¸ ì½”ë“œ ìˆ˜ì •

**MemberServiceTest**:
```java
class MemberServiceTest {

    MemberService memberService;

    @BeforeEach
    public void beforeEach() {
        AppConfig appConfig = new AppConfig();
        memberService = appConfig.memberService();
    }

    // í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ...
}
```

**OrderServiceTest**:
```java
class OrderServiceTest {

    MemberService memberService;
    OrderService orderService;

    @BeforeEach
    public void beforeEach() {
        AppConfig appConfig = new AppConfig();
        memberService = appConfig.memberService();
        orderService = appConfig.orderService();
    }

    // í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ...
}
```

**`@BeforeEach`**:
- ê° í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ê¸° ì „ì— í˜¸ì¶œë¨
- AppConfigë¥¼ í†µí•´ ì„œë¹„ìŠ¤ ê°ì²´ ìƒì„±

---

## ğŸ’¡ í•µì‹¬ ì •ë¦¬

### ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬

**ë°°ì—­ê³¼ ë°°ìš°ì˜ ë¹„ìœ **:

| ì—­í•  | ì±…ì„ | ë¹„ìœ  |
|------|------|------|
| **AppConfig** | - êµ¬í˜„ ê°ì²´ ìƒì„±<br/>- ì˜ì¡´ê´€ê³„ ì—°ê²°<br/>- ì „ì²´ êµ¬ì„± ì±…ì„ | ê³µì—° ê¸°íšì |
| **ServiceImpl** | - ìì‹ ì˜ ê¸°ëŠ¥ ì‹¤í–‰<br/>- ì‹¤í–‰ì—ë§Œ ì§‘ì¤‘ | ë°°ìš° |

### DIP ì™„ì„±

**MemberServiceImpl**:
- âœ… `MemoryMemberRepository`ë¥¼ ì˜ì¡´í•˜ì§€ ì•ŠìŒ
- âœ… `MemberRepository` ì¸í„°í˜ì´ìŠ¤ë§Œ ì˜ì¡´
- âœ… êµ¬ì²´ í´ë˜ìŠ¤ë¥¼ ëª°ë¼ë„ ë¨

### ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬

**ì—­í•  ë¶„ë¦¬**:
- âœ… ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì—°ê²°í•˜ëŠ” ì—­í• : `AppConfig`
- âœ… ì‹¤í–‰í•˜ëŠ” ì—­í• : `MemberServiceImpl`, `OrderServiceImpl`
- âœ… ê´€ì‹¬ì‚¬ê°€ ëª…í™•íˆ ë¶„ë¦¬ë¨

---

## ì •ë¦¬

### AppConfigë¥¼ í†µí•œ ê°œì„ 

**Before**:
```java
// ServiceImplì´ ì§ì ‘ ìƒì„± - ì±…ì„ ê³¼ë‹¤
private final MemberRepository memberRepository
    = new MemoryMemberRepository();
```

**After**:
```java
// AppConfigê°€ ìƒì„±í•˜ì—¬ ì£¼ì… - ì±…ì„ ë¶„ë¦¬
public MemberServiceImpl(MemberRepository memberRepository) {
    this.memberRepository = memberRepository;
}
```

### ì´ì œ ê° ë°°ìš°ë“¤ì€...

- ë‹´ë‹¹ **ê¸°ëŠ¥ì„ ì‹¤í–‰í•˜ëŠ” ì±…ì„ë§Œ** ì§€ë©´ ë¨
- `OrderServiceImpl`ì€ **ê¸°ëŠ¥ì„ ì‹¤í–‰í•˜ëŠ” ì±…ì„ë§Œ** ì§€ë©´ ë¨
- ì–´ë–¤ êµ¬í˜„ ê°ì²´ê°€ ì£¼ì…ë ì§€ëŠ” **ì•Œ í•„ìš” ì—†ìŒ**
- **ì˜¤ì§ ì™¸ë¶€(AppConfig)ì—ì„œ ê²°ì •**

---

## ğŸ“š AppConfig ì‹¬ì¸µ ë¶„ì„

> **ìŠ¤í”„ë§ì˜ í•µì‹¬ ì›ë¦¬ë¥¼ ì´í•´í•˜ê¸° ìœ„í•œ ìƒì„¸ ì„¤ëª…**

### 1. AppConfigì˜ íƒ„ìƒ ë°°ê²½

#### ë¬¸ì œ ìƒí™©: ì±…ì„ì˜ ê³¼ë‹¤

**ë³€ê²½ ì „ OrderServiceImpl**:
```java
public class OrderServiceImpl implements OrderService {
    // ë¬¸ì œ 1: êµ¬ì²´ í´ë˜ìŠ¤ì— ì§ì ‘ ì˜ì¡´
    private final MemberRepository memberRepository = new MemoryMemberRepository();
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        // ë¬¸ì œ 2: ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆ˜í–‰
        Member member = memberRepository.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice);
        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

**ì´ ì½”ë“œì˜ ë¬¸ì œì **:

| ë¬¸ì œ | ì„¤ëª… | SOLID ì›ì¹™ ìœ„ë°˜ |
|------|------|----------------|
| **1. ê°ì²´ ìƒì„± ì±…ì„** | `new MemoryMemberRepository()`, `new FixDiscountPolicy()` ì§ì ‘ ìƒì„± | SRP (ë‹¨ì¼ ì±…ì„ ì›ì¹™) ìœ„ë°˜ |
| **2. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆ˜í–‰** | `createOrder()` ë©”ì„œë“œë¡œ ì£¼ë¬¸ ìƒì„± ë¡œì§ ì‹¤í–‰ | - |
| **3. êµ¬ì²´ í´ë˜ìŠ¤ ì˜ì¡´** | ì¸í„°í˜ì´ìŠ¤ê°€ ì•„ë‹Œ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ì•Œì•„ì•¼ í•¨ | DIP (ì˜ì¡´ê´€ê³„ ì—­ì „ ì›ì¹™) ìœ„ë°˜ |
| **4. ë³€ê²½ ì‹œ ì˜í–¥ ë²”ìœ„** | êµ¬í˜„ì²´ ë³€ê²½ ì‹œ ServiceImpl ì½”ë“œ ìˆ˜ì • í•„ìš” | OCP (ê°œë°©-íì‡„ ì›ì¹™) ìœ„ë°˜ |

#### í•´ê²° ë°©ì•ˆ: ì±…ì„ ë¶„ë¦¬

**í•µì‹¬ ì•„ì´ë””ì–´**:
```
"ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì—°ê²°í•˜ëŠ” ì±…ì„"ê³¼ "ì‹¤í–‰í•˜ëŠ” ì±…ì„"ì„ ë¶„ë¦¬í•˜ì!
```

```mermaid
graph TB
    subgraph "ë³€ê²½ ì „: ì±…ì„ ê³¼ë‹¤"
    A1[OrderServiceImpl]
    A1 -->|ì±…ì„ 1| A2[ê°ì²´ ìƒì„±]
    A1 -->|ì±…ì„ 2| A3[ì˜ì¡´ê´€ê³„ ì„¤ì •]
    A1 -->|ì±…ì„ 3| A4[ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰]
    end

    subgraph "ë³€ê²½ í›„: ì±…ì„ ë¶„ë¦¬"
    B1[AppConfig]
    B2[OrderServiceImpl]
    B1 -->|ì±…ì„ 1| B3[ê°ì²´ ìƒì„±]
    B1 -->|ì±…ì„ 2| B4[ì˜ì¡´ê´€ê³„ ì„¤ì •]
    B2 -->|ì±…ì„ 3| B5[ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰]
    end

    style A1 fill:#ffcccc
    style B1 fill:#ccffcc
    style B2 fill:#ccffcc
```

---

### 2. AppConfigì˜ í•µì‹¬ ì—­í•  ìƒì„¸

#### ì—­í•  1: êµ¬í˜„ ê°ì²´ ìƒì„±

**AppConfigê°€ ìƒì„±í•˜ëŠ” ëª¨ë“  ê°ì²´**:
```java
public class AppConfig {

    public MemberService memberService() {
        // 1. MemoryMemberRepository ê°ì²´ ìƒì„±
        // 2. MemberServiceImpl ê°ì²´ ìƒì„±
        return new MemberServiceImpl(new MemoryMemberRepository());
    }

    public OrderService orderService() {
        // 3. MemoryMemberRepository ê°ì²´ ìƒì„± (ë˜ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤)
        // 4. FixDiscountPolicy ê°ì²´ ìƒì„±
        // 5. OrderServiceImpl ê°ì²´ ìƒì„±
        return new OrderServiceImpl(
            new MemoryMemberRepository(),
            new FixDiscountPolicy()
        );
    }
}
```

**ë©”ëª¨ë¦¬ ê´€ì ì—ì„œ ë³´ê¸°**:
```
Heap Memory:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MemoryMemberRepository@x001         â”‚ â† memberServiceìš©
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MemberServiceImpl@x002              â”‚
â”‚   - memberRepository: @x001         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MemoryMemberRepository@x003         â”‚ â† orderServiceìš©
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FixDiscountPolicy@x004              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OrderServiceImpl@x005               â”‚
â”‚   - memberRepository: @x003         â”‚
â”‚   - discountPolicy: @x004           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ì—­í•  2: ìƒì„±ìë¥¼ í†µí•œ ì˜ì¡´ê´€ê³„ ì£¼ì…

**ìƒì„±ì ì£¼ì…ì˜ ë™ì‘ ê³¼ì •**:

```java
// Step 1: AppConfigì—ì„œ ì‹œì‘
AppConfig appConfig = new AppConfig();

// Step 2: memberService() í˜¸ì¶œ
MemberService memberService = appConfig.memberService();

// Step 3: AppConfig ë‚´ë¶€ ë™ì‘ (ì‹¤ì œë¡œëŠ” í•œ ì¤„ì´ì§€ë§Œ ë‹¨ê³„ë³„ ë¶„ì„)
// 3-1. MemoryMemberRepository ìƒì„±
MemoryMemberRepository repository = new MemoryMemberRepository();

// 3-2. MemberServiceImpl ìƒì„±ì í˜¸ì¶œí•˜ë©´ì„œ repository ì „ë‹¬
MemberServiceImpl serviceImpl = new MemberServiceImpl(repository);

// 3-3. MemberServiceImpl ìƒì„±ì ë‚´ë¶€
public MemberServiceImpl(MemberRepository memberRepository) {
    this.memberRepository = memberRepository;  // ì°¸ì¡°ê°’ì´ ì €ì¥ë¨
}

// Step 4: ë°˜í™˜
return serviceImpl;  // MemberService íƒ€ì…ìœ¼ë¡œ ë°˜í™˜
```

**ì˜ì¡´ê´€ê³„ ì£¼ì… ìƒì„¸ ë¶„ì„**:

```mermaid
sequenceDiagram
    participant Client as í´ë¼ì´ì–¸íŠ¸
    participant Config as AppConfig
    participant Repo as MemoryMemberRepository
    participant Service as MemberServiceImpl

    Client->>Config: memberService() í˜¸ì¶œ
    Config->>Repo: new MemoryMemberRepository()
    Repo-->>Config: ê°ì²´ ìƒì„± ì™„ë£Œ (@x001)
    Config->>Service: new MemberServiceImpl(@x001)
    Note over Service: ìƒì„±ì ì‹¤í–‰<br/>memberRepository = @x001
    Service-->>Config: ê°ì²´ ìƒì„± ì™„ë£Œ (@x002)
    Config-->>Client: MemberService ë°˜í™˜ (@x002)
```

---

### 3. ìƒì„±ì ì£¼ì…ì˜ ì›ë¦¬

#### ìƒì„±ì ì£¼ì…ì´ë€?

**ì •ì˜**:
- ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ìƒì„±ìë¥¼ í†µí•´ ì˜ì¡´ê´€ê³„ë¥¼ ì™¸ë¶€ì—ì„œ ì£¼ì…ë°›ëŠ” ë°©ì‹

**ì™œ ìƒì„±ìì¸ê°€?**

```java
public class MemberServiceImpl implements MemberService {

    private final MemberRepository memberRepository;

    // ìƒì„±ì: ê°ì²´ ìƒì„± ì‹œ ë°˜ë“œì‹œ í˜¸ì¶œë¨
    public MemberServiceImpl(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }
}
```

**ì¥ì **:

| ì¥ì  | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|
| **1. ë¶ˆë³€ì„± (Immutability)** | `final` í‚¤ì›Œë“œ ì‚¬ìš© ê°€ëŠ¥ | ëŸ°íƒ€ì„ì— ì˜ì¡´ê´€ê³„ ë³€ê²½ ë¶ˆê°€ |
| **2. í•„ìˆ˜ ì˜ì¡´ê´€ê³„ ë³´ì¥** | ìƒì„±ì í˜¸ì¶œ ì‹œ ë°˜ë“œì‹œ ì „ë‹¬ í•„ìš” | ì»´íŒŒì¼ íƒ€ì„ì— ì˜¤ë¥˜ ë°œê²¬ |
| **3. ìˆœí™˜ ì°¸ì¡° ë°©ì§€** | ìƒì„±ì í˜¸ì¶œ ì‹œì ì— ìˆœí™˜ ì°¸ì¡° ê°ì§€ | StackOverflowError ì˜ˆë°© |
| **4. í…ŒìŠ¤íŠ¸ ìš©ì´ì„±** | Mock ê°ì²´ ì£¼ì… ê°„í¸ | ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± ì‰¬ì›€ |

#### Before & After ì½”ë“œ ë¹„êµ

**Before: ì§ì ‘ ìƒì„± ë°©ì‹**:
```java
public class MemberServiceImpl implements MemberService {

    // ë¬¸ì œì ë“¤:
    // 1. final ì‚¬ìš© ë¶ˆê°€ (ìƒì„± ì‹œì ì— ì´ˆê¸°í™” ì•ˆ ë¨)
    // 2. MemoryMemberRepository êµ¬ì²´ í´ë˜ìŠ¤ì— ì˜ì¡´
    // 3. í…ŒìŠ¤íŠ¸ ì‹œ ë‹¤ë¥¸ êµ¬í˜„ì²´ë¡œ êµì²´ ë¶ˆê°€ëŠ¥
    // 4. DIP ìœ„ë°˜
    private MemberRepository memberRepository = new MemoryMemberRepository();

    public void join(Member member) {
        memberRepository.save(member);
    }
}
```

**ì½”ë“œ ë¶„ì„**:
```java
MemberRepository memberRepository = new MemoryMemberRepository();
//     â†‘                                      â†‘
// ì¸í„°í˜ì´ìŠ¤ íƒ€ì…                        êµ¬ì²´ í´ë˜ìŠ¤
// (ì¶”ìƒì— ì˜ì¡´)                      (êµ¬ì²´ì— ì˜ì¡´)
//
// ê²°ë¡ : ì¶”ìƒê³¼ êµ¬ì²´ ëª¨ë‘ì— ì˜ì¡´ â†’ DIP ìœ„ë°˜!
```

**After: ìƒì„±ì ì£¼ì… ë°©ì‹**:
```java
public class MemberServiceImpl implements MemberService {

    // ê°œì„ ì ë“¤:
    // 1. final ì‚¬ìš© ê°€ëŠ¥ (ë¶ˆë³€ì„± ë³´ì¥)
    // 2. MemberRepository ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´
    // 3. í…ŒìŠ¤íŠ¸ ì‹œ Mock ê°ì²´ ì£¼ì… ê°€ëŠ¥
    // 4. DIP ì¤€ìˆ˜
    private final MemberRepository memberRepository;

    // ìƒì„±ìë¥¼ í†µí•´ ì™¸ë¶€ì—ì„œ ì£¼ì…
    public MemberServiceImpl(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    public void join(Member member) {
        memberRepository.save(member);
    }
}
```

**ì½”ë“œ ë¶„ì„**:
```java
private final MemberRepository memberRepository;
//            â†‘
//       ì¸í„°í˜ì´ìŠ¤ íƒ€ì…
//       (ì¶”ìƒì—ë§Œ ì˜ì¡´)
//
// ìƒì„±ìì—ì„œ:
public MemberServiceImpl(MemberRepository memberRepository) {
//                       â†‘
//                  ì¸í„°í˜ì´ìŠ¤ íƒ€ì…
//
// ê²°ë¡ : ì¶”ìƒ(ì¸í„°í˜ì´ìŠ¤)ì—ë§Œ ì˜ì¡´ â†’ DIP ì¤€ìˆ˜!
```

---

### 4. DI (Dependency Injection) ì‹¬ì¸µ ì´í•´

#### DIì˜ ì •ì˜ì™€ í•µì‹¬

**Dependency Injection (ì˜ì¡´ê´€ê³„ ì£¼ì…)**:
- **Dependency (ì˜ì¡´ê´€ê³„)**: í•œ ê°ì²´ê°€ ë‹¤ë¥¸ ê°ì²´ë¥¼ í•„ìš”ë¡œ í•˜ëŠ” ê´€ê³„
- **Injection (ì£¼ì…)**: ì™¸ë¶€ì—ì„œ ê·¸ ê°ì²´ë¥¼ ë„£ì–´ì£¼ëŠ” ê²ƒ

**ë¹„ìœ **:
```
ğŸ“± ìŠ¤ë§ˆíŠ¸í°(MemberServiceImpl)ì´ ë°°í„°ë¦¬(MemberRepository)ê°€ í•„ìš”í•¨

âŒ ë‚˜ìœ ë°©ì‹: ìŠ¤ë§ˆíŠ¸í° ë‚´ë¶€ì—ì„œ ë°°í„°ë¦¬ë¥¼ ì§ì ‘ ìƒì„±
   â†’ ë°°í„°ë¦¬ êµì²´ ë¶ˆê°€ëŠ¥
   â†’ íŠ¹ì • ë°°í„°ë¦¬ì— ì¢…ì†ì 

âœ… ì¢‹ì€ ë°©ì‹: ì™¸ë¶€ì—ì„œ ë°°í„°ë¦¬ë¥¼ ë¼ì›Œì¤Œ (ì£¼ì…)
   â†’ ë°°í„°ë¦¬ êµì²´ ê°€ëŠ¥
   â†’ ë‹¤ì–‘í•œ ë°°í„°ë¦¬ ì‚¬ìš© ê°€ëŠ¥
```

#### DIì˜ 3ê°€ì§€ ë°©ë²•

**1. ìƒì„±ì ì£¼ì… (Constructor Injection)** â­ ê¶Œì¥
```java
public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    // ìƒì„±ìë¥¼ í†µí•´ ì£¼ì…
    public OrderServiceImpl(MemberRepository memberRepository,
                           DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
}
```

**ì¥ì **:
- `final` ì‚¬ìš© ê°€ëŠ¥ â†’ ë¶ˆë³€ì„± ë³´ì¥
- í•„ìˆ˜ ì˜ì¡´ê´€ê³„ ëª…í™•íˆ í‘œí˜„
- ìˆœí™˜ ì°¸ì¡° ì»´íŒŒì¼ ì‹œì ì— ë°œê²¬
- **ìŠ¤í”„ë§ íŒ€ ê¶Œì¥ ë°©ì‹**

**2. Setter ì£¼ì… (Setter Injection)**
```java
public class OrderServiceImpl implements OrderService {

    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;

    // Setter ë©”ì„œë“œë¥¼ í†µí•´ ì£¼ì…
    public void setMemberRepository(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    public void setDiscountPolicy(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }
}
```

**ë‹¨ì **:
- `final` ì‚¬ìš© ë¶ˆê°€ â†’ ë¶ˆë³€ì„± ë³´ì¥ ì•ˆ ë¨
- ì„ íƒì  ì˜ì¡´ê´€ê³„ (ë‚˜ì¤‘ì— ë³€ê²½ ê°€ëŠ¥)
- ëŸ°íƒ€ì„ì— ì˜ì¡´ê´€ê³„ ë³€ê²½ ê°€ëŠ¥ (ìœ„í—˜)

**3. í•„ë“œ ì£¼ì… (Field Injection)**
```java
public class OrderServiceImpl implements OrderService {

    // í•„ë“œì— ì§ì ‘ ì£¼ì… (ìŠ¤í”„ë§ì˜ @Autowired ì‚¬ìš© ì‹œ)
    private MemberRepository memberRepository;
    private DiscountPolicy discountPolicy;
}
```

**ë‹¨ì **:
- ì™¸ë¶€ì—ì„œ ë³€ê²½ ë¶ˆê°€ëŠ¥ â†’ í…ŒìŠ¤íŠ¸ ì–´ë ¤ì›€
- DI í”„ë ˆì„ì›Œí¬ ì—†ì´ëŠ” ì‚¬ìš© ë¶ˆê°€
- **ì•ˆí‹°íŒ¨í„´ìœ¼ë¡œ ê°„ì£¼ë¨**

#### DI ì „/í›„ ì˜ì¡´ê´€ê³„ ë¹„êµ

**DI ì ìš© ì „**:
```mermaid
graph LR
    A[OrderServiceImpl]
    B[MemoryMemberRepository]
    C[FixDiscountPolicy]

    A -->|ì§ì ‘ ìƒì„±<br/>new| B
    A -->|ì§ì ‘ ìƒì„±<br/>new| C

    style A fill:#ffcccc

    Note1[OrderServiceImplì´<br/>êµ¬ì²´ í´ë˜ìŠ¤ë¥¼ ì•Œì•„ì•¼ í•¨]
```

**ë¬¸ì œì **:
- `OrderServiceImpl`ì´ `MemoryMemberRepository`, `FixDiscountPolicy` êµ¬ì²´ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ì•Œì•„ì•¼ í•¨
- êµ¬í˜„ì²´ ë³€ê²½ ì‹œ `OrderServiceImpl` ì½”ë“œ ìˆ˜ì • í•„ìš”

**DI ì ìš© í›„**:
```mermaid
graph TB
    subgraph "AppConfig ì˜ì—­"
    D[AppConfig]
    D -->|ìƒì„±| E[MemoryMemberRepository]
    D -->|ìƒì„±| F[FixDiscountPolicy]
    D -->|ìƒì„± + ì£¼ì…| G[OrderServiceImpl]
    end

    subgraph "OrderServiceImpl ì˜ì—­"
    G -->|ì¸í„°í˜ì´ìŠ¤ë¡œë§Œ<br/>ì˜ì¡´| H[MemberRepository]
    G -->|ì¸í„°í˜ì´ìŠ¤ë¡œë§Œ<br/>ì˜ì¡´| I[DiscountPolicy]
    end

    E -.êµ¬í˜„ì²´.-> H
    F -.êµ¬í˜„ì²´.-> I

    style D fill:#ccffcc
    style G fill:#cce5ff
```

**ê°œì„ ì **:
- `OrderServiceImpl`ì€ ì¸í„°í˜ì´ìŠ¤ë§Œ ì•Œë©´ ë¨
- êµ¬í˜„ì²´ ë³€ê²½ ì‹œ `AppConfig`ë§Œ ìˆ˜ì •
- `OrderServiceImpl` ì½”ë“œëŠ” ì „í˜€ ê±´ë“œë¦¬ì§€ ì•ŠìŒ

---

### 5. ì œì–´ì˜ ì—­ì „ (IoC: Inversion of Control)

#### IoCë€?

**ì •ì˜**:
- í”„ë¡œê·¸ë¨ì˜ ì œì–´ íë¦„ì„ ì§ì ‘ ì œì–´í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì™¸ë¶€ì—ì„œ ê´€ë¦¬í•˜ëŠ” ê²ƒ

**ì „í†µì ì¸ í”„ë¡œê·¸ë¨ íë¦„**:
```java
// ê°œë°œìê°€ ì§ì ‘ ì œì–´
public class OrderServiceImpl {
    public OrderServiceImpl() {
        // ë‚´ê°€ í•„ìš”í•œ ê°ì²´ë¥¼ ë‚´ê°€ ì§ì ‘ ìƒì„±
        this.memberRepository = new MemoryMemberRepository();
        this.discountPolicy = new FixDiscountPolicy();
    }
}
```

**IoC ì ìš© í›„**:
```java
// ì™¸ë¶€(AppConfig)ê°€ ì œì–´
public class OrderServiceImpl {
    public OrderServiceImpl(MemberRepository memberRepository,
                           DiscountPolicy discountPolicy) {
        // ëˆ„êµ°ê°€(AppConfig)ê°€ ë§Œë“¤ì–´ì„œ ë„£ì–´ì¤Œ
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
}
```

#### ì œì–´ê¶Œì˜ ì´ë™

**Before: êµ¬í˜„ ê°ì²´ê°€ ì œì–´ê¶Œì„ ê°€ì§**:
```java
public class OrderServiceImpl implements OrderService {

    // ë‚´ê°€ ê²°ì •: MemoryMemberRepositoryë¥¼ ì‚¬ìš©í•˜ê² ë‹¤!
    private final MemberRepository memberRepository = new MemoryMemberRepository();

    // ë‚´ê°€ ê²°ì •: FixDiscountPolicyë¥¼ ì‚¬ìš©í•˜ê² ë‹¤!
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

    // ë‚´ê°€ ì‹¤í–‰
    public Order createOrder(...) {
        // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    }
}
```

**ì œì–´ê¶Œ ë¶„ì„**:
- âœ… ì‹¤í–‰ ì œì–´: `OrderServiceImpl`ì´ ê°€ì§
- âŒ ìƒì„± ì œì–´: `OrderServiceImpl`ì´ ê°€ì§ â†’ ë¬¸ì œ!
- âŒ ì˜ì¡´ê´€ê³„ ì„¤ì • ì œì–´: `OrderServiceImpl`ì´ ê°€ì§ â†’ ë¬¸ì œ!

**After: AppConfigê°€ ì œì–´ê¶Œì„ ê°€ì§**:
```java
// AppConfig.java - ì œì–´ê¶Œì„ ê°€ì§„ í´ë˜ìŠ¤
public class AppConfig {

    // ë‚´ê°€ ê²°ì •: MemoryMemberRepositoryë¥¼ ì‚¬ìš©í•˜ê²Œ í•˜ê² ë‹¤!
    // ë‚´ê°€ ê²°ì •: FixDiscountPolicyë¥¼ ì‚¬ìš©í•˜ê²Œ í•˜ê² ë‹¤!
    public OrderService orderService() {
        return new OrderServiceImpl(
            new MemoryMemberRepository(),
            new FixDiscountPolicy()
        );
    }
}

// OrderServiceImpl.java - ì œì–´ê¶Œì´ ì—†ëŠ” í´ë˜ìŠ¤
public class OrderServiceImpl implements OrderService {

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    // ë°›ê¸°ë§Œ í•¨: ëˆ„ê°€ ë­˜ ì¤„ì§€ ëª¨ë¦„
    public OrderServiceImpl(MemberRepository memberRepository,
                           DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    // ì‹¤í–‰ë§Œ í•¨
    public Order createOrder(...) {
        // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    }
}
```

**ì œì–´ê¶Œ ë¶„ì„**:
- âœ… ìƒì„± ì œì–´: `AppConfig`ê°€ ê°€ì§
- âœ… ì˜ì¡´ê´€ê³„ ì„¤ì • ì œì–´: `AppConfig`ê°€ ê°€ì§
- âœ… ì‹¤í–‰ ì œì–´: `OrderServiceImpl`ì´ ê°€ì§

#### IoC ì»¨í…Œì´ë„ˆ, DI ì»¨í…Œì´ë„ˆ

**AppConfig = DI ì»¨í…Œì´ë„ˆ**:
```java
public class AppConfig {
    // ì´ í´ë˜ìŠ¤ëŠ” DI ì»¨í…Œì´ë„ˆ ì—­í• ì„ í•¨
    // - ê°ì²´ë¥¼ ìƒì„±í•˜ê³ 
    // - ì˜ì¡´ê´€ê³„ë¥¼ ì—°ê²°í•˜ê³ 
    // - ê´€ë¦¬í•¨

    public MemberService memberService() { ... }
    public OrderService orderService() { ... }
}
```

**ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ**:
- ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ëŠ” ì´ `AppConfig` ì—­í• ì„ ë” ê°•ë ¥í•˜ê²Œ ìˆ˜í–‰
- `@Configuration`, `@Bean` ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš©
- ì‹±ê¸€í†¤ ë³´ì¥, ë¼ì´í”„ì‚¬ì´í´ ê´€ë¦¬ ë“± ì¶”ê°€ ê¸°ëŠ¥ ì œê³µ

---

### 6. ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤: ì •ì±… ë³€ê²½

#### ì‹œë‚˜ë¦¬ì˜¤: í• ì¸ ì •ì±… ë³€ê²½

**ìš”êµ¬ì‚¬í•­ ë³€ê²½**:
```
ê³ ì • í• ì¸ ì •ì±… â†’ ì •ë¥  í• ì¸ ì •ì±…ìœ¼ë¡œ ë³€ê²½
FixDiscountPolicy â†’ RateDiscountPolicy
```

#### DI ì ìš© ì „: ì—¬ëŸ¬ ê³³ ìˆ˜ì • í•„ìš”

```java
// âŒ OrderServiceImpl.java ìˆ˜ì • í•„ìš”
public class OrderServiceImpl implements OrderService {

    // ì´ ì¤„ì„ ìˆ˜ì •í•´ì•¼ í•¨
    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
}

// âŒ OrderApp.java ìˆ˜ì • í•„ìš”
public class OrderApp {
    public static void main(String[] args) {
        // OrderServiceImpl ë‚´ë¶€ë¥¼ ìˆ˜ì •í–ˆìœ¼ë¯€ë¡œ ì˜í–¥ë°›ìŒ
        OrderService orderService = new OrderServiceImpl();
    }
}

// âŒ OrderServiceTest.java ìˆ˜ì • í•„ìš”
class OrderServiceTest {
    OrderService orderService = new OrderServiceImpl();
    // í…ŒìŠ¤íŠ¸ë„ ì˜í–¥ë°›ìŒ
}
```

**ë¬¸ì œì **:
- 3ê³³ ì´ìƒ ìˆ˜ì • í•„ìš”
- OCP ìœ„ë°˜ (ë³€ê²½ì— ë‹«í˜€ìˆì§€ ì•ŠìŒ)
- ì‹¤í–‰ ì½”ë“œ ìˆ˜ì • í•„ìš” (ì»´íŒŒì¼ ë‹¤ì‹œ í•„ìš”)

#### DI ì ìš© í›„: í•œ ê³³ë§Œ ìˆ˜ì •

```java
// âœ… AppConfig.java ë§Œ ìˆ˜ì •
public class AppConfig {

    public OrderService orderService() {
        return new OrderServiceImpl(
            new MemoryMemberRepository(),
            // new FixDiscountPolicy()  // ì´ ì¤„ë§Œ ìˆ˜ì •
            new RateDiscountPolicy()    // ì´ë ‡ê²Œ!
        );
    }
}

// âœ… OrderServiceImpl.java ìˆ˜ì • ë¶ˆí•„ìš”
public class OrderServiceImpl implements OrderService {
    private final DiscountPolicy discountPolicy;
    // ì´ ì½”ë“œëŠ” ì „í˜€ ê±´ë“œë¦¬ì§€ ì•ŠìŒ!
}

// âœ… OrderApp.java ìˆ˜ì • ë¶ˆí•„ìš”
public class OrderApp {
    public static void main(String[] args) {
        AppConfig appConfig = new AppConfig();
        OrderService orderService = appConfig.orderService();
        // ì´ ì½”ë“œë„ ì „í˜€ ê±´ë“œë¦¬ì§€ ì•ŠìŒ!
    }
}
```

**ê°œì„ ì **:
- 1ê³³ë§Œ ìˆ˜ì • (`AppConfig.java`)
- OCP ì¤€ìˆ˜ (í™•ì¥ì—ëŠ” ì—´ë ¤ìˆê³ , ë³€ê²½ì—ëŠ” ë‹«í˜€ìˆìŒ)
- í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš”

#### ë³€ê²½ ì˜í–¥ ë²”ìœ„ ë¹„êµ

```mermaid
graph TB
    subgraph "DI ì ìš© ì „"
    A1[ì •ì±… ë³€ê²½ ë°œìƒ]
    A1 --> A2[OrderServiceImpl ìˆ˜ì •]
    A1 --> A3[OrderApp ìˆ˜ì •]
    A1 --> A4[OrderServiceTest ìˆ˜ì •]
    A1 --> A5[ê¸°íƒ€ ì‚¬ìš© ì½”ë“œ ìˆ˜ì •]
    end

    subgraph "DI ì ìš© í›„"
    B1[ì •ì±… ë³€ê²½ ë°œìƒ]
    B1 --> B2[AppConfigë§Œ ìˆ˜ì •]
    B3[OrderServiceImpl]
    B4[OrderApp]
    B5[OrderServiceTest]
    B6[ê¸°íƒ€ ì‚¬ìš© ì½”ë“œ]

    B2 -.ì˜í–¥ ì—†ìŒ.-> B3
    B2 -.ì˜í–¥ ì—†ìŒ.-> B4
    B2 -.ì˜í–¥ ì—†ìŒ.-> B5
    B2 -.ì˜í–¥ ì—†ìŒ.-> B6
    end

    style A2 fill:#ffcccc
    style A3 fill:#ffcccc
    style A4 fill:#ffcccc
    style A5 fill:#ffcccc
    style B2 fill:#ccffcc
```

---

### 7. AppConfigì™€ ìŠ¤í”„ë§ì˜ ê´€ê³„

#### í˜„ì¬ AppConfig (ìˆœìˆ˜ ìë°”)

```java
public class AppConfig {

    public MemberService memberService() {
        return new MemberServiceImpl(new MemoryMemberRepository());
    }

    public OrderService orderService() {
        return new OrderServiceImpl(
            new MemoryMemberRepository(),
            new FixDiscountPolicy()
        );
    }
}
```

**íŠ¹ì§•**:
- ìˆœìˆ˜ ìë°” ì½”ë“œ
- ìŠ¤í”„ë§ ì—†ì´ë„ ë™ì‘
- DI ì›ë¦¬ë¥¼ ì§ì ‘ êµ¬í˜„
- ì‹±ê¸€í†¤ ë³´ì¥ ì•ˆ ë¨ (ë§¤ë²ˆ ìƒˆë¡œìš´ ê°ì²´ ìƒì„±)

#### ìŠ¤í”„ë§ ì ìš© í›„ AppConfig (ë‹¤ìŒ ì±•í„° ì˜ˆê³ )

```java
@Configuration
public class AppConfig {

    @Bean
    public MemberService memberService() {
        return new MemberServiceImpl(memberRepository());
    }

    @Bean
    public MemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }

    @Bean
    public OrderService orderService() {
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }

    @Bean
    public DiscountPolicy discountPolicy() {
        return new RateDiscountPolicy();
    }
}
```

**ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ì¶”ê°€ ê¸°ëŠ¥**:
- **ì‹±ê¸€í†¤ ë³´ì¥**: ê°™ì€ ê°ì²´ë¥¼ ì¬ì‚¬ìš©
- **ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì…**: `@Autowired`
- **ë¼ì´í”„ì‚¬ì´í´ ê´€ë¦¬**: ì´ˆê¸°í™”, ì†Œë©¸ ì½œë°±
- **AOP**: ë¶€ê°€ ê¸°ëŠ¥ ì ìš©
- **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ**: ê°ì²´ ê´€ë¦¬

---

### 8. í•µì‹¬ ì›ë¦¬ ì´ì •ë¦¬

#### AppConfigì˜ ì—­í• 

```mermaid
graph TB
    A[AppConfig<br/>ê³µì—° ê¸°íšì]

    A --> B[ì—­í•  1: ë°°ìš° ì„­ì™¸<br/>êµ¬í˜„ ê°ì²´ ìƒì„±]
    A --> C[ì—­í•  2: ë°°ì—­ ë°°ì •<br/>ì˜ì¡´ê´€ê³„ ì£¼ì…]
    A --> D[ì—­í•  3: ê³µì—° êµ¬ì„±<br/>ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì •]

    B --> B1[MemberServiceImpl]
    B --> B2[OrderServiceImpl]
    B --> B3[MemoryMemberRepository]
    B --> B4[DiscountPolicy êµ¬í˜„ì²´]

    C --> C1[MemberServiceImplì—<br/>Repository ì£¼ì…]
    C --> C2[OrderServiceImplì—<br/>Repository, Policy ì£¼ì…]

    D --> D1[ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜<br/>ë™ì‘ ë°©ì‹ ê²°ì •]

    style A fill:#e1f5ff
```

#### SOLID ì›ì¹™ ì¤€ìˆ˜

| ì›ì¹™ | AppConfig ì ìš© ì „ | AppConfig ì ìš© í›„ |
|------|------------------|------------------|
| **SRP**<br/>ë‹¨ì¼ ì±…ì„ | âŒ ServiceImplì´ ìƒì„±+ì‹¤í–‰ ë‹´ë‹¹ | âœ… AppConfig: ìƒì„±<br/>âœ… ServiceImpl: ì‹¤í–‰ |
| **OCP**<br/>ê°œë°©-íì‡„ | âŒ ë³€ê²½ ì‹œ ServiceImpl ìˆ˜ì • | âœ… AppConfigë§Œ ìˆ˜ì • |
| **LSP**<br/>ë¦¬ìŠ¤ì½”í”„ ì¹˜í™˜ | âš ï¸ êµ¬í˜„ì²´ì— ì˜ì¡´ | âœ… ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´ |
| **ISP**<br/>ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬ | - | - |
| **DIP**<br/>ì˜ì¡´ê´€ê³„ ì—­ì „ | âŒ êµ¬ì²´ í´ë˜ìŠ¤ì— ì˜ì¡´ | âœ… ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´ |

#### í•µì‹¬ í‚¤ì›Œë“œ ì •ë¦¬

**1. ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬ (Separation of Concerns)**:
- ìƒì„± ê´€ì‹¬ì‚¬ â†’ `AppConfig`
- ì‹¤í–‰ ê´€ì‹¬ì‚¬ â†’ `ServiceImpl`

**2. ì˜ì¡´ê´€ê³„ ì£¼ì… (Dependency Injection)**:
- ìƒì„±ìë¥¼ í†µí•´ ì™¸ë¶€ì—ì„œ ì£¼ì…
- ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´

**3. ì œì–´ì˜ ì—­ì „ (Inversion of Control)**:
- êµ¬í˜„ ê°ì²´ëŠ” ì‹¤í–‰ë§Œ ë‹´ë‹¹
- ì œì–´ íë¦„ì€ `AppConfig`ê°€ ê´€ë¦¬

**4. DI ì»¨í…Œì´ë„ˆ**:
- `AppConfig` = ìˆ˜ë™ DI ì»¨í…Œì´ë„ˆ
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ = ìë™ DI ì»¨í…Œì´ë„ˆ

---

### 9. ì‹¤ìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸

#### AppConfig ì´í•´ë„ ì²´í¬

- [ ] AppConfigê°€ ì™œ í•„ìš”í•œì§€ ì„¤ëª…í•  ìˆ˜ ìˆëŠ”ê°€?
- [ ] ìƒì„±ì ì£¼ì…ì˜ ì¥ì ì„ 3ê°€ì§€ ì´ìƒ ë§í•  ìˆ˜ ìˆëŠ”ê°€?
- [ ] DIì™€ IoCì˜ ì°¨ì´ë¥¼ ì„¤ëª…í•  ìˆ˜ ìˆëŠ”ê°€?
- [ ] ì •ì±… ë³€ê²½ ì‹œ ì–´ëŠ ë¶€ë¶„ë§Œ ìˆ˜ì •í•˜ë©´ ë˜ëŠ”ì§€ ì•„ëŠ”ê°€?
- [ ] DIP ìœ„ë°˜ ì½”ë“œì™€ ì¤€ìˆ˜ ì½”ë“œë¥¼ êµ¬ë¶„í•  ìˆ˜ ìˆëŠ”ê°€?

#### ì½”ë“œ ì‘ì„± ì‹¤ìŠµ

**ì—°ìŠµ 1: ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ ì¶”ê°€**
```java
// TODO: PaymentServiceë¥¼ AppConfigì— ì¶”ê°€í•´ë³´ì„¸ìš”
public interface PaymentService { }
public class PaymentServiceImpl implements PaymentService {
    private final PaymentRepository paymentRepository;

    // ìƒì„±ì ì£¼ì… ë°©ì‹ìœ¼ë¡œ ì‘ì„±
}
```

**ì—°ìŠµ 2: ì •ì±… ë³€ê²½ ì‹¤ìŠµ**
```java
// TODO: DiscountPolicyë¥¼ ë³€ê²½í•´ë³´ì„¸ìš”
// FixDiscountPolicy â†’ RateDiscountPolicy
// ì–´ëŠ íŒŒì¼ì„ ìˆ˜ì •í•´ì•¼ í• ê¹Œìš”?
```

**ì—°ìŠµ 3: í…ŒìŠ¤íŠ¸ ì‘ì„±**
```java
// TODO: Mock ê°ì²´ë¥¼ ì‚¬ìš©í•œ í…ŒìŠ¤íŠ¸ ì‘ì„±
class OrderServiceTest {
    @Test
    void createOrder() {
        // Mock Repositoryì™€ Mock Policyë¥¼ ìƒì„±ìì— ì£¼ì…
        // ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•œ ì´ìœ ëŠ”?
    }
}
```

---

### 10. ìì£¼ í•˜ëŠ” ì§ˆë¬¸ (FAQ)

**Q1. AppConfigì—ì„œ ë§¤ë²ˆ `new`ë¥¼ í•˜ëŠ”ë°, ì‹±ê¸€í†¤ì´ ì•„ë‹Œê°€ìš”?**
```java
public MemberService memberService() {
    return new MemberServiceImpl(new MemoryMemberRepository());  // ìƒˆ ê°ì²´
}

public OrderService orderService() {
    return new OrderServiceImpl(
        new MemoryMemberRepository(),  // ë˜ ìƒˆ ê°ì²´!
        new FixDiscountPolicy()
    );
}
```

A1. ë§ìŠµë‹ˆë‹¤! í˜„ì¬ëŠ” ì‹±ê¸€í†¤ì´ ì•„ë‹™ë‹ˆë‹¤.
- `memberService()` í˜¸ì¶œ ì‹œ: `MemoryMemberRepository` ìƒì„±
- `orderService()` í˜¸ì¶œ ì‹œ: ë˜ ë‹¤ë¥¸ `MemoryMemberRepository` ìƒì„±
- **ë¬¸ì œì **: ê°™ì€ Repositoryê°€ 2ê°œ ìƒì„±ë¨
- **í•´ê²°ì±…**: ë‹¤ìŒ ì±•í„°ì—ì„œ ë¦¬íŒ©í„°ë§ìœ¼ë¡œ í•´ê²° + ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ì‚¬ìš©

**Q2. ì™œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê¼­ ì¨ì•¼ í•˜ë‚˜ìš”?**

A2. ì¸í„°í˜ì´ìŠ¤ê°€ ì—†ë‹¤ë©´:
```java
// ì¸í„°í˜ì´ìŠ¤ ì—†ì´ êµ¬ì²´ í´ë˜ìŠ¤ë§Œ ì‚¬ìš©
public class OrderServiceImpl {
    private final MemoryMemberRepository memberRepository;

    // MemoryMemberRepositoryë¥¼ JpaMemberRepositoryë¡œ ë³€ê²½í•˜ë ¤ë©´?
    // â†’ ì´ ì½”ë“œë¥¼ ì „ë¶€ ìˆ˜ì •í•´ì•¼ í•¨!
}
```

ì¸í„°í˜ì´ìŠ¤ê°€ ìˆë‹¤ë©´:
```java
// ì¸í„°í˜ì´ìŠ¤ ì‚¬ìš©
public class OrderServiceImpl {
    private final MemberRepository memberRepository;  // ì¸í„°í˜ì´ìŠ¤

    // MemoryMemberRepositoryë¥¼ JpaMemberRepositoryë¡œ ë³€ê²½í•˜ë ¤ë©´?
    // â†’ AppConfigë§Œ ìˆ˜ì •í•˜ë©´ ë¨!
}
```

**Q3. ìƒì„±ì ì£¼ì… ë§ê³  Setter ì£¼ì…ì„ ì“°ë©´ ì•ˆ ë˜ë‚˜ìš”?**

A3. Setter ì£¼ì…ì˜ ë¬¸ì œì :
```java
public class OrderServiceImpl {
    private MemberRepository memberRepository;

    public void setMemberRepository(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    public Order createOrder(...) {
        // memberRepositoryê°€ nullì¼ ìˆ˜ ìˆìŒ! (NullPointerException ìœ„í—˜)
        memberRepository.findById(...);
    }
}
```

ìƒì„±ì ì£¼ì…ì˜ ì¥ì :
```java
public class OrderServiceImpl {
    private final MemberRepository memberRepository;  // final ê°€ëŠ¥!

    public OrderServiceImpl(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;  // ë°˜ë“œì‹œ ì´ˆê¸°í™”
    }

    public Order createOrder(...) {
        // memberRepositoryê°€ nullì¼ ìˆ˜ ì—†ìŒ! (ì•ˆì „)
        memberRepository.findById(...);
    }
}
```

**Q4. AppConfig ì—†ì´ ê·¸ëƒ¥ ìŠ¤í”„ë§ì˜ `@Autowired`ë§Œ ì“°ë©´ ì•ˆ ë˜ë‚˜ìš”?**

A4. `@Autowired`ë„ ê²°êµ­ ê°™ì€ ì›ë¦¬ì…ë‹ˆë‹¤:
```java
// AppConfig ë°©ì‹ (ìˆ˜ë™)
public class AppConfig {
    public OrderService orderService() {
        return new OrderServiceImpl(
            memberRepository(),
            discountPolicy()
        );
    }
}

// @Autowired ë°©ì‹ (ìë™)
@Component
public class OrderServiceImpl {
    @Autowired  // ìŠ¤í”„ë§ì´ ìë™ìœ¼ë¡œ ì£¼ì…
    public OrderServiceImpl(MemberRepository memberRepository,
                           DiscountPolicy discountPolicy) {
        // ...
    }
}
```

- **AppConfig**: ìˆ˜ë™ìœ¼ë¡œ ëª…ì‹œì  ì„¤ì • (ëª…í™•, ì œì–´ ê°€ëŠ¥)
- **@Autowired**: ìë™ìœ¼ë¡œ ì£¼ì… (í¸ë¦¬, ë¹ ë¥¸ ê°œë°œ)
- ìŠ¤í”„ë§ì˜ `@Autowired`ë¥¼ ì´í•´í•˜ë ¤ë©´ AppConfig ì›ë¦¬ë¥¼ ë¨¼ì € ì•Œì•„ì•¼ í•¨!

---

## ë‹¤ìŒ í•™ìŠµ

â¡ï¸ **[3-4. AppConfig ë¦¬íŒ©í„°ë§](./3-4-AppConfigë¦¬íŒ©í„°ë§.md)**
- ì¤‘ë³µ ì œê±°
- ì—­í• ê³¼ êµ¬í˜„ ëª…í™•íˆ ë¶„ë¦¬
- ê°€ë…ì„± í–¥ìƒ
