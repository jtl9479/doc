# ÏÑπÏÖò 32: Docker Swarm (Ïò§ÏºÄÏä§Ìä∏Î†àÏù¥ÏÖò)

## ÎπÑÏú†Î°ú ÏãúÏûëÌïòÍ∏∞

Docker SwarmÏùÄ **Ïò§ÏºÄÏä§Ìä∏Îùº ÏßÄÌúòÏûê**ÏôÄ Í∞ôÏäµÎãàÎã§.

```
Ïò§ÏºÄÏä§Ìä∏Îùº                           Docker Swarm
=========                           ============
üéº ÏïÖÎ≥¥                         ‚Üí    docker-compose.yml
üéª Î∞îÏù¥Ïò¨Î¶∞ Ï£ºÏûêÎì§              ‚Üí    Ïª®ÌÖåÏù¥ÎÑà Î†àÌîåÎ¶¨Ïπ¥
üé∫ Ìä∏ÎüºÌé´ Ï£ºÏûêÎì§                ‚Üí    Îã§Î•∏ ÏÑúÎπÑÏä§
üëî ÏßÄÌúòÏûê                       ‚Üí    Swarm Manager
üé≠ Î¨¥ÎåÄ (Ïó¨Îü¨ Í∞ú)               ‚Üí    Worker Nodes
üìä ÏïÖÎ≥¥ Î∞∞Ïπò                    ‚Üí    ÏÑúÎπÑÏä§ Ïä§ÏºÄÏ§ÑÎßÅ
üîÅ Ïó∞Ï£ºÏûê ÍµêÏ≤¥                  ‚Üí    Î°§ÎßÅ ÏóÖÎç∞Ïù¥Ìä∏
üö® Ïó∞Ï£ºÏûê Î∂ÄÏÉÅ Ïãú Î∞±ÏóÖ Ìà¨ÏûÖ     ‚Üí    ÏûêÍ∞Ä ÏπòÏú†
```

ÏßÄÌúòÏûê ÏóÜÏù¥ 100Î™ÖÏù¥ Ïó∞Ï£ºÌïòÎ©¥ ÌòºÎûÄÏä§ÎüΩÎìØÏù¥, Ïò§ÏºÄÏä§Ìä∏Î†àÏù¥ÏÖò ÏóÜÏù¥ ÏàòÎ∞± Í∞úÏùò Ïª®ÌÖåÏù¥ÎÑàÎ•º Í¥ÄÎ¶¨ÌïòÎ©¥ Î∂àÍ∞ÄÎä•Ìï©ÎãàÎã§.

---

## Ïôú Ïò§ÏºÄÏä§Ìä∏Î†àÏù¥ÏÖòÏù¥ ÌïÑÏöîÌïúÍ∞Ä?

### 1. docker-composeÏùò ÌïúÍ≥Ñ

```
docker-compose (Îã®Ïùº Ìò∏Ïä§Ìä∏)
============================

ÏÑúÎ≤Ñ 1ÎåÄ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Docker Engine                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îÇ
‚îÇ  ‚îÇ A   ‚îÇ ‚îÇ B   ‚îÇ ‚îÇ C   ‚îÇ          ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Î¨∏Ï†úÏ†ê:
‚ùå 1ÎåÄ ÏÑúÎ≤Ñ Ïû•Ïï† = Ï†ÑÏ≤¥ ÏÑúÎπÑÏä§ Ï§ëÎã®
‚ùå Ìä∏ÎûòÌîΩ Ï¶ùÍ∞Ä Ïãú Ïä§ÏºÄÏùº Î∂àÍ∞Ä
‚ùå Î°úÎìú Î∞∏Îü∞Ïã± Î∂àÍ∞Ä
‚ùå ÏûêÎèô Î≥µÍµ¨ ÏóÜÏùå
‚ùå Î¨¥Ï§ëÎã® Î∞∞Ìè¨ Ïñ¥Î†§ÏõÄ


Docker Swarm (ÌÅ¥Îü¨Ïä§ÌÑ∞)
========================

      Manager Node
     /      |      \
    /       |       \
Worker 1  Worker 2  Worker 3
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ A   ‚îÇ   ‚îÇ A   ‚îÇ   ‚îÇ B   ‚îÇ
‚îÇ B   ‚îÇ   ‚îÇ C   ‚îÇ   ‚îÇ C   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Ïû•Ï†ê:
‚úÖ Í≥†Í∞ÄÏö©ÏÑ± (HA)
‚úÖ ÏûêÎèô Ïä§ÏºÄÏùºÎßÅ
‚úÖ Î°úÎìú Î∞∏Îü∞Ïã±
‚úÖ ÏûêÍ∞Ä ÏπòÏú†
‚úÖ Î¨¥Ï§ëÎã® Î∞∞Ìè¨
‚úÖ Î≥¥Ïïà (ÏïîÌò∏Ìôî ÌÜµÏã†)
```

### 2. Docker Swarm vs Kubernetes

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ÌäπÏßï                ‚îÇ Docker Swarm    ‚îÇ Kubernetes       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Î≥µÏû°ÎèÑ              ‚îÇ ÎÇÆÏùå ‚≠ê         ‚îÇ ÎÜíÏùå ‚≠ê‚≠ê‚≠ê‚≠ê    ‚îÇ
‚îÇ Îü¨Îãù Ïª§Î∏å           ‚îÇ Ïâ¨ÏõÄ            ‚îÇ Ïñ¥Î†§ÏõÄ           ‚îÇ
‚îÇ ÏÑ§Ï†ï                ‚îÇ Í∞ÑÎã®            ‚îÇ Î≥µÏû°             ‚îÇ
‚îÇ ÏÉùÌÉúÍ≥Ñ              ‚îÇ ÏûëÏùå            ‚îÇ Îß§Ïö∞ ÌÅº          ‚îÇ
‚îÇ Í∏∞Îä•                ‚îÇ Í∏∞Î≥∏Ï†Å          ‚îÇ Îß§Ïö∞ ÌíçÎ∂Ä        ‚îÇ
‚îÇ ÏÜåÍ∑úÎ™® ÌîÑÎ°úÏ†ùÌä∏     ‚îÇ Ï†ÅÌï© ‚úÖ         ‚îÇ Í≥ºÌï®             ‚îÇ
‚îÇ ÎåÄÍ∑úÎ™® ÌîÑÎ°úÏ†ùÌä∏     ‚îÇ Î∂ÄÏ°±            ‚îÇ Ï†ÅÌï© ‚úÖ          ‚îÇ
‚îÇ Docker ÌÜµÌï©         ‚îÇ ÏôÑÎ≤Ω            ‚îÇ Î≥ÑÎèÑ ÎèÑÍµ¨        ‚îÇ
‚îÇ Î©ÄÌã∞ ÌÅ¥ÎùºÏö∞Îìú       ‚îÇ Ï†úÌïúÏ†Å          ‚îÇ Ïö∞Ïàò             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Docker SwarmÏùÑ ÏÑ†ÌÉùÌïòÎäî Í≤ΩÏö∞:
- ÏÜå~Ï§ëÍ∑úÎ™® ÌîÑÎ°úÏ†ùÌä∏
- Îπ†Î•∏ ÏãúÏûë ÌïÑÏöî
- Docker ComposeÏóêÏÑú ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò
- ÌåÄÏùò Kubernetes Í≤ΩÌóò Î∂ÄÏ°±
- Î≥µÏû°ÏÑ± ÏµúÏÜåÌôî

KubernetesÎ•º ÏÑ†ÌÉùÌïòÎäî Í≤ΩÏö∞:
- ÎåÄÍ∑úÎ™® ÌîÑÎ°úÏ†ùÌä∏
- Î≥µÏû°Ìïú ÏöîÍµ¨ÏÇ¨Ìï≠
- Î©ÄÌã∞ ÌÅ¥ÎùºÏö∞Îìú
- ÌíçÎ∂ÄÌïú ÏÉùÌÉúÍ≥Ñ ÌïÑÏöî
```

---

## Docker Swarm Í∏∞Ï¥à

### 1. ÌïµÏã¨ Í∞úÎÖê

```
Swarm ÏïÑÌÇ§ÌÖçÏ≤ò
==============

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Manager Nodes                        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  Manager 1   ‚îÇ  ‚îÇ  Manager 2   ‚îÇ  ‚îÇ  Manager 3   ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ   (Leader)   ‚îÇ  ‚îÇ  (Reachable) ‚îÇ  ‚îÇ  (Reachable) ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ         ‚îÇ                  ‚îÇ                  ‚îÇ         ‚îÇ
‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îÇ                            ‚îÇ (Raft Consensus)           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇ                                 ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    Worker Node 1     ‚îÇ          ‚îÇ    Worker Node 2     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ          ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇTask1‚îÇ   ‚îÇTask2‚îÇ  ‚îÇ          ‚îÇ  ‚îÇTask3‚îÇ   ‚îÇTask4‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ          ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Ïö©Ïñ¥:
- Node: SwarmÏóê Ï∞∏Ïó¨ÌïòÎäî Docker ÏóîÏßÑ Ïù∏Ïä§ÌÑ¥Ïä§
- Manager Node: ÌÅ¥Îü¨Ïä§ÌÑ∞ ÏÉÅÌÉú Í¥ÄÎ¶¨, Ïä§ÏºÄÏ§ÑÎßÅ Í≤∞Ï†ï
- Worker Node: Ïª®ÌÖåÏù¥ÎÑà Ïã§Ìñâ
- Service: Ïä§ÏõúÏóêÏÑú Ïã§ÌñâÎêòÎäî Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò Ï†ïÏùò
- Task: ServiceÏùò Í∞úÎ≥Ñ Ïª®ÌÖåÏù¥ÎÑà Ïù∏Ïä§ÌÑ¥Ïä§
- Stack: Ïó¨Îü¨ ServiceÏùò Í∑∏Î£π
```

### 2. Service Î≥µÏ†ú Î™®Îìú

```
Replicated Mode (Î≥µÏ†ú Î™®Îìú)
==========================

Service: web
Replicas: 3

ManagerÍ∞Ä ÏûêÎèôÏúºÎ°ú Î∞∞Ïπò:

Node 1      Node 2      Node 3
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ web ‚îÇ     ‚îÇ web ‚îÇ     ‚îÇ web ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚Üí 3Í∞úÏùò ÎèôÏùºÌïú Î†àÌîåÎ¶¨Ïπ¥


Global Mode (Ï†ÑÏó≠ Î™®Îìú)
======================

Service: monitoring-agent
Mode: global

Î™®Îì† ÎÖ∏ÎìúÏóê 1Í∞úÏî© Î∞∞Ïπò:

Node 1      Node 2      Node 3
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇagent‚îÇ     ‚îÇagent‚îÇ     ‚îÇagent‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚Üí Í∞Å ÎÖ∏ÎìúÎßàÎã§ 1Í∞ú
‚Üí Î°úÍπÖ, Î™®ÎãàÌÑ∞ÎßÅÏóê Ï†ÅÌï©
```

---

## Docker Swarm ÏãúÏûëÌïòÍ∏∞

### 1. Swarm Ï¥àÍ∏∞Ìôî

```bash
# Manager ÎÖ∏ÎìúÏóêÏÑú Swarm Ï¥àÍ∏∞Ìôî
docker swarm init --advertise-addr 192.168.1.10

# Ï∂úÎ†•:
Swarm initialized: current node (abc123xyz) is now a manager.

To add a worker to this swarm, run the following command:

    docker swarm join --token SWMTKN-1-xxx... 192.168.1.10:2377

To add a manager to this swarm, run 'docker swarm join-token manager' and follow the instructions.

# Swarm ÏÉÅÌÉú ÌôïÏù∏
docker info | grep Swarm
# Swarm: active

# ÎÖ∏Îìú Î™©Î°ù ÌôïÏù∏
docker node ls

# Ï∂úÎ†•:
ID                            HOSTNAME   STATUS    AVAILABILITY   MANAGER STATUS
abc123xyz *                   manager1   Ready     Active         Leader
```

### 2. Worker ÎÖ∏Îìú Ï∂îÍ∞Ä

```bash
# Worker ÏÑúÎ≤ÑÏóêÏÑú Ïã§Ìñâ
docker swarm join --token SWMTKN-1-xxx... 192.168.1.10:2377

# Manager ÎÖ∏ÎìúÏóêÏÑú ÌôïÏù∏
docker node ls

# Ï∂úÎ†•:
ID                            HOSTNAME   STATUS    AVAILABILITY   MANAGER STATUS
abc123xyz *                   manager1   Ready     Active         Leader
def456abc                     worker1    Ready     Active
ghi789def                     worker2    Ready     Active
```

### 3. Ï∂îÍ∞Ä Manager ÎÖ∏Îìú Ï∂îÍ∞Ä (HA)

```bash
# Manager ÎÖ∏ÎìúÏóêÏÑú ÌÜ†ÌÅ∞ ÌôïÏù∏
docker swarm join-token manager

# Ï∂úÎ†•:
To add a manager to this swarm, run the following command:

    docker swarm join --token SWMTKN-1-yyy... 192.168.1.10:2377

# ÏÉà Manager ÏÑúÎ≤ÑÏóêÏÑú Ïã§Ìñâ
docker swarm join --token SWMTKN-1-yyy... 192.168.1.10:2377

# ÌôïÏù∏
docker node ls

# Ï∂úÎ†•:
ID                            HOSTNAME   STATUS    AVAILABILITY   MANAGER STATUS
abc123xyz *                   manager1   Ready     Active         Leader
def456abc                     worker1    Ready     Active
ghi789def                     worker2    Ready     Active
jkl012ghi                     manager2   Ready     Active         Reachable
```

---

## Service ÏÉùÏÑ± Î∞è Í¥ÄÎ¶¨

### 1. Í∞ÑÎã®Ìïú Service ÏÉùÏÑ±

```bash
# Nginx ÏÑúÎπÑÏä§ ÏÉùÏÑ± (3Í∞ú Î†àÌîåÎ¶¨Ïπ¥)
docker service create \
  --name web \
  --replicas 3 \
  --publish 80:80 \
  nginx:alpine

# ÏÑúÎπÑÏä§ Î™©Î°ù ÌôïÏù∏
docker service ls

# Ï∂úÎ†•:
ID             NAME   MODE         REPLICAS   IMAGE          PORTS
abc123xyz      web    replicated   3/3        nginx:alpine   *:80->80/tcp

# ÏÑúÎπÑÏä§ ÏÉÅÏÑ∏ Ï†ïÎ≥¥
docker service ps web

# Ï∂úÎ†•:
ID             NAME      IMAGE          NODE       DESIRED STATE   CURRENT STATE
abc123         web.1     nginx:alpine   manager1   Running         Running 30 seconds ago
def456         web.2     nginx:alpine   worker1    Running         Running 30 seconds ago
ghi789         web.3     nginx:alpine   worker2    Running         Running 30 seconds ago
```

### 2. Service Ïä§ÏºÄÏùºÎßÅ

```bash
# 5Í∞úÎ°ú Ïä§ÏºÄÏùº ÏóÖ
docker service scale web=5

# Ï∂úÎ†•:
web scaled to 5
overall progress: 5 out of 5 tasks
1/5: running   [==================================================>]
2/5: running   [==================================================>]
3/5: running   [==================================================>]
4/5: running   [==================================================>]
5/5: running   [==================================================>]
verify: Service converged

# ÌôïÏù∏
docker service ls
# REPLICAS: 5/5

# Ïä§ÏºÄÏùº Îã§Ïö¥
docker service scale web=2
```

### 3. Service ÏóÖÎç∞Ïù¥Ìä∏

```bash
# Ïù¥ÎØ∏ÏßÄ ÏóÖÎç∞Ïù¥Ìä∏ (Î°§ÎßÅ ÏóÖÎç∞Ïù¥Ìä∏)
docker service update \
  --image nginx:1.21 \
  --update-parallelism 1 \
  --update-delay 10s \
  web

# Ïã§ÏãúÍ∞Ñ ÏßÑÌñâ ÏÉÅÌô© ÌôïÏù∏
watch -n 1 'docker service ps web'

# ÏóÖÎç∞Ïù¥Ìä∏ Î°§Î∞±
docker service rollback web
```

### 4. Service ÏÇ≠Ï†ú

```bash
# ÏÑúÎπÑÏä§ ÏÇ≠Ï†ú
docker service rm web

# ÌôïÏù∏
docker service ls
# (Îπà Î™©Î°ù)
```

---

## Docker Stack (Î≥µÏû°Ìïú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò)

### 1. docker-compose.ymlÏùÑ StackÏúºÎ°ú Î∞∞Ìè¨

```yaml
# docker-stack.yml
version: '3.8'

services:
  # User Service
  user-service:
    image: lk-trade/user-service:latest
    deploy:
      replicas: 3
      update_config:
        parallelism: 1
        delay: 10s
        failure_action: rollback
      rollback_config:
        parallelism: 1
        delay: 10s
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 3
      placement:
        constraints:
          - node.role == worker
      resources:
        limits:
          cpus: '1.0'
          memory: 1G
        reservations:
          cpus: '0.5'
          memory: 512M
    networks:
      - lk-trade-network
    secrets:
      - db_password
      - jwt_secret
    environment:
      - SPRING_PROFILES_ACTIVE=prod
      - DB_PASSWORD_FILE=/run/secrets/db_password
    healthcheck:
      test: ["CMD", "wget", "--spider", "http://localhost:8080/actuator/health"]
      interval: 30s
      timeout: 3s
      retries: 3

  # Trade Service
  trade-service:
    image: lk-trade/trade-service:latest
    deploy:
      replicas: 3
      update_config:
        parallelism: 1
        delay: 10s
      restart_policy:
        condition: on-failure
      placement:
        constraints:
          - node.role == worker
      resources:
        limits:
          cpus: '1.0'
          memory: 1G
    networks:
      - lk-trade-network
    secrets:
      - db_password

  # Account Service
  account-service:
    image: lk-trade/account-service:latest
    deploy:
      replicas: 2
      update_config:
        parallelism: 1
        delay: 10s
      restart_policy:
        condition: on-failure
      placement:
        constraints:
          - node.role == worker
      resources:
        limits:
          cpus: '0.5'
          memory: 512M
    networks:
      - lk-trade-network

  # Strategy Service
  strategy-service:
    image: lk-trade/strategy-service:latest
    deploy:
      replicas: 2
      update_config:
        parallelism: 1
        delay: 10s
      restart_policy:
        condition: on-failure
      placement:
        constraints:
          - node.role == worker
      resources:
        limits:
          cpus: '0.5'
          memory: 512M
    networks:
      - lk-trade-network

  # PostgreSQL (Îã®Ïùº Ïù∏Ïä§ÌÑ¥Ïä§, ManagerÏóê Î∞∞Ïπò)
  postgres:
    image: postgres:16-alpine
    deploy:
      replicas: 1
      placement:
        constraints:
          - node.role == manager
      restart_policy:
        condition: on-failure
    volumes:
      - postgres-data:/var/lib/postgresql/data
    networks:
      - lk-trade-network
    secrets:
      - db_password
    environment:
      - POSTGRES_DB=lk_trade
      - POSTGRES_USER=lk_admin
      - POSTGRES_PASSWORD_FILE=/run/secrets/db_password

  # Redis
  redis:
    image: redis:7-alpine
    deploy:
      replicas: 1
      placement:
        constraints:
          - node.role == manager
      restart_policy:
        condition: on-failure
    volumes:
      - redis-data:/data
    networks:
      - lk-trade-network

  # Nginx (Reverse Proxy & Load Balancer)
  nginx:
    image: nginx:alpine
    deploy:
      replicas: 2
      placement:
        constraints:
          - node.role == worker
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
    networks:
      - lk-trade-network

  # Visualizer (Swarm ÏãúÍ∞ÅÌôî ÎèÑÍµ¨)
  visualizer:
    image: dockersamples/visualizer:latest
    deploy:
      replicas: 1
      placement:
        constraints:
          - node.role == manager
    ports:
      - "8080:8080"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    networks:
      - lk-trade-network

volumes:
  postgres-data:
  redis-data:

networks:
  lk-trade-network:
    driver: overlay
    attachable: true

secrets:
  db_password:
    external: true
  jwt_secret:
    external: true
```

### 2. Secret ÏÉùÏÑ±

```bash
# Secret ÌååÏùº ÏÉùÏÑ±
echo "super_secure_db_password" | docker secret create db_password -
echo "jwt_secret_key_here" | docker secret create jwt_secret -

# ÎòêÎäî ÌååÏùºÏóêÏÑú ÏÉùÏÑ±
docker secret create db_password ./secrets/db_password.txt

# Secret Î™©Î°ù ÌôïÏù∏
docker secret ls

# Ï∂úÎ†•:
ID                          NAME           CREATED          UPDATED
abc123xyz                   db_password    10 seconds ago   10 seconds ago
def456abc                   jwt_secret     5 seconds ago    5 seconds ago
```

### 3. Stack Î∞∞Ìè¨

```bash
# Stack Î∞∞Ìè¨
docker stack deploy -c docker-stack.yml lk-trade

# Ï∂úÎ†•:
Creating network lk-trade_lk-trade-network
Creating service lk-trade_user-service
Creating service lk-trade_trade-service
Creating service lk-trade_account-service
Creating service lk-trade_strategy-service
Creating service lk-trade_postgres
Creating service lk-trade_redis
Creating service lk-trade_nginx
Creating service lk-trade_visualizer

# Stack Î™©Î°ù ÌôïÏù∏
docker stack ls

# Ï∂úÎ†•:
NAME       SERVICES   ORCHESTRATOR
lk-trade   8          Swarm

# StackÏùò ÏÑúÎπÑÏä§ ÌôïÏù∏
docker stack services lk-trade

# Ï∂úÎ†•:
ID             NAME                        MODE         REPLICAS   IMAGE
abc123         lk-trade_user-service       replicated   3/3        lk-trade/user-service:latest
def456         lk-trade_trade-service      replicated   3/3        lk-trade/trade-service:latest
ghi789         lk-trade_account-service    replicated   2/2        lk-trade/account-service:latest
jkl012         lk-trade_strategy-service   replicated   2/2        lk-trade/strategy-service:latest
mno345         lk-trade_postgres           replicated   1/1        postgres:16-alpine
pqr678         lk-trade_redis              replicated   1/1        redis:7-alpine
stu901         lk-trade_nginx              replicated   2/2        nginx:alpine
vwx234         lk-trade_visualizer         replicated   1/1        dockersamples/visualizer:latest

# StackÏùò Task ÌôïÏù∏ (Ïñ¥Îäê ÎÖ∏ÎìúÏóêÏÑú Ïã§Ìñâ Ï§ëÏù∏ÏßÄ)
docker stack ps lk-trade

# Stack ÏÇ≠Ï†ú
docker stack rm lk-trade
```

---

## Í≥†Í∏â Í∏∞Îä•

### 1. Î°úÎìú Î∞∏Îü∞Ïã±

```
Ingress Load Balancing (Í∏∞Î≥∏)
==============================

Ïô∏Î∂Ä ÏöîÏ≤≠ ‚Üí 80:80
              ‚Üì
    Swarm Ingress Network
       (ÏûêÎèô Î°úÎìú Î∞∏Îü∞Ïã±)
         /    |    \
        /     |     \
    Node1  Node2  Node3
    ‚îå‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇweb‚îÇ  ‚îÇweb‚îÇ  ‚îÇweb‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îò

‚Üí Ïñ¥Îäê ÎÖ∏ÎìúÎ°ú ÏöîÏ≤≠Ìï¥ÎèÑ ÏûêÎèôÏúºÎ°ú Î∂ÑÏÇ∞
‚Üí Round-robin Î∞©Ïãù
```

```bash
# Î°úÎìú Î∞∏Îü∞Ïã± ÌÖåÏä§Ìä∏
for i in {1..10}; do
    curl http://localhost/
done

# Í∞Å Ïª®ÌÖåÏù¥ÎÑàÏóêÏÑú ÏùëÎãµ ÌôïÏù∏
docker service logs lk-trade_user-service
```

### 2. Î∞∞Ïπò Ï†úÏïΩ Ï°∞Í±¥ (Placement Constraints)

```yaml
services:
  # Manager ÎÖ∏ÎìúÏóêÎßå Î∞∞Ïπò
  postgres:
    deploy:
      placement:
        constraints:
          - node.role == manager

  # Worker ÎÖ∏ÎìúÏóêÎßå Î∞∞Ïπò
  web:
    deploy:
      placement:
        constraints:
          - node.role == worker

  # ÌäπÏ†ï Î†àÏù¥Î∏îÏùÑ Í∞ÄÏßÑ ÎÖ∏ÎìúÏóê Î∞∞Ïπò
  database:
    deploy:
      placement:
        constraints:
          - node.labels.type == database

  # Ïó¨Îü¨ Ï°∞Í±¥
  app:
    deploy:
      placement:
        constraints:
          - node.role == worker
          - node.labels.zone == asia
          - node.labels.ssd == true
```

ÎÖ∏ÎìúÏóê Î†àÏù¥Î∏î Ï∂îÍ∞Ä:

```bash
# ÎÖ∏ÎìúÏóê Î†àÏù¥Î∏î Ï∂îÍ∞Ä
docker node update --label-add type=database worker1
docker node update --label-add zone=asia worker2
docker node update --label-add ssd=true worker3

# ÎÖ∏Îìú Ï†ïÎ≥¥ ÌôïÏù∏
docker node inspect worker1 --pretty
```

### 3. Î∞∞Ïπò ÏÑ†Ìò∏ÎèÑ (Placement Preferences)

```yaml
services:
  web:
    deploy:
      replicas: 6
      placement:
        # Í∞ÄÎä•Ìïú Ïó¨Îü¨ zoneÏóê Î∂ÑÏÇ∞
        preferences:
          - spread: node.labels.zone
```

### 4. Ìó¨Ïä§ Ï≤¥ÌÅ¨

```yaml
services:
  user-service:
    healthcheck:
      test: ["CMD", "wget", "--spider", "http://localhost:8080/actuator/health"]
      interval: 30s      # 30Ï¥àÎßàÎã§ Ï≤¥ÌÅ¨
      timeout: 3s        # 3Ï¥à ÎÇ¥Ïóê ÏùëÎãµ ÏóÜÏúºÎ©¥ Ïã§Ìå®
      retries: 3         # 3Ìöå Ïó∞ÏÜç Ïã§Ìå® Ïãú unhealthy
      start_period: 40s  # ÏãúÏûë ÌõÑ 40Ï¥àÎäî Ïã§Ìå® Î¨¥Ïãú
```

### 5. Î¶¨ÏÜåÏä§ Ï†úÌïú

```yaml
services:
  user-service:
    deploy:
      resources:
        # ÌïòÎìú Î¶¨ÎØ∏Ìä∏ (Ï¥àÍ≥º Î∂àÍ∞Ä)
        limits:
          cpus: '1.0'
          memory: 1G
        # ÏòàÏïΩ (Î≥¥Ïû•)
        reservations:
          cpus: '0.5'
          memory: 512M
```

---

## Swarm Î™®ÎãàÌÑ∞ÎßÅ

### 1. Visualizer (Ïã§ÏãúÍ∞Ñ ÏãúÍ∞ÅÌôî)

```bash
# Visualizer Ï†ëÏÜç
http://localhost:8080

# ÌôîÎ©¥Ïóê ÌëúÏãúÎêòÎäî Ï†ïÎ≥¥:
- Í∞Å ÎÖ∏ÎìúÏùò ÏÉÅÌÉú
- Ïã§Ìñâ Ï§ëÏù∏ Ïª®ÌÖåÏù¥ÎÑà
- Ïª®ÌÖåÏù¥ÎÑà Î∞∞Ïπò ÏÉÅÌÉú
- Ïã§ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏
```

### 2. Î™ÖÎ†πÏñ¥Î°ú Î™®ÎãàÌÑ∞ÎßÅ

```bash
# ÎÖ∏Îìú ÏÉÅÌÉú ÌôïÏù∏
docker node ls

# ÏÑúÎπÑÏä§ ÏÉÅÌÉú ÌôïÏù∏
docker service ls

# ÌäπÏ†ï ÏÑúÎπÑÏä§Ïùò Task ÌôïÏù∏
docker service ps lk-trade_user-service

# ÏÑúÎπÑÏä§ Î°úÍ∑∏ ÌôïÏù∏
docker service logs -f lk-trade_user-service

# ÌäπÏ†ï TaskÏùò Î°úÍ∑∏
docker service logs lk-trade_user-service.1

# ÏÑúÎπÑÏä§ ÏÉÅÏÑ∏ Ï†ïÎ≥¥
docker service inspect lk-trade_user-service --pretty

# ÎÖ∏Îìú ÏÉÅÏÑ∏ Ï†ïÎ≥¥
docker node inspect manager1 --pretty
```

### 3. Prometheus + Grafana ÌÜµÌï©

```yaml
# docker-stack-monitoring.yml
version: '3.8'

services:
  prometheus:
    image: prom/prometheus:latest
    deploy:
      replicas: 1
      placement:
        constraints:
          - node.role == manager
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus/prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus-data:/prometheus
    networks:
      - monitoring

  grafana:
    image: grafana/grafana:latest
    deploy:
      replicas: 1
      placement:
        constraints:
          - node.role == manager
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
    volumes:
      - grafana-data:/var/lib/grafana
    networks:
      - monitoring

  # Docker Î©îÌä∏Î¶≠ ÏàòÏßë
  cadvisor:
    image: gcr.io/cadvisor/cadvisor:latest
    deploy:
      mode: global  # Î™®Îì† ÎÖ∏ÎìúÏóê Î∞∞Ïπò
    volumes:
      - /:/rootfs:ro
      - /var/run:/var/run:ro
      - /sys:/sys:ro
      - /var/lib/docker/:/var/lib/docker:ro
    networks:
      - monitoring

  # Node Î©îÌä∏Î¶≠ ÏàòÏßë
  node-exporter:
    image: prom/node-exporter:latest
    deploy:
      mode: global
    volumes:
      - /proc:/host/proc:ro
      - /sys:/host/sys:ro
      - /:/rootfs:ro
    command:
      - '--path.procfs=/host/proc'
      - '--path.sysfs=/host/sys'
      - '--collector.filesystem.mount-points-exclude=^/(sys|proc|dev|host|etc)($$|/)'
    networks:
      - monitoring

volumes:
  prometheus-data:
  grafana-data:

networks:
  monitoring:
    driver: overlay
```

---

## ÏûêÍ∞Ä ÏπòÏú† (Self-Healing)

### 1. Ïª®ÌÖåÏù¥ÎÑà Ïû•Ïï† Ïãú ÏûêÎèô Ïû¨ÏãúÏûë

```bash
# ÌÖåÏä§Ìä∏: Ïª®ÌÖåÏù¥ÎÑà Í∞ïÏ†ú Ï¢ÖÎ£å
docker ps | grep user-service
# abc123  lk-trade/user-service...

docker kill abc123

# SwarmÏù¥ ÏûêÎèôÏúºÎ°ú ÏÉà Ïª®ÌÖåÏù¥ÎÑà ÏãúÏûë
docker service ps lk-trade_user-service

# Ï∂úÎ†•:
ID             NAME                       NODE      CURRENT STATE
def456         lk-trade_user-service.1    worker1   Running 5 seconds ago
abc123          \_ lk-trade_user-service.1 worker1   Shutdown 10 seconds ago
```

### 2. ÎÖ∏Îìú Ïû•Ïï† Ïãú ÏûêÎèô Ïû¨Î∞∞Ïπò

```bash
# ÎÖ∏Îìú Îã§Ïö¥ ÏãúÎÆ¨Î†àÏù¥ÏÖò
# Worker1ÏóêÏÑú:
sudo systemctl stop docker

# ManagerÏóêÏÑú ÌôïÏù∏
docker node ls

# Ï∂úÎ†•:
ID             HOSTNAME   STATUS    AVAILABILITY   MANAGER STATUS
abc123         manager1   Ready     Active         Leader
def456         worker1    Down      Active         ‚Üê Down!
ghi789         worker2    Ready     Active

# Worker1Ïóê ÏûàÎçò TaskÎì§Ïù¥ ÏûêÎèôÏúºÎ°ú Îã§Î•∏ ÎÖ∏ÎìúÎ°ú Ïù¥Îèô
docker service ps lk-trade_user-service

# Worker1 Î≥µÍµ¨
# Worker1ÏóêÏÑú:
sudo systemctl start docker

# SwarmÏóê ÏûêÎèô Ïû¨Í∞ÄÏûÖ
docker node ls
# worker1Ïù¥ Îã§Ïãú Ready ÏÉÅÌÉú
```

### 3. ÎÖ∏Îìú Ïú†ÏßÄÎ≥¥Ïàò Î™®Îìú

```bash
# Worker1ÏùÑ Ïú†ÏßÄÎ≥¥Ïàò Î™®ÎìúÎ°ú Ï†ÑÌôò (ÏÉà Task Î∞∞Ïπò Ïïà Îê®)
docker node update --availability drain worker1

# ÌôïÏù∏
docker node ls

# Ï∂úÎ†•:
ID             HOSTNAME   STATUS    AVAILABILITY   MANAGER STATUS
abc123         manager1   Ready     Active         Leader
def456         worker1    Ready     Drain          ‚Üê Drain!
ghi789         worker2    Ready     Active

# Worker1Ïùò Î™®Îì† TaskÍ∞Ä Îã§Î•∏ ÎÖ∏ÎìúÎ°ú Ïù¥Îèô
docker node ps worker1

# Ïú†ÏßÄÎ≥¥Ïàò ÏôÑÎ£å ÌõÑ Îã§Ïãú ÌôúÏÑ±Ìôî
docker node update --availability active worker1
```

---

## Î¨¥Ï§ëÎã® Î∞∞Ìè¨ (Rolling Update)

### 1. ÏóÖÎç∞Ïù¥Ìä∏ ÏÑ§Ï†ï

```yaml
services:
  user-service:
    deploy:
      update_config:
        parallelism: 1        # Ìïú Î≤àÏóê 1Í∞úÏî© ÏóÖÎç∞Ïù¥Ìä∏
        delay: 10s            # Í∞Å ÏóÖÎç∞Ïù¥Ìä∏ ÏÇ¨Ïù¥ 10Ï¥à ÎåÄÍ∏∞
        failure_action: rollback  # Ïã§Ìå® Ïãú Î°§Î∞±
        monitor: 60s          # 60Ï¥à ÎèôÏïà Î™®ÎãàÌÑ∞ÎßÅ
        max_failure_ratio: 0.3    # 30% Ïã§Ìå® Ïãú Ï§ëÎã®
        order: stop-first     # Í∏∞Ï°¥ Ïª®ÌÖåÏù¥ÎÑà Ï§ëÏßÄ ÌõÑ ÏÉà Ïª®ÌÖåÏù¥ÎÑà ÏãúÏûë
```

### 2. Î°§ÎßÅ ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìñâ

```bash
# Ïù¥ÎØ∏ÏßÄ ÏóÖÎç∞Ïù¥Ìä∏
docker service update \
  --image lk-trade/user-service:2.0.0 \
  lk-trade_user-service

# Ïã§ÏãúÍ∞Ñ ÏßÑÌñâ ÏÉÅÌô© ÌôïÏù∏
watch -n 1 'docker service ps lk-trade_user-service'

# Ï∂úÎ†• (ÏãúÍ∞Ñ Í≤ΩÍ≥º):
# 10:00 - user-service.1 ÏóÖÎç∞Ïù¥Ìä∏ Ï§ë
# 10:10 - user-service.1 ÏôÑÎ£å, user-service.2 ÏóÖÎç∞Ïù¥Ìä∏ Ï§ë
# 10:20 - user-service.2 ÏôÑÎ£å, user-service.3 ÏóÖÎç∞Ïù¥Ìä∏ Ï§ë
# 10:30 - Î™®Îëê ÏôÑÎ£å!
```

### 3. Î°§Î∞±

```bash
# ÏàòÎèô Î°§Î∞±
docker service rollback lk-trade_user-service

# ÎòêÎäî Ïù¥Ï†Ñ Î≤ÑÏ†ÑÏúºÎ°ú ÏóÖÎç∞Ïù¥Ìä∏
docker service update \
  --image lk-trade/user-service:1.0.0 \
  lk-trade_user-service
```

---

## ÏûêÎèôÌôî Ïä§ÌÅ¨Î¶ΩÌä∏

### 1. Swarm Ï¥àÍ∏∞Ìôî Ïä§ÌÅ¨Î¶ΩÌä∏

```bash
#!/bin/bash
# scripts/swarm-init.sh

set -e

echo "üêù Initializing Docker Swarm..."

# ÌòÑÏû¨ ÏÑúÎ≤Ñ IP Í∞êÏßÄ
IP=$(hostname -I | awk '{print $1}')

# Swarm Ï¥àÍ∏∞Ìôî
docker swarm init --advertise-addr $IP

echo "‚úÖ Swarm initialized successfully!"
echo ""
echo "Manager node is ready at: $IP"
echo ""
echo "To add worker nodes, run this on worker servers:"
docker swarm join-token worker
echo ""
echo "To add manager nodes, run this on manager servers:"
docker swarm join-token manager
```

### 2. Stack Î∞∞Ìè¨ Ïä§ÌÅ¨Î¶ΩÌä∏

```bash
#!/bin/bash
# scripts/deploy-stack.sh

set -e

STACK_NAME=${1:-lk-trade}
VERSION=${2:-latest}

echo "üöÄ Deploying stack: $STACK_NAME (version: $VERSION)"

# Secret ÏÉùÏÑ± (ÏóÜÏúºÎ©¥)
if ! docker secret ls | grep -q db_password; then
    echo "Creating db_password secret..."
    cat ./secrets/db_password.txt | docker secret create db_password -
fi

if ! docker secret ls | grep -q jwt_secret; then
    echo "Creating jwt_secret secret..."
    cat ./secrets/jwt_secret.txt | docker secret create jwt_secret -
fi

# ÌôòÍ≤Ω Î≥ÄÏàò ÏÑ§Ï†ï
export VERSION=$VERSION

# Stack Î∞∞Ìè¨
docker stack deploy -c docker-stack.yml $STACK_NAME

echo ""
echo "‚è≥ Waiting for services to start..."
sleep 30

# ÏÑúÎπÑÏä§ ÏÉÅÌÉú ÌôïÏù∏
docker stack services $STACK_NAME

echo ""
echo "‚úÖ Stack deployed successfully!"
echo ""
echo "Visualizer: http://localhost:8080"
```

### 3. Makefile ÌÜµÌï©

```makefile
# Makefile
.PHONY: swarm-init swarm-join deploy-stack update-stack remove-stack swarm-status

# Swarm Ï¥àÍ∏∞Ìôî
swarm-init:
	bash scripts/swarm-init.sh

# Swarm ÏÉÅÌÉú ÌôïÏù∏
swarm-status:
	@echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
	@echo "Nodes:"
	@docker node ls
	@echo ""
	@echo "Stacks:"
	@docker stack ls
	@echo ""
	@echo "Services:"
	@docker service ls

# Stack Î∞∞Ìè¨
deploy-stack:
	@read -p "Enter stack name (default: lk-trade): " name; \
	name=$${name:-lk-trade}; \
	read -p "Enter version (default: latest): " version; \
	version=$${version:-latest}; \
	bash scripts/deploy-stack.sh $$name $$version

# Stack ÏóÖÎç∞Ïù¥Ìä∏
update-stack:
	@read -p "Enter stack name: " name; \
	read -p "Enter service to update: " service; \
	read -p "Enter new version: " version; \
	docker service update --image lk-trade/$$service:$$version $${name}_$$service

# Stack ÏÇ≠Ï†ú
remove-stack:
	@read -p "Enter stack name: " name; \
	docker stack rm $$name

# Swarm Îñ†ÎÇòÍ∏∞
swarm-leave:
	@read -p "Are you sure? (yes/no): " confirm; \
	if [ "$$confirm" = "yes" ]; then \
		docker swarm leave --force; \
	fi

# Î™®ÎãàÌÑ∞ÎßÅ
swarm-monitor:
	watch -n 2 'docker node ls; echo ""; docker service ls'
```

---

## Îã§Ïùå Îã®Í≥Ñ

Ï∂ïÌïòÌï©ÎãàÎã§! üéâ Docker Swarm Ïò§ÏºÄÏä§Ìä∏Î†àÏù¥ÏÖòÏùÑ ÏôÑÎ≤ΩÌïòÍ≤å ÎßàÏä§ÌÑ∞ÌñàÏäµÎãàÎã§.

### Ïù¥Î≤à ÏÑπÏÖòÏóêÏÑú Î∞∞Ïö¥ Í≤É

‚úÖ Docker SwarmÏùò ÌïÑÏöîÏÑ± Î∞è Kubernetes ÎπÑÍµê
‚úÖ Swarm ÏïÑÌÇ§ÌÖçÏ≤ò (Manager, Worker, Service, Task)
‚úÖ Swarm Ï¥àÍ∏∞Ìôî Î∞è ÎÖ∏Îìú Ï∂îÍ∞Ä
‚úÖ Service ÏÉùÏÑ±, Ïä§ÏºÄÏùºÎßÅ, ÏóÖÎç∞Ïù¥Ìä∏
‚úÖ Docker StackÏúºÎ°ú Î≥µÏû°Ìïú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò Î∞∞Ìè¨
‚úÖ Secret Í¥ÄÎ¶¨
‚úÖ Î°úÎìú Î∞∏Îü∞Ïã± Î∞è Î∞∞Ïπò Ï†úÏïΩÏ°∞Í±¥
‚úÖ ÏûêÍ∞Ä ÏπòÏú† Î∞è Î¨¥Ï§ëÎã® Î∞∞Ìè¨
‚úÖ Swarm Î™®ÎãàÌÑ∞ÎßÅ (Visualizer, Prometheus)
‚úÖ ÏûêÎèôÌôî Ïä§ÌÅ¨Î¶ΩÌä∏

### Îã§ÏùåÏóê Î∞∞Ïö∏ Í≤É

**ÏÑπÏÖò 33: Kubernetes ÏÜåÍ∞ú**ÏóêÏÑúÎäî:
- Kubernetes Í∏∞Î≥∏ Í∞úÎÖê
- Docker Swarm vs Kubernetes Ïã§Ï†Ñ ÎπÑÍµê
- Kubernetes ÏïÑÌÇ§ÌÖçÏ≤ò
- kubectl Í∏∞Î≥∏ Î™ÖÎ†πÏñ¥
- Í∞ÑÎã®Ìïú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò Î∞∞Ìè¨

### Ï∂îÍ∞Ä ÌïôÏäµ ÏûêÎ£å

**Í≥µÏãù Î¨∏ÏÑú:**
- [Docker Swarm Documentation](https://docs.docker.com/engine/swarm/)
- [Docker Stack Deploy](https://docs.docker.com/engine/reference/commandline/stack_deploy/)

**Ïú†Ïö©Ìïú ÎèÑÍµ¨:**
- [Portainer](https://www.portainer.io/) - Swarm Ïõπ UI
- [Swarmpit](https://swarmpit.io/) - Swarm Í¥ÄÎ¶¨ ÎèÑÍµ¨

---

**Îã§Ïùå ÏÑπÏÖòÏóêÏÑú ÎßåÎÇòÏöî!** üöÄ