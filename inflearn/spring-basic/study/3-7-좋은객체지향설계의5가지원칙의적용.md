# 3-7. μΆ‹μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ 5κ°€μ§€ μ›μΉ™μ μ μ©

**μ¶μ²**: μΈν”„λ° - μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ κΈ°λ³ΈνΈ
**μ±•ν„°**: 3. μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ μ΄ν•΄2 - κ°μ²΄ μ§€ν–¥ μ›λ¦¬ μ μ©

---

## ν•™μµ λ©ν‘

- [ ] SOLID μ›μΉ™ μ¤‘ SRP, DIP, OCPκ°€ μ–΄λ–»κ² μ μ©λμ—λ”μ§€ μ„¤λ…ν•  μ μλ‹¤
- [ ] κ° μ›μΉ™μ μ„λ° μ‚¬λ΅€μ™€ μ¤€μ μ‚¬λ΅€λ¥Ό κµ¬λ¶„ν•  μ μλ‹¤
- [ ] AppConfigλ¥Ό ν†µν• κ°μ„ μ΄ μ™ μΆ‹μ€ μ„¤κ³„μΈμ§€ μ΄ν•΄ν•λ‹¤

---

## SOLID μ›μΉ™ λ³µμµ

**SOLID**λ” λ΅λ²„νΈ λ§ν‹΄μ΄ μ •λ¦¬ν• κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ 5κ°€μ§€ μ›μΉ™:
- **S**RP: Single Responsibility Principle (λ‹¨μΌ μ±…μ„ μ›μΉ™)
- **O**CP: Open/Closed Principle (κ°λ°©-νμ‡„ μ›μΉ™)
- **L**SP: Liskov Substitution Principle (λ¦¬μ¤μ½”ν”„ μΉν™ μ›μΉ™)
- **I**SP: Interface Segregation Principle (μΈν„°νμ΄μ¤ λ¶„λ¦¬ μ›μΉ™)
- **D**IP: Dependency Inversion Principle (μμ΅΄κ΄€κ³„ μ—­μ „ μ›μΉ™)

**μ΄λ² μ„Ήμ…μ—μ„λ”**: SRP, DIP, OCP **3κ°€μ§€ μ›μΉ™**μ΄ μ–΄λ–»κ² μ μ©λμ—λ”μ§€ ν™•μΈ

---

## SRP - λ‹¨μΌ μ±…μ„ μ›μΉ™

### Single Responsibility Principle

> **ν• ν΄λμ¤λ” ν•λ‚μ μ±…μ„λ§ κ°€μ Έμ•Ό ν•λ‹¤.**

### λ¬Έμ  μƒν™© (Before)

**OrderServiceImplμ μ±…μ„**:
```java
public class OrderServiceImpl implements OrderService {
    // 1. λΉ„μ¦λ‹μ¤ λ΅μ§ μ‹¤ν–‰ (μμ‹ μ μ±…μ„)
    // 2. κµ¬ν„ κ°μ²΄ μ„ νƒ (λ‚¨μ μ±…μ„)
    // 3. κµ¬ν„ κ°μ²΄ μƒμ„± (λ‚¨μ μ±…μ„)
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
}
```

**λ¬Έμ μ **:
- β ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” μ§μ ‘ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ—°κ²°ν•κ³ , μ‹¤ν–‰ν•λ” **λ‹¤μ–‘ν• μ±…μ„**μ„ κ°€μ§€κ³  μμ
- β **SRP λ‹¨μΌ μ±…μ„ μ›μΉ™ μ„λ°**

---

### ν•΄κ²° (After)

**SRP λ‹¨μΌ μ±…μ„ μ›μΉ™μ„ λ”°λ¥΄λ©΄μ„ κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬**:

**1. AppConfig: κ°μ²΄ μƒμ„± λ° μ—°κ²° μ±…μ„**:
```java
public class AppConfig {
    // μ±…μ„: κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°
    public OrderService orderService() {
        return new OrderServiceImpl(
            memberRepository(),
            discountPolicy()
        );
    }

    public DiscountPolicy discountPolicy() {
        return new RateDiscountPolicy();
    }
}
```

**2. OrderServiceImpl: μ‹¤ν–‰ μ±…μ„**:
```java
public class OrderServiceImpl implements OrderService {
    // μ±…μ„: λΉ„μ¦λ‹μ¤ λ΅μ§ μ‹¤ν–‰λ§
    private final DiscountPolicy discountPolicy;

    public OrderServiceImpl(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }

    // μ‹¤ν–‰μ—λ§ μ§‘μ¤‘
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        int discountPrice = discountPolicy.discount(member, itemPrice);
        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

**κ°μ„  ν¨κ³Ό**:
- β… κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ±…μ„μ€ **AppConfig**κ°€ λ‹΄λ‹Ή
- β… ν΄λΌμ΄μ–ΈνΈ κ°μ²΄λ” **μ‹¤ν–‰ν•λ” μ±…μ„**λ§ λ‹΄λ‹Ή
- β… **SRP λ‹¨μΌ μ±…μ„ μ›μΉ™ μ¤€μ**

---

## DIP - μμ΅΄κ΄€κ³„ μ—­μ „ μ›μΉ™

### Dependency Inversion Principle

> **ν”„λ΅κ·Έλλ¨Έλ” "μ¶”μƒν™”μ— μμ΅΄ν•΄μ•Όμ§€, κµ¬μ²΄ν™”μ— μμ΅΄ν•λ©΄ μ•λλ‹¤."**
>
> μμ΅΄μ„± μ£Όμ…μ€ μ΄ μ›μΉ™μ„ λ”°λ¥΄λ” λ°©λ²• μ¤‘ ν•λ‚λ‹¤.

### λ¬Έμ  μƒν™© (Before)

**κΈ°λ€ν–λ μμ΅΄κ΄€κ³„**:
```mermaid
classDiagram
    class OrderServiceImpl
    class DiscountPolicy {
        <<interface>>
    }

    OrderServiceImpl --> DiscountPolicy

    note for OrderServiceImpl "μΈν„°νμ΄μ¤μ—λ§ μμ΅΄"
```

**μ‹¤μ  μμ΅΄κ΄€κ³„**:
```mermaid
classDiagram
    class OrderServiceImpl
    class DiscountPolicy {
        <<interface>>
    }
    class FixDiscountPolicy

    OrderServiceImpl --> DiscountPolicy : μ¶”μƒ μμ΅΄
    OrderServiceImpl --> FixDiscountPolicy : κµ¬μ²΄ μμ΅΄ (DIP μ„λ°!)
    DiscountPolicy <|.. FixDiscountPolicy
```

**μ½”λ“λ΅ ν™•μΈ**:
```java
public class OrderServiceImpl implements OrderService {
    // μ¶”μƒ(μΈν„°νμ΄μ¤) μμ΅΄: DiscountPolicy
    private final DiscountPolicy discountPolicy

    // κµ¬μ²΄(κµ¬ν„) ν΄λμ¤ μμ΅΄: FixDiscountPolicy - DIP μ„λ°!
        = new FixDiscountPolicy();
}
```

**λ¬Έμ μ **:
- β `OrderServiceImpl`μ€ `DiscountPolicy` **μ¶”μƒν™” μΈν„°νμ΄μ¤**μ— μμ΅΄ν•λ” κ²ƒ κ°™μ§€λ§
- β λ™μ‹μ— `FixDiscountPolicy` **κµ¬μ²΄ν™” κµ¬ν„ ν΄λμ¤**μ—λ„ μμ΅΄
- β **DIP μμ΅΄κ΄€κ³„ μ—­μ „ μ›μΉ™ μ„λ°**

---

### ν•΄κ²° μ‹λ„ 1: μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ λ³€κ²½

**μ½”λ“ μμ •**:
```java
public class OrderServiceImpl implements OrderService {
    // μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ - DIP μ¤€μ!
    private DiscountPolicy discountPolicy;
}
```

**μƒλ΅μ΄ λ¬Έμ  λ°μƒ**:
```
NullPointerException (NPE) λ°μƒ!
```

**μ™?**
- β… DIPλ” μ¤€μ
- β ν•μ§€λ§ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” μΈν„°νμ΄μ¤λ§μΌλ΅λ” μ•„λ¬΄κ²ƒλ„ μ‹¤ν–‰ν•  μ μ—†μ
- β κµ¬ν„μ²΄κ°€ μ—†μΌλ―€λ΅ μ½”λ“ μ‹¤ν–‰ λ¶κ°€

---

### ν•΄κ²° μ‹λ„ 2: AppConfigλ¥Ό ν†µν• μμ΅΄κ΄€κ³„ μ£Όμ…

**ν•΄κ²° λ°©λ²•**:
- AppConfigκ°€ `FixDiscountPolicy` κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό ν΄λΌμ΄μ–ΈνΈ μ½”λ“ λ€μ‹  μƒμ„±
- ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μμ΅΄κ΄€κ³„λ¥Ό μ£Όμ…

**AppConfig**:
```java
public class AppConfig {
    public OrderService orderService() {
        return new OrderServiceImpl(
            memberRepository(),
            discountPolicy()  // FixDiscountPolicy μƒμ„±ν•μ—¬ μ£Όμ…
        );
    }

    public DiscountPolicy discountPolicy() {
        return new FixDiscountPolicy();
    }
}
```

**OrderServiceImpl**:
```java
public class OrderServiceImpl implements OrderService {
    // μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ - DIP μ¤€μ!
    private final DiscountPolicy discountPolicy;

    // μƒμ„±μλ¥Ό ν†µν•΄ μ™Έλ¶€μ—μ„ μ£Όμ…λ°›μ
    public OrderServiceImpl(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }
}
```

**κ°μ„  ν¨κ³Ό**:
- β… ν΄λΌμ΄μ–ΈνΈ μ½”λ“κ°€ `DiscountPolicy` **μ¶”μƒν™” μΈν„°νμ΄μ¤μ—λ§ μμ΅΄**
- β… `RateDiscountPolicy` κµ¬μ²΄ ν΄λμ¤λ¥Ό μ „ν€ λ¨λ¦„
- β… AppConfigκ°€ μμ΅΄κ΄€κ³„λ¥Ό μ£Όμ…
- β… **DIP μ™„λ²½ μ¤€μ**

---

## OCP - κ°λ°©-νμ‡„ μ›μΉ™

### Open/Closed Principle

> **μ†ν”„νΈμ›¨μ–΄ μ”μ†λ” ν™•μ¥μ—λ” μ—΄λ ¤ μμΌλ‚ λ³€κ²½μ—λ” λ‹«ν€ μμ–΄μ•Ό ν•λ‹¤.**

### λ¬Έμ  μƒν™© (Before)

**ν• μΈ μ •μ±… λ³€κ²½ μ‹**:
```java
public class OrderServiceImpl implements OrderService {
    // κΈ°μ΅΄: μ •μ•΅ ν• μΈ
    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

    // λ³€κ²½: μ •λ¥  ν• μΈ - ν΄λΌμ΄μ–ΈνΈ μ½”λ“ μμ • ν•„μ”!
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
}
```

**λ¬Έμ μ **:
- β κΈ°λ¥μ„ **ν™•μ¥**(μƒλ΅μ΄ ν• μΈ μ •μ±… μ¶”κ°€)ν–μ„ λ•
- β ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ¥Ό **λ³€κ²½**ν•΄μ•Ό ν•¨
- β **OCP κ°λ°©-νμ‡„ μ›μΉ™ μ„λ°**

---

### ν•΄κ²° (After)

**λ‹¤ν•μ„± μ‚¬μ© + DIP μ¤€μ**:

**μ‚¬μ© μμ—­κ³Ό κµ¬μ„± μμ—­ λ¶„λ¦¬**:
```mermaid
graph TB
    subgraph "μ‚¬μ© μμ—­ - Closed for modification"
        A[OrderServiceImpl<br/>λ³€κ²½ μ—†μ]
        B[DiscountPolicy<br/>interface]
        A --> B
    end

    subgraph "κµ¬μ„± μμ—­ - Open for extension"
        C[AppConfig<br/>λ³€κ²½]
        C -.μƒμ„± λ° μ£Όμ….-> A
    end

    subgraph "κµ¬ν„μ²΄ μ„ νƒ"
        D[FixDiscountPolicy]
        E[RateDiscountPolicy<br/>μ„ νƒλ¨]
    end

    C -.μ„ νƒ.-> D
    C -.μ„ νƒ.-> E
    E -.-> B

    style A fill:#ccffcc
    style C fill:#ffcccc
    style E fill:#ffffcc
```

**μ‚¬μ© μμ—­ - λ³€κ²½ μ—†μ**:
```java
public class OrderServiceImpl implements OrderService {
    // μ „ν€ λ³€κ²½ν•μ§€ μ•μ!
    private final DiscountPolicy discountPolicy;

    public OrderServiceImpl(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }
}
```

**κµ¬μ„± μμ—­ - ν™•μ¥μ— μ—΄λ ¤μμ**:
```java
public class AppConfig {
    public DiscountPolicy discountPolicy() {
        // return new FixDiscountPolicy();      // κΈ°μ΅΄ μ •μ±…
        return new RateDiscountPolicy();        // μƒλ΅μ΄ μ •μ±…μΌλ΅ ν™•μ¥
    }
}
```

**κ°μ„  ν¨κ³Ό**:
- β… AppConfigκ°€ μμ΅΄κ΄€κ³„λ¥Ό `FixDiscountPolicy` β†’ `RateDiscountPolicy`λ΅ λ³€κ²½ν•΄μ„ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μ£Όμ…
- β… ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” λ³€κ²½ν•μ§€ μ•μ•„λ„ λ¨
- β… **μ†ν”„νΈμ›¨μ–΄ μ”μ†λ¥Ό μƒλ΅­κ² ν™•μ¥**ν•΄λ„ **μ‚¬μ© μμ—­μ λ³€κ²½μ€ λ‹«ν€ μμ**
- β… **OCP μ™„λ²½ μ¤€μ**

---

## μ›μΉ™ μ μ© λΉ„κµν‘

| μ›μΉ™ | Before (μ„λ°) | After (μ¤€μ) |
|------|--------------|-------------|
| **SRP** | OrderServiceImplμ΄ μ—¬λ¬ μ±…μ„ | AppConfig: μƒμ„±/μ—°κ²°<br/>OrderServiceImpl: μ‹¤ν–‰ |
| **DIP** | μ¶”μƒν™” + κµ¬μ²΄ν™” λ¨λ‘ μμ΅΄ | μ¶”μƒν™”μ—λ§ μμ΅΄ |
| **OCP** | ν™•μ¥ μ‹ ν΄λΌμ΄μ–ΈνΈ μ½”λ“ λ³€κ²½ | μ‚¬μ© μμ—­μ€ λ³€κ²½μ— λ‹«ν€μμ |

---

## π’΅ ν•µμ‹¬ μ •λ¦¬

### λ‹¤ν•μ„±λ§μΌλ΅λ” λ¶€μ΅±ν•λ‹¤

**λ¬Έμ **:
- λ‹¤ν•μ„±λ§μΌλ΅λ” OCP, DIPλ¥Ό μ§€ν‚¬ μ μ—†μ
- ν΄λΌμ΄μ–ΈνΈ μ½”λ“κ°€ κµ¬μ²΄ ν΄λμ¤λ¥Ό μ§μ ‘ μ„ νƒν•λ©΄ DIP μ„λ°
- κµ¬ν„ κ°μ²΄ λ³€κ²½ μ‹ ν΄λΌμ΄μ–ΈνΈ μ½”λ“ λ³€κ²½ ν•„μ” = OCP μ„λ°

**ν•΄κ²°**:
- μ™Έλ¶€μ—μ„ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ£Όμ…ν•λ” **DI(μμ΅΄κ΄€κ³„ μ£Όμ…)** ν•„μ”
- AppConfig κ°™μ€ **κµ¬μ„± μμ—­**μ΄ ν•„μ”

---

### AppConfigμ μ—­ν• 

**1. κ°μ²΄ μƒμ„±κ³Ό μ—°κ²° μ±…μ„ (SRP)**:
- κµ¬ν„ κ°μ²΄ μƒμ„±
- μƒμ„±μλ¥Ό ν†µν•΄ μμ΅΄κ΄€κ³„ μ£Όμ…

**2. μ¶”μƒν™”μ—λ§ μμ΅΄ (DIP)**:
- ν΄λΌμ΄μ–ΈνΈλ” μΈν„°νμ΄μ¤μ—λ§ μμ΅΄
- κµ¬μ²΄ ν΄λμ¤λ” AppConfigκ°€ κ΄€λ¦¬

**3. μ‚¬μ© μμ—­κ³Ό κµ¬μ„± μμ—­ λ¶„λ¦¬ (OCP)**:
- μ‚¬μ© μμ—­: λ³€κ²½μ— λ‹«ν€μμ
- κµ¬μ„± μμ—­: ν™•μ¥μ— μ—΄λ ¤μμ

---

## κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ ν•µμ‹¬

```mermaid
graph TB
    A[λ‹¤ν•μ„±] --> B{μ¶©λ¶„ν•κ°€?}
    B -->|NO| C[DI ν•„μ”]
    C --> D[AppConfig<br/>κµ¬μ„± μμ—­]
    D --> E[SOLID μ›μΉ™ μ¤€μ]
    E --> F[μΆ‹μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„]

    style A fill:#e1f5ff
    style C fill:#fff5e1
    style E fill:#ccffcc
    style F fill:#ffffcc
```

**ν•µμ‹¬**:
1. **λ‹¤ν•μ„±**μ€ κΈ°λ³Έ
2. **DI(μμ΅΄κ΄€κ³„ μ£Όμ…)**μ΄ ν•„μ”
3. **AppConfig** κ°™μ€ κµ¬μ„± μμ—­μΌλ΅ μ±…μ„ λ¶„λ¦¬
4. **SOLID μ›μΉ™** μ¤€μ
5. **μ μ—°ν•κ³  λ³€κ²½μ— κ°•ν•** κ°μ²΄ μ§€ν–¥ μ„¤κ³„ μ™„μ„±

---

## μ‹¤μ „ μ μ© μμ‹

### ν• μΈ μ •μ±… λ³€κ²½ μ‹λ‚λ¦¬μ¤

**μ”κµ¬μ‚¬ν•­**: μ •μ•΅ ν• μΈ β†’ μ •λ¥  ν• μΈ

**Before (SOLID μ„λ°)**:
```java
// 1. OrderServiceImpl μ§μ ‘ μμ • - OCP μ„λ°
// 2. κµ¬μ²΄ ν΄λμ¤μ— μμ΅΄ - DIP μ„λ°
// 3. μ—¬λ¬ μ±…μ„ - SRP μ„λ°
public class OrderServiceImpl implements OrderService {
    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
}
```

**λ³€κ²½ νμΌ**: `OrderServiceImpl.java` (μ‚¬μ© μμ—­)

---

**After (SOLID μ¤€μ)**:
```java
// AppConfigλ§ μμ • - OCP, DIP, SRP λ¨λ‘ μ¤€μ
public class AppConfig {
    public DiscountPolicy discountPolicy() {
        // return new FixDiscountPolicy();
        return new RateDiscountPolicy();  // ν• μ¤„λ§ λ³€κ²½!
    }
}
```

**λ³€κ²½ νμΌ**: `AppConfig.java` (κµ¬μ„± μμ—­)
**μν–¥ λ°›μ§€ μ•λ” νμΌ**: `OrderServiceImpl.java` (μ‚¬μ© μμ—­)

---

## μ •λ¦¬

### SOLID μ›μΉ™ μ μ© κ²°κ³Ό

**1. SRP λ‹¨μΌ μ±…μ„ μ›μΉ™**:
- AppConfig: κ°μ²΄ μƒμ„± λ° μ—°κ²°
- ServiceImpl: λΉ„μ¦λ‹μ¤ λ΅μ§ μ‹¤ν–‰

**2. DIP μμ΅΄κ΄€κ³„ μ—­μ „ μ›μΉ™**:
- ν΄λΌμ΄μ–ΈνΈ μ½”λ“: μΈν„°νμ΄μ¤μ—λ§ μμ΅΄
- AppConfig: κµ¬μ²΄ ν΄λμ¤ κ΄€λ¦¬ λ° μ£Όμ…

**3. OCP κ°λ°©-νμ‡„ μ›μΉ™**:
- μ‚¬μ© μμ—­: λ³€κ²½μ— λ‹«ν€μμ
- κµ¬μ„± μμ—­: ν™•μ¥μ— μ—΄λ ¤μμ

### μΆ‹μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„

**ν•µμ‹¬ 3μ”μ†**:
1. **λ‹¤ν•μ„± ν™μ©**
2. **μμ΅΄κ΄€κ³„ μ£Όμ… (DI)**
3. **SOLID μ›μΉ™ μ¤€μ**

**κ²°κ³Ό**:
- β… μ μ—°ν• μ„¤κ³„
- β… λ³€κ²½μ— κ°•ν• μ½”λ“
- β… ν™•μ¥μ΄ μ©μ΄
- β… μ μ§€λ³΄μκ°€ μ‰¬μ›€

---

## λ‹¤μ ν•™μµ

β΅οΈ **[3-8. IoC, DI, κ·Έλ¦¬κ³  μ»¨ν…μ΄λ„](./3-8-IoC-DI-κ·Έλ¦¬κ³ -μ»¨ν…μ΄λ„.md)**
- IoC (μ μ–΄μ μ—­μ „) κ°λ…
- DI (μμ΅΄κ΄€κ³„ μ£Όμ…) μƒμ„Έ μ„¤λ…
- IoC μ»¨ν…μ΄λ„μ™€ DI μ»¨ν…μ΄λ„
