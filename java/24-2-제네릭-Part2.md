# 24ì¥ ì œë„¤ë¦­ Part 2 - ê¸°ì—… ì‚¬ë¡€ & ì£¼ë‹ˆì–´ ì‹œë‚˜ë¦¬ì˜¤ ğŸ’¼

## ğŸ¢ ì‹¤ì œ ê¸°ì—… ì‚¬ë¡€ë¡œ ë°°ìš°ëŠ” ì œë„¤ë¦­

---

## ì‚¬ë¡€ 1: ë„¤ì´ë²„ - API Response Wrapper íŒ¨í„´ ğŸŸ¢

### ë°°ê²½
ë„¤ì´ë²„ ê²€ìƒ‰ APIëŠ” ì„±ê³µ, ì‹¤íŒ¨, ë¶€ë¶„ ì„±ê³µ ë“± ë‹¤ì–‘í•œ ì‘ë‹µ íƒ€ì…ì„ ë°˜í™˜í•´ì•¼ í•©ë‹ˆë‹¤. ëª¨ë“  APIê°€ ì¼ê´€ëœ ì‘ë‹µ êµ¬ì¡°ë¥¼ ê°–ë„ë¡ ì œë„¤ë¦­ Response Wrapperë¥¼ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.

### ë¬¸ì œ ìƒí™©
```java
// âŒ ì œë„¤ë¦­ ì—†ì´: APIë§ˆë‹¤ ë‹¤ë¥¸ Response í´ë˜ìŠ¤
class SearchResponse {
    private boolean success;
    private List<SearchResult> data;
    private String errorMessage;
    // ... ìˆ˜ì‹­ ê°œì˜ APIë§ˆë‹¤ ë¹„ìŠ·í•œ í´ë˜ìŠ¤ ë°˜ë³µ
}

class UserResponse {
    private boolean success;
    private User data;
    private String errorMessage;
    // ì¤‘ë³µ ì½”ë“œ!
}
```

### í•´ê²° ë°©ë²•: ì œë„¤ë¦­ Response Wrapper

```java
import java.time.LocalDateTime;
import java.util.*;

// ì œë„¤ë¦­ API Response Wrapper
class ApiResponse<T> {
    private final boolean success;
    private final T data;
    private final String errorMessage;
    private final String errorCode;
    private final LocalDateTime timestamp;

    // Private ìƒì„±ì - Builder íŒ¨í„´ ì‚¬ìš©
    private ApiResponse(boolean success, T data, String errorMessage, String errorCode) {
        this.success = success;
        this.data = data;
        this.errorMessage = errorMessage;
        this.errorCode = errorCode;
        this.timestamp = LocalDateTime.now();
    }

    // ì„±ê³µ ì‘ë‹µ ìƒì„±
    public static <T> ApiResponse<T> success(T data) {
        return new ApiResponse<>(true, data, null, null);
    }

    // ì‹¤íŒ¨ ì‘ë‹µ ìƒì„±
    public static <T> ApiResponse<T> fail(String errorCode, String errorMessage) {
        return new ApiResponse<>(false, null, errorMessage, errorCode);
    }

    // ë°ì´í„° ì—†ëŠ” ì„±ê³µ ì‘ë‹µ
    public static ApiResponse<Void> successNoContent() {
        return new ApiResponse<>(true, null, null, null);
    }

    // Getterë“¤
    public boolean isSuccess() { return success; }
    public T getData() { return data; }
    public String getErrorMessage() { return errorMessage; }
    public String getErrorCode() { return errorCode; }
    public LocalDateTime getTimestamp() { return timestamp; }

    @Override
    public String toString() {
        if (success) {
            return "âœ… ì„±ê³µ [" + timestamp + "] - ë°ì´í„°: " + data;
        } else {
            return "âŒ ì‹¤íŒ¨ [" + errorCode + "] - " + errorMessage;
        }
    }
}

// ë„ë©”ì¸ ëª¨ë¸ë“¤
class SearchResult {
    private String title;
    private String url;
    private int rank;

    public SearchResult(String title, String url, int rank) {
        this.title = title;
        this.url = url;
        this.rank = rank;
    }

    @Override
    public String toString() {
        return rank + ". " + title + " (" + url + ")";
    }
}

class User {
    private String userId;
    private String name;
    private String email;

    public User(String userId, String name, String email) {
        this.userId = userId;
        this.name = name;
        this.email = email;
    }

    @Override
    public String toString() {
        return name + " (" + email + ")";
    }
}

class BlogPost {
    private String title;
    private String author;
    private int likes;

    public BlogPost(String title, String author, int likes) {
        this.title = title;
        this.author = author;
        this.likes = likes;
    }

    @Override
    public String toString() {
        return title + " by " + author + " [â¤ï¸ " + likes + "]";
    }
}

// ë„¤ì´ë²„ API ì„œë¹„ìŠ¤ ì‹œë®¬ë ˆì´ì…˜
class NaverApiService {

    // ê²€ìƒ‰ API - List<SearchResult> ë°˜í™˜
    public ApiResponse<List<SearchResult>> search(String keyword) {
        System.out.println("ğŸ” ê²€ìƒ‰ API í˜¸ì¶œ: " + keyword);

        if (keyword == null || keyword.trim().isEmpty()) {
            return ApiResponse.fail("INVALID_PARAM", "ê²€ìƒ‰ì–´ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤");
        }

        try {
            // ì‹¤ì œë¡œëŠ” ì™¸ë¶€ API í˜¸ì¶œ
            List<SearchResult> results = Arrays.asList(
                new SearchResult("ë„¤ì´ë²„ " + keyword + " ê³µì‹ ë¬¸ì„œ", "https://naver.com/1", 1),
                new SearchResult(keyword + " ì™„ë²½ ê°€ì´ë“œ", "https://blog.naver.com/2", 2),
                new SearchResult(keyword + " ìµœì‹  íŠ¸ë Œë“œ", "https://news.naver.com/3", 3)
            );

            return ApiResponse.success(results);

        } catch (Exception e) {
            return ApiResponse.fail("SEARCH_ERROR", "ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: " + e.getMessage());
        }
    }

    // ì‚¬ìš©ì ì •ë³´ API - User ë°˜í™˜
    public ApiResponse<User> getUserInfo(String userId) {
        System.out.println("ğŸ‘¤ ì‚¬ìš©ì ì •ë³´ API í˜¸ì¶œ: " + userId);

        if (userId.equals("unknown")) {
            return ApiResponse.fail("USER_NOT_FOUND", "ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");
        }

        User user = new User(userId, "ê¹€ë„¤ì´ë²„", "naver@naver.com");
        return ApiResponse.success(user);
    }

    // ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ API - BlogPost ë°˜í™˜
    public ApiResponse<BlogPost> getBlogPost(int postId) {
        System.out.println("ğŸ“ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ API í˜¸ì¶œ: " + postId);

        if (postId <= 0) {
            return ApiResponse.fail("INVALID_POST_ID", "ìœ íš¨í•˜ì§€ ì•Šì€ í¬ìŠ¤íŠ¸ IDì…ë‹ˆë‹¤");
        }

        BlogPost post = new BlogPost("ì œë„¤ë¦­ ì™„ë²½ ê°€ì´ë“œ", "ë„¤ì´ë²„ ê°œë°œì", 1523);
        return ApiResponse.success(post);
    }

    // ë°ì´í„° ì‚­ì œ API - Void ë°˜í™˜
    public ApiResponse<Void> deletePost(int postId) {
        System.out.println("ğŸ—‘ï¸ í¬ìŠ¤íŠ¸ ì‚­ì œ API í˜¸ì¶œ: " + postId);

        if (postId <= 0) {
            return ApiResponse.fail("INVALID_POST_ID", "ìœ íš¨í•˜ì§€ ì•Šì€ í¬ìŠ¤íŠ¸ IDì…ë‹ˆë‹¤");
        }

        // ì‚­ì œ ë¡œì§...
        return ApiResponse.successNoContent();
    }
}

// API í´ë¼ì´ì–¸íŠ¸
public class NaverApiExample {
    public static void main(String[] args) {
        NaverApiService api = new NaverApiService();

        System.out.println("=== ë„¤ì´ë²„ API Response Wrapper íŒ¨í„´ ===\n");

        // 1. ê²€ìƒ‰ API - List<SearchResult>
        ApiResponse<List<SearchResult>> searchResponse = api.search("Java ì œë„¤ë¦­");
        System.out.println(searchResponse);

        if (searchResponse.isSuccess()) {
            System.out.println("ê²€ìƒ‰ ê²°ê³¼:");
            for (SearchResult result : searchResponse.getData()) {
                System.out.println("   " + result);
            }
        }
        System.out.println();

        // 2. ì‚¬ìš©ì ì •ë³´ API - User
        ApiResponse<User> userResponse = api.getUserInfo("user123");
        System.out.println(userResponse);
        if (userResponse.isSuccess()) {
            System.out.println("ì‚¬ìš©ì: " + userResponse.getData());
        }
        System.out.println();

        // 3. ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ API - BlogPost
        ApiResponse<BlogPost> postResponse = api.getBlogPost(100);
        System.out.println(postResponse);
        if (postResponse.isSuccess()) {
            System.out.println("í¬ìŠ¤íŠ¸: " + postResponse.getData());
        }
        System.out.println();

        // 4. ì‹¤íŒ¨ ì¼€ì´ìŠ¤ - ìœ íš¨í•˜ì§€ ì•Šì€ ê²€ìƒ‰
        ApiResponse<List<SearchResult>> failedSearch = api.search("");
        System.out.println(failedSearch);
        System.out.println("ì—ëŸ¬ ì½”ë“œ: " + failedSearch.getErrorCode());
        System.out.println();

        // 5. ì‹¤íŒ¨ ì¼€ì´ìŠ¤ - ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì‚¬ìš©ì
        ApiResponse<User> notFoundUser = api.getUserInfo("unknown");
        System.out.println(notFoundUser);
        System.out.println();

        // 6. Void ì‘ë‹µ - ì‚­ì œ API
        ApiResponse<Void> deleteResponse = api.deletePost(200);
        System.out.println(deleteResponse);
        System.out.println("ì‚­ì œ ì„±ê³µ ì—¬ë¶€: " + deleteResponse.isSuccess());

        System.out.println("\nâœ… ì œë„¤ë¦­ Wrapperì˜ ì¥ì :");
        System.out.println("1. ì¼ê´€ëœ API ì‘ë‹µ êµ¬ì¡°");
        System.out.println("2. íƒ€ì… ì•ˆì „ì„±: ê° APIê°€ ë°˜í™˜í•˜ëŠ” ë°ì´í„° íƒ€ì… ëª…í™•");
        System.out.println("3. ì½”ë“œ ì¬ì‚¬ìš©: í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë¡œ ëª¨ë“  API ì»¤ë²„");
        System.out.println("4. ì—ëŸ¬ ì²˜ë¦¬ í†µì¼: success, errorCode, errorMessage í‘œì¤€í™”");
    }
}
```

### ì‹¤í–‰ ê²°ê³¼
```
=== ë„¤ì´ë²„ API Response Wrapper íŒ¨í„´ ===

ğŸ” ê²€ìƒ‰ API í˜¸ì¶œ: Java ì œë„¤ë¦­
âœ… ì„±ê³µ [2025-10-10T...] - ë°ì´í„°: [1. ë„¤ì´ë²„ Java ì œë„¤ë¦­ ê³µì‹ ë¬¸ì„œ (...), ...]
ê²€ìƒ‰ ê²°ê³¼:
   1. ë„¤ì´ë²„ Java ì œë„¤ë¦­ ê³µì‹ ë¬¸ì„œ (https://naver.com/1)
   2. Java ì œë„¤ë¦­ ì™„ë²½ ê°€ì´ë“œ (https://blog.naver.com/2)
   3. Java ì œë„¤ë¦­ ìµœì‹  íŠ¸ë Œë“œ (https://news.naver.com/3)

ğŸ‘¤ ì‚¬ìš©ì ì •ë³´ API í˜¸ì¶œ: user123
âœ… ì„±ê³µ [2025-10-10T...] - ë°ì´í„°: ê¹€ë„¤ì´ë²„ (naver@naver.com)
ì‚¬ìš©ì: ê¹€ë„¤ì´ë²„ (naver@naver.com)

ğŸ“ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ API í˜¸ì¶œ: 100
âœ… ì„±ê³µ [2025-10-10T...] - ë°ì´í„°: ì œë„¤ë¦­ ì™„ë²½ ê°€ì´ë“œ by ë„¤ì´ë²„ ê°œë°œì [â¤ï¸ 1523]
í¬ìŠ¤íŠ¸: ì œë„¤ë¦­ ì™„ë²½ ê°€ì´ë“œ by ë„¤ì´ë²„ ê°œë°œì [â¤ï¸ 1523]

ğŸ” ê²€ìƒ‰ API í˜¸ì¶œ:
âŒ ì‹¤íŒ¨ [INVALID_PARAM] - ê²€ìƒ‰ì–´ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤
ì—ëŸ¬ ì½”ë“œ: INVALID_PARAM

ğŸ‘¤ ì‚¬ìš©ì ì •ë³´ API í˜¸ì¶œ: unknown
âŒ ì‹¤íŒ¨ [USER_NOT_FOUND] - ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤

ğŸ—‘ï¸ í¬ìŠ¤íŠ¸ ì‚­ì œ API í˜¸ì¶œ: 200
âœ… ì„±ê³µ [2025-10-10T...] - ë°ì´í„°: null
ì‚­ì œ ì„±ê³µ ì—¬ë¶€: true

âœ… ì œë„¤ë¦­ Wrapperì˜ ì¥ì :
1. ì¼ê´€ëœ API ì‘ë‹µ êµ¬ì¡°
2. íƒ€ì… ì•ˆì „ì„±: ê° APIê°€ ë°˜í™˜í•˜ëŠ” ë°ì´í„° íƒ€ì… ëª…í™•
3. ì½”ë“œ ì¬ì‚¬ìš©: í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë¡œ ëª¨ë“  API ì»¤ë²„
4. ì—ëŸ¬ ì²˜ë¦¬ í†µì¼: success, errorCode, errorMessage í‘œì¤€í™”
```

### í•µì‹¬ êµí›ˆ
- **ì œë„¤ë¦­ ì •ì  íŒ©í† ë¦¬ ë©”ì„œë“œ**: `ApiResponse.success(data)` íŒ¨í„´
- **íƒ€ì… ì¶”ë¡ **: `<T>` ëª…ì‹œ ì—†ì´ë„ ì»´íŒŒì¼ëŸ¬ê°€ ìë™ ì¶”ë¡ 
- **Void íƒ€ì…**: ë°ì´í„°ê°€ ì—†ëŠ” ì„±ê³µ ì‘ë‹µì— ì‚¬ìš©
- **ì‹¤ë¬´ ì ìš©**: Spring RestControllerì—ì„œ ResponseEntity ëŒ€ì‹  ì‚¬ìš© ê°€ëŠ¥

---

## ì‚¬ë¡€ 2: ì¹´ì¹´ì˜¤ - ì œë„¤ë¦­ DAO íŒ¨í„´ ğŸ’¬

### ë°°ê²½
ì¹´ì¹´ì˜¤í†¡ ì„œë²„ëŠ” ì‚¬ìš©ì, ë©”ì‹œì§€, ì±„íŒ…ë°© ë“± ìˆ˜ì‹­ ê°œì˜ í…Œì´ë¸”ì„ ê´€ë¦¬í•©ë‹ˆë‹¤. ê° í…Œì´ë¸”ë§ˆë‹¤ CRUD ì½”ë“œë¥¼ ì¤‘ë³µ ì‘ì„±í•˜ëŠ” ëŒ€ì‹ , ì œë„¤ë¦­ DAO(Data Access Object)ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

### ë¬¸ì œ ìƒí™©
```java
// âŒ ì œë„¤ë¦­ ì—†ì´: ê° ì—”í‹°í‹°ë§ˆë‹¤ DAO í´ë˜ìŠ¤ ì¤‘ë³µ
class UserDao {
    public User findById(Long id) { /* JDBC ì½”ë“œ */ }
    public void save(User user) { /* JDBC ì½”ë“œ */ }
    public void delete(Long id) { /* JDBC ì½”ë“œ */ }
}

class MessageDao {
    public Message findById(Long id) { /* ê±°ì˜ ë™ì¼í•œ JDBC ì½”ë“œ */ }
    public void save(Message message) { /* ê±°ì˜ ë™ì¼í•œ JDBC ì½”ë“œ */ }
    public void delete(Long id) { /* ê±°ì˜ ë™ì¼í•œ JDBC ì½”ë“œ */ }
}
// ... ìˆ˜ì‹­ ê°œì˜ DAO í´ë˜ìŠ¤ ë°˜ë³µ
```

### í•´ê²° ë°©ë²•: ì œë„¤ë¦­ Base DAO

```java
import java.util.*;
import java.util.concurrent.ConcurrentHashMap;
import java.util.stream.Collectors;

// ëª¨ë“  ì—”í‹°í‹°ê°€ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤
interface Entity {
    Long getId();
    void setId(Long id);
}

// ì—”í‹°í‹° í´ë˜ìŠ¤ë“¤
class KakaoUser implements Entity {
    private Long id;
    private String nickname;
    private String phoneNumber;

    public KakaoUser(Long id, String nickname, String phoneNumber) {
        this.id = id;
        this.nickname = nickname;
        this.phoneNumber = phoneNumber;
    }

    @Override public Long getId() { return id; }
    @Override public void setId(Long id) { this.id = id; }

    public String getNickname() { return nickname; }
    public String getPhoneNumber() { return phoneNumber; }

    @Override
    public String toString() {
        return "User[" + id + "] " + nickname + " (" + phoneNumber + ")";
    }
}

class ChatRoom implements Entity {
    private Long id;
    private String roomName;
    private int memberCount;

    public ChatRoom(Long id, String roomName, int memberCount) {
        this.id = id;
        this.roomName = roomName;
        this.memberCount = memberCount;
    }

    @Override public Long getId() { return id; }
    @Override public void setId(Long id) { this.id = id; }

    public String getRoomName() { return roomName; }
    public int getMemberCount() { return memberCount; }

    @Override
    public String toString() {
        return "Room[" + id + "] " + roomName + " (" + memberCount + "ëª…)";
    }
}

class Message implements Entity {
    private Long id;
    private Long roomId;
    private String senderName;
    private String content;

    public Message(Long id, Long roomId, String senderName, String content) {
        this.id = id;
        this.roomId = roomId;
        this.senderName = senderName;
        this.content = content;
    }

    @Override public Long getId() { return id; }
    @Override public void setId(Long id) { this.id = id; }

    public Long getRoomId() { return roomId; }
    public String getSenderName() { return senderName; }
    public String getContent() { return content; }

    @Override
    public String toString() {
        return "Msg[" + id + "] " + senderName + ": " + content;
    }
}

// ì œë„¤ë¦­ Base DAO - ëª¨ë“  ì—”í‹°í‹°ì— ê³µí†µ ì ìš©
abstract class BaseDao<T extends Entity> {
    // ì‹¤ì œë¡œëŠ” DB ì—°ê²°, ì—¬ê¸°ì„œëŠ” ë©”ëª¨ë¦¬ë¡œ ì‹œë®¬ë ˆì´ì…˜
    protected final Map<Long, T> storage = new ConcurrentHashMap<>();
    private long nextId = 1L;

    protected abstract String getTableName();

    // Create
    public T save(T entity) {
        if (entity.getId() == null) {
            entity.setId(nextId++);
            System.out.println("ğŸ’¾ INSERT into " + getTableName() + ": " + entity);
        } else {
            System.out.println("ğŸ”„ UPDATE " + getTableName() + ": " + entity);
        }
        storage.put(entity.getId(), entity);
        return entity;
    }

    // Read
    public Optional<T> findById(Long id) {
        System.out.println("ğŸ” SELECT from " + getTableName() + " WHERE id=" + id);
        return Optional.ofNullable(storage.get(id));
    }

    // Read All
    public List<T> findAll() {
        System.out.println("ğŸ“‹ SELECT * from " + getTableName());
        return new ArrayList<>(storage.values());
    }

    // Delete
    public boolean delete(Long id) {
        System.out.println("ğŸ—‘ï¸ DELETE from " + getTableName() + " WHERE id=" + id);
        return storage.remove(id) != null;
    }

    // Count
    public int count() {
        return storage.size();
    }
}

// êµ¬ì²´ì ì¸ DAO êµ¬í˜„ - ì œë„¤ë¦­ ìƒì†
class UserDao extends BaseDao<KakaoUser> {
    @Override
    protected String getTableName() {
        return "kakao_users";
    }

    // User ì „ìš© ì¿¼ë¦¬ ë©”ì„œë“œ
    public Optional<KakaoUser> findByPhoneNumber(String phoneNumber) {
        System.out.println("ğŸ” SELECT from " + getTableName() +
                         " WHERE phone_number='" + phoneNumber + "'");
        return storage.values().stream()
                     .filter(user -> user.getPhoneNumber().equals(phoneNumber))
                     .findFirst();
    }
}

class ChatRoomDao extends BaseDao<ChatRoom> {
    @Override
    protected String getTableName() {
        return "chat_rooms";
    }

    // ChatRoom ì „ìš© ì¿¼ë¦¬ ë©”ì„œë“œ
    public List<ChatRoom> findLargeRooms(int minMembers) {
        System.out.println("ğŸ” SELECT from " + getTableName() +
                         " WHERE member_count >= " + minMembers);
        return storage.values().stream()
                     .filter(room -> room.getMemberCount() >= minMembers)
                     .collect(Collectors.toList());
    }
}

class MessageDao extends BaseDao<Message> {
    @Override
    protected String getTableName() {
        return "messages";
    }

    // Message ì „ìš© ì¿¼ë¦¬ ë©”ì„œë“œ
    public List<Message> findByRoomId(Long roomId) {
        System.out.println("ğŸ” SELECT from " + getTableName() +
                         " WHERE room_id=" + roomId);
        return storage.values().stream()
                     .filter(msg -> msg.getRoomId().equals(roomId))
                     .collect(Collectors.toList());
    }
}

public class KakaoDaoExample {
    public static void main(String[] args) {
        System.out.println("=== ì¹´ì¹´ì˜¤ ì œë„¤ë¦­ DAO íŒ¨í„´ ===\n");

        UserDao userDao = new UserDao();
        ChatRoomDao roomDao = new ChatRoomDao();
        MessageDao messageDao = new MessageDao();

        // 1. ì‚¬ìš©ì ì €ì¥
        System.out.println("--- ì‚¬ìš©ì ê´€ë¦¬ ---");
        KakaoUser user1 = userDao.save(new KakaoUser(null, "ê¹€ì¹´ì¹´ì˜¤", "010-1234-5678"));
        KakaoUser user2 = userDao.save(new KakaoUser(null, "ì´í†¡í†¡", "010-8765-4321"));
        System.out.println();

        // 2. ì‚¬ìš©ì ì¡°íšŒ
        Optional<KakaoUser> foundUser = userDao.findById(1L);
        foundUser.ifPresent(user -> System.out.println("ì¡°íšŒ ê²°ê³¼: " + user));
        System.out.println();

        // 3. ì „í™”ë²ˆí˜¸ë¡œ ê²€ìƒ‰ (UserDao ì „ìš© ë©”ì„œë“œ)
        Optional<KakaoUser> userByPhone = userDao.findByPhoneNumber("010-1234-5678");
        userByPhone.ifPresent(user -> System.out.println("ì „í™”ë²ˆí˜¸ ê²€ìƒ‰: " + user));
        System.out.println();

        // 4. ì±„íŒ…ë°© ì €ì¥
        System.out.println("--- ì±„íŒ…ë°© ê´€ë¦¬ ---");
        ChatRoom room1 = roomDao.save(new ChatRoom(null, "ìë°” ìŠ¤í„°ë””", 12));
        ChatRoom room2 = roomDao.save(new ChatRoom(null, "ì ì‹¬ ë©”ë‰´", 5));
        ChatRoom room3 = roomDao.save(new ChatRoom(null, "ì „ì‚¬ ê³µì§€", 150));
        System.out.println();

        // 5. ëŒ€ê·œëª¨ ì±„íŒ…ë°© ê²€ìƒ‰ (ChatRoomDao ì „ìš© ë©”ì„œë“œ)
        List<ChatRoom> largeRooms = roomDao.findLargeRooms(10);
        System.out.println("10ëª… ì´ìƒ ì±„íŒ…ë°©:");
        largeRooms.forEach(room -> System.out.println("   " + room));
        System.out.println();

        // 6. ë©”ì‹œì§€ ì €ì¥
        System.out.println("--- ë©”ì‹œì§€ ê´€ë¦¬ ---");
        messageDao.save(new Message(null, 1L, "ê¹€ì¹´ì¹´ì˜¤", "ì•ˆë…•í•˜ì„¸ìš”!"));
        messageDao.save(new Message(null, 1L, "ì´í†¡í†¡", "ë°˜ê°‘ìŠµë‹ˆë‹¤!"));
        messageDao.save(new Message(null, 1L, "ê¹€ì¹´ì¹´ì˜¤", "ì˜¤ëŠ˜ ìŠ¤í„°ë”” ì£¼ì œëŠ” ì œë„¤ë¦­ì…ë‹ˆë‹¤."));
        System.out.println();

        // 7. ì±„íŒ…ë°©ë³„ ë©”ì‹œì§€ ì¡°íšŒ (MessageDao ì „ìš© ë©”ì„œë“œ)
        List<Message> roomMessages = messageDao.findByRoomId(1L);
        System.out.println("ì±„íŒ…ë°© 1ë²ˆ ë©”ì‹œì§€:");
        roomMessages.forEach(msg -> System.out.println("   " + msg));
        System.out.println();

        // 8. ì „ì²´ ì¡°íšŒ
        System.out.println("--- ì „ì²´ ë°ì´í„° ì¡°íšŒ ---");
        System.out.println("ì „ì²´ ì‚¬ìš©ì ìˆ˜: " + userDao.count());
        System.out.println("ì „ì²´ ì±„íŒ…ë°© ìˆ˜: " + roomDao.count());
        System.out.println("ì „ì²´ ë©”ì‹œì§€ ìˆ˜: " + messageDao.count());

        System.out.println("\nâœ… ì œë„¤ë¦­ DAO íŒ¨í„´ì˜ ì¥ì :");
        System.out.println("1. ì½”ë“œ ì¬ì‚¬ìš©: CRUD ë¡œì§ì„ BaseDaoì— í•œ ë²ˆë§Œ êµ¬í˜„");
        System.out.println("2. íƒ€ì… ì•ˆì „ì„±: UserDaoëŠ” KakaoUserë§Œ, RoomDaoëŠ” ChatRoomë§Œ ì²˜ë¦¬");
        System.out.println("3. í™•ì¥ì„±: ì—”í‹°í‹°ë³„ ì „ìš© ë©”ì„œë“œë¥¼ ì¶”ê°€ ê°€ëŠ¥");
        System.out.println("4. ìœ ì§€ë³´ìˆ˜: ê³µí†µ ë¡œì§ ìˆ˜ì • ì‹œ BaseDaoë§Œ ë³€ê²½");
    }
}
```

### ì‹¤í–‰ ê²°ê³¼
```
=== ì¹´ì¹´ì˜¤ ì œë„¤ë¦­ DAO íŒ¨í„´ ===

--- ì‚¬ìš©ì ê´€ë¦¬ ---
ğŸ’¾ INSERT into kakao_users: User[1] ê¹€ì¹´ì¹´ì˜¤ (010-1234-5678)
ğŸ’¾ INSERT into kakao_users: User[2] ì´í†¡í†¡ (010-8765-4321)

ğŸ” SELECT from kakao_users WHERE id=1
ì¡°íšŒ ê²°ê³¼: User[1] ê¹€ì¹´ì¹´ì˜¤ (010-1234-5678)

ğŸ” SELECT from kakao_users WHERE phone_number='010-1234-5678'
ì „í™”ë²ˆí˜¸ ê²€ìƒ‰: User[1] ê¹€ì¹´ì¹´ì˜¤ (010-1234-5678)

--- ì±„íŒ…ë°© ê´€ë¦¬ ---
ğŸ’¾ INSERT into chat_rooms: Room[1] ìë°” ìŠ¤í„°ë”” (12ëª…)
ğŸ’¾ INSERT into chat_rooms: Room[2] ì ì‹¬ ë©”ë‰´ (5ëª…)
ğŸ’¾ INSERT into chat_rooms: Room[3] ì „ì‚¬ ê³µì§€ (150ëª…)

ğŸ” SELECT from chat_rooms WHERE member_count >= 10
10ëª… ì´ìƒ ì±„íŒ…ë°©:
   Room[1] ìë°” ìŠ¤í„°ë”” (12ëª…)
   Room[3] ì „ì‚¬ ê³µì§€ (150ëª…)

--- ë©”ì‹œì§€ ê´€ë¦¬ ---
ğŸ’¾ INSERT into messages: Msg[1] ê¹€ì¹´ì¹´ì˜¤: ì•ˆë…•í•˜ì„¸ìš”!
ğŸ’¾ INSERT into messages: Msg[2] ì´í†¡í†¡: ë°˜ê°‘ìŠµë‹ˆë‹¤!
ğŸ’¾ INSERT into messages: Msg[3] ê¹€ì¹´ì¹´ì˜¤: ì˜¤ëŠ˜ ìŠ¤í„°ë”” ì£¼ì œëŠ” ì œë„¤ë¦­ì…ë‹ˆë‹¤.

ğŸ” SELECT from messages WHERE room_id=1
ì±„íŒ…ë°© 1ë²ˆ ë©”ì‹œì§€:
   Msg[1] ê¹€ì¹´ì¹´ì˜¤: ì•ˆë…•í•˜ì„¸ìš”!
   Msg[2] ì´í†¡í†¡: ë°˜ê°‘ìŠµë‹ˆë‹¤!
   Msg[3] ê¹€ì¹´ì¹´ì˜¤: ì˜¤ëŠ˜ ìŠ¤í„°ë”” ì£¼ì œëŠ” ì œë„¤ë¦­ì…ë‹ˆë‹¤.

--- ì „ì²´ ë°ì´í„° ì¡°íšŒ ---
ì „ì²´ ì‚¬ìš©ì ìˆ˜: 2
ì „ì²´ ì±„íŒ…ë°© ìˆ˜: 3
ì „ì²´ ë©”ì‹œì§€ ìˆ˜: 3

âœ… ì œë„¤ë¦­ DAO íŒ¨í„´ì˜ ì¥ì :
1. ì½”ë“œ ì¬ì‚¬ìš©: CRUD ë¡œì§ì„ BaseDaoì— í•œ ë²ˆë§Œ êµ¬í˜„
2. íƒ€ì… ì•ˆì „ì„±: UserDaoëŠ” KakaoUserë§Œ, RoomDaoëŠ” ChatRoomë§Œ ì²˜ë¦¬
3. í™•ì¥ì„±: ì—”í‹°í‹°ë³„ ì „ìš© ë©”ì„œë“œë¥¼ ì¶”ê°€ ê°€ëŠ¥
4. ìœ ì§€ë³´ìˆ˜: ê³µí†µ ë¡œì§ ìˆ˜ì • ì‹œ BaseDaoë§Œ ë³€ê²½
```

### í•µì‹¬ êµí›ˆ
- **ì œë„¤ë¦­ ìƒì†**: `BaseDao<T extends Entity>` ìƒì†ìœ¼ë¡œ ê³µí†µ ë¡œì§ ì¬ì‚¬ìš©
- **íƒ€ì… ë°”ìš´ë“œ**: `T extends Entity` - ëª¨ë“  ì—”í‹°í‹°ê°€ getId/setId ë³´ì¥
- **ì „ìš© ë©”ì„œë“œ**: ê° DAOê°€ ìì²´ì ì¸ ì¿¼ë¦¬ ë©”ì„œë“œ ì¶”ê°€ ê°€ëŠ¥
- **ì‹¤ë¬´ ì ìš©**: Spring Data JPAì˜ JpaRepositoryê°€ ì´ íŒ¨í„´ ì‚¬ìš©

---

## ì‚¬ë¡€ 3: ì¿ íŒ¡ - ì œë„¤ë¦­ ìºì‹œ ì‹œìŠ¤í…œ ğŸ“¦

### ë°°ê²½
ì¿ íŒ¡ ìƒí’ˆ ì¡°íšŒ APIëŠ” ì´ˆë‹¹ ìˆ˜ë§Œ ê±´ì˜ ìš”ì²­ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. DB ë¶€í•˜ë¥¼ ì¤„ì´ê¸° ìœ„í•´ ìƒí’ˆ, ì¹´í…Œê³ ë¦¬, ì‚¬ìš©ì ë“± ë‹¤ì–‘í•œ ë°ì´í„°ë¥¼ ìºì‹±í•˜ëŠ” ë²”ìš© ìºì‹œ ì‹œìŠ¤í…œì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

### ë¬¸ì œ ìƒí™©
```java
// âŒ ì œë„¤ë¦­ ì—†ì´: ê° ë°ì´í„° íƒ€ì…ë§ˆë‹¤ ìºì‹œ í´ë˜ìŠ¤ ì¤‘ë³µ
class ProductCache {
    private Map<String, Product> cache = new HashMap<>();
    // ìºì‹œ ë¡œì§...
}

class CategoryCache {
    private Map<String, Category> cache = new HashMap<>();
    // ë™ì¼í•œ ìºì‹œ ë¡œì§ ë°˜ë³µ...
}
```

### í•´ê²° ë°©ë²•: ì œë„¤ë¦­ LRU ìºì‹œ

```java
import java.time.Duration;
import java.time.LocalDateTime;
import java.util.*;
import java.util.concurrent.ConcurrentHashMap;
import java.util.function.Function;

// ìºì‹œ ì—”íŠ¸ë¦¬ - ë°ì´í„° + ë©”íƒ€ì •ë³´
class CacheEntry<V> {
    private final V value;
    private final LocalDateTime createdAt;
    private final Duration ttl; // Time To Live
    private int hitCount; // ì¡°íšŒ íšŸìˆ˜

    public CacheEntry(V value, Duration ttl) {
        this.value = value;
        this.createdAt = LocalDateTime.now();
        this.ttl = ttl;
        this.hitCount = 0;
    }

    public V getValue() {
        hitCount++;
        return value;
    }

    public boolean isExpired() {
        return LocalDateTime.now().isAfter(createdAt.plus(ttl));
    }

    public int getHitCount() { return hitCount; }
    public LocalDateTime getCreatedAt() { return createdAt; }
}

// ì œë„¤ë¦­ LRU ìºì‹œ (Least Recently Used)
class LRUCache<K, V> {
    private final int maxSize;
    private final Duration defaultTtl;
    private final Map<K, CacheEntry<V>> cache;
    private final LinkedHashMap<K, LocalDateTime> accessOrder; // LRU ì¶”ì 

    // í†µê³„
    private int hits = 0;
    private int misses = 0;

    public LRUCache(int maxSize, Duration defaultTtl) {
        this.maxSize = maxSize;
        this.defaultTtl = defaultTtl;
        this.cache = new ConcurrentHashMap<>();
        this.accessOrder = new LinkedHashMap<>(maxSize, 0.75f, true) {
            @Override
            protected boolean removeEldestEntry(Map.Entry<K, LocalDateTime> eldest) {
                return size() > maxSize;
            }
        };
    }

    // ìºì‹œ ì¡°íšŒ
    public Optional<V> get(K key) {
        CacheEntry<V> entry = cache.get(key);

        if (entry == null) {
            misses++;
            System.out.println("âŒ CACHE MISS: " + key);
            return Optional.empty();
        }

        if (entry.isExpired()) {
            cache.remove(key);
            accessOrder.remove(key);
            misses++;
            System.out.println("â° CACHE EXPIRED: " + key);
            return Optional.empty();
        }

        hits++;
        accessOrder.put(key, LocalDateTime.now()); // LRU ì—…ë°ì´íŠ¸
        System.out.println("âœ… CACHE HIT: " + key + " (ì¡°íšŒ " + entry.getHitCount() + "íšŒ)");
        return Optional.of(entry.getValue());
    }

    // ìºì‹œ ì €ì¥
    public void put(K key, V value) {
        put(key, value, defaultTtl);
    }

    public void put(K key, V value, Duration ttl) {
        if (cache.size() >= maxSize && !cache.containsKey(key)) {
            evictLRU(); // LRU ì œê±°
        }

        cache.put(key, new CacheEntry<>(value, ttl));
        accessOrder.put(key, LocalDateTime.now());
        System.out.println("ğŸ’¾ CACHE PUT: " + key);
    }

    // LRU(ê°€ì¥ ì˜¤ë˜ëœ í•­ëª©) ì œê±°
    private void evictLRU() {
        if (accessOrder.isEmpty()) return;

        K lruKey = accessOrder.keySet().iterator().next();
        cache.remove(lruKey);
        accessOrder.remove(lruKey);
        System.out.println("ğŸ—‘ï¸ LRU EVICTION: " + lruKey);
    }

    // ìºì‹œê°€ ì—†ìœ¼ë©´ loader í•¨ìˆ˜ë¡œ ë¡œë“œ í›„ ìºì‹±
    public V getOrLoad(K key, Function<K, V> loader) {
        return get(key).orElseGet(() -> {
            V value = loader.apply(key);
            if (value != null) {
                put(key, value);
            }
            return value;
        });
    }

    // í†µê³„
    public void printStats() {
        System.out.println("\nğŸ“Š ìºì‹œ í†µê³„:");
        System.out.println("   í¬ê¸°: " + cache.size() + "/" + maxSize);
        System.out.println("   Hit: " + hits + ", Miss: " + misses);
        double hitRate = (hits + misses) == 0 ? 0 :
                        (double) hits / (hits + misses) * 100;
        System.out.println("   Hit Rate: " + String.format("%.1f%%", hitRate));
    }

    public void clear() {
        cache.clear();
        accessOrder.clear();
        System.out.println("ğŸ§¹ ìºì‹œ ì „ì²´ ì‚­ì œ");
    }
}

// ë„ë©”ì¸ ëª¨ë¸ë“¤
class Product {
    private String productId;
    private String name;
    private int price;

    public Product(String productId, String name, int price) {
        this.productId = productId;
        this.name = name;
        this.price = price;
    }

    @Override
    public String toString() {
        return name + " (" + String.format("%,dì›", price) + ")";
    }
}

class Category {
    private String categoryId;
    private String name;

    public Category(String categoryId, String name) {
        this.categoryId = categoryId;
        this.name = name;
    }

    @Override
    public String toString() {
        return name;
    }
}

// ì¿ íŒ¡ ìƒí’ˆ ì„œë¹„ìŠ¤ ì‹œë®¬ë ˆì´ì…˜
class CoupangProductService {
    private final LRUCache<String, Product> productCache;
    private final LRUCache<String, Category> categoryCache;

    public CoupangProductService() {
        this.productCache = new LRUCache<>(3, Duration.ofSeconds(10)); // ìµœëŒ€ 3ê°œ, 10ì´ˆ TTL
        this.categoryCache = new LRUCache<>(2, Duration.ofSeconds(15)); // ìµœëŒ€ 2ê°œ, 15ì´ˆ TTL
    }

    // DBì—ì„œ ìƒí’ˆ ì¡°íšŒ ì‹œë®¬ë ˆì´ì…˜
    private Product loadProductFromDB(String productId) {
        System.out.println("ğŸ”„ DBì—ì„œ ìƒí’ˆ ë¡œë“œ: " + productId);
        // ì‹¤ì œë¡œëŠ” DB ì¿¼ë¦¬
        return new Product(productId, "ìƒí’ˆ-" + productId, 10000 + productId.hashCode() % 50000);
    }

    // DBì—ì„œ ì¹´í…Œê³ ë¦¬ ì¡°íšŒ ì‹œë®¬ë ˆì´ì…˜
    private Category loadCategoryFromDB(String categoryId) {
        System.out.println("ğŸ”„ DBì—ì„œ ì¹´í…Œê³ ë¦¬ ë¡œë“œ: " + categoryId);
        return new Category(categoryId, "ì¹´í…Œê³ ë¦¬-" + categoryId);
    }

    // ìºì‹œë¥¼ í™œìš©í•œ ìƒí’ˆ ì¡°íšŒ
    public Product getProduct(String productId) {
        return productCache.getOrLoad(productId, this::loadProductFromDB);
    }

    // ìºì‹œë¥¼ í™œìš©í•œ ì¹´í…Œê³ ë¦¬ ì¡°íšŒ
    public Category getCategory(String categoryId) {
        return categoryCache.getOrLoad(categoryId, this::loadCategoryFromDB);
    }

    public void printAllStats() {
        System.out.println("\n=== ìƒí’ˆ ìºì‹œ ===");
        productCache.printStats();
        System.out.println("\n=== ì¹´í…Œê³ ë¦¬ ìºì‹œ ===");
        categoryCache.printStats();
    }
}

public class CoupangCacheExample {
    public static void main(String[] args) throws InterruptedException {
        System.out.println("=== ì¿ íŒ¡ ì œë„¤ë¦­ ìºì‹œ ì‹œìŠ¤í…œ ===\n");

        CoupangProductService service = new CoupangProductService();

        // 1. ìƒí’ˆ ì¡°íšŒ - ì²« ì¡°íšŒëŠ” DBì—ì„œ ë¡œë“œ
        System.out.println("--- ì²« ë²ˆì§¸ ì¡°íšŒ ---");
        Product p1 = service.getProduct("PROD-001");
        System.out.println("ê²°ê³¼: " + p1 + "\n");

        // 2. ë™ì¼ ìƒí’ˆ ì¬ì¡°íšŒ - ìºì‹œ íˆíŠ¸
        System.out.println("--- ë‘ ë²ˆì§¸ ì¡°íšŒ (ìºì‹œ íˆíŠ¸) ---");
        Product p1Again = service.getProduct("PROD-001");
        System.out.println("ê²°ê³¼: " + p1Again + "\n");

        // 3. ë‹¤ë¥¸ ìƒí’ˆë“¤ ì¡°íšŒ
        System.out.println("--- ì—¬ëŸ¬ ìƒí’ˆ ì¡°íšŒ ---");
        service.getProduct("PROD-002");
        service.getProduct("PROD-003");
        service.getProduct("PROD-001"); // ìºì‹œ íˆíŠ¸
        System.out.println();

        // 4. LRU ì œê±° í…ŒìŠ¤íŠ¸ - ìºì‹œ í¬ê¸° ì´ˆê³¼
        System.out.println("--- LRU ì œê±° í…ŒìŠ¤íŠ¸ (ìºì‹œ í¬ê¸°: 3) ---");
        service.getProduct("PROD-004"); // PROD-002ê°€ LRUë¡œ ì œê±°ë  ê²ƒ
        service.getProduct("PROD-002"); // ë‹¤ì‹œ DBì—ì„œ ë¡œë“œ
        System.out.println();

        // 5. ì¹´í…Œê³ ë¦¬ ìºì‹œ í…ŒìŠ¤íŠ¸
        System.out.println("--- ì¹´í…Œê³ ë¦¬ ìºì‹œ ---");
        service.getCategory("CAT-A");
        service.getCategory("CAT-B");
        service.getCategory("CAT-A"); // ìºì‹œ íˆíŠ¸
        System.out.println();

        // 6. TTL ë§Œë£Œ í…ŒìŠ¤íŠ¸
        System.out.println("--- TTL ë§Œë£Œ í…ŒìŠ¤íŠ¸ (10ì´ˆ ëŒ€ê¸°) ---");
        System.out.println("11ì´ˆ í›„ ì¬ì¡°íšŒí•˜ë©´ ìºì‹œ ë§Œë£Œ...");
        Thread.sleep(11000); // 11ì´ˆ ëŒ€ê¸°
        service.getProduct("PROD-001"); // ë§Œë£Œë˜ì–´ DBì—ì„œ ì¬ë¡œë“œ
        System.out.println();

        // 7. í†µê³„ ì¶œë ¥
        service.printAllStats();

        System.out.println("\n\nâœ… ì œë„¤ë¦­ ìºì‹œ ì‹œìŠ¤í…œì˜ ì¥ì :");
        System.out.println("1. ë²”ìš©ì„±: í•˜ë‚˜ì˜ ìºì‹œë¡œ Product, Category ë“± ëª¨ë“  íƒ€ì… ì²˜ë¦¬");
        System.out.println("2. íƒ€ì… ì•ˆì „ì„±: productCacheëŠ” Productë§Œ, categoryCacheëŠ” Categoryë§Œ");
        System.out.println("3. ì„±ëŠ¥ í–¥ìƒ: DB ì¡°íšŒ ëŒ€ì‹  ë©”ëª¨ë¦¬ ìºì‹œë¡œ ë¹ ë¥¸ ì‘ë‹µ");
        System.out.println("4. ë©”ëª¨ë¦¬ ê´€ë¦¬: LRU + TTLë¡œ ë©”ëª¨ë¦¬ íš¨ìœ¨ì  ì‚¬ìš©");
    }
}
```

### ì‹¤í–‰ ê²°ê³¼
```
=== ì¿ íŒ¡ ì œë„¤ë¦­ ìºì‹œ ì‹œìŠ¤í…œ ===

--- ì²« ë²ˆì§¸ ì¡°íšŒ ---
âŒ CACHE MISS: PROD-001
ğŸ”„ DBì—ì„œ ìƒí’ˆ ë¡œë“œ: PROD-001
ğŸ’¾ CACHE PUT: PROD-001
ê²°ê³¼: ìƒí’ˆ-PROD-001 (35,297ì›)

--- ë‘ ë²ˆì§¸ ì¡°íšŒ (ìºì‹œ íˆíŠ¸) ---
âœ… CACHE HIT: PROD-001 (ì¡°íšŒ 1íšŒ)
ê²°ê³¼: ìƒí’ˆ-PROD-001 (35,297ì›)

--- ì—¬ëŸ¬ ìƒí’ˆ ì¡°íšŒ ---
âŒ CACHE MISS: PROD-002
ğŸ”„ DBì—ì„œ ìƒí’ˆ ë¡œë“œ: PROD-002
ğŸ’¾ CACHE PUT: PROD-002
âŒ CACHE MISS: PROD-003
ğŸ”„ DBì—ì„œ ìƒí’ˆ ë¡œë“œ: PROD-003
ğŸ’¾ CACHE PUT: PROD-003
âœ… CACHE HIT: PROD-001 (ì¡°íšŒ 2íšŒ)

--- LRU ì œê±° í…ŒìŠ¤íŠ¸ (ìºì‹œ í¬ê¸°: 3) ---
ğŸ—‘ï¸ LRU EVICTION: PROD-002
ğŸ’¾ CACHE PUT: PROD-004
âŒ CACHE MISS: PROD-002
ğŸ”„ DBì—ì„œ ìƒí’ˆ ë¡œë“œ: PROD-002
ğŸ—‘ï¸ LRU EVICTION: PROD-003
ğŸ’¾ CACHE PUT: PROD-002

--- ì¹´í…Œê³ ë¦¬ ìºì‹œ ---
âŒ CACHE MISS: CAT-A
ğŸ”„ DBì—ì„œ ì¹´í…Œê³ ë¦¬ ë¡œë“œ: CAT-A
ğŸ’¾ CACHE PUT: CAT-A
âŒ CACHE MISS: CAT-B
ğŸ”„ DBì—ì„œ ì¹´í…Œê³ ë¦¬ ë¡œë“œ: CAT-B
ğŸ’¾ CACHE PUT: CAT-B
âœ… CACHE HIT: CAT-A (ì¡°íšŒ 1íšŒ)

--- TTL ë§Œë£Œ í…ŒìŠ¤íŠ¸ (10ì´ˆ ëŒ€ê¸°) ---
11ì´ˆ í›„ ì¬ì¡°íšŒí•˜ë©´ ìºì‹œ ë§Œë£Œ...
â° CACHE EXPIRED: PROD-001
ğŸ”„ DBì—ì„œ ìƒí’ˆ ë¡œë“œ: PROD-001
ğŸ—‘ï¸ LRU EVICTION: PROD-004
ğŸ’¾ CACHE PUT: PROD-001

=== ìƒí’ˆ ìºì‹œ ===

ğŸ“Š ìºì‹œ í†µê³„:
   í¬ê¸°: 3/3
   Hit: 3, Miss: 7
   Hit Rate: 30.0%

=== ì¹´í…Œê³ ë¦¬ ìºì‹œ ===

ğŸ“Š ìºì‹œ í†µê³„:
   í¬ê¸°: 2/2
   Hit: 1, Miss: 2
   Hit Rate: 33.3%


âœ… ì œë„¤ë¦­ ìºì‹œ ì‹œìŠ¤í…œì˜ ì¥ì :
1. ë²”ìš©ì„±: í•˜ë‚˜ì˜ ìºì‹œë¡œ Product, Category ë“± ëª¨ë“  íƒ€ì… ì²˜ë¦¬
2. íƒ€ì… ì•ˆì „ì„±: productCacheëŠ” Productë§Œ, categoryCacheëŠ” Categoryë§Œ
3. ì„±ëŠ¥ í–¥ìƒ: DB ì¡°íšŒ ëŒ€ì‹  ë©”ëª¨ë¦¬ ìºì‹œë¡œ ë¹ ë¥¸ ì‘ë‹µ
4. ë©”ëª¨ë¦¬ ê´€ë¦¬: LRU + TTLë¡œ ë©”ëª¨ë¦¬ íš¨ìœ¨ì  ì‚¬ìš©
```

### í•µì‹¬ êµí›ˆ
- **ë³µí•© ì œë„¤ë¦­**: `CacheEntry<V>`, `LRUCache<K, V>` - ì—¬ëŸ¬ íƒ€ì… íŒŒë¼ë¯¸í„°
- **Function ì¸í„°í˜ì´ìŠ¤**: `getOrLoad(K key, Function<K, V> loader)` - í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°
- **ì‹¤ë¬´ íŒ¨í„´**: Redis, Caffeine ë“± ì‹¤ì œ ìºì‹œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ê¸°ë³¸ ì›ë¦¬
- **ì„±ëŠ¥ ìµœì í™”**: DB ë¶€í•˜ ê°ì†Œ, ì‘ë‹µ ì†ë„ í–¥ìƒ

---

## ğŸ”° ì£¼ë‹ˆì–´ ê°œë°œì í”í•œ ì‹¤ìˆ˜ ì‹œë‚˜ë¦¬ì˜¤

---

## ì‹¤ìˆ˜ 1: Raw Type ì‚¬ìš© âš ï¸

### ë¬¸ì œ ì½”ë“œ
```java
import java.util.*;

public class RawTypeError {
    public static void main(String[] args) {
        // âŒ Raw Type ì‚¬ìš© - ì œë„¤ë¦­ íƒ€ì… ì§€ì • ì•ˆ í•¨
        List products = new ArrayList();

        products.add("ë…¸íŠ¸ë¶");
        products.add(Integer.valueOf(1000000)); // ì»´íŒŒì¼ OK - ë¬¸ì œ ì—†ìŒ
        products.add(new Date()); // ì»´íŒŒì¼ OK - ë¬¸ì œ ì—†ìŒ

        // ëŸ°íƒ€ì„ ì—ëŸ¬ ë°œìƒ!
        for (Object obj : products) {
            String product = (String) obj; // ClassCastException!
            System.out.println(product.toUpperCase());
        }
    }
}
```

### ì‹¤í–‰ ê²°ê³¼
```
ë…¸íŠ¸ë¶
Exception in thread "main" java.lang.ClassCastException:
    java.lang.Integer cannot be cast to java.lang.String
```

### ì˜¬ë°”ë¥¸ ì½”ë“œ
```java
import java.util.*;

public class RawTypeFixed {
    public static void main(String[] args) {
        // âœ… ì œë„¤ë¦­ íƒ€ì… ëª…ì‹œ
        List<String> products = new ArrayList<>();

        products.add("ë…¸íŠ¸ë¶");
        // products.add(1000000); // âŒ ì»´íŒŒì¼ ì—ëŸ¬! íƒ€ì… ì•ˆì „ì„± ë³´ì¥
        // products.add(new Date()); // âŒ ì»´íŒŒì¼ ì—ëŸ¬!

        // íƒ€ì… ìºìŠ¤íŒ… ë¶ˆí•„ìš”
        for (String product : products) {
            System.out.println(product.toUpperCase());
        }
    }
}
```

### êµí›ˆ
- **Raw Type ì ˆëŒ€ ê¸ˆì§€**: `List` ëŒ€ì‹  `List<T>` ì‚¬ìš©
- **ì»´íŒŒì¼ íƒ€ì„ ì²´í¬**: ì œë„¤ë¦­ìœ¼ë¡œ ëŸ°íƒ€ì„ ì—ëŸ¬ ë°©ì§€
- **IDE ê²½ê³  ì£¼ì˜**: "unchecked" ê²½ê³ ëŠ” ë¬´ì‹œí•˜ì§€ ë§ ê²ƒ

---

## ì‹¤ìˆ˜ 2: ì œë„¤ë¦­ ë°°ì—´ ìƒì„± ì‹œë„ âš ï¸

### ë¬¸ì œ ì½”ë“œ
```java
public class GenericArrayError<T> {
    private T[] items;

    public GenericArrayError(int size) {
        // âŒ ì»´íŒŒì¼ ì—ëŸ¬: Generic array creation
        // items = new T[size];

        // âš ï¸ ê²½ê³  ë°œìƒí•˜ëŠ” ìš°íšŒ ë°©ë²•
        items = (T[]) new Object[size];
    }

    public void set(int index, T item) {
        items[index] = item;
    }

    public T get(int index) {
        return items[index];
    }

    public static void main(String[] args) {
        GenericArrayError<String> array = new GenericArrayError<>(3);
        array.set(0, "Hello");
        array.set(1, "World");

        // âš ï¸ ëŸ°íƒ€ì„ì— ë¬¸ì œ ë°œìƒ ê°€ëŠ¥
        String[] strings = (String[]) array.items; // ClassCastException ê°€ëŠ¥!
    }
}
```

### ì˜¬ë°”ë¥¸ ì½”ë“œ - ArrayList ì‚¬ìš©
```java
import java.util.*;

public class GenericArrayFixed<T> {
    private List<T> items; // âœ… ArrayList ì‚¬ìš©

    public GenericArrayFixed() {
        items = new ArrayList<>();
    }

    public void add(T item) {
        items.add(item);
    }

    public T get(int index) {
        return items.get(index);
    }

    public int size() {
        return items.size();
    }

    public static void main(String[] args) {
        GenericArrayFixed<String> array = new GenericArrayFixed<>();
        array.add("Hello");
        array.add("World");

        System.out.println("í¬ê¸°: " + array.size());
        System.out.println("ì²« ë²ˆì§¸: " + array.get(0));
    }
}
```

### êµí›ˆ
- **ì œë„¤ë¦­ ë°°ì—´ ìƒì„± ë¶ˆê°€**: íƒ€ì… ì†Œê±°ë¡œ ì¸í•´ `new T[]` ë¶ˆê°€ëŠ¥
- **ArrayList ì‚¬ìš© ê¶Œì¥**: ì œë„¤ë¦­ ë°°ì—´ ëŒ€ì‹  `List<T>` ì‚¬ìš©
- **ë¶ˆê°€í”¼í•œ ê²½ìš°**: `@SuppressWarnings("unchecked")` + ì£¼ì„ìœ¼ë¡œ ê²½ê³  ì–µì œ

---

## ì‹¤ìˆ˜ 3: ì™€ì¼ë“œì¹´ë“œ ì˜¤ìš© âš ï¸

### ë¬¸ì œ ì½”ë“œ
```java
import java.util.*;

public class WildcardError {
    // âŒ extendsëŠ” ì½ê¸° ì „ìš©! ì“°ê¸° ë¶ˆê°€
    public static void addNumber(List<? extends Number> numbers) {
        // numbers.add(10); // âŒ ì»´íŒŒì¼ ì—ëŸ¬!
        // numbers.add(3.14); // âŒ ì»´íŒŒì¼ ì—ëŸ¬!
        // List<Integer>, List<Double> ë“± ì–´ë–¤ íƒ€ì…ì¸ì§€ ëª¨ë¥´ë¯€ë¡œ ì“°ê¸° ë¶ˆê°€

        Number num = numbers.get(0); // âœ… ì½ê¸°ëŠ” ê°€ëŠ¥
    }

    // âŒ superëŠ” ì“°ê¸° ì „ìš©! ì½ê¸° ì œí•œ
    public static void printNumbers(List<? super Integer> numbers) {
        numbers.add(10); // âœ… ì“°ê¸°ëŠ” ê°€ëŠ¥

        // Integer num = numbers.get(0); // âŒ ì»´íŒŒì¼ ì—ëŸ¬!
        Object obj = numbers.get(0); // âš ï¸ Objectë¡œë§Œ ì½ì„ ìˆ˜ ìˆìŒ
        System.out.println(obj);
    }

    public static void main(String[] args) {
        List<Integer> integers = Arrays.asList(1, 2, 3);
        addNumber(integers); // extendsëŠ” ì½ê¸°ë§Œ

        List<Number> numbers = new ArrayList<>();
        printNumbers(numbers); // superëŠ” ì“°ê¸°ë§Œ
    }
}
```

### ì˜¬ë°”ë¥¸ ì½”ë“œ - PECS ì›ì¹™ ì ìš©
```java
import java.util.*;

public class WildcardFixed {

    // Producer (ë°ì´í„° ì œê³µ) - extends ì‚¬ìš©
    public static double sumNumbers(List<? extends Number> numbers) {
        double sum = 0;
        for (Number num : numbers) { // âœ… ì½ê¸° ì „ìš©
            sum += num.doubleValue();
        }
        return sum;
    }

    // Consumer (ë°ì´í„° ì†Œë¹„) - super ì‚¬ìš©
    public static void addIntegers(List<? super Integer> numbers) {
        numbers.add(10); // âœ… ì“°ê¸° ê°€ëŠ¥
        numbers.add(20);
        numbers.add(30);
    }

    public static void main(String[] args) {
        // Producer: ë‹¤ì–‘í•œ Number íƒ€ì…ì—ì„œ ì½ê¸°
        List<Integer> integers = Arrays.asList(1, 2, 3);
        List<Double> doubles = Arrays.asList(1.5, 2.5, 3.5);

        System.out.println("Integer í•©: " + sumNumbers(integers));
        System.out.println("Double í•©: " + sumNumbers(doubles));

        // Consumer: Number ë¦¬ìŠ¤íŠ¸ì— Integer ì“°ê¸°
        List<Number> numbers = new ArrayList<>();
        addIntegers(numbers);
        System.out.println("ì¶”ê°€ëœ ìˆ«ì: " + numbers);
    }
}
```

### ì‹¤í–‰ ê²°ê³¼
```
Integer í•©: 6.0
Double í•©: 7.5
ì¶”ê°€ëœ ìˆ«ì: [10, 20, 30]
```

### êµí›ˆ
- **PECS ì›ì¹™**: Producer-Extends (ì½ê¸°), Consumer-Super (ì“°ê¸°)
- **extends**: ë°ì´í„°ë¥¼ "ìƒì‚°"í•˜ëŠ” ê²½ìš° (`List<? extends T>`)
- **super**: ë°ì´í„°ë¥¼ "ì†Œë¹„"í•˜ëŠ” ê²½ìš° (`List<? super T>`)

---

## ì‹¤ìˆ˜ 4: íƒ€ì… ì†Œê±° ì´í•´ ë¶€ì¡± âš ï¸

### ë¬¸ì œ ì½”ë“œ
```java
import java.util.*;

public class TypeErasureError<T> {
    private List<T> items = new ArrayList<>();

    // âŒ ëŸ°íƒ€ì„ì— Tì˜ íƒ€ì…ì„ ì•Œ ìˆ˜ ì—†ìŒ
    public void addIfString(Object obj) {
        // if (obj instanceof T) { // âŒ ì»´íŒŒì¼ ì—ëŸ¬: TëŠ” ëŸ°íƒ€ì„ì— ì†Œê±°ë¨
        //     items.add((T) obj);
        // }

        // if (items instanceof List<String>) { // âŒ ì»´íŒŒì¼ ì—ëŸ¬
        //     System.out.println("String ë¦¬ìŠ¤íŠ¸");
        // }

        if (items instanceof List) { // âš ï¸ Raw typeë§Œ ì²´í¬ ê°€ëŠ¥
            System.out.println("Listì¸ì§€ë§Œ í™•ì¸ ê°€ëŠ¥ (êµ¬ì²´ íƒ€ì…ì€ ëª¨ë¦„)");
        }
    }

    // âŒ ì œë„¤ë¦­ íƒ€ì… ì •ë³´ë¥¼ ëŸ°íƒ€ì„ì— ì–»ì„ ìˆ˜ ì—†ìŒ
    public void printType() {
        // System.out.println(T.class); // âŒ ì»´íŒŒì¼ ì—ëŸ¬
        System.out.println(items.getClass()); // ArrayList (íƒ€ì… íŒŒë¼ë¯¸í„° ì •ë³´ ì—†ìŒ)
    }

    public static void main(String[] args) {
        TypeErasureError<String> stringList = new TypeErasureError<>();
        TypeErasureError<Integer> intList = new TypeErasureError<>();

        // ëŸ°íƒ€ì„ì—ëŠ” ë‘˜ ë‹¤ ê°™ì€ í´ë˜ìŠ¤!
        System.out.println(stringList.getClass() == intList.getClass()); // true
    }
}
```

### ì˜¬ë°”ë¥¸ ì½”ë“œ - Class ê°ì²´ ì „ë‹¬
```java
import java.util.*;

public class TypeErasureFixed<T> {
    private List<T> items = new ArrayList<>();
    private Class<T> type; // âœ… íƒ€ì… ì •ë³´ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì €ì¥

    public TypeErasureFixed(Class<T> type) {
        this.type = type;
    }

    // âœ… Class ê°ì²´ë¡œ ëŸ°íƒ€ì„ íƒ€ì… ì²´í¬
    public void addIfType(Object obj) {
        if (type.isInstance(obj)) {
            items.add(type.cast(obj));
            System.out.println("âœ… ì¶”ê°€: " + obj + " (íƒ€ì…: " + type.getSimpleName() + ")");
        } else {
            System.out.println("âŒ íƒ€ì… ë¶ˆì¼ì¹˜: " + obj.getClass().getSimpleName() +
                             " (ê¸°ëŒ€: " + type.getSimpleName() + ")");
        }
    }

    public void printType() {
        System.out.println("ì €ì¥ëœ íƒ€ì…: " + type.getName());
    }

    public List<T> getItems() {
        return new ArrayList<>(items);
    }

    public static void main(String[] args) {
        // âœ… Class ê°ì²´ë¥¼ ìƒì„±ìì— ì „ë‹¬
        TypeErasureFixed<String> stringList = new TypeErasureFixed<>(String.class);
        stringList.printType();
        stringList.addIfType("Hello"); // ì„±ê³µ
        stringList.addIfType(123);      // ì‹¤íŒ¨

        System.out.println();

        TypeErasureFixed<Integer> intList = new TypeErasureFixed<>(Integer.class);
        intList.printType();
        intList.addIfType(456);        // ì„±ê³µ
        intList.addIfType("World");    // ì‹¤íŒ¨

        System.out.println("\nìµœì¢… ê²°ê³¼:");
        System.out.println("String ë¦¬ìŠ¤íŠ¸: " + stringList.getItems());
        System.out.println("Integer ë¦¬ìŠ¤íŠ¸: " + intList.getItems());
    }
}
```

### ì‹¤í–‰ ê²°ê³¼
```
ì €ì¥ëœ íƒ€ì…: java.lang.String
âœ… ì¶”ê°€: Hello (íƒ€ì…: String)
âŒ íƒ€ì… ë¶ˆì¼ì¹˜: Integer (ê¸°ëŒ€: String)

ì €ì¥ëœ íƒ€ì…: java.lang.Integer
âœ… ì¶”ê°€: 456 (íƒ€ì…: Integer)
âŒ íƒ€ì… ë¶ˆì¼ì¹˜: String (ê¸°ëŒ€: Integer)

ìµœì¢… ê²°ê³¼:
String ë¦¬ìŠ¤íŠ¸: [Hello]
Integer ë¦¬ìŠ¤íŠ¸: [456]
```

### êµí›ˆ
- **íƒ€ì… ì†Œê±°**: ì œë„¤ë¦­ íƒ€ì… ì •ë³´ëŠ” ëŸ°íƒ€ì„ì— ì‚¬ë¼ì§
- **Class ê°ì²´ ì „ë‹¬**: `Class<T>` ë¥¼ ìƒì„±ì íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ íƒ€ì… ì •ë³´ ë³´ì¡´
- **instanceof ì œí•œ**: `obj instanceof T` ë¶ˆê°€, `type.isInstance(obj)` ì‚¬ìš©
- **ì‹¤ë¬´ íŒ¨í„´**: Jackson, Gson ë“± JSON ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì´ ë°©ì‹ ì‚¬ìš© (`TypeReference<T>`)

---

## ğŸ¯ Part 2 í•µì‹¬ ìš”ì•½

### ê¸°ì—… ì‚¬ë¡€ í•µì‹¬ íŒ¨í„´
1. **API Response Wrapper** (ë„¤ì´ë²„): ì¼ê´€ëœ ì‘ë‹µ êµ¬ì¡°, íƒ€ì… ì•ˆì „ì„±
2. **Generic DAO** (ì¹´ì¹´ì˜¤): CRUD ì½”ë“œ ì¬ì‚¬ìš©, ì—”í‹°í‹°ë³„ íƒ€ì… ë³´ì¥
3. **Generic Cache** (ì¿ íŒ¡): ë²”ìš© ìºì‹œ ì‹œìŠ¤í…œ, LRU + TTL êµ¬í˜„

### ì£¼ë‹ˆì–´ ì‹¤ìˆ˜ ë°©ì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸
- âŒ Raw Type ì‚¬ìš© ê¸ˆì§€ â†’ âœ… `List<T>` ëª…ì‹œ
- âŒ ì œë„¤ë¦­ ë°°ì—´ ìƒì„± ê¸ˆì§€ â†’ âœ… `List<T>` ì‚¬ìš©
- âŒ ì™€ì¼ë“œì¹´ë“œ ì˜¤ìš© â†’ âœ… PECS ì›ì¹™ (Producer-Extends, Consumer-Super)
- âŒ íƒ€ì… ì†Œê±° ë¬´ì‹œ â†’ âœ… `Class<T>` ê°ì²´ í™œìš©

### ì‹¤ë¬´ ì ìš© í¬ì¸íŠ¸
- Spring Framework: `ResponseEntity<T>`, JpaRepository<T, ID>
- Functional Programming: `Function<T, R>`, `Supplier<T>`
- JSON ë¼ì´ë¸ŒëŸ¬ë¦¬: `TypeReference<T>`, `Gson.fromJson(json, Class<T>)`

ë‹¤ìŒ Part 3ì—ì„œëŠ” ì‹¤ì „ í”„ë¡œì íŠ¸ë¡œ "ë²”ìš© ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì—”ì§„"ì„ êµ¬í˜„í•˜ê³ , ë©´ì ‘ ì§ˆë¬¸ì„ ë‹¤ë£¹ë‹ˆë‹¤! ğŸš€
